var w_=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var E_=w_((exports,module)=>{function _mergeNamespaces(e,o){for(var s=0;s<o.length;s++){const h=o[s];if(typeof h!="string"&&!Array.isArray(h)){for(const d in h)if(d!=="default"&&!(d in e)){const g=Object.getOwnPropertyDescriptor(h,d);g&&Object.defineProperty(e,d,g.get?g:{enumerable:!0,get:()=>h[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))h(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const _ of g.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&h(_)}).observe(document,{childList:!0,subtree:!0});function s(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function h(d){if(d.ep)return;d.ep=!0;const g=s(d);fetch(d.href,g)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,o,s){this.props=e,this.context=o,this.refs=D$1,this.updater=s||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,o){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,o,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,o,s){this.props=e,this.context=o,this.refs=D$1,this.updater=s||B$1}var H$3=G$1.prototype=new F;H$3.constructor=G$1;C$1(H$3,E$1.prototype);H$3.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,o,s){var h,d={},g=null,_=null;if(o!=null)for(h in o.ref!==void 0&&(_=o.ref),o.key!==void 0&&(g=""+o.key),o)J.call(o,h)&&!L$1.hasOwnProperty(h)&&(d[h]=o[h]);var j=arguments.length-2;if(j===1)d.children=s;else if(1<j){for(var $=Array(j),_t=0;_t<j;_t++)$[_t]=arguments[_t+2];d.children=$}if(e&&e.defaultProps)for(h in j=e.defaultProps,j)d[h]===void 0&&(d[h]=j[h]);return{$$typeof:l$1,type:e,key:g,ref:_,props:d,_owner:K$1.current}}function N$1(e,o){return{$$typeof:l$1,type:e.type,key:o,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape(e){var o={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return o[s]})}var P$1=/\/+/g;function Q$1(e,o){return typeof e=="object"&&e!==null&&e.key!=null?escape(""+e.key):o.toString(36)}function R$1(e,o,s,h,d){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var _=!1;if(e===null)_=!0;else switch(g){case"string":case"number":_=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:_=!0}}if(_)return _=e,d=d(_),e=h===""?"."+Q$1(_,0):h,I$1(d)?(s="",e!=null&&(s=e.replace(P$1,"$&/")+"/"),R$1(d,o,s,"",function(_t){return _t})):d!=null&&(O$1(d)&&(d=N$1(d,s+(!d.key||_&&_.key===d.key?"":(""+d.key).replace(P$1,"$&/")+"/")+e)),o.push(d)),1;if(_=0,h=h===""?".":h+":",I$1(e))for(var j=0;j<e.length;j++){g=e[j];var $=h+Q$1(g,j);_+=R$1(g,o,s,$,d)}else if($=A$1(e),typeof $=="function")for(e=$.call(e),j=0;!(g=e.next()).done;)g=g.value,$=h+Q$1(g,j++),_+=R$1(g,o,s,$,d);else if(g==="object")throw o=String(e),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return _}function S$1(e,o,s){if(e==null)return e;var h=[],d=0;return R$1(e,h,"","",function(g){return o.call(s,g,d++)}),h}function T$1(e){if(e._status===-1){var o=e._result;o=o(),o.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=o)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};react_production_min.Children={map:S$1,forEach:function(e,o,s){S$1(e,function(){o.apply(this,arguments)},s)},count:function(e){var o=0;return S$1(e,function(){o++}),o},toArray:function(e){return S$1(e,function(o){return o})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function(e,o,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var h=C$1({},e.props),d=e.key,g=e.ref,_=e._owner;if(o!=null){if(o.ref!==void 0&&(g=o.ref,_=K$1.current),o.key!==void 0&&(d=""+o.key),e.type&&e.type.defaultProps)var j=e.type.defaultProps;for($ in o)J.call(o,$)&&!L$1.hasOwnProperty($)&&(h[$]=o[$]===void 0&&j!==void 0?j[$]:o[$])}var $=arguments.length-2;if($===1)h.children=s;else if(1<$){j=Array($);for(var _t=0;_t<$;_t++)j[_t]=arguments[_t+2];h.children=j}return{$$typeof:l$1,type:e.type,key:d,ref:g,props:h,_owner:_}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var o=M$1.bind(null,e);return o.type=e,o};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,o){return{$$typeof:x,type:e,compare:o===void 0?null:o}};react_production_min.startTransition=function(e){var o=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=o}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(e,o){return U$1.current.useCallback(e,o)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,o){return U$1.current.useEffect(e,o)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,o,s){return U$1.current.useImperativeHandle(e,o,s)};react_production_min.useInsertionEffect=function(e,o){return U$1.current.useInsertionEffect(e,o)};react_production_min.useLayoutEffect=function(e,o){return U$1.current.useLayoutEffect(e,o)};react_production_min.useMemo=function(e,o){return U$1.current.useMemo(e,o)};react_production_min.useReducer=function(e,o,s){return U$1.current.useReducer(e,o,s)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,o,s){return U$1.current.useSyncExternalStore(e,o,s)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,o,s){var h,d={},g=null,_=null;s!==void 0&&(g=""+s),o.key!==void 0&&(g=""+o.key),o.ref!==void 0&&(_=o.ref);for(h in o)m$1.call(o,h)&&!p$1.hasOwnProperty(h)&&(d[h]=o[h]);if(e&&e.defaultProps)for(h in o=e.defaultProps,o)d[h]===void 0&&(d[h]=o[h]);return{$$typeof:k,type:e,key:g,ref:_,props:d,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function o(Ay,Ny){var Hy=Ay.length;Ay.push(Ny);t:for(;0<Hy;){var n0=Hy-1>>>1,v0=Ay[n0];if(0<d(v0,Ny))Ay[n0]=Ny,Ay[Hy]=v0,Hy=n0;else break t}}function s(Ay){return Ay.length===0?null:Ay[0]}function h(Ay){if(Ay.length===0)return null;var Ny=Ay[0],Hy=Ay.pop();if(Hy!==Ny){Ay[0]=Hy;t:for(var n0=0,v0=Ay.length,f0=v0>>>1;n0<f0;){var A0=2*(n0+1)-1,q0=Ay[A0],D0=A0+1,K0=Ay[D0];if(0>d(q0,Hy))D0<v0&&0>d(K0,q0)?(Ay[n0]=K0,Ay[D0]=Hy,n0=D0):(Ay[n0]=q0,Ay[A0]=Hy,n0=A0);else if(D0<v0&&0>d(K0,Hy))Ay[n0]=K0,Ay[D0]=Hy,n0=D0;else break t}}return Ny}function d(Ay,Ny){var Hy=Ay.sortIndex-Ny.sortIndex;return Hy!==0?Hy:Ay.id-Ny.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var _=Date,j=_.now();e.unstable_now=function(){return _.now()-j}}var $=[],_t=[],_e=1,_r=null,_n=3,_o=!1,ga=!1,_l=!1,_f=typeof setTimeout=="function"?setTimeout:null,_c=typeof clearTimeout=="function"?clearTimeout:null,_p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _g(Ay){for(var Ny=s(_t);Ny!==null;){if(Ny.callback===null)h(_t);else if(Ny.startTime<=Ay)h(_t),Ny.sortIndex=Ny.expirationTime,o($,Ny);else break;Ny=s(_t)}}function ty(Ay){if(_l=!1,_g(Ay),!ga)if(s($)!==null)ga=!0,s0(oy);else{var Ny=s(_t);Ny!==null&&t0(ty,Ny.startTime-Ay)}}function oy(Ay,Ny){ga=!1,_l&&(_l=!1,_c(py),py=-1),_o=!0;var Hy=_n;try{for(_g(Ny),_r=s($);_r!==null&&(!(_r.expirationTime>Ny)||Ay&&!wy());){var n0=_r.callback;if(typeof n0=="function"){_r.callback=null,_n=_r.priorityLevel;var v0=n0(_r.expirationTime<=Ny);Ny=e.unstable_now(),typeof v0=="function"?_r.callback=v0:_r===s($)&&h($),_g(Ny)}else h($);_r=s($)}if(_r!==null)var f0=!0;else{var A0=s(_t);A0!==null&&t0(ty,A0.startTime-Ny),f0=!1}return f0}finally{_r=null,_n=Hy,_o=!1}}var ry=!1,ly=null,py=-1,gy=5,by=-1;function wy(){return!(e.unstable_now()-by<gy)}function Cy(){if(ly!==null){var Ay=e.unstable_now();by=Ay;var Ny=!0;try{Ny=ly(!0,Ay)}finally{Ny?Gy():(ry=!1,ly=null)}}else ry=!1}var Gy;if(typeof _p=="function")Gy=function(){_p(Cy)};else if(typeof MessageChannel<"u"){var Ly=new MessageChannel,d0=Ly.port2;Ly.port1.onmessage=Cy,Gy=function(){d0.postMessage(null)}}else Gy=function(){_f(Cy,0)};function s0(Ay){ly=Ay,ry||(ry=!0,Gy())}function t0(Ay,Ny){py=_f(function(){Ay(e.unstable_now())},Ny)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ay){Ay.callback=null},e.unstable_continueExecution=function(){ga||_o||(ga=!0,s0(oy))},e.unstable_forceFrameRate=function(Ay){0>Ay||125<Ay?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):gy=0<Ay?Math.floor(1e3/Ay):5},e.unstable_getCurrentPriorityLevel=function(){return _n},e.unstable_getFirstCallbackNode=function(){return s($)},e.unstable_next=function(Ay){switch(_n){case 1:case 2:case 3:var Ny=3;break;default:Ny=_n}var Hy=_n;_n=Ny;try{return Ay()}finally{_n=Hy}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ay,Ny){switch(Ay){case 1:case 2:case 3:case 4:case 5:break;default:Ay=3}var Hy=_n;_n=Ay;try{return Ny()}finally{_n=Hy}},e.unstable_scheduleCallback=function(Ay,Ny,Hy){var n0=e.unstable_now();switch(typeof Hy=="object"&&Hy!==null?(Hy=Hy.delay,Hy=typeof Hy=="number"&&0<Hy?n0+Hy:n0):Hy=n0,Ay){case 1:var v0=-1;break;case 2:v0=250;break;case 5:v0=1073741823;break;case 4:v0=1e4;break;default:v0=5e3}return v0=Hy+v0,Ay={id:_e++,callback:Ny,priorityLevel:Ay,startTime:Hy,expirationTime:v0,sortIndex:-1},Hy>n0?(Ay.sortIndex=Hy,o(_t,Ay),s($)===null&&Ay===s(_t)&&(_l?(_c(py),py=-1):_l=!0,t0(ty,Hy-n0))):(Ay.sortIndex=v0,o($,Ay),ga||_o||(ga=!0,s0(oy))),Ay},e.unstable_shouldYield=wy,e.unstable_wrapCallback=function(Ay){var Ny=_n;return function(){var Hy=_n;_n=Ny;try{return Ay.apply(this,arguments)}finally{_n=Hy}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)o+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,o){ha(e,o),ha(e+"Capture",o)}function ha(e,o){for(ea[e]=o,e=0;e<o.length;e++)da.add(o[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,o,s,h){if(s!==null&&s.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,o,s,h){if(o===null||typeof o>"u"||pa(e,o,s,h))return!0;if(h)return!1;if(s!==null)switch(s.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v(e,o,s,h,d,g,_){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=d,this.mustUseProperty=s,this.propertyName=e,this.type=o,this.sanitizeURL=g,this.removeEmptyString=_}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var o=e[0];z[o]=new v(o,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,o,s,h){var d=z.hasOwnProperty(o)?z[o]:null;(d!==null?d.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(qa(o,s,d,h)&&(s=null),h||d===null?oa(o)&&(s===null?e.removeAttribute(o):e.setAttribute(o,""+s)):d.mustUseProperty?e[d.propertyName]=s===null?d.type===3?!1:"":s:(o=d.attributeName,h=d.attributeNamespace,s===null?e.removeAttribute(o):(d=d.type,s=d===3||d===4&&s===!0?"":""+s,h?e.setAttributeNS(h,o,s):e.setAttribute(o,s))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(s){var o=s.stack.trim().match(/\n( *(at )?)/);La=o&&o[1]||""}return`
`+La+e}var Na=!1;function Oa(e,o){if(!e||Na)return"";Na=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(_t){var h=_t}Reflect.construct(e,[],o)}else{try{o.call()}catch(_t){h=_t}e.call(o.prototype)}else{try{throw Error()}catch(_t){h=_t}e()}}catch(_t){if(_t&&h&&typeof _t.stack=="string"){for(var d=_t.stack.split(`
`),g=h.stack.split(`
`),_=d.length-1,j=g.length-1;1<=_&&0<=j&&d[_]!==g[j];)j--;for(;1<=_&&0<=j;_--,j--)if(d[_]!==g[j]){if(_!==1||j!==1)do if(_--,j--,0>j||d[_]!==g[j]){var $=`
`+d[_].replace(" at new "," at ");return e.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",e.displayName)),$}while(1<=_&&0<=j);break}}}finally{Na=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var o=e.render;return e=e.displayName,e||(e=o.displayName||o.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return o=e.displayName||null,o!==null?o:Qa(e.type)||"Memo";case Ha:o=e._payload,e=e._init;try{return Qa(e(o))}catch{}}return null}function Ra(e){var o=e.type;switch(e.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=o.render,e=e.displayName||e.name||"",o.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(o);case 8:return o===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var o=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ua(e){var o=Ta(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,o),h=""+e[o];if(!e.hasOwnProperty(o)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var d=s.get,g=s.set;return Object.defineProperty(e,o,{configurable:!0,get:function(){return d.call(this)},set:function(_){h=""+_,g.call(this,_)}}),Object.defineProperty(e,o,{enumerable:s.enumerable}),{getValue:function(){return h},setValue:function(_){h=""+_},stopTracking:function(){e._valueTracker=null,delete e[o]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var o=e._valueTracker;if(!o)return!0;var s=o.getValue(),h="";return e&&(h=Ta(e)?e.checked?"true":"false":e.value),e=h,e!==s?(o.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,o){var s=o.checked;return A({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Za(e,o){var s=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;s=Sa(o.value!=null?o.value:s),e._wrapperState={initialChecked:h,initialValue:s,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ab(e,o){o=o.checked,o!=null&&ta(e,"checked",o,!1)}function bb(e,o){ab(e,o);var s=Sa(o.value),h=o.type;if(s!=null)h==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(h==="submit"||h==="reset"){e.removeAttribute("value");return}o.hasOwnProperty("value")?cb(e,o.type,s):o.hasOwnProperty("defaultValue")&&cb(e,o.type,Sa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(e.defaultChecked=!!o.defaultChecked)}function db(e,o,s){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+e._wrapperState.initialValue,s||o===e.value||(e.value=o),e.defaultValue=o}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function cb(e,o,s){(o!=="number"||Xa(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var eb=Array.isArray;function fb(e,o,s,h){if(e=e.options,o){o={};for(var d=0;d<s.length;d++)o["$"+s[d]]=!0;for(s=0;s<e.length;s++)d=o.hasOwnProperty("$"+e[s].value),e[s].selected!==d&&(e[s].selected=d),d&&h&&(e[s].defaultSelected=!0)}else{for(s=""+Sa(s),o=null,d=0;d<e.length;d++){if(e[d].value===s){e[d].selected=!0,h&&(e[d].defaultSelected=!0);return}o!==null||e[d].disabled||(o=e[d])}o!==null&&(o.selected=!0)}}function gb(e,o){if(o.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},o,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,o){var s=o.value;if(s==null){if(s=o.children,o=o.defaultValue,s!=null){if(o!=null)throw Error(p(92));if(eb(s)){if(1<s.length)throw Error(p(93));s=s[0]}o=s}o==null&&(o=""),s=o}e._wrapperState={initialValue:Sa(s)}}function ib(e,o){var s=Sa(o.value),h=Sa(o.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),o.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),h!=null&&(e.defaultValue=""+h)}function jb(e){var o=e.textContent;o===e._wrapperState.initialValue&&o!==""&&o!==null&&(e.value=o)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,o){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(o):e==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,s,h,d){MSApp.execUnsafeLocalFunction(function(){return e(o,s,h,d)})}:e}(function(e,o){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=o;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;o.firstChild;)e.appendChild(o.firstChild)}});function ob(e,o){if(o){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=o;return}}e.textContent=o}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(o){o=o+e.charAt(0).toUpperCase()+e.substring(1),pb[o]=pb[e]})});function rb(e,o,s){return o==null||typeof o=="boolean"||o===""?"":s||typeof o!="number"||o===0||pb.hasOwnProperty(e)&&pb[e]?(""+o).trim():o+"px"}function sb(e,o){e=e.style;for(var s in o)if(o.hasOwnProperty(s)){var h=s.indexOf("--")===0,d=rb(s,o[s],h);s==="float"&&(s="cssFloat"),h?e.setProperty(s,d):e[s]=d}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,o){if(o){if(tb[e]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(p(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(p(61))}if(o.style!=null&&typeof o.style!="object")throw Error(p(62))}}function vb(e,o){if(e.indexOf("-")===-1)return typeof o.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var o=e.stateNode;o&&(o=Db(o),yb(e.stateNode,e.type,o))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,o=Ab;if(Ab=zb=null,Bb(e),o)for(e=0;e<o.length;e++)Bb(o[e])}}function Gb(e,o){return e(o)}function Hb(){}var Ib=!1;function Jb(e,o,s){if(Ib)return e(o,s);Ib=!0;try{return Gb(e,o,s)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,o){var s=e.stateNode;if(s===null)return null;var h=Db(s);if(h===null)return null;s=h[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break t;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(p(231,o,typeof s));return s}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,o,s,h,d,g,_,j,$){var _t=Array.prototype.slice.call(arguments,3);try{o.apply(s,_t)}catch(_e){this.onError(_e)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,o,s,h,d,g,_,j,$){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,o,s,h,d,g,_,j,$){if(Tb.apply(this,arguments),Ob){if(Ob){var _t=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_t)}}function Vb(e){var o=e,s=e;if(e.alternate)for(;o.return;)o=o.return;else{e=o;do o=e,o.flags&4098&&(s=o.return),e=o.return;while(e)}return o.tag===3?s:null}function Wb(e){if(e.tag===13){var o=e.memoizedState;if(o===null&&(e=e.alternate,e!==null&&(o=e.memoizedState)),o!==null)return o.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var o=e.alternate;if(!o){if(o=Vb(e),o===null)throw Error(p(188));return o!==e?null:e}for(var s=e,h=o;;){var d=s.return;if(d===null)break;var g=d.alternate;if(g===null){if(h=d.return,h!==null){s=h;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===s)return Xb(d),e;if(g===h)return Xb(d),o;g=g.sibling}throw Error(p(188))}if(s.return!==h.return)s=d,h=g;else{for(var _=!1,j=d.child;j;){if(j===s){_=!0,s=d,h=g;break}if(j===h){_=!0,h=d,s=g;break}j=j.sibling}if(!_){for(j=g.child;j;){if(j===s){_=!0,s=g,h=d;break}if(j===h){_=!0,h=g,s=d;break}j=j.sibling}if(!_)throw Error(p(189))}}if(s.alternate!==h)throw Error(p(190))}if(s.tag!==3)throw Error(p(188));return s.stateNode.current===s?e:o}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var o=$b(e);if(o!==null)return o;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,o){var s=e.pendingLanes;if(s===0)return 0;var h=0,d=e.suspendedLanes,g=e.pingedLanes,_=s&268435455;if(_!==0){var j=_&~d;j!==0?h=tc(j):(g&=_,g!==0&&(h=tc(g)))}else _=s&~d,_!==0?h=tc(_):g!==0&&(h=tc(g));if(h===0)return 0;if(o!==0&&o!==h&&!(o&d)&&(d=h&-h,g=o&-o,d>=g||d===16&&(g&4194240)!==0))return o;if(h&4&&(h|=s&16),o=e.entangledLanes,o!==0)for(e=e.entanglements,o&=h;0<o;)s=31-oc(o),d=1<<s,h|=e[s],o&=~d;return h}function vc(e,o){switch(e){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,o){for(var s=e.suspendedLanes,h=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes;0<g;){var _=31-oc(g),j=1<<_,$=d[_];$===-1?(!(j&s)||j&h)&&(d[_]=vc(j,o)):$<=o&&(e.expiredLanes|=j),g&=~j}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var o=[],s=0;31>s;s++)o.push(e);return o}function Ac(e,o,s){e.pendingLanes|=o,o!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,o=31-oc(o),e[o]=s}function Bc(e,o){var s=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;var h=e.eventTimes;for(e=e.expirationTimes;0<s;){var d=31-oc(s),g=1<<d;o[d]=0,h[d]=-1,e[d]=-1,s&=~g}}function Cc(e,o){var s=e.entangledLanes|=o;for(e=e.entanglements;s;){var h=31-oc(s),d=1<<h;d&o|e[h]&o&&(e[h]|=o),s&=~d}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,o){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(o.pointerId)}}function Tc(e,o,s,h,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:o,domEventName:s,eventSystemFlags:h,nativeEvent:g,targetContainers:[d]},o!==null&&(o=Cb(o),o!==null&&Fc(o)),e):(e.eventSystemFlags|=h,o=e.targetContainers,d!==null&&o.indexOf(d)===-1&&o.push(d),e)}function Uc(e,o,s,h,d){switch(o){case"focusin":return Lc=Tc(Lc,e,o,s,h,d),!0;case"dragenter":return Mc=Tc(Mc,e,o,s,h,d),!0;case"mouseover":return Nc=Tc(Nc,e,o,s,h,d),!0;case"pointerover":var g=d.pointerId;return Oc.set(g,Tc(Oc.get(g)||null,e,o,s,h,d)),!0;case"gotpointercapture":return g=d.pointerId,Pc.set(g,Tc(Pc.get(g)||null,e,o,s,h,d)),!0}return!1}function Vc(e){var o=Wc(e.target);if(o!==null){var s=Vb(o);if(s!==null){if(o=s.tag,o===13){if(o=Wb(s),o!==null){e.blockedOn=o,Ic(e.priority,function(){Gc(s)});return}}else if(o===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var o=e.targetContainers;0<o.length;){var s=Yc(e.domEventName,e.eventSystemFlags,o[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var h=new s.constructor(s.type,s);wb=h,s.target.dispatchEvent(h),wb=null}else return o=Cb(s),o!==null&&Fc(o),e.blockedOn=s,!1;o.shift()}return!0}function Zc(e,o,s){Xc(e)&&s.delete(o)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,o){e.blockedOn===o&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function o(d){return ad(d,e)}if(0<Kc.length){ad(Kc[0],e);for(var s=1;s<Kc.length;s++){var h=Kc[s];h.blockedOn===e&&(h.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(o),Pc.forEach(o),s=0;s<Qc.length;s++)h=Qc[s],h.blockedOn===e&&(h.blockedOn=null);for(;0<Qc.length&&(s=Qc[0],s.blockedOn===null);)Vc(s),s.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,o,s,h){var d=C,g=cd.transition;cd.transition=null;try{C=1,fd(e,o,s,h)}finally{C=d,cd.transition=g}}function gd(e,o,s,h){var d=C,g=cd.transition;cd.transition=null;try{C=4,fd(e,o,s,h)}finally{C=d,cd.transition=g}}function fd(e,o,s,h){if(dd){var d=Yc(e,o,s,h);if(d===null)hd(e,o,h,id,s),Sc(e,h);else if(Uc(d,e,o,s,h))h.stopPropagation();else if(Sc(e,h),o&4&&-1<Rc.indexOf(e)){for(;d!==null;){var g=Cb(d);if(g!==null&&Ec(g),g=Yc(e,o,s,h),g===null&&hd(e,o,h,id,s),g===d)break;d=g}d!==null&&h.stopPropagation()}else hd(e,o,h,null,s)}}var id=null;function Yc(e,o,s,h){if(id=null,e=xb(h),e=Wc(e),e!==null)if(o=Vb(e),o===null)e=null;else if(s=o.tag,s===13){if(e=Wb(o),e!==null)return e;e=null}else if(s===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;e=null}else o!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,o=ld,s=o.length,h,d="value"in kd?kd.value:kd.textContent,g=d.length;for(e=0;e<s&&o[e]===d[e];e++);var _=s-e;for(h=1;h<=_&&o[s-h]===d[g-h];h++);return md=d.slice(e,1<h?1-h:void 0)}function od(e){var o=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&o===13&&(e=13)):e=o,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function o(s,h,d,g,_){this._reactName=s,this._targetInst=d,this.type=h,this.nativeEvent=g,this.target=_,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(s=e[j],this[j]=s?s(g):g[j]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),o}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(e):(e=Od[e])?!!o[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var o=Md[e.key]||e.key;if(o!=="Unidentified")return o}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(e,o){switch(e){case"keyup":return $d.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,o){switch(e){case"compositionend":return he(o);case"keypress":return o.which!==32?null:(fe=!0,ee);case"textInput":return e=o.data,e===ee&&fe?null:e;default:return null}}function ke(e,o){if(ie)return e==="compositionend"||!ae&&ge(e,o)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return de&&o.locale!=="ko"?null:o.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o==="input"?!!le[e.type]:o==="textarea"}function ne(e,o,s,h){Eb(h),o=oe(o,"onChange"),0<o.length&&(s=new td("onChange","change",null,s,h),e.push({event:s,listeners:o}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){var o=ue(e);if(Wa(o))return e}function ve(e,o){if(e==="change")return o}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var o=[];ne(o,qe,e,xb(e)),Jb(re,o)}}function Ce(e,o,s){e==="focusin"?(Ae(),pe=o,qe=s,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,o){if(e==="click")return te(o)}function Fe(e,o){if(e==="input"||e==="change")return te(o)}function Ge(e,o){return e===o&&(e!==0||1/e===1/o)||e!==e&&o!==o}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,o){if(He(e,o))return!0;if(typeof e!="object"||e===null||typeof o!="object"||o===null)return!1;var s=Object.keys(e),h=Object.keys(o);if(s.length!==h.length)return!1;for(h=0;h<s.length;h++){var d=s[h];if(!ja.call(o,d)||!He(e[d],o[d]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,o){var s=Je(e);e=0;for(var h;s;){if(s.nodeType===3){if(h=e+s.textContent.length,e<=o&&h>=o)return{node:s,offset:o-e};e=h}t:{for(;s;){if(s.nextSibling){s=s.nextSibling;break t}s=s.parentNode}s=void 0}s=Je(s)}}function Le(e,o){return e&&o?e===o?!0:e&&e.nodeType===3?!1:o&&o.nodeType===3?Le(e,o.parentNode):"contains"in e?e.contains(o):e.compareDocumentPosition?!!(e.compareDocumentPosition(o)&16):!1:!1}function Me(){for(var e=window,o=Xa();o instanceof e.HTMLIFrameElement;){try{var s=typeof o.contentWindow.location.href=="string"}catch{s=!1}if(s)e=o.contentWindow;else break;o=Xa(e.document)}return o}function Ne(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o&&(o==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||o==="textarea"||e.contentEditable==="true")}function Oe(e){var o=Me(),s=e.focusedElem,h=e.selectionRange;if(o!==s&&s&&s.ownerDocument&&Le(s.ownerDocument.documentElement,s)){if(h!==null&&Ne(s)){if(o=h.start,e=h.end,e===void 0&&(e=o),"selectionStart"in s)s.selectionStart=o,s.selectionEnd=Math.min(e,s.value.length);else if(e=(o=s.ownerDocument||document)&&o.defaultView||window,e.getSelection){e=e.getSelection();var d=s.textContent.length,g=Math.min(h.start,d);h=h.end===void 0?g:Math.min(h.end,d),!e.extend&&g>h&&(d=h,h=g,g=d),d=Ke(s,g);var _=Ke(s,h);d&&_&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==_.node||e.focusOffset!==_.offset)&&(o=o.createRange(),o.setStart(d.node,d.offset),e.removeAllRanges(),g>h?(e.addRange(o),e.extend(_.node,_.offset)):(o.setEnd(_.node,_.offset),e.addRange(o)))}}for(o=[],e=s;e=e.parentNode;)e.nodeType===1&&o.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<o.length;s++)e=o[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,o,s){var h=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Te||Qe==null||Qe!==Xa(h)||(h=Qe,"selectionStart"in h&&Ne(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Se&&Ie(Se,h)||(Se=h,h=oe(Re,"onSelect"),0<h.length&&(o=new td("onSelect","select",null,o,s),e.push({event:o,listeners:h}),o.target=Qe)))}function Ve(e,o){var s={};return s[e.toLowerCase()]=o.toLowerCase(),s["Webkit"+e]="webkit"+o,s["Moz"+e]="moz"+o,s}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var o=We[e],s;for(s in o)if(o.hasOwnProperty(s)&&s in Ye)return Xe[e]=o[s];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,o){df.set(e,o),fa(o,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,o,s){var h=e.type||"unknown-event";e.currentTarget=s,Ub(h,o,void 0,e),e.currentTarget=null}function se(e,o){o=(o&4)!==0;for(var s=0;s<e.length;s++){var h=e[s],d=h.event;h=h.listeners;t:{var g=void 0;if(o)for(var _=h.length-1;0<=_;_--){var j=h[_],$=j.instance,_t=j.currentTarget;if(j=j.listener,$!==g&&d.isPropagationStopped())break t;nf(d,j,_t),g=$}else for(_=0;_<h.length;_++){if(j=h[_],$=j.instance,_t=j.currentTarget,j=j.listener,$!==g&&d.isPropagationStopped())break t;nf(d,j,_t),g=$}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,o){var s=o[of];s===void 0&&(s=o[of]=new Set);var h=e+"__bubble";s.has(h)||(pf(o,e,2,!1),s.add(h))}function qf(e,o,s){var h=0;o&&(h|=4),pf(s,e,h,o)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(s){s!=="selectionchange"&&(mf.has(s)||qf(s,!1,e),qf(s,!0,e))});var o=e.nodeType===9?e:e.ownerDocument;o===null||o[rf]||(o[rf]=!0,qf("selectionchange",!1,o))}}function pf(e,o,s,h){switch(jd(o)){case 1:var d=ed;break;case 4:d=gd;break;default:d=fd}s=d.bind(null,o,s,e),d=void 0,!Lb||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(d=!0),h?d!==void 0?e.addEventListener(o,s,{capture:!0,passive:d}):e.addEventListener(o,s,!0):d!==void 0?e.addEventListener(o,s,{passive:d}):e.addEventListener(o,s,!1)}function hd(e,o,s,h,d){var g=h;if(!(o&1)&&!(o&2)&&h!==null)t:for(;;){if(h===null)return;var _=h.tag;if(_===3||_===4){var j=h.stateNode.containerInfo;if(j===d||j.nodeType===8&&j.parentNode===d)break;if(_===4)for(_=h.return;_!==null;){var $=_.tag;if(($===3||$===4)&&($=_.stateNode.containerInfo,$===d||$.nodeType===8&&$.parentNode===d))return;_=_.return}for(;j!==null;){if(_=Wc(j),_===null)return;if($=_.tag,$===5||$===6){h=g=_;continue t}j=j.parentNode}}h=h.return}Jb(function(){var _t=g,_e=xb(s),_r=[];t:{var _n=df.get(e);if(_n!==void 0){var _o=td,ga=e;switch(e){case"keypress":if(od(s)===0)break t;case"keydown":case"keyup":_o=Rd;break;case"focusin":ga="focus",_o=Fd;break;case"focusout":ga="blur",_o=Fd;break;case"beforeblur":case"afterblur":_o=Fd;break;case"click":if(s.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_o=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_o=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_o=Vd;break;case $e:case af:case bf:_o=Hd;break;case cf:_o=Xd;break;case"scroll":_o=vd;break;case"wheel":_o=Zd;break;case"copy":case"cut":case"paste":_o=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_o=Td}var _l=(o&4)!==0,_f=!_l&&e==="scroll",_c=_l?_n!==null?_n+"Capture":null:_n;_l=[];for(var _p=_t,_g;_p!==null;){_g=_p;var ty=_g.stateNode;if(_g.tag===5&&ty!==null&&(_g=ty,_c!==null&&(ty=Kb(_p,_c),ty!=null&&_l.push(tf(_p,ty,_g)))),_f)break;_p=_p.return}0<_l.length&&(_n=new _o(_n,ga,null,s,_e),_r.push({event:_n,listeners:_l}))}}if(!(o&7)){t:{if(_n=e==="mouseover"||e==="pointerover",_o=e==="mouseout"||e==="pointerout",_n&&s!==wb&&(ga=s.relatedTarget||s.fromElement)&&(Wc(ga)||ga[uf]))break t;if((_o||_n)&&(_n=_e.window===_e?_e:(_n=_e.ownerDocument)?_n.defaultView||_n.parentWindow:window,_o?(ga=s.relatedTarget||s.toElement,_o=_t,ga=ga?Wc(ga):null,ga!==null&&(_f=Vb(ga),ga!==_f||ga.tag!==5&&ga.tag!==6)&&(ga=null)):(_o=null,ga=_t),_o!==ga)){if(_l=Bd,ty="onMouseLeave",_c="onMouseEnter",_p="mouse",(e==="pointerout"||e==="pointerover")&&(_l=Td,ty="onPointerLeave",_c="onPointerEnter",_p="pointer"),_f=_o==null?_n:ue(_o),_g=ga==null?_n:ue(ga),_n=new _l(ty,_p+"leave",_o,s,_e),_n.target=_f,_n.relatedTarget=_g,ty=null,Wc(_e)===_t&&(_l=new _l(_c,_p+"enter",ga,s,_e),_l.target=_g,_l.relatedTarget=_f,ty=_l),_f=ty,_o&&ga)e:{for(_l=_o,_c=ga,_p=0,_g=_l;_g;_g=vf(_g))_p++;for(_g=0,ty=_c;ty;ty=vf(ty))_g++;for(;0<_p-_g;)_l=vf(_l),_p--;for(;0<_g-_p;)_c=vf(_c),_g--;for(;_p--;){if(_l===_c||_c!==null&&_l===_c.alternate)break e;_l=vf(_l),_c=vf(_c)}_l=null}else _l=null;_o!==null&&wf(_r,_n,_o,_l,!1),ga!==null&&_f!==null&&wf(_r,_f,ga,_l,!0)}}t:{if(_n=_t?ue(_t):window,_o=_n.nodeName&&_n.nodeName.toLowerCase(),_o==="select"||_o==="input"&&_n.type==="file")var oy=ve;else if(me(_n))if(we)oy=Fe;else{oy=De;var ry=Ce}else(_o=_n.nodeName)&&_o.toLowerCase()==="input"&&(_n.type==="checkbox"||_n.type==="radio")&&(oy=Ee);if(oy&&(oy=oy(e,_t))){ne(_r,oy,s,_e);break t}ry&&ry(e,_n,_t),e==="focusout"&&(ry=_n._wrapperState)&&ry.controlled&&_n.type==="number"&&cb(_n,"number",_n.value)}switch(ry=_t?ue(_t):window,e){case"focusin":(me(ry)||ry.contentEditable==="true")&&(Qe=ry,Re=_t,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(_r,s,_e);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(_r,s,_e)}var ly;if(ae)t:{switch(e){case"compositionstart":var py="onCompositionStart";break t;case"compositionend":py="onCompositionEnd";break t;case"compositionupdate":py="onCompositionUpdate";break t}py=void 0}else ie?ge(e,s)&&(py="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(py="onCompositionStart");py&&(de&&s.locale!=="ko"&&(ie||py!=="onCompositionStart"?py==="onCompositionEnd"&&ie&&(ly=nd()):(kd=_e,ld="value"in kd?kd.value:kd.textContent,ie=!0)),ry=oe(_t,py),0<ry.length&&(py=new Ld(py,e,null,s,_e),_r.push({event:py,listeners:ry}),ly?py.data=ly:(ly=he(s),ly!==null&&(py.data=ly)))),(ly=ce?je(e,s):ke(e,s))&&(_t=oe(_t,"onBeforeInput"),0<_t.length&&(_e=new Ld("onBeforeInput","beforeinput",null,s,_e),_r.push({event:_e,listeners:_t}),_e.data=ly))}se(_r,o)})}function tf(e,o,s){return{instance:e,listener:o,currentTarget:s}}function oe(e,o){for(var s=o+"Capture",h=[];e!==null;){var d=e,g=d.stateNode;d.tag===5&&g!==null&&(d=g,g=Kb(e,s),g!=null&&h.unshift(tf(e,g,d)),g=Kb(e,o),g!=null&&h.push(tf(e,g,d))),e=e.return}return h}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,o,s,h,d){for(var g=o._reactName,_=[];s!==null&&s!==h;){var j=s,$=j.alternate,_t=j.stateNode;if($!==null&&$===h)break;j.tag===5&&_t!==null&&(j=_t,d?($=Kb(s,g),$!=null&&_.unshift(tf(s,$,j))):d||($=Kb(s,g),$!=null&&_.push(tf(s,$,j)))),s=s.return}_.length!==0&&e.push({event:o,listeners:_})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,o,s){if(o=zf(o),zf(e)!==o&&s)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,o){return e==="textarea"||e==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,o){var s=o,h=0;do{var d=s.nextSibling;if(e.removeChild(s),d&&d.nodeType===8)if(s=d.data,s==="/$"){if(h===0){e.removeChild(d),bd(o);return}h--}else s!=="$"&&s!=="$?"&&s!=="$!"||h++;s=d}while(s);bd(o)}function Lf(e){for(;e!=null;e=e.nextSibling){var o=e.nodeType;if(o===1||o===3)break;if(o===8){if(o=e.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var o=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(o===0)return e;o--}else s==="/$"&&o++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var o=e[Of];if(o)return o;for(var s=e.parentNode;s;){if(o=s[uf]||s[Of]){if(s=o.alternate,o.child!==null||s!==null&&s.child!==null)for(e=Mf(e);e!==null;){if(s=e[Of])return s;e=Mf(e)}return o}e=s,s=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,o){Tf++,Sf[Tf]=e.current,e.current=o}var Vf={},H$2=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,o){var s=e.type.contextTypes;if(!s)return Vf;var h=e.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var d={},g;for(g in s)d[g]=o[g];return h&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=d),d}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H$2)}function ag(e,o,s){if(H$2.current!==Vf)throw Error(p(168));G(H$2,o),G(Wf,s)}function bg(e,o,s){var h=e.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return s;h=h.getChildContext();for(var d in h)if(!(d in o))throw Error(p(108,Ra(e)||"Unknown",d));return A({},s,h)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$2.current,G(H$2,e),G(Wf,Wf.current),!0}function dg(e,o,s){var h=e.stateNode;if(!h)throw Error(p(169));s?(e=bg(e,o,Xf),h.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H$2),G(H$2,e)):E(Wf),G(Wf,s)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,o=C;try{var s=eg;for(C=1;e<s.length;e++){var h=s[e];do h=h(!0);while(h!==null)}eg=null,fg=!1}catch(d){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),d}finally{C=o,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,o){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=o}function ug(e,o,s){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var h=rg;e=sg;var d=32-oc(h)-1;h&=~(1<<d),s+=1;var g=32-oc(o)+d;if(30<g){var _=d-d%5;g=(h&(1<<_)-1).toString(32),h>>=_,d-=_,rg=1<<32-oc(o)+d|s<<d|h,sg=g+e}else rg=1<<g|s<<d|h,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,o){var s=Bg(5,null,null,0);s.elementType="DELETED",s.stateNode=o,s.return=e,o=e.deletions,o===null?(e.deletions=[s],e.flags|=16):o.push(s)}function Cg(e,o){switch(e.tag){case 5:var s=e.type;return o=o.nodeType!==1||s.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(e.stateNode=o,xg=e,yg=Lf(o.firstChild),!0):!1;case 6:return o=e.pendingProps===""||o.nodeType!==3?null:o,o!==null?(e.stateNode=o,xg=e,yg=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(s=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:o,treeContext:s,retryLane:1073741824},s=Bg(18,null,null,0),s.stateNode=o,s.return=e,e.child=s,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var o=yg;if(o){var s=o;if(!Cg(e,o)){if(Dg(e))throw Error(p(418));o=Lf(s.nextSibling);var h=xg;o&&Cg(e,o)?Ag(h,s):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var o;if((o=e.tag!==3)&&!(o=e.tag!==5)&&(o=e.type,o=o!=="head"&&o!=="body"&&!Ef(e.type,e.memoizedProps)),o&&(o=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;o;)Ag(e,o),o=Lf(o.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));t:{for(e=e.nextSibling,o=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(o===0){yg=Lf(e.nextSibling);break t}o--}else s!=="$"&&s!=="$!"&&s!=="$?"||o++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,o){if(e&&e.defaultProps){o=A({},o),e=e.defaultProps;for(var s in e)o[s]===void 0&&(o[s]=e[s]);return o}return o}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(e){var o=Mg.current;E(Mg),e._currentValue=o}function Sg(e,o,s){for(;e!==null;){var h=e.alternate;if((e.childLanes&o)!==o?(e.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),e===s)break;e=e.return}}function Tg(e,o){Ng=e,Pg=Og=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&o&&(Ug=!0),e.firstContext=null)}function Vg(e){var o=e._currentValue;if(Pg!==e)if(e={context:e,memoizedValue:o,next:null},Og===null){if(Ng===null)throw Error(p(308));Og=e,Ng.dependencies={lanes:0,firstContext:e}}else Og=Og.next=e;return o}var Wg=null;function Xg(e){Wg===null?Wg=[e]:Wg.push(e)}function Yg(e,o,s,h){var d=o.interleaved;return d===null?(s.next=s,Xg(o)):(s.next=d.next,d.next=s),o.interleaved=s,Zg(e,h)}function Zg(e,o){e.lanes|=o;var s=e.alternate;for(s!==null&&(s.lanes|=o),s=e,e=e.return;e!==null;)e.childLanes|=o,s=e.alternate,s!==null&&(s.childLanes|=o),s=e,e=e.return;return s.tag===3?s.stateNode:null}var $g=!1;function ah(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(e,o){e=e.updateQueue,o.updateQueue===e&&(o.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ch(e,o){return{eventTime:e,lane:o,tag:0,payload:null,callback:null,next:null}}function dh(e,o,s){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,K&2){var d=h.pending;return d===null?o.next=o:(o.next=d.next,d.next=o),h.pending=o,Zg(e,s)}return d=h.interleaved,d===null?(o.next=o,Xg(h)):(o.next=d.next,d.next=o),h.interleaved=o,Zg(e,s)}function eh(e,o,s){if(o=o.updateQueue,o!==null&&(o=o.shared,(s&4194240)!==0)){var h=o.lanes;h&=e.pendingLanes,s|=h,o.lanes=s,Cc(e,s)}}function fh(e,o){var s=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,s===h)){var d=null,g=null;if(s=s.firstBaseUpdate,s!==null){do{var _={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};g===null?d=g=_:g=g.next=_,s=s.next}while(s!==null);g===null?d=g=o:g=g.next=o}else d=g=o;s={baseState:h.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:h.shared,effects:h.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=o:e.next=o,s.lastBaseUpdate=o}function gh(e,o,s,h){var d=e.updateQueue;$g=!1;var g=d.firstBaseUpdate,_=d.lastBaseUpdate,j=d.shared.pending;if(j!==null){d.shared.pending=null;var $=j,_t=$.next;$.next=null,_===null?g=_t:_.next=_t,_=$;var _e=e.alternate;_e!==null&&(_e=_e.updateQueue,j=_e.lastBaseUpdate,j!==_&&(j===null?_e.firstBaseUpdate=_t:j.next=_t,_e.lastBaseUpdate=$))}if(g!==null){var _r=d.baseState;_=0,_e=_t=$=null,j=g;do{var _n=j.lane,_o=j.eventTime;if((h&_n)===_n){_e!==null&&(_e=_e.next={eventTime:_o,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});t:{var ga=e,_l=j;switch(_n=o,_o=s,_l.tag){case 1:if(ga=_l.payload,typeof ga=="function"){_r=ga.call(_o,_r,_n);break t}_r=ga;break t;case 3:ga.flags=ga.flags&-65537|128;case 0:if(ga=_l.payload,_n=typeof ga=="function"?ga.call(_o,_r,_n):ga,_n==null)break t;_r=A({},_r,_n);break t;case 2:$g=!0}}j.callback!==null&&j.lane!==0&&(e.flags|=64,_n=d.effects,_n===null?d.effects=[j]:_n.push(j))}else _o={eventTime:_o,lane:_n,tag:j.tag,payload:j.payload,callback:j.callback,next:null},_e===null?(_t=_e=_o,$=_r):_e=_e.next=_o,_|=_n;if(j=j.next,j===null){if(j=d.shared.pending,j===null)break;_n=j,j=_n.next,_n.next=null,d.lastBaseUpdate=_n,d.shared.pending=null}}while(!0);if(_e===null&&($=_r),d.baseState=$,d.firstBaseUpdate=_t,d.lastBaseUpdate=_e,o=d.shared.interleaved,o!==null){d=o;do _|=d.lane,d=d.next;while(d!==o)}else g===null&&(d.shared.lanes=0);hh|=_,e.lanes=_,e.memoizedState=_r}}function ih(e,o,s){if(e=o.effects,o.effects=null,e!==null)for(o=0;o<e.length;o++){var h=e[o],d=h.callback;if(d!==null){if(h.callback=null,h=s,typeof d!="function")throw Error(p(191,d));d.call(h)}}}var jh=new aa.Component().refs;function kh(e,o,s,h){o=e.memoizedState,s=s(h,o),s=s==null?o:A({},o,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var nh={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,o,s){e=e._reactInternals;var h=L(),d=lh(e),g=ch(h,d);g.payload=o,s!=null&&(g.callback=s),o=dh(e,g,d),o!==null&&(mh(o,e,d,h),eh(o,e,d))},enqueueReplaceState:function(e,o,s){e=e._reactInternals;var h=L(),d=lh(e),g=ch(h,d);g.tag=1,g.payload=o,s!=null&&(g.callback=s),o=dh(e,g,d),o!==null&&(mh(o,e,d,h),eh(o,e,d))},enqueueForceUpdate:function(e,o){e=e._reactInternals;var s=L(),h=lh(e),d=ch(s,h);d.tag=2,o!=null&&(d.callback=o),o=dh(e,d,h),o!==null&&(mh(o,e,h,s),eh(o,e,h))}};function oh(e,o,s,h,d,g,_){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,g,_):o.prototype&&o.prototype.isPureReactComponent?!Ie(s,h)||!Ie(d,g):!0}function ph(e,o,s){var h=!1,d=Vf,g=o.contextType;return typeof g=="object"&&g!==null?g=Vg(g):(d=Zf(o)?Xf:H$2.current,h=o.contextTypes,g=(h=h!=null)?Yf(e,d):Vf),o=new o(s,g),e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=nh,e.stateNode=o,o._reactInternals=e,h&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=g),o}function qh(e,o,s,h){e=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(s,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(s,h),o.state!==e&&nh.enqueueReplaceState(o,o.state,null)}function rh(e,o,s,h){var d=e.stateNode;d.props=s,d.state=e.memoizedState,d.refs=jh,ah(e);var g=o.contextType;typeof g=="object"&&g!==null?d.context=Vg(g):(g=Zf(o)?Xf:H$2.current,d.context=Yf(e,g)),d.state=e.memoizedState,g=o.getDerivedStateFromProps,typeof g=="function"&&(kh(e,o,g,s),d.state=e.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(o=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),o!==d.state&&nh.enqueueReplaceState(d,d.state,null),gh(e,s,d,h),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function sh(e,o,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(p(309));var h=s.stateNode}if(!h)throw Error(p(147,e));var d=h,g=""+e;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===g?o.ref:(o=function(_){var j=d.refs;j===jh&&(j=d.refs={}),_===null?delete j[g]:j[g]=_},o._stringRef=g,o)}if(typeof e!="string")throw Error(p(284));if(!s._owner)throw Error(p(290,e))}return e}function th(e,o){throw e=Object.prototype.toString.call(o),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":e))}function uh(e){var o=e._init;return o(e._payload)}function vh(e){function o(_c,_p){if(e){var _g=_c.deletions;_g===null?(_c.deletions=[_p],_c.flags|=16):_g.push(_p)}}function s(_c,_p){if(!e)return null;for(;_p!==null;)o(_c,_p),_p=_p.sibling;return null}function h(_c,_p){for(_c=new Map;_p!==null;)_p.key!==null?_c.set(_p.key,_p):_c.set(_p.index,_p),_p=_p.sibling;return _c}function d(_c,_p){return _c=wh(_c,_p),_c.index=0,_c.sibling=null,_c}function g(_c,_p,_g){return _c.index=_g,e?(_g=_c.alternate,_g!==null?(_g=_g.index,_g<_p?(_c.flags|=2,_p):_g):(_c.flags|=2,_p)):(_c.flags|=1048576,_p)}function _(_c){return e&&_c.alternate===null&&(_c.flags|=2),_c}function j(_c,_p,_g,ty){return _p===null||_p.tag!==6?(_p=xh(_g,_c.mode,ty),_p.return=_c,_p):(_p=d(_p,_g),_p.return=_c,_p)}function $(_c,_p,_g,ty){var oy=_g.type;return oy===ya?_e(_c,_p,_g.props.children,ty,_g.key):_p!==null&&(_p.elementType===oy||typeof oy=="object"&&oy!==null&&oy.$$typeof===Ha&&uh(oy)===_p.type)?(ty=d(_p,_g.props),ty.ref=sh(_c,_p,_g),ty.return=_c,ty):(ty=yh(_g.type,_g.key,_g.props,null,_c.mode,ty),ty.ref=sh(_c,_p,_g),ty.return=_c,ty)}function _t(_c,_p,_g,ty){return _p===null||_p.tag!==4||_p.stateNode.containerInfo!==_g.containerInfo||_p.stateNode.implementation!==_g.implementation?(_p=zh(_g,_c.mode,ty),_p.return=_c,_p):(_p=d(_p,_g.children||[]),_p.return=_c,_p)}function _e(_c,_p,_g,ty,oy){return _p===null||_p.tag!==7?(_p=Ah(_g,_c.mode,ty,oy),_p.return=_c,_p):(_p=d(_p,_g),_p.return=_c,_p)}function _r(_c,_p,_g){if(typeof _p=="string"&&_p!==""||typeof _p=="number")return _p=xh(""+_p,_c.mode,_g),_p.return=_c,_p;if(typeof _p=="object"&&_p!==null){switch(_p.$$typeof){case va:return _g=yh(_p.type,_p.key,_p.props,null,_c.mode,_g),_g.ref=sh(_c,null,_p),_g.return=_c,_g;case wa:return _p=zh(_p,_c.mode,_g),_p.return=_c,_p;case Ha:var ty=_p._init;return _r(_c,ty(_p._payload),_g)}if(eb(_p)||Ka(_p))return _p=Ah(_p,_c.mode,_g,null),_p.return=_c,_p;th(_c,_p)}return null}function _n(_c,_p,_g,ty){var oy=_p!==null?_p.key:null;if(typeof _g=="string"&&_g!==""||typeof _g=="number")return oy!==null?null:j(_c,_p,""+_g,ty);if(typeof _g=="object"&&_g!==null){switch(_g.$$typeof){case va:return _g.key===oy?$(_c,_p,_g,ty):null;case wa:return _g.key===oy?_t(_c,_p,_g,ty):null;case Ha:return oy=_g._init,_n(_c,_p,oy(_g._payload),ty)}if(eb(_g)||Ka(_g))return oy!==null?null:_e(_c,_p,_g,ty,null);th(_c,_g)}return null}function _o(_c,_p,_g,ty,oy){if(typeof ty=="string"&&ty!==""||typeof ty=="number")return _c=_c.get(_g)||null,j(_p,_c,""+ty,oy);if(typeof ty=="object"&&ty!==null){switch(ty.$$typeof){case va:return _c=_c.get(ty.key===null?_g:ty.key)||null,$(_p,_c,ty,oy);case wa:return _c=_c.get(ty.key===null?_g:ty.key)||null,_t(_p,_c,ty,oy);case Ha:var ry=ty._init;return _o(_c,_p,_g,ry(ty._payload),oy)}if(eb(ty)||Ka(ty))return _c=_c.get(_g)||null,_e(_p,_c,ty,oy,null);th(_p,ty)}return null}function ga(_c,_p,_g,ty){for(var oy=null,ry=null,ly=_p,py=_p=0,gy=null;ly!==null&&py<_g.length;py++){ly.index>py?(gy=ly,ly=null):gy=ly.sibling;var by=_n(_c,ly,_g[py],ty);if(by===null){ly===null&&(ly=gy);break}e&&ly&&by.alternate===null&&o(_c,ly),_p=g(by,_p,py),ry===null?oy=by:ry.sibling=by,ry=by,ly=gy}if(py===_g.length)return s(_c,ly),I&&tg(_c,py),oy;if(ly===null){for(;py<_g.length;py++)ly=_r(_c,_g[py],ty),ly!==null&&(_p=g(ly,_p,py),ry===null?oy=ly:ry.sibling=ly,ry=ly);return I&&tg(_c,py),oy}for(ly=h(_c,ly);py<_g.length;py++)gy=_o(ly,_c,py,_g[py],ty),gy!==null&&(e&&gy.alternate!==null&&ly.delete(gy.key===null?py:gy.key),_p=g(gy,_p,py),ry===null?oy=gy:ry.sibling=gy,ry=gy);return e&&ly.forEach(function(wy){return o(_c,wy)}),I&&tg(_c,py),oy}function _l(_c,_p,_g,ty){var oy=Ka(_g);if(typeof oy!="function")throw Error(p(150));if(_g=oy.call(_g),_g==null)throw Error(p(151));for(var ry=oy=null,ly=_p,py=_p=0,gy=null,by=_g.next();ly!==null&&!by.done;py++,by=_g.next()){ly.index>py?(gy=ly,ly=null):gy=ly.sibling;var wy=_n(_c,ly,by.value,ty);if(wy===null){ly===null&&(ly=gy);break}e&&ly&&wy.alternate===null&&o(_c,ly),_p=g(wy,_p,py),ry===null?oy=wy:ry.sibling=wy,ry=wy,ly=gy}if(by.done)return s(_c,ly),I&&tg(_c,py),oy;if(ly===null){for(;!by.done;py++,by=_g.next())by=_r(_c,by.value,ty),by!==null&&(_p=g(by,_p,py),ry===null?oy=by:ry.sibling=by,ry=by);return I&&tg(_c,py),oy}for(ly=h(_c,ly);!by.done;py++,by=_g.next())by=_o(ly,_c,py,by.value,ty),by!==null&&(e&&by.alternate!==null&&ly.delete(by.key===null?py:by.key),_p=g(by,_p,py),ry===null?oy=by:ry.sibling=by,ry=by);return e&&ly.forEach(function(Cy){return o(_c,Cy)}),I&&tg(_c,py),oy}function _f(_c,_p,_g,ty){if(typeof _g=="object"&&_g!==null&&_g.type===ya&&_g.key===null&&(_g=_g.props.children),typeof _g=="object"&&_g!==null){switch(_g.$$typeof){case va:t:{for(var oy=_g.key,ry=_p;ry!==null;){if(ry.key===oy){if(oy=_g.type,oy===ya){if(ry.tag===7){s(_c,ry.sibling),_p=d(ry,_g.props.children),_p.return=_c,_c=_p;break t}}else if(ry.elementType===oy||typeof oy=="object"&&oy!==null&&oy.$$typeof===Ha&&uh(oy)===ry.type){s(_c,ry.sibling),_p=d(ry,_g.props),_p.ref=sh(_c,ry,_g),_p.return=_c,_c=_p;break t}s(_c,ry);break}else o(_c,ry);ry=ry.sibling}_g.type===ya?(_p=Ah(_g.props.children,_c.mode,ty,_g.key),_p.return=_c,_c=_p):(ty=yh(_g.type,_g.key,_g.props,null,_c.mode,ty),ty.ref=sh(_c,_p,_g),ty.return=_c,_c=ty)}return _(_c);case wa:t:{for(ry=_g.key;_p!==null;){if(_p.key===ry)if(_p.tag===4&&_p.stateNode.containerInfo===_g.containerInfo&&_p.stateNode.implementation===_g.implementation){s(_c,_p.sibling),_p=d(_p,_g.children||[]),_p.return=_c,_c=_p;break t}else{s(_c,_p);break}else o(_c,_p);_p=_p.sibling}_p=zh(_g,_c.mode,ty),_p.return=_c,_c=_p}return _(_c);case Ha:return ry=_g._init,_f(_c,_p,ry(_g._payload),ty)}if(eb(_g))return ga(_c,_p,_g,ty);if(Ka(_g))return _l(_c,_p,_g,ty);th(_c,_g)}return typeof _g=="string"&&_g!==""||typeof _g=="number"?(_g=""+_g,_p!==null&&_p.tag===6?(s(_c,_p.sibling),_p=d(_p,_g),_p.return=_c,_c=_p):(s(_c,_p),_p=xh(_g,_c.mode,ty),_p.return=_c,_c=_p),_(_c)):s(_c,_p)}return _f}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(e){if(e===Dh)throw Error(p(174));return e}function Ih(e,o){switch(G(Gh,o),G(Fh,e),G(Eh,Dh),e=o.nodeType,e){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:lb(null,"");break;default:e=e===8?o.parentNode:o,o=e.namespaceURI||null,e=e.tagName,o=lb(o,e)}E(Eh),G(Eh,o)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh(e){Hh(Gh.current);var o=Hh(Eh.current),s=lb(o,e.type);o!==s&&(G(Fh,e),G(Eh,s))}function Lh(e){Fh.current===e&&(E(Eh),E(Fh))}var M=Uf(0);function Mh(e){for(var o=e;o!==null;){if(o.tag===13){var s=o.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Nh=[];function Oh(){for(var e=0;e<Nh.length;e++)Nh[e]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q(){throw Error(p(321))}function Wh(e,o){if(o===null)return!1;for(var s=0;s<o.length&&s<e.length;s++)if(!He(e[s],o[s]))return!1;return!0}function Xh(e,o,s,h,d,g){if(Rh=g,N=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ph.current=e===null||e.memoizedState===null?Yh:Zh,e=s(h,d),Th){g=0;do{if(Th=!1,Uh=0,25<=g)throw Error(p(301));g+=1,P=O=null,o.updateQueue=null,Ph.current=$h,e=s(h,d)}while(Th)}if(Ph.current=ai,o=O!==null&&O.next!==null,Rh=0,P=O=N=null,Sh=!1,o)throw Error(p(300));return e}function bi(){var e=Uh!==0;return Uh=0,e}function ci(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N.memoizedState=P=e:P=P.next=e,P}function di(){if(O===null){var e=N.alternate;e=e!==null?e.memoizedState:null}else e=O.next;var o=P===null?N.memoizedState:P.next;if(o!==null)P=o,O=e;else{if(e===null)throw Error(p(310));O=e,e={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N.memoizedState=P=e:P=P.next=e}return P}function ei(e,o){return typeof o=="function"?o(e):o}function fi(e){var o=di(),s=o.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var h=O,d=h.baseQueue,g=s.pending;if(g!==null){if(d!==null){var _=d.next;d.next=g.next,g.next=_}h.baseQueue=d=g,s.pending=null}if(d!==null){g=d.next,h=h.baseState;var j=_=null,$=null,_t=g;do{var _e=_t.lane;if((Rh&_e)===_e)$!==null&&($=$.next={lane:0,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null}),h=_t.hasEagerState?_t.eagerState:e(h,_t.action);else{var _r={lane:_e,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null};$===null?(j=$=_r,_=h):$=$.next=_r,N.lanes|=_e,hh|=_e}_t=_t.next}while(_t!==null&&_t!==g);$===null?_=h:$.next=j,He(h,o.memoizedState)||(Ug=!0),o.memoizedState=h,o.baseState=_,o.baseQueue=$,s.lastRenderedState=h}if(e=s.interleaved,e!==null){d=e;do g=d.lane,N.lanes|=g,hh|=g,d=d.next;while(d!==e)}else d===null&&(s.lanes=0);return[o.memoizedState,s.dispatch]}function gi(e){var o=di(),s=o.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var h=s.dispatch,d=s.pending,g=o.memoizedState;if(d!==null){s.pending=null;var _=d=d.next;do g=e(g,_.action),_=_.next;while(_!==d);He(g,o.memoizedState)||(Ug=!0),o.memoizedState=g,o.baseQueue===null&&(o.baseState=g),s.lastRenderedState=g}return[g,h]}function hi(){}function ii(e,o){var s=N,h=di(),d=o(),g=!He(h.memoizedState,d);if(g&&(h.memoizedState=d,Ug=!0),h=h.queue,ji(ki.bind(null,s,h,e),[e]),h.getSnapshot!==o||g||P!==null&&P.memoizedState.tag&1){if(s.flags|=2048,li(9,mi.bind(null,s,h,d,o),void 0,null),R===null)throw Error(p(349));Rh&30||ni(s,o,d)}return d}function ni(e,o,s){e.flags|=16384,e={getSnapshot:o,value:s},o=N.updateQueue,o===null?(o={lastEffect:null,stores:null},N.updateQueue=o,o.stores=[e]):(s=o.stores,s===null?o.stores=[e]:s.push(e))}function mi(e,o,s,h){o.value=s,o.getSnapshot=h,oi(o)&&pi(e)}function ki(e,o,s){return s(function(){oi(o)&&pi(e)})}function oi(e){var o=e.getSnapshot;e=e.value;try{var s=o();return!He(e,s)}catch{return!0}}function pi(e){var o=Zg(e,1);o!==null&&mh(o,e,1,-1)}function qi(e){var o=ci();return typeof e=="function"&&(e=e()),o.memoizedState=o.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:e},o.queue=e,e=e.dispatch=ri.bind(null,N,e),[o.memoizedState,e]}function li(e,o,s,h){return e={tag:e,create:o,destroy:s,deps:h,next:null},o=N.updateQueue,o===null?(o={lastEffect:null,stores:null},N.updateQueue=o,o.lastEffect=e.next=e):(s=o.lastEffect,s===null?o.lastEffect=e.next=e:(h=s.next,s.next=e,e.next=h,o.lastEffect=e)),e}function si(){return di().memoizedState}function ti(e,o,s,h){var d=ci();N.flags|=e,d.memoizedState=li(1|o,s,void 0,h===void 0?null:h)}function ui(e,o,s,h){var d=di();h=h===void 0?null:h;var g=void 0;if(O!==null){var _=O.memoizedState;if(g=_.destroy,h!==null&&Wh(h,_.deps)){d.memoizedState=li(o,s,g,h);return}}N.flags|=e,d.memoizedState=li(1|o,s,g,h)}function vi(e,o){return ti(8390656,8,e,o)}function ji(e,o){return ui(2048,8,e,o)}function wi(e,o){return ui(4,2,e,o)}function xi(e,o){return ui(4,4,e,o)}function yi(e,o){if(typeof o=="function")return e=e(),o(e),function(){o(null)};if(o!=null)return e=e(),o.current=e,function(){o.current=null}}function zi(e,o,s){return s=s!=null?s.concat([e]):null,ui(4,4,yi.bind(null,o,e),s)}function Ai(){}function Bi(e,o){var s=di();o=o===void 0?null:o;var h=s.memoizedState;return h!==null&&o!==null&&Wh(o,h[1])?h[0]:(s.memoizedState=[e,o],e)}function Ci(e,o){var s=di();o=o===void 0?null:o;var h=s.memoizedState;return h!==null&&o!==null&&Wh(o,h[1])?h[0]:(e=e(),s.memoizedState=[e,o],e)}function Di(e,o,s){return Rh&21?(He(s,o)||(s=yc(),N.lanes|=s,hh|=s,e.baseState=!0),o):(e.baseState&&(e.baseState=!1,Ug=!0),e.memoizedState=s)}function Ei(e,o){var s=C;C=s!==0&&4>s?s:4,e(!0);var h=Qh.transition;Qh.transition={};try{e(!1),o()}finally{C=s,Qh.transition=h}}function Fi(){return di().memoizedState}function Gi(e,o,s){var h=lh(e);if(s={lane:h,action:s,hasEagerState:!1,eagerState:null,next:null},Hi(e))Ii(o,s);else if(s=Yg(e,o,s,h),s!==null){var d=L();mh(s,e,h,d),Ji(s,o,h)}}function ri(e,o,s){var h=lh(e),d={lane:h,action:s,hasEagerState:!1,eagerState:null,next:null};if(Hi(e))Ii(o,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=o.lastRenderedReducer,g!==null))try{var _=o.lastRenderedState,j=g(_,s);if(d.hasEagerState=!0,d.eagerState=j,He(j,_)){var $=o.interleaved;$===null?(d.next=d,Xg(o)):(d.next=$.next,$.next=d),o.interleaved=d;return}}catch{}finally{}s=Yg(e,o,d,h),s!==null&&(d=L(),mh(s,e,h,d),Ji(s,o,h))}}function Hi(e){var o=e.alternate;return e===N||o!==null&&o===N}function Ii(e,o){Th=Sh=!0;var s=e.pending;s===null?o.next=o:(o.next=s.next,s.next=o),e.pending=o}function Ji(e,o,s){if(s&4194240){var h=o.lanes;h&=e.pendingLanes,s|=h,o.lanes=s,Cc(e,s)}}var ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(e,o){return ci().memoizedState=[e,o===void 0?null:o],e},useContext:Vg,useEffect:vi,useImperativeHandle:function(e,o,s){return s=s!=null?s.concat([e]):null,ti(4194308,4,yi.bind(null,o,e),s)},useLayoutEffect:function(e,o){return ti(4194308,4,e,o)},useInsertionEffect:function(e,o){return ti(4,2,e,o)},useMemo:function(e,o){var s=ci();return o=o===void 0?null:o,e=e(),s.memoizedState=[e,o],e},useReducer:function(e,o,s){var h=ci();return o=s!==void 0?s(o):o,h.memoizedState=h.baseState=o,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},h.queue=e,e=e.dispatch=Gi.bind(null,N,e),[h.memoizedState,e]},useRef:function(e){var o=ci();return e={current:e},o.memoizedState=e},useState:qi,useDebugValue:Ai,useDeferredValue:function(e){return ci().memoizedState=e},useTransition:function(){var e=qi(!1),o=e[0];return e=Ei.bind(null,e[1]),ci().memoizedState=e,[o,e]},useMutableSource:function(){},useSyncExternalStore:function(e,o,s){var h=N,d=ci();if(I){if(s===void 0)throw Error(p(407));s=s()}else{if(s=o(),R===null)throw Error(p(349));Rh&30||ni(h,o,s)}d.memoizedState=s;var g={value:s,getSnapshot:o};return d.queue=g,vi(ki.bind(null,h,g,e),[e]),h.flags|=2048,li(9,mi.bind(null,h,g,s,o),void 0,null),s},useId:function(){var e=ci(),o=R.identifierPrefix;if(I){var s=sg,h=rg;s=(h&~(1<<32-oc(h)-1)).toString(32)+s,o=":"+o+"R"+s,s=Uh++,0<s&&(o+="H"+s.toString(32)),o+=":"}else s=Vh++,o=":"+o+"r"+s.toString(32)+":";return e.memoizedState=o},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(e){var o=di();return Di(o,O.memoizedState,e)},useTransition:function(){var e=fi(ei)[0],o=di().memoizedState;return[e,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(e){var o=di();return O===null?o.memoizedState=e:Di(o,O.memoizedState,e)},useTransition:function(){var e=gi(ei)[0],o=di().memoizedState;return[e,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(e,o){try{var s="",h=o;do s+=Pa(h),h=h.return;while(h);var d=s}catch(g){d=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:o,stack:d,digest:null}}function Li(e,o,s){return{value:e,source:null,stack:s??null,digest:o??null}}function Mi(e,o){try{console.error(o.value)}catch(s){setTimeout(function(){throw s})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(e,o,s){s=ch(-1,s),s.tag=3,s.payload={element:null};var h=o.value;return s.callback=function(){Pi||(Pi=!0,Qi=h),Mi(e,o)},s}function Ri(e,o,s){s=ch(-1,s),s.tag=3;var h=e.type.getDerivedStateFromError;if(typeof h=="function"){var d=o.value;s.payload=function(){return h(d)},s.callback=function(){Mi(e,o)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(s.callback=function(){Mi(e,o),typeof h!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var _=o.stack;this.componentDidCatch(o.value,{componentStack:_!==null?_:""})}),s}function Ti(e,o,s){var h=e.pingCache;if(h===null){h=e.pingCache=new Ni;var d=new Set;h.set(o,d)}else d=h.get(o),d===void 0&&(d=new Set,h.set(o,d));d.has(s)||(d.add(s),e=Ui.bind(null,e,o,s),o.then(e,e))}function Vi(e){do{var o;if((o=e.tag===13)&&(o=e.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return e;e=e.return}while(e!==null);return null}function Wi(e,o,s,h,d){return e.mode&1?(e.flags|=65536,e.lanes=d,e):(e===o?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(o=ch(-1,1),o.tag=2,dh(s,o,1))),s.lanes|=1),e)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(e,o,s,h){o.child=e===null?Ch(o,null,s,h):Bh(o,e.child,s,h)}function Zi(e,o,s,h,d){s=s.render;var g=o.ref;return Tg(o,d),h=Xh(e,o,s,h,g,d),s=bi(),e!==null&&!Ug?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~d,$i(e,o,d)):(I&&s&&vg(o),o.flags|=1,Yi(e,o,h,d),o.child)}function aj(e,o,s,h,d){if(e===null){var g=s.type;return typeof g=="function"&&!bj(g)&&g.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(o.tag=15,o.type=g,cj(e,o,g,h,d)):(e=yh(s.type,null,h,o,o.mode,d),e.ref=o.ref,e.return=o,o.child=e)}if(g=e.child,!(e.lanes&d)){var _=g.memoizedProps;if(s=s.compare,s=s!==null?s:Ie,s(_,h)&&e.ref===o.ref)return $i(e,o,d)}return o.flags|=1,e=wh(g,h),e.ref=o.ref,e.return=o,o.child=e}function cj(e,o,s,h,d){if(e!==null){var g=e.memoizedProps;if(Ie(g,h)&&e.ref===o.ref)if(Ug=!1,o.pendingProps=h=g,(e.lanes&d)!==0)e.flags&131072&&(Ug=!0);else return o.lanes=e.lanes,$i(e,o,d)}return dj(e,o,s,h,d)}function ej(e,o,s){var h=o.pendingProps,d=h.children,g=e!==null?e.memoizedState:null;if(h.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=s;else{if(!(s&1073741824))return e=g!==null?g.baseLanes|s:s,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:e,cachePool:null,transitions:null},o.updateQueue=null,G(fj,gj),gj|=e,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=g!==null?g.baseLanes:s,G(fj,gj),gj|=h}else g!==null?(h=g.baseLanes|s,o.memoizedState=null):h=s,G(fj,gj),gj|=h;return Yi(e,o,d,s),o.child}function hj(e,o){var s=o.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(o.flags|=512,o.flags|=2097152)}function dj(e,o,s,h,d){var g=Zf(s)?Xf:H$2.current;return g=Yf(o,g),Tg(o,d),s=Xh(e,o,s,h,g,d),h=bi(),e!==null&&!Ug?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~d,$i(e,o,d)):(I&&h&&vg(o),o.flags|=1,Yi(e,o,s,d),o.child)}function ij(e,o,s,h,d){if(Zf(s)){var g=!0;cg(o)}else g=!1;if(Tg(o,d),o.stateNode===null)jj(e,o),ph(o,s,h),rh(o,s,h,d),h=!0;else if(e===null){var _=o.stateNode,j=o.memoizedProps;_.props=j;var $=_.context,_t=s.contextType;typeof _t=="object"&&_t!==null?_t=Vg(_t):(_t=Zf(s)?Xf:H$2.current,_t=Yf(o,_t));var _e=s.getDerivedStateFromProps,_r=typeof _e=="function"||typeof _.getSnapshotBeforeUpdate=="function";_r||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(j!==h||$!==_t)&&qh(o,_,h,_t),$g=!1;var _n=o.memoizedState;_.state=_n,gh(o,h,_,d),$=o.memoizedState,j!==h||_n!==$||Wf.current||$g?(typeof _e=="function"&&(kh(o,s,_e,h),$=o.memoizedState),(j=$g||oh(o,s,j,h,_n,$,_t))?(_r||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(o.flags|=4194308)):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=$),_.props=h,_.state=$,_.context=_t,h=j):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{_=o.stateNode,bh(e,o),j=o.memoizedProps,_t=o.type===o.elementType?j:Lg(o.type,j),_.props=_t,_r=o.pendingProps,_n=_.context,$=s.contextType,typeof $=="object"&&$!==null?$=Vg($):($=Zf(s)?Xf:H$2.current,$=Yf(o,$));var _o=s.getDerivedStateFromProps;(_e=typeof _o=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(j!==_r||_n!==$)&&qh(o,_,h,$),$g=!1,_n=o.memoizedState,_.state=_n,gh(o,h,_,d);var ga=o.memoizedState;j!==_r||_n!==ga||Wf.current||$g?(typeof _o=="function"&&(kh(o,s,_o,h),ga=o.memoizedState),(_t=$g||oh(o,s,_t,h,_n,ga,$)||!1)?(_e||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(h,ga,$),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(h,ga,$)),typeof _.componentDidUpdate=="function"&&(o.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof _.componentDidUpdate!="function"||j===e.memoizedProps&&_n===e.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||j===e.memoizedProps&&_n===e.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=ga),_.props=h,_.state=ga,_.context=$,h=_t):(typeof _.componentDidUpdate!="function"||j===e.memoizedProps&&_n===e.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||j===e.memoizedProps&&_n===e.memoizedState||(o.flags|=1024),h=!1)}return kj(e,o,s,h,g,d)}function kj(e,o,s,h,d,g){hj(e,o);var _=(o.flags&128)!==0;if(!h&&!_)return d&&dg(o,s,!1),$i(e,o,g);h=o.stateNode,Xi.current=o;var j=_&&typeof s.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,e!==null&&_?(o.child=Bh(o,e.child,null,g),o.child=Bh(o,null,j,g)):Yi(e,o,j,g),o.memoizedState=h.state,d&&dg(o,s,!0),o.child}function lj(e){var o=e.stateNode;o.pendingContext?ag(e,o.pendingContext,o.pendingContext!==o.context):o.context&&ag(e,o.context,!1),Ih(e,o.containerInfo)}function mj(e,o,s,h,d){return Ig(),Jg(d),o.flags|=256,Yi(e,o,s,h),o.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(e){return{baseLanes:e,cachePool:null,transitions:null}}function pj(e,o,s){var h=o.pendingProps,d=M.current,g=!1,_=(o.flags&128)!==0,j;if((j=_)||(j=e!==null&&e.memoizedState===null?!1:(d&2)!==0),j?(g=!0,o.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),G(M,d&1),e===null)return Eg(o),e=o.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(o.mode&1?e.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(_=h.children,e=h.fallback,g?(h=o.mode,g=o.child,_={mode:"hidden",children:_},!(h&1)&&g!==null?(g.childLanes=0,g.pendingProps=_):g=qj(_,h,0,null),e=Ah(e,h,s,null),g.return=o,e.return=o,g.sibling=e,o.child=g,o.child.memoizedState=oj(s),o.memoizedState=nj,e):rj(o,_));if(d=e.memoizedState,d!==null&&(j=d.dehydrated,j!==null))return sj(e,o,_,h,j,d,s);if(g){g=h.fallback,_=o.mode,d=e.child,j=d.sibling;var $={mode:"hidden",children:h.children};return!(_&1)&&o.child!==d?(h=o.child,h.childLanes=0,h.pendingProps=$,o.deletions=null):(h=wh(d,$),h.subtreeFlags=d.subtreeFlags&14680064),j!==null?g=wh(j,g):(g=Ah(g,_,s,null),g.flags|=2),g.return=o,h.return=o,h.sibling=g,o.child=h,h=g,g=o.child,_=e.child.memoizedState,_=_===null?oj(s):{baseLanes:_.baseLanes|s,cachePool:null,transitions:_.transitions},g.memoizedState=_,g.childLanes=e.childLanes&~s,o.memoizedState=nj,h}return g=e.child,e=g.sibling,h=wh(g,{mode:"visible",children:h.children}),!(o.mode&1)&&(h.lanes=s),h.return=o,h.sibling=null,e!==null&&(s=o.deletions,s===null?(o.deletions=[e],o.flags|=16):s.push(e)),o.child=h,o.memoizedState=null,h}function rj(e,o){return o=qj({mode:"visible",children:o},e.mode,0,null),o.return=e,e.child=o}function tj(e,o,s,h){return h!==null&&Jg(h),Bh(o,e.child,null,s),e=rj(o,o.pendingProps.children),e.flags|=2,o.memoizedState=null,e}function sj(e,o,s,h,d,g,_){if(s)return o.flags&256?(o.flags&=-257,h=Li(Error(p(422))),tj(e,o,_,h)):o.memoizedState!==null?(o.child=e.child,o.flags|=128,null):(g=h.fallback,d=o.mode,h=qj({mode:"visible",children:h.children},d,0,null),g=Ah(g,d,_,null),g.flags|=2,h.return=o,g.return=o,h.sibling=g,o.child=h,o.mode&1&&Bh(o,e.child,null,_),o.child.memoizedState=oj(_),o.memoizedState=nj,g);if(!(o.mode&1))return tj(e,o,_,null);if(d.data==="$!"){if(h=d.nextSibling&&d.nextSibling.dataset,h)var j=h.dgst;return h=j,g=Error(p(419)),h=Li(g,h,void 0),tj(e,o,_,h)}if(j=(_&e.childLanes)!==0,Ug||j){if(h=R,h!==null){switch(_&-_){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(h.suspendedLanes|_)?0:d,d!==0&&d!==g.retryLane&&(g.retryLane=d,Zg(e,d),mh(h,e,d,-1))}return uj(),h=Li(Error(p(421))),tj(e,o,_,h)}return d.data==="$?"?(o.flags|=128,o.child=e.child,o=vj.bind(null,e),d._reactRetry=o,null):(e=g.treeContext,yg=Lf(d.nextSibling),xg=o,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=o),o=rj(o,h.children),o.flags|=4096,o)}function wj(e,o,s){e.lanes|=o;var h=e.alternate;h!==null&&(h.lanes|=o),Sg(e.return,o,s)}function xj(e,o,s,h,d){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:s,tailMode:d}:(g.isBackwards=o,g.rendering=null,g.renderingStartTime=0,g.last=h,g.tail=s,g.tailMode=d)}function yj(e,o,s){var h=o.pendingProps,d=h.revealOrder,g=h.tail;if(Yi(e,o,h.children,s),h=M.current,h&2)h=h&1|2,o.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=o.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wj(e,s,o);else if(e.tag===19)wj(e,s,o);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===o)break t;for(;e.sibling===null;){if(e.return===null||e.return===o)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}h&=1}if(G(M,h),!(o.mode&1))o.memoizedState=null;else switch(d){case"forwards":for(s=o.child,d=null;s!==null;)e=s.alternate,e!==null&&Mh(e)===null&&(d=s),s=s.sibling;s=d,s===null?(d=o.child,o.child=null):(d=s.sibling,s.sibling=null),xj(o,!1,d,s,g);break;case"backwards":for(s=null,d=o.child,o.child=null;d!==null;){if(e=d.alternate,e!==null&&Mh(e)===null){o.child=d;break}e=d.sibling,d.sibling=s,s=d,d=e}xj(o,!0,s,null,g);break;case"together":xj(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function jj(e,o){!(o.mode&1)&&e!==null&&(e.alternate=null,o.alternate=null,o.flags|=2)}function $i(e,o,s){if(e!==null&&(o.dependencies=e.dependencies),hh|=o.lanes,!(s&o.childLanes))return null;if(e!==null&&o.child!==e.child)throw Error(p(153));if(o.child!==null){for(e=o.child,s=wh(e,e.pendingProps),o.child=s,s.return=o;e.sibling!==null;)e=e.sibling,s=s.sibling=wh(e,e.pendingProps),s.return=o;s.sibling=null}return o.child}function zj(e,o,s){switch(o.tag){case 3:lj(o),Ig();break;case 5:Kh(o);break;case 1:Zf(o.type)&&cg(o);break;case 4:Ih(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,d=o.memoizedProps.value;G(Mg,h._currentValue),h._currentValue=d;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(G(M,M.current&1),o.flags|=128,null):s&o.child.childLanes?pj(e,o,s):(G(M,M.current&1),e=$i(e,o,s),e!==null?e.sibling:null);G(M,M.current&1);break;case 19:if(h=(s&o.childLanes)!==0,e.flags&128){if(h)return yj(e,o,s);o.flags|=128}if(d=o.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),G(M,M.current),h)break;return null;case 22:case 23:return o.lanes=0,ej(e,o,s)}return $i(e,o,s)}var Aj,Bj,Cj,Dj;Aj=function(e,o){for(var s=o.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Bj=function(){};Cj=function(e,o,s,h){var d=e.memoizedProps;if(d!==h){e=o.stateNode,Hh(Eh.current);var g=null;switch(s){case"input":d=Ya(e,d),h=Ya(e,h),g=[];break;case"select":d=A({},d,{value:void 0}),h=A({},h,{value:void 0}),g=[];break;case"textarea":d=gb(e,d),h=gb(e,h),g=[];break;default:typeof d.onClick!="function"&&typeof h.onClick=="function"&&(e.onclick=Bf)}ub(s,h);var _;s=null;for(_t in d)if(!h.hasOwnProperty(_t)&&d.hasOwnProperty(_t)&&d[_t]!=null)if(_t==="style"){var j=d[_t];for(_ in j)j.hasOwnProperty(_)&&(s||(s={}),s[_]="")}else _t!=="dangerouslySetInnerHTML"&&_t!=="children"&&_t!=="suppressContentEditableWarning"&&_t!=="suppressHydrationWarning"&&_t!=="autoFocus"&&(ea.hasOwnProperty(_t)?g||(g=[]):(g=g||[]).push(_t,null));for(_t in h){var $=h[_t];if(j=d!=null?d[_t]:void 0,h.hasOwnProperty(_t)&&$!==j&&($!=null||j!=null))if(_t==="style")if(j){for(_ in j)!j.hasOwnProperty(_)||$&&$.hasOwnProperty(_)||(s||(s={}),s[_]="");for(_ in $)$.hasOwnProperty(_)&&j[_]!==$[_]&&(s||(s={}),s[_]=$[_])}else s||(g||(g=[]),g.push(_t,s)),s=$;else _t==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,j=j?j.__html:void 0,$!=null&&j!==$&&(g=g||[]).push(_t,$)):_t==="children"?typeof $!="string"&&typeof $!="number"||(g=g||[]).push(_t,""+$):_t!=="suppressContentEditableWarning"&&_t!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_t)?($!=null&&_t==="onScroll"&&D("scroll",e),g||j===$||(g=[])):(g=g||[]).push(_t,$))}s&&(g=g||[]).push("style",s);var _t=g;(o.updateQueue=_t)&&(o.flags|=4)}};Dj=function(e,o,s,h){s!==h&&(o.flags|=4)};function Ej(e,o){if(!I)switch(e.tailMode){case"hidden":o=e.tail;for(var s=null;o!==null;)o.alternate!==null&&(s=o),o=o.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var h=null;s!==null;)s.alternate!==null&&(h=s),s=s.sibling;h===null?o||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function S(e){var o=e.alternate!==null&&e.alternate.child===e.child,s=0,h=0;if(o)for(var d=e.child;d!==null;)s|=d.lanes|d.childLanes,h|=d.subtreeFlags&14680064,h|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)s|=d.lanes|d.childLanes,h|=d.subtreeFlags,h|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=h,e.childLanes=s,o}function Fj(e,o,s){var h=o.pendingProps;switch(wg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(o),null;case 1:return Zf(o.type)&&$f(),S(o),null;case 3:return h=o.stateNode,Jh(),E(Wf),E(H$2),Oh(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(e===null||e.child===null)&&(Gg(o)?o.flags|=4:e===null||e.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(e,o),S(o),null;case 5:Lh(o);var d=Hh(Gh.current);if(s=o.type,e!==null&&o.stateNode!=null)Cj(e,o,s,h,d),e.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(p(166));return S(o),null}if(e=Hh(Eh.current),Gg(o)){h=o.stateNode,s=o.type;var g=o.memoizedProps;switch(h[Of]=o,h[Pf]=g,e=(o.mode&1)!==0,s){case"dialog":D("cancel",h),D("close",h);break;case"iframe":case"object":case"embed":D("load",h);break;case"video":case"audio":for(d=0;d<lf.length;d++)D(lf[d],h);break;case"source":D("error",h);break;case"img":case"image":case"link":D("error",h),D("load",h);break;case"details":D("toggle",h);break;case"input":Za(h,g),D("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!g.multiple},D("invalid",h);break;case"textarea":hb(h,g),D("invalid",h)}ub(s,g),d=null;for(var _ in g)if(g.hasOwnProperty(_)){var j=g[_];_==="children"?typeof j=="string"?h.textContent!==j&&(g.suppressHydrationWarning!==!0&&Af(h.textContent,j,e),d=["children",j]):typeof j=="number"&&h.textContent!==""+j&&(g.suppressHydrationWarning!==!0&&Af(h.textContent,j,e),d=["children",""+j]):ea.hasOwnProperty(_)&&j!=null&&_==="onScroll"&&D("scroll",h)}switch(s){case"input":Va(h),db(h,g,!0);break;case"textarea":Va(h),jb(h);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(h.onclick=Bf)}h=d,o.updateQueue=h,h!==null&&(o.flags|=4)}else{_=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=_.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof h.is=="string"?e=_.createElement(s,{is:h.is}):(e=_.createElement(s),s==="select"&&(_=e,h.multiple?_.multiple=!0:h.size&&(_.size=h.size))):e=_.createElementNS(e,s),e[Of]=o,e[Pf]=h,Aj(e,o,!1,!1),o.stateNode=e;t:{switch(_=vb(s,h),s){case"dialog":D("cancel",e),D("close",e),d=h;break;case"iframe":case"object":case"embed":D("load",e),d=h;break;case"video":case"audio":for(d=0;d<lf.length;d++)D(lf[d],e);d=h;break;case"source":D("error",e),d=h;break;case"img":case"image":case"link":D("error",e),D("load",e),d=h;break;case"details":D("toggle",e),d=h;break;case"input":Za(e,h),d=Ya(e,h),D("invalid",e);break;case"option":d=h;break;case"select":e._wrapperState={wasMultiple:!!h.multiple},d=A({},h,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,h),d=gb(e,h),D("invalid",e);break;default:d=h}ub(s,d),j=d;for(g in j)if(j.hasOwnProperty(g)){var $=j[g];g==="style"?sb(e,$):g==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&nb(e,$)):g==="children"?typeof $=="string"?(s!=="textarea"||$!=="")&&ob(e,$):typeof $=="number"&&ob(e,""+$):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(ea.hasOwnProperty(g)?$!=null&&g==="onScroll"&&D("scroll",e):$!=null&&ta(e,g,$,_))}switch(s){case"input":Va(e),db(e,h,!1);break;case"textarea":Va(e),jb(e);break;case"option":h.value!=null&&e.setAttribute("value",""+Sa(h.value));break;case"select":e.multiple=!!h.multiple,g=h.value,g!=null?fb(e,!!h.multiple,g,!1):h.defaultValue!=null&&fb(e,!!h.multiple,h.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=Bf)}switch(s){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return S(o),null;case 6:if(e&&o.stateNode!=null)Dj(e,o,e.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(p(166));if(s=Hh(Gh.current),Hh(Eh.current),Gg(o)){if(h=o.stateNode,s=o.memoizedProps,h[Of]=o,(g=h.nodeValue!==s)&&(e=xg,e!==null))switch(e.tag){case 3:Af(h.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(h.nodeValue,s,(e.mode&1)!==0)}g&&(o.flags|=4)}else h=(s.nodeType===9?s:s.ownerDocument).createTextNode(h),h[Of]=o,o.stateNode=h}return S(o),null;case 13:if(E(M),h=o.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&o.mode&1&&!(o.flags&128))Hg(),Ig(),o.flags|=98560,g=!1;else if(g=Gg(o),h!==null&&h.dehydrated!==null){if(e===null){if(!g)throw Error(p(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(p(317));g[Of]=o}else Ig(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;S(o),g=!1}else zg!==null&&(Gj(zg),zg=null),g=!0;if(!g)return o.flags&65536?o:null}return o.flags&128?(o.lanes=s,o):(h=h!==null,h!==(e!==null&&e.memoizedState!==null)&&h&&(o.child.flags|=8192,o.mode&1&&(e===null||M.current&1?T===0&&(T=3):uj())),o.updateQueue!==null&&(o.flags|=4),S(o),null);case 4:return Jh(),Bj(e,o),e===null&&sf(o.stateNode.containerInfo),S(o),null;case 10:return Rg(o.type._context),S(o),null;case 17:return Zf(o.type)&&$f(),S(o),null;case 19:if(E(M),g=o.memoizedState,g===null)return S(o),null;if(h=(o.flags&128)!==0,_=g.rendering,_===null)if(h)Ej(g,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=o.child;e!==null;){if(_=Mh(e),_!==null){for(o.flags|=128,Ej(g,!1),h=_.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=s,s=o.child;s!==null;)g=s,e=h,g.flags&=14680066,_=g.alternate,_===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=_.childLanes,g.lanes=_.lanes,g.child=_.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=_.memoizedProps,g.memoizedState=_.memoizedState,g.updateQueue=_.updateQueue,g.type=_.type,e=_.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return G(M,M.current&1|2),o.child}e=e.sibling}g.tail!==null&&B()>Hj&&(o.flags|=128,h=!0,Ej(g,!1),o.lanes=4194304)}else{if(!h)if(e=Mh(_),e!==null){if(o.flags|=128,h=!0,s=e.updateQueue,s!==null&&(o.updateQueue=s,o.flags|=4),Ej(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!I)return S(o),null}else 2*B()-g.renderingStartTime>Hj&&s!==1073741824&&(o.flags|=128,h=!0,Ej(g,!1),o.lanes=4194304);g.isBackwards?(_.sibling=o.child,o.child=_):(s=g.last,s!==null?s.sibling=_:o.child=_,g.last=_)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=B(),o.sibling=null,s=M.current,G(M,h?s&1|2:s&1),o):(S(o),null);case 22:case 23:return Ij(),h=o.memoizedState!==null,e!==null&&e.memoizedState!==null!==h&&(o.flags|=8192),h&&o.mode&1?gj&1073741824&&(S(o),o.subtreeFlags&6&&(o.flags|=8192)):S(o),null;case 24:return null;case 25:return null}throw Error(p(156,o.tag))}function Jj(e,o){switch(wg(o),o.tag){case 1:return Zf(o.type)&&$f(),e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 3:return Jh(),E(Wf),E(H$2),Oh(),e=o.flags,e&65536&&!(e&128)?(o.flags=e&-65537|128,o):null;case 5:return Lh(o),null;case 13:if(E(M),e=o.memoizedState,e!==null&&e.dehydrated!==null){if(o.alternate===null)throw Error(p(340));Ig()}return e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 19:return E(M),null;case 4:return Jh(),null;case 10:return Rg(o.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj(e,o){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(h){W(e,o,h)}else s.current=null}function Nj(e,o,s){try{s()}catch(h){W(e,o,h)}}var Oj=!1;function Pj(e,o){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else t:{s=(s=e.ownerDocument)&&s.defaultView||window;var h=s.getSelection&&s.getSelection();if(h&&h.rangeCount!==0){s=h.anchorNode;var d=h.anchorOffset,g=h.focusNode;h=h.focusOffset;try{s.nodeType,g.nodeType}catch{s=null;break t}var _=0,j=-1,$=-1,_t=0,_e=0,_r=e,_n=null;e:for(;;){for(var _o;_r!==s||d!==0&&_r.nodeType!==3||(j=_+d),_r!==g||h!==0&&_r.nodeType!==3||($=_+h),_r.nodeType===3&&(_+=_r.nodeValue.length),(_o=_r.firstChild)!==null;)_n=_r,_r=_o;for(;;){if(_r===e)break e;if(_n===s&&++_t===d&&(j=_),_n===g&&++_e===h&&($=_),(_o=_r.nextSibling)!==null)break;_r=_n,_n=_r.parentNode}_r=_o}s=j===-1||$===-1?null:{start:j,end:$}}else s=null}s=s||{start:0,end:0}}else s=null;for(Df={focusedElem:e,selectionRange:s},dd=!1,V=o;V!==null;)if(o=V,e=o.child,(o.subtreeFlags&1028)!==0&&e!==null)e.return=o,V=e;else for(;V!==null;){o=V;try{var ga=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ga!==null){var _l=ga.memoizedProps,_f=ga.memoizedState,_c=o.stateNode,_p=_c.getSnapshotBeforeUpdate(o.elementType===o.type?_l:Lg(o.type,_l),_f);_c.__reactInternalSnapshotBeforeUpdate=_p}break;case 3:var _g=o.stateNode.containerInfo;_g.nodeType===1?_g.textContent="":_g.nodeType===9&&_g.documentElement&&_g.removeChild(_g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(ty){W(o,o.return,ty)}if(e=o.sibling,e!==null){e.return=o.return,V=e;break}V=o.return}return ga=Oj,Oj=!1,ga}function Qj(e,o,s){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var d=h=h.next;do{if((d.tag&e)===e){var g=d.destroy;d.destroy=void 0,g!==void 0&&Nj(o,s,g)}d=d.next}while(d!==h)}}function Rj(e,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var s=o=o.next;do{if((s.tag&e)===e){var h=s.create;s.destroy=h()}s=s.next}while(s!==o)}}function Sj(e){var o=e.ref;if(o!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof o=="function"?o(e):o.current=e}}function Tj(e){var o=e.alternate;o!==null&&(e.alternate=null,Tj(o)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(o=e.stateNode,o!==null&&(delete o[Of],delete o[Pf],delete o[of],delete o[Qf],delete o[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Uj(e){return e.tag===5||e.tag===3||e.tag===4}function Vj(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Uj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wj(e,o,s){var h=e.tag;if(h===5||h===6)e=e.stateNode,o?s.nodeType===8?s.parentNode.insertBefore(e,o):s.insertBefore(e,o):(s.nodeType===8?(o=s.parentNode,o.insertBefore(e,s)):(o=s,o.appendChild(e)),s=s._reactRootContainer,s!=null||o.onclick!==null||(o.onclick=Bf));else if(h!==4&&(e=e.child,e!==null))for(Wj(e,o,s),e=e.sibling;e!==null;)Wj(e,o,s),e=e.sibling}function Xj(e,o,s){var h=e.tag;if(h===5||h===6)e=e.stateNode,o?s.insertBefore(e,o):s.appendChild(e);else if(h!==4&&(e=e.child,e!==null))for(Xj(e,o,s),e=e.sibling;e!==null;)Xj(e,o,s),e=e.sibling}var X=null,Yj=!1;function Zj(e,o,s){for(s=s.child;s!==null;)ak(e,o,s),s=s.sibling}function ak(e,o,s){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,s)}catch{}switch(s.tag){case 5:U||Mj(s,o);case 6:var h=X,d=Yj;X=null,Zj(e,o,s),X=h,Yj=d,X!==null&&(Yj?(e=X,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):X.removeChild(s.stateNode));break;case 18:X!==null&&(Yj?(e=X,s=s.stateNode,e.nodeType===8?Kf(e.parentNode,s):e.nodeType===1&&Kf(e,s),bd(e)):Kf(X,s.stateNode));break;case 4:h=X,d=Yj,X=s.stateNode.containerInfo,Yj=!0,Zj(e,o,s),X=h,Yj=d;break;case 0:case 11:case 14:case 15:if(!U&&(h=s.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){d=h=h.next;do{var g=d,_=g.destroy;g=g.tag,_!==void 0&&(g&2||g&4)&&Nj(s,o,_),d=d.next}while(d!==h)}Zj(e,o,s);break;case 1:if(!U&&(Mj(s,o),h=s.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=s.memoizedProps,h.state=s.memoizedState,h.componentWillUnmount()}catch(j){W(s,o,j)}Zj(e,o,s);break;case 21:Zj(e,o,s);break;case 22:s.mode&1?(U=(h=U)||s.memoizedState!==null,Zj(e,o,s),U=h):Zj(e,o,s);break;default:Zj(e,o,s)}}function bk(e){var o=e.updateQueue;if(o!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Lj),o.forEach(function(h){var d=ck.bind(null,e,h);s.has(h)||(s.add(h),h.then(d,d))})}}function dk(e,o){var s=o.deletions;if(s!==null)for(var h=0;h<s.length;h++){var d=s[h];try{var g=e,_=o,j=_;t:for(;j!==null;){switch(j.tag){case 5:X=j.stateNode,Yj=!1;break t;case 3:X=j.stateNode.containerInfo,Yj=!0;break t;case 4:X=j.stateNode.containerInfo,Yj=!0;break t}j=j.return}if(X===null)throw Error(p(160));ak(g,_,d),X=null,Yj=!1;var $=d.alternate;$!==null&&($.return=null),d.return=null}catch(_t){W(d,o,_t)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)ek(o,e),o=o.sibling}function ek(e,o){var s=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(dk(o,e),fk(e),h&4){try{Qj(3,e,e.return),Rj(3,e)}catch(_l){W(e,e.return,_l)}try{Qj(5,e,e.return)}catch(_l){W(e,e.return,_l)}}break;case 1:dk(o,e),fk(e),h&512&&s!==null&&Mj(s,s.return);break;case 5:if(dk(o,e),fk(e),h&512&&s!==null&&Mj(s,s.return),e.flags&32){var d=e.stateNode;try{ob(d,"")}catch(_l){W(e,e.return,_l)}}if(h&4&&(d=e.stateNode,d!=null)){var g=e.memoizedProps,_=s!==null?s.memoizedProps:g,j=e.type,$=e.updateQueue;if(e.updateQueue=null,$!==null)try{j==="input"&&g.type==="radio"&&g.name!=null&&ab(d,g),vb(j,_);var _t=vb(j,g);for(_=0;_<$.length;_+=2){var _e=$[_],_r=$[_+1];_e==="style"?sb(d,_r):_e==="dangerouslySetInnerHTML"?nb(d,_r):_e==="children"?ob(d,_r):ta(d,_e,_r,_t)}switch(j){case"input":bb(d,g);break;case"textarea":ib(d,g);break;case"select":var _n=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!g.multiple;var _o=g.value;_o!=null?fb(d,!!g.multiple,_o,!1):_n!==!!g.multiple&&(g.defaultValue!=null?fb(d,!!g.multiple,g.defaultValue,!0):fb(d,!!g.multiple,g.multiple?[]:"",!1))}d[Pf]=g}catch(_l){W(e,e.return,_l)}}break;case 6:if(dk(o,e),fk(e),h&4){if(e.stateNode===null)throw Error(p(162));d=e.stateNode,g=e.memoizedProps;try{d.nodeValue=g}catch(_l){W(e,e.return,_l)}}break;case 3:if(dk(o,e),fk(e),h&4&&s!==null&&s.memoizedState.isDehydrated)try{bd(o.containerInfo)}catch(_l){W(e,e.return,_l)}break;case 4:dk(o,e),fk(e);break;case 13:dk(o,e),fk(e),d=e.child,d.flags&8192&&(g=d.memoizedState!==null,d.stateNode.isHidden=g,!g||d.alternate!==null&&d.alternate.memoizedState!==null||(gk=B())),h&4&&bk(e);break;case 22:if(_e=s!==null&&s.memoizedState!==null,e.mode&1?(U=(_t=U)||_e,dk(o,e),U=_t):dk(o,e),fk(e),h&8192){if(_t=e.memoizedState!==null,(e.stateNode.isHidden=_t)&&!_e&&e.mode&1)for(V=e,_e=e.child;_e!==null;){for(_r=V=_e;V!==null;){switch(_n=V,_o=_n.child,_n.tag){case 0:case 11:case 14:case 15:Qj(4,_n,_n.return);break;case 1:Mj(_n,_n.return);var ga=_n.stateNode;if(typeof ga.componentWillUnmount=="function"){h=_n,s=_n.return;try{o=h,ga.props=o.memoizedProps,ga.state=o.memoizedState,ga.componentWillUnmount()}catch(_l){W(h,s,_l)}}break;case 5:Mj(_n,_n.return);break;case 22:if(_n.memoizedState!==null){hk(_r);continue}}_o!==null?(_o.return=_n,V=_o):hk(_r)}_e=_e.sibling}t:for(_e=null,_r=e;;){if(_r.tag===5){if(_e===null){_e=_r;try{d=_r.stateNode,_t?(g=d.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(j=_r.stateNode,$=_r.memoizedProps.style,_=$!=null&&$.hasOwnProperty("display")?$.display:null,j.style.display=rb("display",_))}catch(_l){W(e,e.return,_l)}}}else if(_r.tag===6){if(_e===null)try{_r.stateNode.nodeValue=_t?"":_r.memoizedProps}catch(_l){W(e,e.return,_l)}}else if((_r.tag!==22&&_r.tag!==23||_r.memoizedState===null||_r===e)&&_r.child!==null){_r.child.return=_r,_r=_r.child;continue}if(_r===e)break t;for(;_r.sibling===null;){if(_r.return===null||_r.return===e)break t;_e===_r&&(_e=null),_r=_r.return}_e===_r&&(_e=null),_r.sibling.return=_r.return,_r=_r.sibling}}break;case 19:dk(o,e),fk(e),h&4&&bk(e);break;case 21:break;default:dk(o,e),fk(e)}}function fk(e){var o=e.flags;if(o&2){try{t:{for(var s=e.return;s!==null;){if(Uj(s)){var h=s;break t}s=s.return}throw Error(p(160))}switch(h.tag){case 5:var d=h.stateNode;h.flags&32&&(ob(d,""),h.flags&=-33);var g=Vj(e);Xj(e,g,d);break;case 3:case 4:var _=h.stateNode.containerInfo,j=Vj(e);Wj(e,j,_);break;default:throw Error(p(161))}}catch($){W(e,e.return,$)}e.flags&=-3}o&4096&&(e.flags&=-4097)}function ik(e,o,s){V=e,jk(e)}function jk(e,o,s){for(var h=(e.mode&1)!==0;V!==null;){var d=V,g=d.child;if(d.tag===22&&h){var _=d.memoizedState!==null||Kj;if(!_){var j=d.alternate,$=j!==null&&j.memoizedState!==null||U;j=Kj;var _t=U;if(Kj=_,(U=$)&&!_t)for(V=d;V!==null;)_=V,$=_.child,_.tag===22&&_.memoizedState!==null?kk(d):$!==null?($.return=_,V=$):kk(d);for(;g!==null;)V=g,jk(g),g=g.sibling;V=d,Kj=j,U=_t}lk(e)}else d.subtreeFlags&8772&&g!==null?(g.return=d,V=g):lk(e)}}function lk(e){for(;V!==null;){var o=V;if(o.flags&8772){var s=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:U||Rj(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!U)if(s===null)h.componentDidMount();else{var d=o.elementType===o.type?s.memoizedProps:Lg(o.type,s.memoizedProps);h.componentDidUpdate(d,s.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var g=o.updateQueue;g!==null&&ih(o,g,h);break;case 3:var _=o.updateQueue;if(_!==null){if(s=null,o.child!==null)switch(o.child.tag){case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}ih(o,_,s)}break;case 5:var j=o.stateNode;if(s===null&&o.flags&4){s=j;var $=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&s.focus();break;case"img":$.src&&(s.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var _t=o.alternate;if(_t!==null){var _e=_t.memoizedState;if(_e!==null){var _r=_e.dehydrated;_r!==null&&bd(_r)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||o.flags&512&&Sj(o)}catch(_n){W(o,o.return,_n)}}if(o===e){V=null;break}if(s=o.sibling,s!==null){s.return=o.return,V=s;break}V=o.return}}function hk(e){for(;V!==null;){var o=V;if(o===e){V=null;break}var s=o.sibling;if(s!==null){s.return=o.return,V=s;break}V=o.return}}function kk(e){for(;V!==null;){var o=V;try{switch(o.tag){case 0:case 11:case 15:var s=o.return;try{Rj(4,o)}catch($){W(o,s,$)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var d=o.return;try{h.componentDidMount()}catch($){W(o,d,$)}}var g=o.return;try{Sj(o)}catch($){W(o,g,$)}break;case 5:var _=o.return;try{Sj(o)}catch($){W(o,_,$)}}}catch($){W(o,o.return,$)}if(o===e){V=null;break}var j=o.sibling;if(j!==null){j.return=o.return,V=j;break}V=o.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K&6?B():Bk!==-1?Bk:Bk=B()}function lh(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function mh(e,o,s,h){if(50<zk)throw zk=0,Ak=null,Error(p(185));Ac(e,s,h),(!(K&2)||e!==R)&&(e===R&&(!(K&2)&&(rk|=s),T===4&&Dk(e,Z)),Ek(e,h),s===1&&K===0&&!(o.mode&1)&&(Hj=B()+500,fg&&jg()))}function Ek(e,o){var s=e.callbackNode;wc(e,o);var h=uc(e,e===R?Z:0);if(h===0)s!==null&&bc(s),e.callbackNode=null,e.callbackPriority=0;else if(o=h&-h,e.callbackPriority!==o){if(s!=null&&bc(s),o===1)e.tag===0?ig(Fk.bind(null,e)):hg(Fk.bind(null,e)),Jf(function(){!(K&6)&&jg()}),s=null;else{switch(Dc(h)){case 1:s=fc;break;case 4:s=gc;break;case 16:s=hc;break;case 536870912:s=jc;break;default:s=hc}s=Gk(s,Hk.bind(null,e))}e.callbackPriority=o,e.callbackNode=s}}function Hk(e,o){if(Bk=-1,Ck=0,K&6)throw Error(p(327));var s=e.callbackNode;if(Ik()&&e.callbackNode!==s)return null;var h=uc(e,e===R?Z:0);if(h===0)return null;if(h&30||h&e.expiredLanes||o)o=Jk(e,h);else{o=h;var d=K;K|=2;var g=Kk();(R!==e||Z!==o)&&(vk=null,Hj=B()+500,Lk(e,o));do try{Mk();break}catch(j){Nk(e,j)}while(!0);Qg(),nk.current=g,K=d,Y!==null?o=0:(R=null,Z=0,o=T)}if(o!==0){if(o===2&&(d=xc(e),d!==0&&(h=d,o=Ok(e,d))),o===1)throw s=qk,Lk(e,0),Dk(e,h),Ek(e,B()),s;if(o===6)Dk(e,h);else{if(d=e.current.alternate,!(h&30)&&!Pk(d)&&(o=Jk(e,h),o===2&&(g=xc(e),g!==0&&(h=g,o=Ok(e,g))),o===1))throw s=qk,Lk(e,0),Dk(e,h),Ek(e,B()),s;switch(e.finishedWork=d,e.finishedLanes=h,o){case 0:case 1:throw Error(p(345));case 2:Qk(e,uk,vk);break;case 3:if(Dk(e,h),(h&130023424)===h&&(o=gk+500-B(),10<o)){if(uc(e,0)!==0)break;if(d=e.suspendedLanes,(d&h)!==h){L(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=Ff(Qk.bind(null,e,uk,vk),o);break}Qk(e,uk,vk);break;case 4:if(Dk(e,h),(h&4194240)===h)break;for(o=e.eventTimes,d=-1;0<h;){var _=31-oc(h);g=1<<_,_=o[_],_>d&&(d=_),h&=~g}if(h=d,h=B()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*mk(h/1960))-h,10<h){e.timeoutHandle=Ff(Qk.bind(null,e,uk,vk),h);break}Qk(e,uk,vk);break;case 5:Qk(e,uk,vk);break;default:throw Error(p(329))}}}return Ek(e,B()),e.callbackNode===s?Hk.bind(null,e):null}function Ok(e,o){var s=tk;return e.current.memoizedState.isDehydrated&&(Lk(e,o).flags|=256),e=Jk(e,o),e!==2&&(o=uk,uk=s,o!==null&&Gj(o)),e}function Gj(e){uk===null?uk=e:uk.push.apply(uk,e)}function Pk(e){for(var o=e;;){if(o.flags&16384){var s=o.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var h=0;h<s.length;h++){var d=s[h],g=d.getSnapshot;d=d.value;try{if(!He(g(),d))return!1}catch{return!1}}}if(s=o.child,o.subtreeFlags&16384&&s!==null)s.return=o,o=s;else{if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Dk(e,o){for(o&=~sk,o&=~rk,e.suspendedLanes|=o,e.pingedLanes&=~o,e=e.expirationTimes;0<o;){var s=31-oc(o),h=1<<s;e[s]=-1,o&=~h}}function Fk(e){if(K&6)throw Error(p(327));Ik();var o=uc(e,0);if(!(o&1))return Ek(e,B()),null;var s=Jk(e,o);if(e.tag!==0&&s===2){var h=xc(e);h!==0&&(o=h,s=Ok(e,h))}if(s===1)throw s=qk,Lk(e,0),Dk(e,o),Ek(e,B()),s;if(s===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=o,Qk(e,uk,vk),Ek(e,B()),null}function Rk(e,o){var s=K;K|=1;try{return e(o)}finally{K=s,K===0&&(Hj=B()+500,fg&&jg())}}function Sk(e){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var o=K;K|=1;var s=pk.transition,h=C;try{if(pk.transition=null,C=1,e)return e()}finally{C=h,pk.transition=s,K=o,!(K&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(e,o){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Gf(s)),Y!==null)for(s=Y.return;s!==null;){var h=s;switch(wg(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&$f();break;case 3:Jh(),E(Wf),E(H$2),Oh();break;case 5:Lh(h);break;case 4:Jh();break;case 13:E(M);break;case 19:E(M);break;case 10:Rg(h.type._context);break;case 22:case 23:Ij()}s=s.return}if(R=e,Y=e=wh(e.current,null),Z=gj=o,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(o=0;o<Wg.length;o++)if(s=Wg[o],h=s.interleaved,h!==null){s.interleaved=null;var d=h.next,g=s.pending;if(g!==null){var _=g.next;g.next=d,h.next=_}s.pending=h}Wg=null}return e}function Nk(e,o){do{var s=Y;try{if(Qg(),Ph.current=ai,Sh){for(var h=N.memoizedState;h!==null;){var d=h.queue;d!==null&&(d.pending=null),h=h.next}Sh=!1}if(Rh=0,P=O=N=null,Th=!1,Uh=0,ok.current=null,s===null||s.return===null){T=1,qk=o,Y=null;break}t:{var g=e,_=s.return,j=s,$=o;if(o=Z,j.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var _t=$,_e=j,_r=_e.tag;if(!(_e.mode&1)&&(_r===0||_r===11||_r===15)){var _n=_e.alternate;_n?(_e.updateQueue=_n.updateQueue,_e.memoizedState=_n.memoizedState,_e.lanes=_n.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var _o=Vi(_);if(_o!==null){_o.flags&=-257,Wi(_o,_,j,g,o),_o.mode&1&&Ti(g,_t,o),o=_o,$=_t;var ga=o.updateQueue;if(ga===null){var _l=new Set;_l.add($),o.updateQueue=_l}else ga.add($);break t}else{if(!(o&1)){Ti(g,_t,o),uj();break t}$=Error(p(426))}}else if(I&&j.mode&1){var _f=Vi(_);if(_f!==null){!(_f.flags&65536)&&(_f.flags|=256),Wi(_f,_,j,g,o),Jg(Ki($,j));break t}}g=$=Ki($,j),T!==4&&(T=2),tk===null?tk=[g]:tk.push(g),g=_;do{switch(g.tag){case 3:g.flags|=65536,o&=-o,g.lanes|=o;var _c=Oi(g,$,o);fh(g,_c);break t;case 1:j=$;var _p=g.type,_g=g.stateNode;if(!(g.flags&128)&&(typeof _p.getDerivedStateFromError=="function"||_g!==null&&typeof _g.componentDidCatch=="function"&&(Si===null||!Si.has(_g)))){g.flags|=65536,o&=-o,g.lanes|=o;var ty=Ri(g,j,o);fh(g,ty);break t}}g=g.return}while(g!==null)}Tk(s)}catch(oy){o=oy,Y===s&&s!==null&&(Y=s=s.return);continue}break}while(!0)}function Kk(){var e=nk.current;return nk.current=ai,e===null?ai:e}function uj(){(T===0||T===3||T===2)&&(T=4),R===null||!(hh&268435455)&&!(rk&268435455)||Dk(R,Z)}function Jk(e,o){var s=K;K|=2;var h=Kk();(R!==e||Z!==o)&&(vk=null,Lk(e,o));do try{Uk();break}catch(d){Nk(e,d)}while(!0);if(Qg(),K=s,nk.current=h,Y!==null)throw Error(p(261));return R=null,Z=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc();)Vk(Y)}function Vk(e){var o=Wk(e.alternate,e,gj);e.memoizedProps=e.pendingProps,o===null?Tk(e):Y=o,ok.current=null}function Tk(e){var o=e;do{var s=o.alternate;if(e=o.return,o.flags&32768){if(s=Jj(s,o),s!==null){s.flags&=32767,Y=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(s=Fj(s,o,gj),s!==null){Y=s;return}if(o=o.sibling,o!==null){Y=o;return}Y=o=e}while(o!==null);T===0&&(T=5)}function Qk(e,o,s){var h=C,d=pk.transition;try{pk.transition=null,C=1,Xk(e,o,s,h)}finally{pk.transition=d,C=h}return null}function Xk(e,o,s,h){do Ik();while(xk!==null);if(K&6)throw Error(p(327));s=e.finishedWork;var d=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var g=s.lanes|s.childLanes;if(Bc(e,g),e===R&&(Y=R=null,Z=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),g=(s.flags&15990)!==0,s.subtreeFlags&15990||g){g=pk.transition,pk.transition=null;var _=C;C=1;var j=K;K|=4,ok.current=null,Pj(e,s),ek(s,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=s,ik(s),dc(),K=j,C=_,pk.transition=g}else e.current=s;if(wk&&(wk=!1,xk=e,yk=d),g=e.pendingLanes,g===0&&(Si=null),mc(s.stateNode),Ek(e,B()),o!==null)for(h=e.onRecoverableError,s=0;s<o.length;s++)d=o[s],h(d.value,{componentStack:d.stack,digest:d.digest});if(Pi)throw Pi=!1,e=Qi,Qi=null,e;return yk&1&&e.tag!==0&&Ik(),g=e.pendingLanes,g&1?e===Ak?zk++:(zk=0,Ak=e):zk=0,jg(),null}function Ik(){if(xk!==null){var e=Dc(yk),o=pk.transition,s=C;try{if(pk.transition=null,C=16>e?16:e,xk===null)var h=!1;else{if(e=xk,xk=null,yk=0,K&6)throw Error(p(331));var d=K;for(K|=4,V=e.current;V!==null;){var g=V,_=g.child;if(V.flags&16){var j=g.deletions;if(j!==null){for(var $=0;$<j.length;$++){var _t=j[$];for(V=_t;V!==null;){var _e=V;switch(_e.tag){case 0:case 11:case 15:Qj(8,_e,g)}var _r=_e.child;if(_r!==null)_r.return=_e,V=_r;else for(;V!==null;){_e=V;var _n=_e.sibling,_o=_e.return;if(Tj(_e),_e===_t){V=null;break}if(_n!==null){_n.return=_o,V=_n;break}V=_o}}}var ga=g.alternate;if(ga!==null){var _l=ga.child;if(_l!==null){ga.child=null;do{var _f=_l.sibling;_l.sibling=null,_l=_f}while(_l!==null)}}V=g}}if(g.subtreeFlags&2064&&_!==null)_.return=g,V=_;else t:for(;V!==null;){if(g=V,g.flags&2048)switch(g.tag){case 0:case 11:case 15:Qj(9,g,g.return)}var _c=g.sibling;if(_c!==null){_c.return=g.return,V=_c;break t}V=g.return}}var _p=e.current;for(V=_p;V!==null;){_=V;var _g=_.child;if(_.subtreeFlags&2064&&_g!==null)_g.return=_,V=_g;else t:for(_=_p;V!==null;){if(j=V,j.flags&2048)try{switch(j.tag){case 0:case 11:case 15:Rj(9,j)}}catch(oy){W(j,j.return,oy)}if(j===_){V=null;break t}var ty=j.sibling;if(ty!==null){ty.return=j.return,V=ty;break t}V=j.return}}if(K=d,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}h=!0}return h}finally{C=s,pk.transition=o}}return!1}function Yk(e,o,s){o=Ki(s,o),o=Oi(e,o,1),e=dh(e,o,1),o=L(),e!==null&&(Ac(e,1,o),Ek(e,o))}function W(e,o,s){if(e.tag===3)Yk(e,e,s);else for(;o!==null;){if(o.tag===3){Yk(o,e,s);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Si===null||!Si.has(h))){e=Ki(s,e),e=Ri(o,e,1),o=dh(o,e,1),e=L(),o!==null&&(Ac(o,1,e),Ek(o,e));break}}o=o.return}}function Ui(e,o,s){var h=e.pingCache;h!==null&&h.delete(o),o=L(),e.pingedLanes|=e.suspendedLanes&s,R===e&&(Z&s)===s&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-gk?Lk(e,0):sk|=s),Ek(e,o)}function Zk(e,o){o===0&&(e.mode&1?(o=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):o=1);var s=L();e=Zg(e,o),e!==null&&(Ac(e,o,s),Ek(e,s))}function vj(e){var o=e.memoizedState,s=0;o!==null&&(s=o.retryLane),Zk(e,s)}function ck(e,o){var s=0;switch(e.tag){case 13:var h=e.stateNode,d=e.memoizedState;d!==null&&(s=d.retryLane);break;case 19:h=e.stateNode;break;default:throw Error(p(314))}h!==null&&h.delete(o),Zk(e,s)}var Wk;Wk=function(e,o,s){if(e!==null)if(e.memoizedProps!==o.pendingProps||Wf.current)Ug=!0;else{if(!(e.lanes&s)&&!(o.flags&128))return Ug=!1,zj(e,o,s);Ug=!!(e.flags&131072)}else Ug=!1,I&&o.flags&1048576&&ug(o,ng,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;jj(e,o),e=o.pendingProps;var d=Yf(o,H$2.current);Tg(o,s),d=Xh(null,o,h,e,d,s);var g=bi();return o.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Zf(h)?(g=!0,cg(o)):g=!1,o.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,ah(o),d.updater=nh,o.stateNode=d,d._reactInternals=o,rh(o,h,e,s),o=kj(null,o,h,!0,g,s)):(o.tag=0,I&&g&&vg(o),Yi(null,o,d,s),o=o.child),o;case 16:h=o.elementType;t:{switch(jj(e,o),e=o.pendingProps,d=h._init,h=d(h._payload),o.type=h,d=o.tag=$k(h),e=Lg(h,e),d){case 0:o=dj(null,o,h,e,s);break t;case 1:o=ij(null,o,h,e,s);break t;case 11:o=Zi(null,o,h,e,s);break t;case 14:o=aj(null,o,h,Lg(h.type,e),s);break t}throw Error(p(306,h,""))}return o;case 0:return h=o.type,d=o.pendingProps,d=o.elementType===h?d:Lg(h,d),dj(e,o,h,d,s);case 1:return h=o.type,d=o.pendingProps,d=o.elementType===h?d:Lg(h,d),ij(e,o,h,d,s);case 3:t:{if(lj(o),e===null)throw Error(p(387));h=o.pendingProps,g=o.memoizedState,d=g.element,bh(e,o),gh(o,h,null,s);var _=o.memoizedState;if(h=_.element,g.isDehydrated)if(g={element:h,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},o.updateQueue.baseState=g,o.memoizedState=g,o.flags&256){d=Ki(Error(p(423)),o),o=mj(e,o,h,s,d);break t}else if(h!==d){d=Ki(Error(p(424)),o),o=mj(e,o,h,s,d);break t}else for(yg=Lf(o.stateNode.containerInfo.firstChild),xg=o,I=!0,zg=null,s=Ch(o,null,h,s),o.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ig(),h===d){o=$i(e,o,s);break t}Yi(e,o,h,s)}o=o.child}return o;case 5:return Kh(o),e===null&&Eg(o),h=o.type,d=o.pendingProps,g=e!==null?e.memoizedProps:null,_=d.children,Ef(h,d)?_=null:g!==null&&Ef(h,g)&&(o.flags|=32),hj(e,o),Yi(e,o,_,s),o.child;case 6:return e===null&&Eg(o),null;case 13:return pj(e,o,s);case 4:return Ih(o,o.stateNode.containerInfo),h=o.pendingProps,e===null?o.child=Bh(o,null,h,s):Yi(e,o,h,s),o.child;case 11:return h=o.type,d=o.pendingProps,d=o.elementType===h?d:Lg(h,d),Zi(e,o,h,d,s);case 7:return Yi(e,o,o.pendingProps,s),o.child;case 8:return Yi(e,o,o.pendingProps.children,s),o.child;case 12:return Yi(e,o,o.pendingProps.children,s),o.child;case 10:t:{if(h=o.type._context,d=o.pendingProps,g=o.memoizedProps,_=d.value,G(Mg,h._currentValue),h._currentValue=_,g!==null)if(He(g.value,_)){if(g.children===d.children&&!Wf.current){o=$i(e,o,s);break t}}else for(g=o.child,g!==null&&(g.return=o);g!==null;){var j=g.dependencies;if(j!==null){_=g.child;for(var $=j.firstContext;$!==null;){if($.context===h){if(g.tag===1){$=ch(-1,s&-s),$.tag=2;var _t=g.updateQueue;if(_t!==null){_t=_t.shared;var _e=_t.pending;_e===null?$.next=$:($.next=_e.next,_e.next=$),_t.pending=$}}g.lanes|=s,$=g.alternate,$!==null&&($.lanes|=s),Sg(g.return,s,o),j.lanes|=s;break}$=$.next}}else if(g.tag===10)_=g.type===o.type?null:g.child;else if(g.tag===18){if(_=g.return,_===null)throw Error(p(341));_.lanes|=s,j=_.alternate,j!==null&&(j.lanes|=s),Sg(_,s,o),_=g.sibling}else _=g.child;if(_!==null)_.return=g;else for(_=g;_!==null;){if(_===o){_=null;break}if(g=_.sibling,g!==null){g.return=_.return,_=g;break}_=_.return}g=_}Yi(e,o,d.children,s),o=o.child}return o;case 9:return d=o.type,h=o.pendingProps.children,Tg(o,s),d=Vg(d),h=h(d),o.flags|=1,Yi(e,o,h,s),o.child;case 14:return h=o.type,d=Lg(h,o.pendingProps),d=Lg(h.type,d),aj(e,o,h,d,s);case 15:return cj(e,o,o.type,o.pendingProps,s);case 17:return h=o.type,d=o.pendingProps,d=o.elementType===h?d:Lg(h,d),jj(e,o),o.tag=1,Zf(h)?(e=!0,cg(o)):e=!1,Tg(o,s),ph(o,h,d),rh(o,h,d,s),kj(null,o,h,!0,e,s);case 19:return yj(e,o,s);case 22:return ej(e,o,s)}throw Error(p(156,o.tag))};function Gk(e,o){return ac(e,o)}function al(e,o,s,h){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,o,s,h){return new al(e,o,s,h)}function bj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $k(e){if(typeof e=="function")return bj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function wh(e,o){var s=e.alternate;return s===null?(s=Bg(e.tag,o,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=o,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,o=e.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function yh(e,o,s,h,d,g){var _=2;if(h=e,typeof e=="function")bj(e)&&(_=1);else if(typeof e=="string")_=5;else t:switch(e){case ya:return Ah(s.children,d,g,o);case za:_=8,d|=8;break;case Aa:return e=Bg(12,s,o,d|2),e.elementType=Aa,e.lanes=g,e;case Ea:return e=Bg(13,s,o,d),e.elementType=Ea,e.lanes=g,e;case Fa:return e=Bg(19,s,o,d),e.elementType=Fa,e.lanes=g,e;case Ia:return qj(s,d,g,o);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:_=10;break t;case Ca:_=9;break t;case Da:_=11;break t;case Ga:_=14;break t;case Ha:_=16,h=null;break t}throw Error(p(130,e==null?e:typeof e,""))}return o=Bg(_,s,o,d),o.elementType=e,o.type=h,o.lanes=g,o}function Ah(e,o,s,h){return e=Bg(7,e,h,o),e.lanes=s,e}function qj(e,o,s,h){return e=Bg(22,e,h,o),e.elementType=Ia,e.lanes=s,e.stateNode={isHidden:!1},e}function xh(e,o,s){return e=Bg(6,e,null,o),e.lanes=s,e}function zh(e,o,s){return o=Bg(4,e.children!==null?e.children:[],e.key,o),o.lanes=s,o.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},o}function bl(e,o,s,h,d){this.tag=o,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=h,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function cl(e,o,s,h,d,g,_,j,$){return e=new bl(e,o,s,j,$),o===1?(o=1,g===!0&&(o|=8)):o=0,g=Bg(3,null,null,o),e.current=g,g.stateNode=e,g.memoizedState={element:h,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(g),e}function dl(e,o,s){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:h==null?null:""+h,children:e,containerInfo:o,implementation:s}}function el(e){if(!e)return Vf;e=e._reactInternals;t:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var o=e;do{switch(o.tag){case 3:o=o.stateNode.context;break t;case 1:if(Zf(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break t}}o=o.return}while(o!==null);throw Error(p(171))}if(e.tag===1){var s=e.type;if(Zf(s))return bg(e,s,o)}return o}function fl(e,o,s,h,d,g,_,j,$){return e=cl(s,h,!0,e,d,g,_,j,$),e.context=el(null),s=e.current,h=L(),d=lh(s),g=ch(h,d),g.callback=o??null,dh(s,g,d),e.current.lanes=d,Ac(e,d,h),Ek(e,h),e}function gl(e,o,s,h){var d=o.current,g=L(),_=lh(d);return s=el(s),o.context===null?o.context=s:o.pendingContext=s,o=ch(g,_),o.payload={element:e},h=h===void 0?null:h,h!==null&&(o.callback=h),e=dh(d,o,_),e!==null&&(mh(e,d,_,g),eh(e,d,_)),_}function hl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function il(e,o){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<o?s:o}}function jl(e,o){il(e,o),(e=e.alternate)&&il(e,o)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(e){console.error(e)};function ml(e){this._internalRoot=e}nl.prototype.render=ml.prototype.render=function(e){var o=this._internalRoot;if(o===null)throw Error(p(409));gl(e,o,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var o=e.containerInfo;Sk(function(){gl(null,e,null,null)}),o[uf]=null}};function nl(e){this._internalRoot=e}nl.prototype.unstable_scheduleHydration=function(e){if(e){var o=Hc();e={blockedOn:null,target:e,priority:o};for(var s=0;s<Qc.length&&o!==0&&o<Qc[s].priority;s++);Qc.splice(s,0,e),s===0&&Vc(e)}};function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function pl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(e,o,s,h,d){if(d){if(typeof h=="function"){var g=h;h=function(){var _t=hl(_);g.call(_t)}}var _=fl(o,h,e,0,null,!1,!1,"",ql);return e._reactRootContainer=_,e[uf]=_.current,sf(e.nodeType===8?e.parentNode:e),Sk(),_}for(;d=e.lastChild;)e.removeChild(d);if(typeof h=="function"){var j=h;h=function(){var _t=hl($);j.call(_t)}}var $=cl(e,0,!1,null,null,!1,!1,"",ql);return e._reactRootContainer=$,e[uf]=$.current,sf(e.nodeType===8?e.parentNode:e),Sk(function(){gl(o,$,s,h)}),$}function sl(e,o,s,h,d){var g=s._reactRootContainer;if(g){var _=g;if(typeof d=="function"){var j=d;d=function(){var $=hl(_);j.call($)}}gl(o,_,e,d)}else _=rl(s,o,e,d,h);return hl(_)}Ec=function(e){switch(e.tag){case 3:var o=e.stateNode;if(o.current.memoizedState.isDehydrated){var s=tc(o.pendingLanes);s!==0&&(Cc(o,s|1),Ek(o,B()),!(K&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var h=Zg(e,1);if(h!==null){var d=L();mh(h,e,1,d)}}),jl(e,1)}};Fc=function(e){if(e.tag===13){var o=Zg(e,134217728);if(o!==null){var s=L();mh(o,e,134217728,s)}jl(e,134217728)}};Gc=function(e){if(e.tag===13){var o=lh(e),s=Zg(e,o);if(s!==null){var h=L();mh(s,e,o,h)}jl(e,o)}};Hc=function(){return C};Ic=function(e,o){var s=C;try{return C=e,o()}finally{C=s}};yb=function(e,o,s){switch(o){case"input":if(bb(e,s),o=s.name,s.type==="radio"&&o!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<s.length;o++){var h=s[o];if(h!==e&&h.form===e.form){var d=Db(h);if(!d)throw Error(p(90));Wa(h),bb(h,d)}}}break;case"textarea":ib(e,s);break;case"select":o=s.value,o!=null&&fb(e,!!s.multiple,o,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(o))throw Error(p(200));return dl(e,o,null,s)};reactDom_production_min.createRoot=function(e,o){if(!ol(e))throw Error(p(299));var s=!1,h="",d=ll;return o!=null&&(o.unstable_strictMode===!0&&(s=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(d=o.onRecoverableError)),o=cl(e,1,!1,null,null,s,!1,h,d),e[uf]=o.current,sf(e.nodeType===8?e.parentNode:e),new ml(o)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var o=e._reactInternals;if(o===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(o),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Sk(e)};reactDom_production_min.hydrate=function(e,o,s){if(!pl(o))throw Error(p(200));return sl(null,e,o,!0,s)};reactDom_production_min.hydrateRoot=function(e,o,s){if(!ol(e))throw Error(p(405));var h=s!=null&&s.hydratedSources||null,d=!1,g="",_=ll;if(s!=null&&(s.unstable_strictMode===!0&&(d=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onRecoverableError!==void 0&&(_=s.onRecoverableError)),o=fl(o,null,e,1,s??null,d,!1,g,_),e[uf]=o.current,sf(e),h)for(e=0;e<h.length;e++)s=h[e],d=s._getVersion,d=d(s._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[s,d]:o.mutableSourceEagerHydrationData.push(s,d);return new nl(o)};reactDom_production_min.render=function(e,o,s){if(!pl(o))throw Error(p(200));return sl(null,e,o,!1,s)};reactDom_production_min.unmountComponentAtNode=function(e){if(!pl(e))throw Error(p(40));return e._reactRootContainer?(Sk(function(){sl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,o,s,h){if(!pl(s))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return sl(e,o,s,!1,h)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const index=getDefaultExportFromCjs(reactDomExports),ReactDOM=_mergeNamespaces({__proto__:null,default:index},[reactDomExports]);var m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(e[h]=s[h])}return e},_extends$3.apply(this,arguments)}var Action;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(e){e===void 0&&(e={});function o(h,d){let{pathname:g,search:_,hash:j}=h.location;return createLocation("",{pathname:g,search:_,hash:j},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function s(h,d){return typeof d=="string"?d:createPath(d)}return getUrlBasedHistory(o,s,null,e)}function invariant(e,o){if(e===!1||e===null||typeof e>"u")throw new Error(o)}function warning(e,o){if(!e){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(e,o){return{usr:e.state,key:e.key,idx:o}}function createLocation(e,o,s,h){return s===void 0&&(s=null),_extends$3({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof o=="string"?parsePath(o):o,{state:s,key:o&&o.key||h||createKey()})}function createPath(e){let{pathname:o="/",search:s="",hash:h=""}=e;return s&&s!=="?"&&(o+=s.charAt(0)==="?"?s:"?"+s),h&&h!=="#"&&(o+=h.charAt(0)==="#"?h:"#"+h),o}function parsePath(e){let o={};if(e){let s=e.indexOf("#");s>=0&&(o.hash=e.substr(s),e=e.substr(0,s));let h=e.indexOf("?");h>=0&&(o.search=e.substr(h),e=e.substr(0,h)),e&&(o.pathname=e)}return o}function getUrlBasedHistory(e,o,s,h){h===void 0&&(h={});let{window:d=document.defaultView,v5Compat:g=!1}=h,_=d.history,j=Action.Pop,$=null,_t=_e();_t==null&&(_t=0,_.replaceState(_extends$3({},_.state,{idx:_t}),""));function _e(){return(_.state||{idx:null}).idx}function _r(){j=Action.Pop;let _f=_e(),_c=_f==null?null:_f-_t;_t=_f,$&&$({action:j,location:_l.location,delta:_c})}function _n(_f,_c){j=Action.Push;let _p=createLocation(_l.location,_f,_c);s&&s(_p,_f),_t=_e()+1;let _g=getHistoryState(_p,_t),ty=_l.createHref(_p);try{_.pushState(_g,"",ty)}catch(oy){if(oy instanceof DOMException&&oy.name==="DataCloneError")throw oy;d.location.assign(ty)}g&&$&&$({action:j,location:_l.location,delta:1})}function _o(_f,_c){j=Action.Replace;let _p=createLocation(_l.location,_f,_c);s&&s(_p,_f),_t=_e();let _g=getHistoryState(_p,_t),ty=_l.createHref(_p);_.replaceState(_g,"",ty),g&&$&&$({action:j,location:_l.location,delta:0})}function ga(_f){let _c=d.location.origin!=="null"?d.location.origin:d.location.href,_p=typeof _f=="string"?_f:createPath(_f);return invariant(_c,"No window.location.(origin|href) available to create URL for href: "+_p),new URL(_p,_c)}let _l={get action(){return j},get location(){return e(d,_)},listen(_f){if($)throw new Error("A history only accepts one active listener");return d.addEventListener(PopStateEventType,_r),$=_f,()=>{d.removeEventListener(PopStateEventType,_r),$=null}},createHref(_f){return o(d,_f)},createURL:ga,encodeLocation(_f){let _c=ga(_f);return{pathname:_c.pathname,search:_c.search,hash:_c.hash}},push:_n,replace:_o,go(_f){return _.go(_f)}};return _l}var ResultType;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ResultType||(ResultType={}));const immutableRouteKeys=new Set(["lazy","caseSensitive","path","id","index","children"]);function isIndexRoute(e){return e.index===!0}function convertRoutesToDataRoutes(e,o,s,h){return s===void 0&&(s=[]),h===void 0&&(h={}),e.map((d,g)=>{let _=[...s,g],j=typeof d.id=="string"?d.id:_.join("-");if(invariant(d.index!==!0||!d.children,"Cannot specify children on an index route"),invariant(!h[j],'Found a route id collision on id "'+j+`".  Route id's must be globally unique within Data Router usages`),isIndexRoute(d)){let $=_extends$3({},d,o(d),{id:j});return h[j]=$,$}else{let $=_extends$3({},d,o(d),{id:j,children:void 0});return h[j]=$,d.children&&($.children=convertRoutesToDataRoutes(d.children,o,_,h)),$}})}function matchRoutes(e,o,s){s===void 0&&(s="/");let h=typeof o=="string"?parsePath(o):o,d=stripBasename(h.pathname||"/",s);if(d==null)return null;let g=flattenRoutes(e);rankRouteBranches(g);let _=null;for(let j=0;_==null&&j<g.length;++j)_=matchRouteBranch(g[j],safelyDecodeURI(d));return _}function convertRouteMatchToUiMatch(e,o){let{route:s,pathname:h,params:d}=e;return{id:s.id,pathname:h,params:d,data:o[s.id],handle:s.handle}}function flattenRoutes(e,o,s,h){o===void 0&&(o=[]),s===void 0&&(s=[]),h===void 0&&(h="");let d=(g,_,j)=>{let $={relativePath:j===void 0?g.path||"":j,caseSensitive:g.caseSensitive===!0,childrenIndex:_,route:g};$.relativePath.startsWith("/")&&(invariant($.relativePath.startsWith(h),'Absolute route path "'+$.relativePath+'" nested under path '+('"'+h+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),$.relativePath=$.relativePath.slice(h.length));let _t=joinPaths([h,$.relativePath]),_e=s.concat($);g.children&&g.children.length>0&&(invariant(g.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_t+'".')),flattenRoutes(g.children,o,_e,_t)),!(g.path==null&&!g.index)&&o.push({path:_t,score:computeScore(_t,g.index),routesMeta:_e})};return e.forEach((g,_)=>{var j;if(g.path===""||!((j=g.path)!=null&&j.includes("?")))d(g,_);else for(let $ of explodeOptionalSegments(g.path))d(g,_,$)}),o}function explodeOptionalSegments(e){let o=e.split("/");if(o.length===0)return[];let[s,...h]=o,d=s.endsWith("?"),g=s.replace(/\?$/,"");if(h.length===0)return d?[g,""]:[g];let _=explodeOptionalSegments(h.join("/")),j=[];return j.push(..._.map($=>$===""?g:[g,$].join("/"))),d&&j.push(..._),j.map($=>e.startsWith("/")&&$===""?"/":$)}function rankRouteBranches(e){e.sort((o,s)=>o.score!==s.score?s.score-o.score:compareIndexes(o.routesMeta.map(h=>h.childrenIndex),s.routesMeta.map(h=>h.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,o){let s=e.split("/"),h=s.length;return s.some(isSplat)&&(h+=splatPenalty),o&&(h+=indexRouteValue),s.filter(d=>!isSplat(d)).reduce((d,g)=>d+(paramRe.test(g)?dynamicSegmentValue:g===""?emptySegmentValue:staticSegmentValue),h)}function compareIndexes(e,o){return e.length===o.length&&e.slice(0,-1).every((h,d)=>h===o[d])?e[e.length-1]-o[o.length-1]:0}function matchRouteBranch(e,o){let{routesMeta:s}=e,h={},d="/",g=[];for(let _=0;_<s.length;++_){let j=s[_],$=_===s.length-1,_t=d==="/"?o:o.slice(d.length)||"/",_e=matchPath({path:j.relativePath,caseSensitive:j.caseSensitive,end:$},_t);if(!_e)return null;Object.assign(h,_e.params);let _r=j.route;g.push({params:h,pathname:joinPaths([d,_e.pathname]),pathnameBase:normalizePathname(joinPaths([d,_e.pathnameBase])),route:_r}),_e.pathnameBase!=="/"&&(d=joinPaths([d,_e.pathnameBase]))}return g}function matchPath(e,o){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,h]=compilePath(e.path,e.caseSensitive,e.end),d=o.match(s);if(!d)return null;let g=d[0],_=g.replace(/(.)\/+$/,"$1"),j=d.slice(1);return{params:h.reduce((_t,_e,_r)=>{let{paramName:_n,isOptional:_o}=_e;if(_n==="*"){let _l=j[_r]||"";_=g.slice(0,g.length-_l.length).replace(/(.)\/+$/,"$1")}const ga=j[_r];return _o&&!ga?_t[_n]=void 0:_t[_n]=safelyDecodeURIComponent(ga||"",_n),_t},{}),pathname:g,pathnameBase:_,pattern:e}}function compilePath(e,o,s){o===void 0&&(o=!1),s===void 0&&(s=!0),warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let h=[],d="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,j,$)=>(h.push({paramName:j,isOptional:$!=null}),$?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(h.push({paramName:"*"}),d+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?d+="\\/*$":e!==""&&e!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,o?void 0:"i"),h]}function safelyDecodeURI(e){try{return decodeURI(e)}catch(o){return warning(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),e}}function safelyDecodeURIComponent(e,o){try{return decodeURIComponent(e)}catch(s){return warning(!1,'The value for the URL param "'+o+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+s+").")),e}}function stripBasename(e,o){if(o==="/")return e;if(!e.toLowerCase().startsWith(o.toLowerCase()))return null;let s=o.endsWith("/")?o.length-1:o.length,h=e.charAt(s);return h&&h!=="/"?null:e.slice(s)||"/"}function resolvePath(e,o){o===void 0&&(o="/");let{pathname:s,search:h="",hash:d=""}=typeof e=="string"?parsePath(e):e;return{pathname:s?s.startsWith("/")?s:resolvePathname(s,o):o,search:normalizeSearch(h),hash:normalizeHash(d)}}function resolvePathname(e,o){let s=o.replace(/\/+$/,"").split("/");return e.split("/").forEach(d=>{d===".."?s.length>1&&s.pop():d!=="."&&s.push(d)}),s.length>1?s.join("/"):"/"}function getInvalidPathError(e,o,s,h){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(h)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(e){return e.filter((o,s)=>s===0||o.route.path&&o.route.path.length>0)}function getResolveToMatches(e,o){let s=getPathContributingMatches(e);return o?s.map((h,d)=>d===e.length-1?h.pathname:h.pathnameBase):s.map(h=>h.pathnameBase)}function resolveTo(e,o,s,h){h===void 0&&(h=!1);let d;typeof e=="string"?d=parsePath(e):(d=_extends$3({},e),invariant(!d.pathname||!d.pathname.includes("?"),getInvalidPathError("?","pathname","search",d)),invariant(!d.pathname||!d.pathname.includes("#"),getInvalidPathError("#","pathname","hash",d)),invariant(!d.search||!d.search.includes("#"),getInvalidPathError("#","search","hash",d)));let g=e===""||d.pathname==="",_=g?"/":d.pathname,j;if(_==null)j=s;else{let _r=o.length-1;if(!h&&_.startsWith("..")){let _n=_.split("/");for(;_n[0]==="..";)_n.shift(),_r-=1;d.pathname=_n.join("/")}j=_r>=0?o[_r]:"/"}let $=resolvePath(d,j),_t=_&&_!=="/"&&_.endsWith("/"),_e=(g||_===".")&&s.endsWith("/");return!$.pathname.endsWith("/")&&(_t||_e)&&($.pathname+="/"),$}const joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class ErrorResponseImpl{constructor(o,s,h,d){d===void 0&&(d=!1),this.status=o,this.statusText=s||"",this.internal=d,h instanceof Error?(this.data=h.toString(),this.error=h):this.data=h}}function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const validMutationMethodsArr=["post","put","patch","delete"],validMutationMethods=new Set(validMutationMethodsArr),validRequestMethodsArr=["get",...validMutationMethodsArr],validRequestMethods=new Set(validRequestMethodsArr),redirectStatusCodes=new Set([301,302,303,307,308]),redirectPreserveMethodStatusCodes=new Set([307,308]),IDLE_NAVIGATION={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},IDLE_FETCHER={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},IDLE_BLOCKER={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ABSOLUTE_URL_REGEX$1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,defaultMapRouteProperties=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),TRANSITIONS_STORAGE_KEY="remix-router-transitions";function createRouter(e){const o=e.window?e.window:typeof window<"u"?window:void 0,s=typeof o<"u"&&typeof o.document<"u"&&typeof o.document.createElement<"u",h=!s;invariant(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let d;if(e.mapRouteProperties)d=e.mapRouteProperties;else if(e.detectErrorBoundary){let yy=e.detectErrorBoundary;d=xy=>({hasErrorBoundary:yy(xy)})}else d=defaultMapRouteProperties;let g={},_=convertRoutesToDataRoutes(e.routes,d,void 0,g),j,$=e.basename||"/",_t=_extends$3({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},e.future),_e=null,_r=new Set,_n=null,_o=null,ga=null,_l=e.hydrationData!=null,_f=matchRoutes(_,e.history.location,$),_c=null;if(_f==null){let yy=getInternalRouterError(404,{pathname:e.history.location.pathname}),{matches:xy,route:Ty}=getShortCircuitMatches(_);_f=xy,_c={[Ty.id]:yy}}let _p,_g=_f.some(yy=>yy.route.lazy),ty=_f.some(yy=>yy.route.loader);if(_g)_p=!1;else if(!ty)_p=!0;else if(_t.v7_partialHydration){let yy=e.hydrationData?e.hydrationData.loaderData:null,xy=e.hydrationData?e.hydrationData.errors:null;_p=_f.every(Ty=>Ty.route.loader&&Ty.route.loader.hydrate!==!0&&(yy&&yy[Ty.route.id]!==void 0||xy&&xy[Ty.route.id]!==void 0))}else _p=e.hydrationData!=null;let oy,ry={historyAction:e.history.action,location:e.history.location,matches:_f,initialized:_p,navigation:IDLE_NAVIGATION,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||_c,fetchers:new Map,blockers:new Map},ly=Action.Pop,py=!1,gy,by=!1,wy=new Map,Cy=null,Gy=!1,Ly=!1,d0=[],s0=[],t0=new Map,Ay=0,Ny=-1,Hy=new Map,n0=new Set,v0=new Map,f0=new Map,A0=new Set,q0=new Map,D0=new Map,K0=!1;function a1(){if(_e=e.history.listen(yy=>{let{action:xy,location:Ty,delta:Wy}=yy;if(K0){K0=!1;return}warning(D0.size===0||Wy!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let _v=c1({currentLocation:ry.location,nextLocation:Ty,historyAction:xy});if(_v&&Wy!=null){K0=!0,e.history.go(Wy*-1),T1(_v,{state:"blocked",location:Ty,proceed(){T1(_v,{state:"proceeding",proceed:void 0,reset:void 0,location:Ty}),e.history.go(Wy)},reset(){let p0=new Map(ry.blockers);p0.set(_v,IDLE_BLOCKER),H0({blockers:p0})}});return}return h1(xy,Ty)}),s){restoreAppliedTransitions(o,wy);let yy=()=>persistAppliedTransitions(o,wy);o.addEventListener("pagehide",yy),Cy=()=>o.removeEventListener("pagehide",yy)}return ry.initialized||h1(Action.Pop,ry.location,{initialHydration:!0}),oy}function J0(){_e&&_e(),Cy&&Cy(),_r.clear(),gy&&gy.abort(),ry.fetchers.forEach((yy,xy)=>B0(xy)),ry.blockers.forEach((yy,xy)=>qy(xy))}function C0(yy){return _r.add(yy),()=>_r.delete(yy)}function H0(yy,xy){xy===void 0&&(xy={}),ry=_extends$3({},ry,yy);let Ty=[],Wy=[];_t.v7_fetcherPersist&&ry.fetchers.forEach((_v,p0)=>{_v.state==="idle"&&(A0.has(p0)?Wy.push(p0):Ty.push(p0))}),[..._r].forEach(_v=>_v(ry,{deletedFetchers:Wy,unstable_viewTransitionOpts:xy.viewTransitionOpts,unstable_flushSync:xy.flushSync===!0})),_t.v7_fetcherPersist&&(Ty.forEach(_v=>ry.fetchers.delete(_v)),Wy.forEach(_v=>B0(_v)))}function u1(yy,xy,Ty){var Wy,_v;let{flushSync:p0}=Ty===void 0?{}:Ty,c0=ry.actionData!=null&&ry.navigation.formMethod!=null&&isMutationMethod(ry.navigation.formMethod)&&ry.navigation.state==="loading"&&((Wy=yy.state)==null?void 0:Wy._isRedirect)!==!0,o0;xy.actionData?Object.keys(xy.actionData).length>0?o0=xy.actionData:o0=null:c0?o0=ry.actionData:o0=null;let _m=xy.loaderData?mergeLoaderData(ry.loaderData,xy.loaderData,xy.matches||[],xy.errors):ry.loaderData,g0=ry.blockers;g0.size>0&&(g0=new Map(g0),g0.forEach((P0,$0)=>g0.set($0,IDLE_BLOCKER)));let k0=py===!0||ry.navigation.formMethod!=null&&isMutationMethod(ry.navigation.formMethod)&&((_v=yy.state)==null?void 0:_v._isRedirect)!==!0;j&&(_=j,j=void 0),Gy||ly===Action.Pop||(ly===Action.Push?e.history.push(yy,yy.state):ly===Action.Replace&&e.history.replace(yy,yy.state));let Qy;if(ly===Action.Pop){let P0=wy.get(ry.location.pathname);P0&&P0.has(yy.pathname)?Qy={currentLocation:ry.location,nextLocation:yy}:wy.has(yy.pathname)&&(Qy={currentLocation:yy,nextLocation:ry.location})}else if(by){let P0=wy.get(ry.location.pathname);P0?P0.add(yy.pathname):(P0=new Set([yy.pathname]),wy.set(ry.location.pathname,P0)),Qy={currentLocation:ry.location,nextLocation:yy}}H0(_extends$3({},xy,{actionData:o0,loaderData:_m,historyAction:ly,location:yy,initialized:!0,navigation:IDLE_NAVIGATION,revalidation:"idle",restoreScrollPosition:O1(yy,xy.matches||ry.matches),preventScrollReset:k0,blockers:g0}),{viewTransitionOpts:Qy,flushSync:p0===!0}),ly=Action.Pop,py=!1,by=!1,Gy=!1,Ly=!1,d0=[],s0=[]}async function t1(yy,xy){if(typeof yy=="number"){e.history.go(yy);return}let Ty=normalizeTo(ry.location,ry.matches,$,_t.v7_prependBasename,yy,_t.v7_relativeSplatPath,xy==null?void 0:xy.fromRouteId,xy==null?void 0:xy.relative),{path:Wy,submission:_v,error:p0}=normalizeNavigateOptions(_t.v7_normalizeFormMethod,!1,Ty,xy),c0=ry.location,o0=createLocation(ry.location,Wy,xy&&xy.state);o0=_extends$3({},o0,e.history.encodeLocation(o0));let _m=xy&&xy.replace!=null?xy.replace:void 0,g0=Action.Push;_m===!0?g0=Action.Replace:_m===!1||_v!=null&&isMutationMethod(_v.formMethod)&&_v.formAction===ry.location.pathname+ry.location.search&&(g0=Action.Replace);let k0=xy&&"preventScrollReset"in xy?xy.preventScrollReset===!0:void 0,Qy=(xy&&xy.unstable_flushSync)===!0,P0=c1({currentLocation:c0,nextLocation:o0,historyAction:g0});if(P0){T1(P0,{state:"blocked",location:o0,proceed(){T1(P0,{state:"proceeding",proceed:void 0,reset:void 0,location:o0}),t1(yy,xy)},reset(){let $0=new Map(ry.blockers);$0.set(P0,IDLE_BLOCKER),H0({blockers:$0})}});return}return await h1(g0,o0,{submission:_v,pendingError:p0,preventScrollReset:k0,replace:xy&&xy.replace,enableViewTransition:xy&&xy.unstable_viewTransition,flushSync:Qy})}function n1(){if(P1(),H0({revalidation:"loading"}),ry.navigation.state!=="submitting"){if(ry.navigation.state==="idle"){h1(ry.historyAction,ry.location,{startUninterruptedRevalidation:!0});return}h1(ly||ry.historyAction,ry.navigation.location,{overrideNavigation:ry.navigation})}}async function h1(yy,xy,Ty){gy&&gy.abort(),gy=null,ly=yy,Gy=(Ty&&Ty.startUninterruptedRevalidation)===!0,A1(ry.location,ry.matches),py=(Ty&&Ty.preventScrollReset)===!0,by=(Ty&&Ty.enableViewTransition)===!0;let Wy=j||_,_v=Ty&&Ty.overrideNavigation,p0=matchRoutes(Wy,xy,$),c0=(Ty&&Ty.flushSync)===!0;if(!p0){let $0=getInternalRouterError(404,{pathname:xy.pathname}),{matches:r1,route:F0}=getShortCircuitMatches(Wy);v1(),u1(xy,{matches:r1,loaderData:{},errors:{[F0.id]:$0}},{flushSync:c0});return}if(ry.initialized&&!Ly&&isHashChangeOnly(ry.location,xy)&&!(Ty&&Ty.submission&&isMutationMethod(Ty.submission.formMethod))){u1(xy,{matches:p0},{flushSync:c0});return}gy=new AbortController;let o0=createClientSideRequest(e.history,xy,gy.signal,Ty&&Ty.submission),_m,g0;if(Ty&&Ty.pendingError)g0={[findNearestBoundary(p0).route.id]:Ty.pendingError};else if(Ty&&Ty.submission&&isMutationMethod(Ty.submission.formMethod)){let $0=await s1(o0,xy,Ty.submission,p0,{replace:Ty.replace,flushSync:c0});if($0.shortCircuited)return;_m=$0.pendingActionData,g0=$0.pendingActionError,_v=getLoadingNavigation(xy,Ty.submission),c0=!1,o0=new Request(o0.url,{signal:o0.signal})}let{shortCircuited:k0,loaderData:Qy,errors:P0}=await W0(o0,xy,p0,_v,Ty&&Ty.submission,Ty&&Ty.fetcherSubmission,Ty&&Ty.replace,Ty&&Ty.initialHydration===!0,c0,_m,g0);k0||(gy=null,u1(xy,_extends$3({matches:p0},_m?{actionData:_m}:{},{loaderData:Qy,errors:P0})))}async function s1(yy,xy,Ty,Wy,_v){_v===void 0&&(_v={}),P1();let p0=getSubmittingNavigation(xy,Ty);H0({navigation:p0},{flushSync:_v.flushSync===!0});let c0,o0=getTargetMatch(Wy,xy);if(!o0.route.action&&!o0.route.lazy)c0={type:ResultType.error,error:getInternalRouterError(405,{method:yy.method,pathname:xy.pathname,routeId:o0.route.id})};else if(c0=await callLoaderOrAction("action",yy,o0,Wy,g,d,$,_t.v7_relativeSplatPath),yy.signal.aborted)return{shortCircuited:!0};if(isRedirectResult(c0)){let _m;return _v&&_v.replace!=null?_m=_v.replace:_m=c0.location===ry.location.pathname+ry.location.search,await X0(ry,c0,{submission:Ty,replace:_m}),{shortCircuited:!0}}if(isErrorResult(c0)){let _m=findNearestBoundary(Wy,o0.route.id);return(_v&&_v.replace)!==!0&&(ly=Action.Push),{pendingActionData:{},pendingActionError:{[_m.route.id]:c0.error}}}if(isDeferredResult(c0))throw getInternalRouterError(400,{type:"defer-action"});return{pendingActionData:{[o0.route.id]:c0.data}}}async function W0(yy,xy,Ty,Wy,_v,p0,c0,o0,_m,g0,k0){let Qy=Wy||getLoadingNavigation(xy,_v),P0=_v||p0||getSubmissionFromNavigation(Qy),$0=j||_,[r1,F0]=getMatchesToLoad(e.history,ry,Ty,P0,xy,_t.v7_partialHydration&&o0===!0,Ly,d0,s0,A0,v0,n0,$0,$,g0,k0);if(v1(By=>!(Ty&&Ty.some($y=>$y.route.id===By))||r1&&r1.some($y=>$y.route.id===By)),Ny=++Ay,r1.length===0&&F0.length===0){let By=Q0();return u1(xy,_extends$3({matches:Ty,loaderData:{},errors:k0||null},g0?{actionData:g0}:{},By?{fetchers:new Map(ry.fetchers)}:{}),{flushSync:_m}),{shortCircuited:!0}}if(!Gy&&(!_t.v7_partialHydration||!o0)){F0.forEach($y=>{let Zy=ry.fetchers.get($y.key),y0=getLoadingFetcher(void 0,Zy?Zy.data:void 0);ry.fetchers.set($y.key,y0)});let By=g0||ry.actionData;H0(_extends$3({navigation:Qy},By?Object.keys(By).length===0?{actionData:null}:{actionData:By}:{},F0.length>0?{fetchers:new Map(ry.fetchers)}:{}),{flushSync:_m})}F0.forEach(By=>{t0.has(By.key)&&e1(By.key),By.controller&&t0.set(By.key,By.controller)});let d1=()=>F0.forEach(By=>e1(By.key));gy&&gy.signal.addEventListener("abort",d1);let{results:_h,loaderResults:iy,fetcherResults:cy}=await l1(ry.matches,Ty,r1,F0,yy);if(yy.signal.aborted)return{shortCircuited:!0};gy&&gy.signal.removeEventListener("abort",d1),F0.forEach(By=>t0.delete(By.key));let hy=findRedirect(_h);if(hy){if(hy.idx>=r1.length){let By=F0[hy.idx-r1.length].key;n0.add(By)}return await X0(ry,hy.result,{replace:c0}),{shortCircuited:!0}}let{loaderData:fy,errors:vy}=processLoaderData(ry,Ty,r1,iy,k0,F0,cy,q0);q0.forEach((By,$y)=>{By.subscribe(Zy=>{(Zy||By.done)&&q0.delete($y)})});let Py=Q0(),Ey=O0(Ny),My=Py||Ey||F0.length>0;return _extends$3({loaderData:fy,errors:vy},My?{fetchers:new Map(ry.fetchers)}:{})}function i1(yy,xy,Ty,Wy){if(h)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");t0.has(yy)&&e1(yy);let _v=(Wy&&Wy.unstable_flushSync)===!0,p0=j||_,c0=normalizeTo(ry.location,ry.matches,$,_t.v7_prependBasename,Ty,_t.v7_relativeSplatPath,xy,Wy==null?void 0:Wy.relative),o0=matchRoutes(p0,c0,$);if(!o0){E1(yy,xy,getInternalRouterError(404,{pathname:c0}),{flushSync:_v});return}let{path:_m,submission:g0,error:k0}=normalizeNavigateOptions(_t.v7_normalizeFormMethod,!0,c0,Wy);if(k0){E1(yy,xy,k0,{flushSync:_v});return}let Qy=getTargetMatch(o0,_m);if(py=(Wy&&Wy.preventScrollReset)===!0,g0&&isMutationMethod(g0.formMethod)){w1(yy,xy,_m,Qy,o0,_v,g0);return}v0.set(yy,{routeId:xy,path:_m}),k1(yy,xy,_m,Qy,o0,_v,g0)}async function w1(yy,xy,Ty,Wy,_v,p0,c0){if(P1(),v0.delete(yy),!Wy.route.action&&!Wy.route.lazy){let $y=getInternalRouterError(405,{method:c0.formMethod,pathname:Ty,routeId:xy});E1(yy,xy,$y,{flushSync:p0});return}let o0=ry.fetchers.get(yy);T0(yy,getSubmittingFetcher(c0,o0),{flushSync:p0});let _m=new AbortController,g0=createClientSideRequest(e.history,Ty,_m.signal,c0);t0.set(yy,_m);let k0=Ay,Qy=await callLoaderOrAction("action",g0,Wy,_v,g,d,$,_t.v7_relativeSplatPath);if(g0.signal.aborted){t0.get(yy)===_m&&t0.delete(yy);return}if(_t.v7_fetcherPersist&&A0.has(yy)){if(isRedirectResult(Qy)||isErrorResult(Qy)){T0(yy,getDoneFetcher(void 0));return}}else{if(isRedirectResult(Qy))if(t0.delete(yy),Ny>k0){T0(yy,getDoneFetcher(void 0));return}else return n0.add(yy),T0(yy,getLoadingFetcher(c0)),X0(ry,Qy,{fetcherSubmission:c0});if(isErrorResult(Qy)){E1(yy,xy,Qy.error);return}}if(isDeferredResult(Qy))throw getInternalRouterError(400,{type:"defer-action"});let P0=ry.navigation.location||ry.location,$0=createClientSideRequest(e.history,P0,_m.signal),r1=j||_,F0=ry.navigation.state!=="idle"?matchRoutes(r1,ry.navigation.location,$):ry.matches;invariant(F0,"Didn't find any matches after fetcher action");let d1=++Ay;Hy.set(yy,d1);let _h=getLoadingFetcher(c0,Qy.data);ry.fetchers.set(yy,_h);let[iy,cy]=getMatchesToLoad(e.history,ry,F0,c0,P0,!1,Ly,d0,s0,A0,v0,n0,r1,$,{[Wy.route.id]:Qy.data},void 0);cy.filter($y=>$y.key!==yy).forEach($y=>{let Zy=$y.key,y0=ry.fetchers.get(Zy),S0=getLoadingFetcher(void 0,y0?y0.data:void 0);ry.fetchers.set(Zy,S0),t0.has(Zy)&&e1(Zy),$y.controller&&t0.set(Zy,$y.controller)}),H0({fetchers:new Map(ry.fetchers)});let hy=()=>cy.forEach($y=>e1($y.key));_m.signal.addEventListener("abort",hy);let{results:fy,loaderResults:vy,fetcherResults:Py}=await l1(ry.matches,F0,iy,cy,$0);if(_m.signal.aborted)return;_m.signal.removeEventListener("abort",hy),Hy.delete(yy),t0.delete(yy),cy.forEach($y=>t0.delete($y.key));let Ey=findRedirect(fy);if(Ey){if(Ey.idx>=iy.length){let $y=cy[Ey.idx-iy.length].key;n0.add($y)}return X0(ry,Ey.result)}let{loaderData:My,errors:By}=processLoaderData(ry,ry.matches,iy,vy,void 0,cy,Py,q0);if(ry.fetchers.has(yy)){let $y=getDoneFetcher(Qy.data);ry.fetchers.set(yy,$y)}O0(d1),ry.navigation.state==="loading"&&d1>Ny?(invariant(ly,"Expected pending action"),gy&&gy.abort(),u1(ry.navigation.location,{matches:F0,loaderData:My,errors:By,fetchers:new Map(ry.fetchers)})):(H0({errors:By,loaderData:mergeLoaderData(ry.loaderData,My,F0,By),fetchers:new Map(ry.fetchers)}),Ly=!1)}async function k1(yy,xy,Ty,Wy,_v,p0,c0){let o0=ry.fetchers.get(yy);T0(yy,getLoadingFetcher(c0,o0?o0.data:void 0),{flushSync:p0});let _m=new AbortController,g0=createClientSideRequest(e.history,Ty,_m.signal);t0.set(yy,_m);let k0=Ay,Qy=await callLoaderOrAction("loader",g0,Wy,_v,g,d,$,_t.v7_relativeSplatPath);if(isDeferredResult(Qy)&&(Qy=await resolveDeferredData(Qy,g0.signal,!0)||Qy),t0.get(yy)===_m&&t0.delete(yy),!g0.signal.aborted){if(A0.has(yy)){T0(yy,getDoneFetcher(void 0));return}if(isRedirectResult(Qy))if(Ny>k0){T0(yy,getDoneFetcher(void 0));return}else{n0.add(yy),await X0(ry,Qy);return}if(isErrorResult(Qy)){E1(yy,xy,Qy.error);return}invariant(!isDeferredResult(Qy),"Unhandled fetcher deferred data"),T0(yy,getDoneFetcher(Qy.data))}}async function X0(yy,xy,Ty){let{submission:Wy,fetcherSubmission:_v,replace:p0}=Ty===void 0?{}:Ty;xy.revalidate&&(Ly=!0);let c0=createLocation(yy.location,xy.location,{_isRedirect:!0});if(invariant(c0,"Expected a location on the redirect navigation"),s){let P0=!1;if(xy.reloadDocument)P0=!0;else if(ABSOLUTE_URL_REGEX$1.test(xy.location)){const $0=e.history.createURL(xy.location);P0=$0.origin!==o.location.origin||stripBasename($0.pathname,$)==null}if(P0){p0?o.location.replace(xy.location):o.location.assign(xy.location);return}}gy=null;let o0=p0===!0?Action.Replace:Action.Push,{formMethod:_m,formAction:g0,formEncType:k0}=yy.navigation;!Wy&&!_v&&_m&&g0&&k0&&(Wy=getSubmissionFromNavigation(yy.navigation));let Qy=Wy||_v;if(redirectPreserveMethodStatusCodes.has(xy.status)&&Qy&&isMutationMethod(Qy.formMethod))await h1(o0,c0,{submission:_extends$3({},Qy,{formAction:xy.location}),preventScrollReset:py});else{let P0=getLoadingNavigation(c0,Wy);await h1(o0,c0,{overrideNavigation:P0,fetcherSubmission:_v,preventScrollReset:py})}}async function l1(yy,xy,Ty,Wy,_v){let p0=await Promise.all([...Ty.map(_m=>callLoaderOrAction("loader",_v,_m,xy,g,d,$,_t.v7_relativeSplatPath)),...Wy.map(_m=>_m.matches&&_m.match&&_m.controller?callLoaderOrAction("loader",createClientSideRequest(e.history,_m.path,_m.controller.signal),_m.match,_m.matches,g,d,$,_t.v7_relativeSplatPath):{type:ResultType.error,error:getInternalRouterError(404,{pathname:_m.path})})]),c0=p0.slice(0,Ty.length),o0=p0.slice(Ty.length);return await Promise.all([resolveDeferredResults(yy,Ty,c0,c0.map(()=>_v.signal),!1,ry.loaderData),resolveDeferredResults(yy,Wy.map(_m=>_m.match),o0,Wy.map(_m=>_m.controller?_m.controller.signal:null),!0)]),{results:p0,loaderResults:c0,fetcherResults:o0}}function P1(){Ly=!0,d0.push(...v1()),v0.forEach((yy,xy)=>{t0.has(xy)&&(s0.push(xy),e1(xy))})}function T0(yy,xy,Ty){Ty===void 0&&(Ty={}),ry.fetchers.set(yy,xy),H0({fetchers:new Map(ry.fetchers)},{flushSync:(Ty&&Ty.flushSync)===!0})}function E1(yy,xy,Ty,Wy){Wy===void 0&&(Wy={});let _v=findNearestBoundary(ry.matches,xy);B0(yy),H0({errors:{[_v.route.id]:Ty},fetchers:new Map(ry.fetchers)},{flushSync:(Wy&&Wy.flushSync)===!0})}function M1(yy){return _t.v7_fetcherPersist&&(f0.set(yy,(f0.get(yy)||0)+1),A0.has(yy)&&A0.delete(yy)),ry.fetchers.get(yy)||IDLE_FETCHER}function B0(yy){let xy=ry.fetchers.get(yy);t0.has(yy)&&!(xy&&xy.state==="loading"&&Hy.has(yy))&&e1(yy),v0.delete(yy),Hy.delete(yy),n0.delete(yy),A0.delete(yy),ry.fetchers.delete(yy)}function p1(yy){if(_t.v7_fetcherPersist){let xy=(f0.get(yy)||0)-1;xy<=0?(f0.delete(yy),A0.add(yy)):f0.set(yy,xy)}else B0(yy);H0({fetchers:new Map(ry.fetchers)})}function e1(yy){let xy=t0.get(yy);invariant(xy,"Expected fetch controller: "+yy),xy.abort(),t0.delete(yy)}function C1(yy){for(let xy of yy){let Ty=M1(xy),Wy=getDoneFetcher(Ty.data);ry.fetchers.set(xy,Wy)}}function Q0(){let yy=[],xy=!1;for(let Ty of n0){let Wy=ry.fetchers.get(Ty);invariant(Wy,"Expected fetcher: "+Ty),Wy.state==="loading"&&(n0.delete(Ty),yy.push(Ty),xy=!0)}return C1(yy),xy}function O0(yy){let xy=[];for(let[Ty,Wy]of Hy)if(Wy<yy){let _v=ry.fetchers.get(Ty);invariant(_v,"Expected fetcher: "+Ty),_v.state==="loading"&&(e1(Ty),Hy.delete(Ty),xy.push(Ty))}return C1(xy),xy.length>0}function y1(yy,xy){let Ty=ry.blockers.get(yy)||IDLE_BLOCKER;return D0.get(yy)!==xy&&D0.set(yy,xy),Ty}function qy(yy){ry.blockers.delete(yy),D0.delete(yy)}function T1(yy,xy){let Ty=ry.blockers.get(yy)||IDLE_BLOCKER;invariant(Ty.state==="unblocked"&&xy.state==="blocked"||Ty.state==="blocked"&&xy.state==="blocked"||Ty.state==="blocked"&&xy.state==="proceeding"||Ty.state==="blocked"&&xy.state==="unblocked"||Ty.state==="proceeding"&&xy.state==="unblocked","Invalid blocker state transition: "+Ty.state+" -> "+xy.state);let Wy=new Map(ry.blockers);Wy.set(yy,xy),H0({blockers:Wy})}function c1(yy){let{currentLocation:xy,nextLocation:Ty,historyAction:Wy}=yy;if(D0.size===0)return;D0.size>1&&warning(!1,"A router only supports one blocker at a time");let _v=Array.from(D0.entries()),[p0,c0]=_v[_v.length-1],o0=ry.blockers.get(p0);if(!(o0&&o0.state==="proceeding")&&c0({currentLocation:xy,nextLocation:Ty,historyAction:Wy}))return p0}function v1(yy){let xy=[];return q0.forEach((Ty,Wy)=>{(!yy||yy(Wy))&&(Ty.cancel(),xy.push(Wy),q0.delete(Wy))}),xy}function L1(yy,xy,Ty){if(_n=yy,ga=xy,_o=Ty||null,!_l&&ry.navigation===IDLE_NAVIGATION){_l=!0;let Wy=O1(ry.location,ry.matches);Wy!=null&&H0({restoreScrollPosition:Wy})}return()=>{_n=null,ga=null,_o=null}}function S1(yy,xy){return _o&&_o(yy,xy.map(Wy=>convertRouteMatchToUiMatch(Wy,ry.loaderData)))||yy.key}function A1(yy,xy){if(_n&&ga){let Ty=S1(yy,xy);_n[Ty]=ga()}}function O1(yy,xy){if(_n){let Ty=S1(yy,xy),Wy=_n[Ty];if(typeof Wy=="number")return Wy}return null}function I1(yy){g={},j=convertRoutesToDataRoutes(yy,d,void 0,g)}return oy={get basename(){return $},get future(){return _t},get state(){return ry},get routes(){return _},get window(){return o},initialize:a1,subscribe:C0,enableScrollRestoration:L1,navigate:t1,fetch:i1,revalidate:n1,createHref:yy=>e.history.createHref(yy),encodeLocation:yy=>e.history.encodeLocation(yy),getFetcher:M1,deleteFetcher:p1,dispose:J0,getBlocker:y1,deleteBlocker:qy,_internalFetchControllers:t0,_internalActiveDeferreds:q0,_internalSetRoutes:I1},oy}function isSubmissionNavigation(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function normalizeTo(e,o,s,h,d,g,_,j){let $,_t;if(_){$=[];for(let _r of o)if($.push(_r),_r.route.id===_){_t=_r;break}}else $=o,_t=o[o.length-1];let _e=resolveTo(d||".",getResolveToMatches($,g),stripBasename(e.pathname,s)||e.pathname,j==="path");return d==null&&(_e.search=e.search,_e.hash=e.hash),(d==null||d===""||d===".")&&_t&&_t.route.index&&!hasNakedIndexQuery(_e.search)&&(_e.search=_e.search?_e.search.replace(/^\?/,"?index&"):"?index"),h&&s!=="/"&&(_e.pathname=_e.pathname==="/"?s:joinPaths([s,_e.pathname])),createPath(_e)}function normalizeNavigateOptions(e,o,s,h){if(!h||!isSubmissionNavigation(h))return{path:s};if(h.formMethod&&!isValidMethod(h.formMethod))return{path:s,error:getInternalRouterError(405,{method:h.formMethod})};let d=()=>({path:s,error:getInternalRouterError(400,{type:"invalid-body"})}),g=h.formMethod||"get",_=e?g.toUpperCase():g.toLowerCase(),j=stripHashFromPath(s);if(h.body!==void 0){if(h.formEncType==="text/plain"){if(!isMutationMethod(_))return d();let _n=typeof h.body=="string"?h.body:h.body instanceof FormData||h.body instanceof URLSearchParams?Array.from(h.body.entries()).reduce((_o,ga)=>{let[_l,_f]=ga;return""+_o+_l+"="+_f+`
`},""):String(h.body);return{path:s,submission:{formMethod:_,formAction:j,formEncType:h.formEncType,formData:void 0,json:void 0,text:_n}}}else if(h.formEncType==="application/json"){if(!isMutationMethod(_))return d();try{let _n=typeof h.body=="string"?JSON.parse(h.body):h.body;return{path:s,submission:{formMethod:_,formAction:j,formEncType:h.formEncType,formData:void 0,json:_n,text:void 0}}}catch{return d()}}}invariant(typeof FormData=="function","FormData is not available in this environment");let $,_t;if(h.formData)$=convertFormDataToSearchParams(h.formData),_t=h.formData;else if(h.body instanceof FormData)$=convertFormDataToSearchParams(h.body),_t=h.body;else if(h.body instanceof URLSearchParams)$=h.body,_t=convertSearchParamsToFormData($);else if(h.body==null)$=new URLSearchParams,_t=new FormData;else try{$=new URLSearchParams(h.body),_t=convertSearchParamsToFormData($)}catch{return d()}let _e={formMethod:_,formAction:j,formEncType:h&&h.formEncType||"application/x-www-form-urlencoded",formData:_t,json:void 0,text:void 0};if(isMutationMethod(_e.formMethod))return{path:s,submission:_e};let _r=parsePath(s);return o&&_r.search&&hasNakedIndexQuery(_r.search)&&$.append("index",""),_r.search="?"+$,{path:createPath(_r),submission:_e}}function getLoaderMatchesUntilBoundary(e,o){let s=e;if(o){let h=e.findIndex(d=>d.route.id===o);h>=0&&(s=e.slice(0,h))}return s}function getMatchesToLoad(e,o,s,h,d,g,_,j,$,_t,_e,_r,_n,_o,ga,_l){let _f=_l?Object.values(_l)[0]:ga?Object.values(ga)[0]:void 0,_c=e.createURL(o.location),_p=e.createURL(d),_g=_l?Object.keys(_l)[0]:void 0,oy=getLoaderMatchesUntilBoundary(s,_g).filter((ly,py)=>{let{route:gy}=ly;if(gy.lazy)return!0;if(gy.loader==null)return!1;if(g)return gy.loader.hydrate?!0:o.loaderData[gy.id]===void 0&&(!o.errors||o.errors[gy.id]===void 0);if(isNewLoader(o.loaderData,o.matches[py],ly)||j.some(Cy=>Cy===ly.route.id))return!0;let by=o.matches[py],wy=ly;return shouldRevalidateLoader(ly,_extends$3({currentUrl:_c,currentParams:by.params,nextUrl:_p,nextParams:wy.params},h,{actionResult:_f,defaultShouldRevalidate:_||_c.pathname+_c.search===_p.pathname+_p.search||_c.search!==_p.search||isNewRouteInstance(by,wy)}))}),ry=[];return _e.forEach((ly,py)=>{if(g||!s.some(Gy=>Gy.route.id===ly.routeId)||_t.has(py))return;let gy=matchRoutes(_n,ly.path,_o);if(!gy){ry.push({key:py,routeId:ly.routeId,path:ly.path,matches:null,match:null,controller:null});return}let by=o.fetchers.get(py),wy=getTargetMatch(gy,ly.path),Cy=!1;_r.has(py)?Cy=!1:$.includes(py)?Cy=!0:by&&by.state!=="idle"&&by.data===void 0?Cy=_:Cy=shouldRevalidateLoader(wy,_extends$3({currentUrl:_c,currentParams:o.matches[o.matches.length-1].params,nextUrl:_p,nextParams:s[s.length-1].params},h,{actionResult:_f,defaultShouldRevalidate:_})),Cy&&ry.push({key:py,routeId:ly.routeId,path:ly.path,matches:gy,match:wy,controller:new AbortController})}),[oy,ry]}function isNewLoader(e,o,s){let h=!o||s.route.id!==o.route.id,d=e[s.route.id]===void 0;return h||d}function isNewRouteInstance(e,o){let s=e.route.path;return e.pathname!==o.pathname||s!=null&&s.endsWith("*")&&e.params["*"]!==o.params["*"]}function shouldRevalidateLoader(e,o){if(e.route.shouldRevalidate){let s=e.route.shouldRevalidate(o);if(typeof s=="boolean")return s}return o.defaultShouldRevalidate}async function loadLazyRouteModule(e,o,s){if(!e.lazy)return;let h=await e.lazy();if(!e.lazy)return;let d=s[e.id];invariant(d,"No route found in manifest");let g={};for(let _ in h){let $=d[_]!==void 0&&_!=="hasErrorBoundary";warning(!$,'Route "'+d.id+'" has a static property "'+_+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+_+'" will be ignored.')),!$&&!immutableRouteKeys.has(_)&&(g[_]=h[_])}Object.assign(d,g),Object.assign(d,_extends$3({},o(d),{lazy:void 0}))}async function callLoaderOrAction(e,o,s,h,d,g,_,j,$){$===void 0&&($={});let _t,_e,_r,_n=_l=>{let _f,_c=new Promise((_p,_g)=>_f=_g);return _r=()=>_f(),o.signal.addEventListener("abort",_r),Promise.race([_l({request:o,params:s.params,context:$.requestContext}),_c])};try{let _l=s.route[e];if(s.route.lazy)if(_l){let _f,_c=await Promise.all([_n(_l).catch(_p=>{_f=_p}),loadLazyRouteModule(s.route,g,d)]);if(_f)throw _f;_e=_c[0]}else if(await loadLazyRouteModule(s.route,g,d),_l=s.route[e],_l)_e=await _n(_l);else if(e==="action"){let _f=new URL(o.url),_c=_f.pathname+_f.search;throw getInternalRouterError(405,{method:o.method,pathname:_c,routeId:s.route.id})}else return{type:ResultType.data,data:void 0};else if(_l)_e=await _n(_l);else{let _f=new URL(o.url),_c=_f.pathname+_f.search;throw getInternalRouterError(404,{pathname:_c})}invariant(_e!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+s.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(_l){_t=ResultType.error,_e=_l}finally{_r&&o.signal.removeEventListener("abort",_r)}if(isResponse(_e)){let _l=_e.status;if(redirectStatusCodes.has(_l)){let _c=_e.headers.get("Location");if(invariant(_c,"Redirects returned/thrown from loaders/actions must have a Location header"),!ABSOLUTE_URL_REGEX$1.test(_c))_c=normalizeTo(new URL(o.url),h.slice(0,h.indexOf(s)+1),_,!0,_c,j);else if(!$.isStaticRequest){let _p=new URL(o.url),_g=_c.startsWith("//")?new URL(_p.protocol+_c):new URL(_c),ty=stripBasename(_g.pathname,_)!=null;_g.origin===_p.origin&&ty&&(_c=_g.pathname+_g.search+_g.hash)}if($.isStaticRequest)throw _e.headers.set("Location",_c),_e;return{type:ResultType.redirect,status:_l,location:_c,revalidate:_e.headers.get("X-Remix-Revalidate")!==null,reloadDocument:_e.headers.get("X-Remix-Reload-Document")!==null}}if($.isRouteRequest)throw{type:_t===ResultType.error?ResultType.error:ResultType.data,response:_e};let _f;try{let _c=_e.headers.get("Content-Type");_c&&/\bapplication\/json\b/.test(_c)?_e.body==null?_f=null:_f=await _e.json():_f=await _e.text()}catch(_c){return{type:ResultType.error,error:_c}}return _t===ResultType.error?{type:_t,error:new ErrorResponseImpl(_l,_e.statusText,_f),headers:_e.headers}:{type:ResultType.data,data:_f,statusCode:_e.status,headers:_e.headers}}if(_t===ResultType.error)return{type:_t,error:_e};if(isDeferredData(_e)){var _o,ga;return{type:ResultType.deferred,deferredData:_e,statusCode:(_o=_e.init)==null?void 0:_o.status,headers:((ga=_e.init)==null?void 0:ga.headers)&&new Headers(_e.init.headers)}}return{type:ResultType.data,data:_e}}function createClientSideRequest(e,o,s,h){let d=e.createURL(stripHashFromPath(o)).toString(),g={signal:s};if(h&&isMutationMethod(h.formMethod)){let{formMethod:_,formEncType:j}=h;g.method=_.toUpperCase(),j==="application/json"?(g.headers=new Headers({"Content-Type":j}),g.body=JSON.stringify(h.json)):j==="text/plain"?g.body=h.text:j==="application/x-www-form-urlencoded"&&h.formData?g.body=convertFormDataToSearchParams(h.formData):g.body=h.formData}return new Request(d,g)}function convertFormDataToSearchParams(e){let o=new URLSearchParams;for(let[s,h]of e.entries())o.append(s,typeof h=="string"?h:h.name);return o}function convertSearchParamsToFormData(e){let o=new FormData;for(let[s,h]of e.entries())o.append(s,h);return o}function processRouteLoaderData(e,o,s,h,d){let g={},_=null,j,$=!1,_t={};return s.forEach((_e,_r)=>{let _n=o[_r].route.id;if(invariant(!isRedirectResult(_e),"Cannot handle redirect results in processLoaderData"),isErrorResult(_e)){let _o=findNearestBoundary(e,_n),ga=_e.error;h&&(ga=Object.values(h)[0],h=void 0),_=_||{},_[_o.route.id]==null&&(_[_o.route.id]=ga),g[_n]=void 0,$||($=!0,j=isRouteErrorResponse(_e.error)?_e.error.status:500),_e.headers&&(_t[_n]=_e.headers)}else isDeferredResult(_e)?(d.set(_n,_e.deferredData),g[_n]=_e.deferredData.data):g[_n]=_e.data,_e.statusCode!=null&&_e.statusCode!==200&&!$&&(j=_e.statusCode),_e.headers&&(_t[_n]=_e.headers)}),h&&(_=h,g[Object.keys(h)[0]]=void 0),{loaderData:g,errors:_,statusCode:j||200,loaderHeaders:_t}}function processLoaderData(e,o,s,h,d,g,_,j){let{loaderData:$,errors:_t}=processRouteLoaderData(o,s,h,d,j);for(let _e=0;_e<g.length;_e++){let{key:_r,match:_n,controller:_o}=g[_e];invariant(_!==void 0&&_[_e]!==void 0,"Did not find corresponding fetcher result");let ga=_[_e];if(!(_o&&_o.signal.aborted))if(isErrorResult(ga)){let _l=findNearestBoundary(e.matches,_n==null?void 0:_n.route.id);_t&&_t[_l.route.id]||(_t=_extends$3({},_t,{[_l.route.id]:ga.error})),e.fetchers.delete(_r)}else if(isRedirectResult(ga))invariant(!1,"Unhandled fetcher revalidation redirect");else if(isDeferredResult(ga))invariant(!1,"Unhandled fetcher deferred data");else{let _l=getDoneFetcher(ga.data);e.fetchers.set(_r,_l)}}return{loaderData:$,errors:_t}}function mergeLoaderData(e,o,s,h){let d=_extends$3({},o);for(let g of s){let _=g.route.id;if(o.hasOwnProperty(_)?o[_]!==void 0&&(d[_]=o[_]):e[_]!==void 0&&g.route.loader&&(d[_]=e[_]),h&&h.hasOwnProperty(_))break}return d}function findNearestBoundary(e,o){return(o?e.slice(0,e.findIndex(h=>h.route.id===o)+1):[...e]).reverse().find(h=>h.route.hasErrorBoundary===!0)||e[0]}function getShortCircuitMatches(e){let o=e.length===1?e[0]:e.find(s=>s.index||!s.path||s.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:o}],route:o}}function getInternalRouterError(e,o){let{pathname:s,routeId:h,method:d,type:g}=o===void 0?{}:o,_="Unknown Server Error",j="Unknown @remix-run/router error";return e===400?(_="Bad Request",d&&s&&h?j="You made a "+d+' request to "'+s+'" but '+('did not provide a `loader` for route "'+h+'", ')+"so there is no way to handle the request.":g==="defer-action"?j="defer() is not supported in actions":g==="invalid-body"&&(j="Unable to encode submission body")):e===403?(_="Forbidden",j='Route "'+h+'" does not match URL "'+s+'"'):e===404?(_="Not Found",j='No route matches URL "'+s+'"'):e===405&&(_="Method Not Allowed",d&&s&&h?j="You made a "+d.toUpperCase()+' request to "'+s+'" but '+('did not provide an `action` for route "'+h+'", ')+"so there is no way to handle the request.":d&&(j='Invalid request method "'+d.toUpperCase()+'"')),new ErrorResponseImpl(e||500,_,new Error(j),!0)}function findRedirect(e){for(let o=e.length-1;o>=0;o--){let s=e[o];if(isRedirectResult(s))return{result:s,idx:o}}}function stripHashFromPath(e){let o=typeof e=="string"?parsePath(e):e;return createPath(_extends$3({},o,{hash:""}))}function isHashChangeOnly(e,o){return e.pathname!==o.pathname||e.search!==o.search?!1:e.hash===""?o.hash!=="":e.hash===o.hash?!0:o.hash!==""}function isDeferredResult(e){return e.type===ResultType.deferred}function isErrorResult(e){return e.type===ResultType.error}function isRedirectResult(e){return(e&&e.type)===ResultType.redirect}function isDeferredData(e){let o=e;return o&&typeof o=="object"&&typeof o.data=="object"&&typeof o.subscribe=="function"&&typeof o.cancel=="function"&&typeof o.resolveData=="function"}function isResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function isValidMethod(e){return validRequestMethods.has(e.toLowerCase())}function isMutationMethod(e){return validMutationMethods.has(e.toLowerCase())}async function resolveDeferredResults(e,o,s,h,d,g){for(let _=0;_<s.length;_++){let j=s[_],$=o[_];if(!$)continue;let _t=e.find(_r=>_r.route.id===$.route.id),_e=_t!=null&&!isNewRouteInstance(_t,$)&&(g&&g[$.route.id])!==void 0;if(isDeferredResult(j)&&(d||_e)){let _r=h[_];invariant(_r,"Expected an AbortSignal for revalidating fetcher deferred result"),await resolveDeferredData(j,_r,d).then(_n=>{_n&&(s[_]=_n||s[_])})}}}async function resolveDeferredData(e,o,s){if(s===void 0&&(s=!1),!await e.deferredData.resolveData(o)){if(s)try{return{type:ResultType.data,data:e.deferredData.unwrappedData}}catch(d){return{type:ResultType.error,error:d}}return{type:ResultType.data,data:e.deferredData.data}}}function hasNakedIndexQuery(e){return new URLSearchParams(e).getAll("index").some(o=>o==="")}function getTargetMatch(e,o){let s=typeof o=="string"?parsePath(o).search:o.search;if(e[e.length-1].route.index&&hasNakedIndexQuery(s||""))return e[e.length-1];let h=getPathContributingMatches(e);return h[h.length-1]}function getSubmissionFromNavigation(e){let{formMethod:o,formAction:s,formEncType:h,text:d,formData:g,json:_}=e;if(!(!o||!s||!h)){if(d!=null)return{formMethod:o,formAction:s,formEncType:h,formData:void 0,json:void 0,text:d};if(g!=null)return{formMethod:o,formAction:s,formEncType:h,formData:g,json:void 0,text:void 0};if(_!==void 0)return{formMethod:o,formAction:s,formEncType:h,formData:void 0,json:_,text:void 0}}}function getLoadingNavigation(e,o){return o?{state:"loading",location:e,formMethod:o.formMethod,formAction:o.formAction,formEncType:o.formEncType,formData:o.formData,json:o.json,text:o.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function getSubmittingNavigation(e,o){return{state:"submitting",location:e,formMethod:o.formMethod,formAction:o.formAction,formEncType:o.formEncType,formData:o.formData,json:o.json,text:o.text}}function getLoadingFetcher(e,o){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:o}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:o}}function getSubmittingFetcher(e,o){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:o?o.data:void 0}}function getDoneFetcher(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function restoreAppliedTransitions(e,o){try{let s=e.sessionStorage.getItem(TRANSITIONS_STORAGE_KEY);if(s){let h=JSON.parse(s);for(let[d,g]of Object.entries(h||{}))g&&Array.isArray(g)&&o.set(d,new Set(g||[]))}}catch{}}function persistAppliedTransitions(e,o){if(o.size>0){let s={};for(let[h,d]of o)s[h]=[...d];try{e.sessionStorage.setItem(TRANSITIONS_STORAGE_KEY,JSON.stringify(s))}catch(h){warning(!1,"Failed to save applied view transitions in sessionStorage ("+h+").")}}}/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(e[h]=s[h])}return e},_extends$2.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(e,o){let{relative:s}=o===void 0?{}:o;useInRouterContext()||invariant(!1);let{basename:h,navigator:d}=reactExports.useContext(NavigationContext),{hash:g,pathname:_,search:j}=useResolvedPath(e,{relative:s}),$=_;return h!=="/"&&($=_==="/"?h:joinPaths([h,_])),d.createHref({pathname:$,search:j,hash:g})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let e=reactExports.useContext(DataRouterContext),{basename:o,future:s,navigator:h}=reactExports.useContext(NavigationContext),{matches:d}=reactExports.useContext(RouteContext),{pathname:g}=useLocation(),_=JSON.stringify(getResolveToMatches(d,s.v7_relativeSplatPath)),j=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{j.current=!0}),reactExports.useCallback(function(_t,_e){if(_e===void 0&&(_e={}),!j.current)return;if(typeof _t=="number"){h.go(_t);return}let _r=resolveTo(_t,JSON.parse(_),g,_e.relative==="path");e==null&&o!=="/"&&(_r.pathname=_r.pathname==="/"?o:joinPaths([o,_r.pathname])),(_e.replace?h.replace:h.push)(_r,_e.state,_e)},[o,h,_,g,e])}const OutletContext=reactExports.createContext(null);function useOutlet(e){let o=reactExports.useContext(RouteContext).outlet;return o&&reactExports.createElement(OutletContext.Provider,{value:e},o)}function useResolvedPath(e,o){let{relative:s}=o===void 0?{}:o,{future:h}=reactExports.useContext(NavigationContext),{matches:d}=reactExports.useContext(RouteContext),{pathname:g}=useLocation(),_=JSON.stringify(getResolveToMatches(d,h.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(_),g,s==="path"),[e,_,g,s])}function useRoutesImpl(e,o,s,h){useInRouterContext()||invariant(!1);let{navigator:d}=reactExports.useContext(NavigationContext),{matches:g}=reactExports.useContext(RouteContext),_=g[g.length-1],j=_?_.params:{};_&&_.pathname;let $=_?_.pathnameBase:"/";_&&_.route;let _t=useLocation(),_e;if(o){var _r;let _f=typeof o=="string"?parsePath(o):o;$==="/"||(_r=_f.pathname)!=null&&_r.startsWith($)||invariant(!1),_e=_f}else _e=_t;let _n=_e.pathname||"/",_o=$==="/"?_n:_n.slice($.length)||"/",ga=matchRoutes(e,{pathname:_o}),_l=_renderMatches(ga&&ga.map(_f=>Object.assign({},_f,{params:Object.assign({},j,_f.params),pathname:joinPaths([$,d.encodeLocation?d.encodeLocation(_f.pathname).pathname:_f.pathname]),pathnameBase:_f.pathnameBase==="/"?$:joinPaths([$,d.encodeLocation?d.encodeLocation(_f.pathnameBase).pathname:_f.pathnameBase])})),g,s,h);return o&&_l?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$2({pathname:"/",search:"",hash:"",state:null,key:"default"},_e),navigationType:Action.Pop}},_l):_l}function DefaultErrorComponent(){let e=useRouteError(),o=isRouteErrorResponse(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},o),s?reactExports.createElement("pre",{style:d},s):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,s){return s.location!==o.location||s.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error!==void 0?o.error:s.error,location:s.location,revalidation:o.revalidation||s.revalidation}}componentDidCatch(o,s){console.error("React Router caught the following error during render",o,s)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(e){let{routeContext:o,match:s,children:h}=e,d=reactExports.useContext(DataRouterContext);return d&&d.static&&d.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=s.route.id),reactExports.createElement(RouteContext.Provider,{value:o},h)}function _renderMatches(e,o,s,h){var d;if(o===void 0&&(o=[]),s===void 0&&(s=null),h===void 0&&(h=null),e==null){var g;if((g=s)!=null&&g.errors)e=s.matches;else return null}let _=e,j=(d=s)==null?void 0:d.errors;if(j!=null){let _e=_.findIndex(_r=>_r.route.id&&(j==null?void 0:j[_r.route.id]));_e>=0||invariant(!1),_=_.slice(0,Math.min(_.length,_e+1))}let $=!1,_t=-1;if(s&&h&&h.v7_partialHydration)for(let _e=0;_e<_.length;_e++){let _r=_[_e];if((_r.route.HydrateFallback||_r.route.hydrateFallbackElement)&&(_t=_e),_r.route.id){let{loaderData:_n,errors:_o}=s,ga=_r.route.loader&&_n[_r.route.id]===void 0&&(!_o||_o[_r.route.id]===void 0);if(_r.route.lazy||ga){$=!0,_t>=0?_=_.slice(0,_t+1):_=[_[0]];break}}}return _.reduceRight((_e,_r,_n)=>{let _o,ga=!1,_l=null,_f=null;s&&(_o=j&&_r.route.id?j[_r.route.id]:void 0,_l=_r.route.errorElement||defaultErrorElement,$&&(_t<0&&_n===0?(warningOnce("route-fallback",!1),ga=!0,_f=null):_t===_n&&(ga=!0,_f=_r.route.hydrateFallbackElement||null)));let _c=o.concat(_.slice(0,_n+1)),_p=()=>{let _g;return _o?_g=_l:ga?_g=_f:_r.route.Component?_g=reactExports.createElement(_r.route.Component,null):_r.route.element?_g=_r.route.element:_g=_e,reactExports.createElement(RenderedRoute,{match:_r,routeContext:{outlet:_e,matches:_c,isDataRoute:s!=null},children:_g})};return s&&(_r.route.ErrorBoundary||_r.route.errorElement||_n===0)?reactExports.createElement(RenderErrorBoundary,{location:s.location,revalidation:s.revalidation,component:_l,error:_o,children:_p(),routeContext:{outlet:null,matches:_c,isDataRoute:!0}}):_p()},null)}var DataRouterHook$1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DataRouterHook$1||{}),DataRouterStateHook$1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(DataRouterStateHook$1||{});function useDataRouterContext(e){let o=reactExports.useContext(DataRouterContext);return o||invariant(!1),o}function useDataRouterState(e){let o=reactExports.useContext(DataRouterStateContext);return o||invariant(!1),o}function useRouteContext(e){let o=reactExports.useContext(RouteContext);return o||invariant(!1),o}function useCurrentRouteId(e){let o=useRouteContext(),s=o.matches[o.matches.length-1];return s.route.id||invariant(!1),s.route.id}function useRouteError(){var e;let o=reactExports.useContext(RouteErrorContext),s=useDataRouterState(DataRouterStateHook$1.UseRouteError),h=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return o!==void 0?o:(e=s.errors)==null?void 0:e[h]}function useNavigateStable(){let{router:e}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),o=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),s=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{s.current=!0}),reactExports.useCallback(function(d,g){g===void 0&&(g={}),s.current&&(typeof d=="number"?e.navigate(d):e.navigate(d,_extends$2({fromRouteId:o},g)))},[e,o])}const alreadyWarned={};function warningOnce(e,o,s){!o&&!alreadyWarned[e]&&(alreadyWarned[e]=!0)}function Outlet(e){return useOutlet(e.context)}function Router(e){let{basename:o="/",children:s=null,location:h,navigationType:d=Action.Pop,navigator:g,static:_=!1,future:j}=e;useInRouterContext()&&invariant(!1);let $=o.replace(/^\/*/,"/"),_t=reactExports.useMemo(()=>({basename:$,navigator:g,static:_,future:_extends$2({v7_relativeSplatPath:!1},j)}),[$,j,g,_]);typeof h=="string"&&(h=parsePath(h));let{pathname:_e="/",search:_r="",hash:_n="",state:_o=null,key:ga="default"}=h,_l=reactExports.useMemo(()=>{let _f=stripBasename(_e,$);return _f==null?null:{location:{pathname:_f,search:_r,hash:_n,state:_o,key:ga},navigationType:d}},[$,_e,_r,_n,_o,ga,d]);return _l==null?null:reactExports.createElement(NavigationContext.Provider,{value:_t},reactExports.createElement(LocationContext.Provider,{children:s,value:_l}))}new Promise(()=>{});function mapRouteProperties(e){let o={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(o,{element:reactExports.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(o,{hydrateFallbackElement:reactExports.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(o,{errorElement:reactExports.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),o}/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(e[h]=s[h])}return e},_extends$1.apply(this,arguments)}function _objectWithoutPropertiesLoose$1(e,o){if(e==null)return{};var s={},h=Object.keys(e),d,g;for(g=0;g<h.length;g++)d=h[g],!(o.indexOf(d)>=0)&&(s[d]=e[d]);return s}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,o){return e.button===0&&(!o||o==="_self")&&!isModifiedEvent(e)}const _excluded$1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];function createBrowserRouter(e,o){return createRouter({basename:o==null?void 0:o.basename,future:_extends$1({},o==null?void 0:o.future,{v7_prependBasename:!0}),history:createBrowserHistory({window:o==null?void 0:o.window}),hydrationData:(o==null?void 0:o.hydrationData)||parseHydrationData(),routes:e,mapRouteProperties,window:o==null?void 0:o.window}).initialize()}function parseHydrationData(){var e;let o=(e=window)==null?void 0:e.__staticRouterHydrationData;return o&&o.errors&&(o=_extends$1({},o,{errors:deserializeErrors(o.errors)})),o}function deserializeErrors(e){if(!e)return null;let o=Object.entries(e),s={};for(let[h,d]of o)if(d&&d.__type==="RouteErrorResponse")s[h]=new ErrorResponseImpl(d.status,d.statusText,d.data,d.internal===!0);else if(d&&d.__type==="Error"){if(d.__subType){let g=window[d.__subType];if(typeof g=="function")try{let _=new g(d.message);_.stack="",s[h]=_}catch{}}if(s[h]==null){let g=new Error(d.message);g.stack="",s[h]=g}}else s[h]=d;return s}const ViewTransitionContext=reactExports.createContext({isTransitioning:!1}),FetchersContext=reactExports.createContext(new Map),START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION],FLUSH_SYNC="flushSync",flushSyncImpl=ReactDOM[FLUSH_SYNC];function startTransitionSafe(e){startTransitionImpl?startTransitionImpl(e):e()}function flushSyncSafe(e){flushSyncImpl?flushSyncImpl(e):e()}class Deferred{constructor(){this.status="pending",this.promise=new Promise((o,s)=>{this.resolve=h=>{this.status==="pending"&&(this.status="resolved",o(h))},this.reject=h=>{this.status==="pending"&&(this.status="rejected",s(h))}})}}function RouterProvider(e){let{fallbackElement:o,router:s,future:h}=e,[d,g]=reactExports.useState(s.state),[_,j]=reactExports.useState(),[$,_t]=reactExports.useState({isTransitioning:!1}),[_e,_r]=reactExports.useState(),[_n,_o]=reactExports.useState(),[ga,_l]=reactExports.useState(),_f=reactExports.useRef(new Map),{v7_startTransition:_c}=h||{},_p=reactExports.useCallback(ly=>{_c?startTransitionSafe(ly):ly()},[_c]),_g=reactExports.useCallback((ly,py)=>{let{deletedFetchers:gy,unstable_flushSync:by,unstable_viewTransitionOpts:wy}=py;gy.forEach(Gy=>_f.current.delete(Gy)),ly.fetchers.forEach((Gy,Ly)=>{Gy.data!==void 0&&_f.current.set(Ly,Gy.data)});let Cy=s.window==null||typeof s.window.document.startViewTransition!="function";if(!wy||Cy){by?flushSyncSafe(()=>g(ly)):_p(()=>g(ly));return}if(by){flushSyncSafe(()=>{_n&&(_e&&_e.resolve(),_n.skipTransition()),_t({isTransitioning:!0,flushSync:!0,currentLocation:wy.currentLocation,nextLocation:wy.nextLocation})});let Gy=s.window.document.startViewTransition(()=>{flushSyncSafe(()=>g(ly))});Gy.finished.finally(()=>{flushSyncSafe(()=>{_r(void 0),_o(void 0),j(void 0),_t({isTransitioning:!1})})}),flushSyncSafe(()=>_o(Gy));return}_n?(_e&&_e.resolve(),_n.skipTransition(),_l({state:ly,currentLocation:wy.currentLocation,nextLocation:wy.nextLocation})):(j(ly),_t({isTransitioning:!0,flushSync:!1,currentLocation:wy.currentLocation,nextLocation:wy.nextLocation}))},[s.window,_n,_e,_f,_p]);reactExports.useLayoutEffect(()=>s.subscribe(_g),[s,_g]),reactExports.useEffect(()=>{$.isTransitioning&&!$.flushSync&&_r(new Deferred)},[$]),reactExports.useEffect(()=>{if(_e&&_&&s.window){let ly=_,py=_e.promise,gy=s.window.document.startViewTransition(async()=>{_p(()=>g(ly)),await py});gy.finished.finally(()=>{_r(void 0),_o(void 0),j(void 0),_t({isTransitioning:!1})}),_o(gy)}},[_p,_,_e,s.window]),reactExports.useEffect(()=>{_e&&_&&d.location.key===_.location.key&&_e.resolve()},[_e,_n,d.location,_]),reactExports.useEffect(()=>{!$.isTransitioning&&ga&&(j(ga.state),_t({isTransitioning:!0,flushSync:!1,currentLocation:ga.currentLocation,nextLocation:ga.nextLocation}),_l(void 0))},[$.isTransitioning,ga]),reactExports.useEffect(()=>{},[]);let ty=reactExports.useMemo(()=>({createHref:s.createHref,encodeLocation:s.encodeLocation,go:ly=>s.navigate(ly),push:(ly,py,gy)=>s.navigate(ly,{state:py,preventScrollReset:gy==null?void 0:gy.preventScrollReset}),replace:(ly,py,gy)=>s.navigate(ly,{replace:!0,state:py,preventScrollReset:gy==null?void 0:gy.preventScrollReset})}),[s]),oy=s.basename||"/",ry=reactExports.useMemo(()=>({router:s,navigator:ty,static:!1,basename:oy}),[s,ty,oy]);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(DataRouterContext.Provider,{value:ry},reactExports.createElement(DataRouterStateContext.Provider,{value:d},reactExports.createElement(FetchersContext.Provider,{value:_f.current},reactExports.createElement(ViewTransitionContext.Provider,{value:$},reactExports.createElement(Router,{basename:oy,location:d.location,navigationType:d.historyAction,navigator:ty,future:{v7_relativeSplatPath:s.future.v7_relativeSplatPath}},d.initialized||s.future.v7_partialHydration?reactExports.createElement(DataRoutes,{routes:s.routes,future:s.future,state:d}):o))))),null)}function DataRoutes(e){let{routes:o,future:s,state:h}=e;return useRoutesImpl(o,void 0,h,s)}const isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(o,s){let{onClick:h,relative:d,reloadDocument:g,replace:_,state:j,target:$,to:_t,preventScrollReset:_e,unstable_viewTransition:_r}=o,_n=_objectWithoutPropertiesLoose$1(o,_excluded$1),{basename:_o}=reactExports.useContext(NavigationContext),ga,_l=!1;if(typeof _t=="string"&&ABSOLUTE_URL_REGEX.test(_t)&&(ga=_t,isBrowser))try{let _g=new URL(window.location.href),ty=_t.startsWith("//")?new URL(_g.protocol+_t):new URL(_t),oy=stripBasename(ty.pathname,_o);ty.origin===_g.origin&&oy!=null?_t=oy+ty.search+ty.hash:_l=!0}catch{}let _f=useHref(_t,{relative:d}),_c=useLinkClickHandler(_t,{replace:_,state:j,target:$,preventScrollReset:_e,relative:d,unstable_viewTransition:_r});function _p(_g){h&&h(_g),_g.defaultPrevented||_c(_g)}return reactExports.createElement("a",_extends$1({},_n,{href:ga||_f,onClick:_l||g?h:_p,ref:s,target:$}))});var DataRouterHook;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(e,o){let{target:s,replace:h,state:d,preventScrollReset:g,relative:_,unstable_viewTransition:j}=o===void 0?{}:o,$=useNavigate(),_t=useLocation(),_e=useResolvedPath(e,{relative:_});return reactExports.useCallback(_r=>{if(shouldProcessLinkClick(_r,s)){_r.preventDefault();let _n=h!==void 0?h:createPath(_t)===createPath(_e);$(e,{replace:_n,state:d,preventScrollReset:g,relative:_,unstable_viewTransition:j})}},[_t,$,_e,h,d,s,e,g,_,j])}var DefaultContext={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},IconContext=React.createContext&&React.createContext(DefaultContext),_excluded=["attr","size","title"];function _objectWithoutProperties(e,o){if(e==null)return{};var s=_objectWithoutPropertiesLoose(e,o),h,d;if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(e);for(d=0;d<g.length;d++)h=g[d],!(o.indexOf(h)>=0)&&Object.prototype.propertyIsEnumerable.call(e,h)&&(s[h]=e[h])}return s}function _objectWithoutPropertiesLoose(e,o){if(e==null)return{};var s={},h=Object.keys(e),d,g;for(g=0;g<h.length;g++)d=h[g],!(o.indexOf(d)>=0)&&(s[d]=e[d]);return s}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(e[h]=s[h])}return e},_extends.apply(this,arguments)}function ownKeys(e,o){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);o&&(h=h.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,h)}return s}function _objectSpread(e){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?ownKeys(Object(s),!0).forEach(function(h){_defineProperty(e,h,s[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach(function(h){Object.defineProperty(e,h,Object.getOwnPropertyDescriptor(s,h))})}return e}function _defineProperty(e,o,s){return o=_toPropertyKey(o),o in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s,e}function _toPropertyKey(e){var o=_toPrimitive(e,"string");return typeof o=="symbol"?o:String(o)}function _toPrimitive(e,o){if(typeof e!="object"||e===null)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var h=s.call(e,o||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(e)}function Tree2Element(e){return e&&e.map((o,s)=>React.createElement(o.tag,_objectSpread({key:s},o.attr),Tree2Element(o.child)))}function GenIcon(e){return o=>React.createElement(IconBase,_extends({attr:_objectSpread({},e.attr)},o),Tree2Element(e.child))}function IconBase(e){var o=s=>{var{attr:h,size:d,title:g}=e,_=_objectWithoutProperties(e,_excluded),j=d||s.size||"1em",$;return s.className&&($=s.className),e.className&&($=($?$+" ":"")+e.className),React.createElement("svg",_extends({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,h,_,{className:$,style:_objectSpread(_objectSpread({color:e.color||s.color},s.style),e.style),height:j,width:j,xmlns:"http://www.w3.org/2000/svg"}),g&&React.createElement("title",null,g),e.children)};return IconContext!==void 0?React.createElement(IconContext.Consumer,null,s=>o(s)):o(DefaultContext)}function PiGearLight(e){return GenIcon({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,82a46,46,0,1,0,46,46A46.06,46.06,0,0,0,128,82Zm0,80a34,34,0,1,1,34-34A34,34,0,0,1,128,162ZM214,130.84c.06-1.89.06-3.79,0-5.68L229.33,106a6,6,0,0,0,1.11-5.29A105.34,105.34,0,0,0,219.76,74.9a6,6,0,0,0-4.53-3l-24.45-2.71q-1.93-2.07-4-4l-2.72-24.46a6,6,0,0,0-3-4.53,105.65,105.65,0,0,0-25.77-10.66A6,6,0,0,0,150,26.68l-19.2,15.37c-1.89-.06-3.79-.06-5.68,0L106,26.67a6,6,0,0,0-5.29-1.11A105.34,105.34,0,0,0,74.9,36.24a6,6,0,0,0-3,4.53L69.23,65.22q-2.07,1.94-4,4L40.76,72a6,6,0,0,0-4.53,3,105.65,105.65,0,0,0-10.66,25.77A6,6,0,0,0,26.68,106l15.37,19.2c-.06,1.89-.06,3.79,0,5.68L26.67,150.05a6,6,0,0,0-1.11,5.29A105.34,105.34,0,0,0,36.24,181.1a6,6,0,0,0,4.53,3l24.45,2.71q1.94,2.07,4,4L72,215.24a6,6,0,0,0,3,4.53,105.65,105.65,0,0,0,25.77,10.66,6,6,0,0,0,5.29-1.11L125.16,214c1.89.06,3.79.06,5.68,0l19.21,15.38a6,6,0,0,0,3.75,1.31,6.2,6.2,0,0,0,1.54-.2,105.34,105.34,0,0,0,25.76-10.68,6,6,0,0,0,3-4.53l2.71-24.45q2.07-1.93,4-4l24.46-2.72a6,6,0,0,0,4.53-3,105.49,105.49,0,0,0,10.66-25.77,6,6,0,0,0-1.11-5.29Zm-3.1,41.63-23.64,2.63a6,6,0,0,0-3.82,2,75.14,75.14,0,0,1-6.31,6.31,6,6,0,0,0-2,3.82l-2.63,23.63A94.28,94.28,0,0,1,155.14,218l-18.57-14.86a6,6,0,0,0-3.75-1.31h-.36a78.07,78.07,0,0,1-8.92,0,6,6,0,0,0-4.11,1.3L100.87,218a94.13,94.13,0,0,1-17.34-7.17L80.9,187.21a6,6,0,0,0-2-3.82,75.14,75.14,0,0,1-6.31-6.31,6,6,0,0,0-3.82-2l-23.63-2.63A94.28,94.28,0,0,1,38,155.14l14.86-18.57a6,6,0,0,0,1.3-4.11,78.07,78.07,0,0,1,0-8.92,6,6,0,0,0-1.3-4.11L38,100.87a94.13,94.13,0,0,1,7.17-17.34L68.79,80.9a6,6,0,0,0,3.82-2,75.14,75.14,0,0,1,6.31-6.31,6,6,0,0,0,2-3.82l2.63-23.63A94.28,94.28,0,0,1,100.86,38l18.57,14.86a6,6,0,0,0,4.11,1.3,78.07,78.07,0,0,1,8.92,0,6,6,0,0,0,4.11-1.3L155.13,38a94.13,94.13,0,0,1,17.34,7.17l2.63,23.64a6,6,0,0,0,2,3.82,75.14,75.14,0,0,1,6.31,6.31,6,6,0,0,0,3.82,2l23.63,2.63A94.28,94.28,0,0,1,218,100.86l-14.86,18.57a6,6,0,0,0-1.3,4.11,78.07,78.07,0,0,1,0,8.92,6,6,0,0,0,1.3,4.11L218,155.13A94.13,94.13,0,0,1,210.85,172.47Z"},child:[]}]})(e)}function PiHouseSimpleLight(e){return GenIcon({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M217.47,105.23l-80-75.49-.09-.08a13.94,13.94,0,0,0-18.83,0l-.09.08-80,75.5A14,14,0,0,0,34,115.55V208a14,14,0,0,0,14,14H208a14,14,0,0,0,14-14V115.55A14.06,14.06,0,0,0,217.47,105.23ZM210,208a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V115.55a2,2,0,0,1,.65-1.48l.09-.08,79.94-75.48a2,2,0,0,1,2.63,0L209.26,114l.08.08a2,2,0,0,1,.66,1.48Z"},child:[]}]})(e)}function PiSmileySadLight(e){return GenIcon({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,26A102,102,0,1,0,230,128,102.12,102.12,0,0,0,128,26Zm0,192a90,90,0,1,1,90-90A90.1,90.1,0,0,1,128,218ZM82,108a10,10,0,1,1,10,10A10,10,0,0,1,82,108Zm92,0a10,10,0,1,1-10-10A10,10,0,0,1,174,108Zm-.81,65a6,6,0,0,1-10.38,6c-7.84-13.54-20.2-21-34.81-21s-27,7.46-34.81,21a6,6,0,0,1-5.2,3,5.9,5.9,0,0,1-3-.81A6,6,0,0,1,82.81,173c9.92-17.16,26.39-27,45.19-27S163.27,155.84,173.19,173Z"},child:[]}]})(e)}function Header(){return jsxRuntimeExports.jsxs("header",{className:"py-4 px-8 bg-[#026fca] flex flex-row justify-between items-center",children:[jsxRuntimeExports.jsx(Link,{to:"",children:jsxRuntimeExports.jsxs("div",{id:"left",className:"flex gap-1 items-center",children:[jsxRuntimeExports.jsx(PiHouseSimpleLight,{size:24}),jsxRuntimeExports.jsx("h1",{className:"text-lg",children:"Next Place"})]})}),jsxRuntimeExports.jsx("div",{id:"right",children:jsxRuntimeExports.jsx(Link,{to:"settings",children:jsxRuntimeExports.jsx(PiGearLight,{size:24})})})]})}const SearchContext=reactExports.createContext({addresses:void 0,setAddresses:e=>null}),SearchProvider=({children:e})=>{const[o,s]=reactExports.useState(void 0);return jsxRuntimeExports.jsx(SearchContext.Provider,{value:{addresses:o,setAddresses:s},children:e})},SettingsContext=reactExports.createContext({hereKey:void 0,setHereKey:e=>null,openRouteServiceKey:void 0,setOpenRouteServiceKey:e=>null}),SettingsProvider=({children:e})=>{const[o,s]=reactExports.useState("fAxJxj6az4RZNjTM-7aVF_UmqgMxYKV86wIHmZvRRtM"),[h,d]=reactExports.useState("5b3ce3597851110001cf624811b8ed45cb8c4d67bdd2a35acd6daca7");return jsxRuntimeExports.jsx(SettingsContext.Provider,{value:{hereKey:o,setHereKey:s,openRouteServiceKey:h,setOpenRouteServiceKey:d},children:e})};function RootLayout(){return jsxRuntimeExports.jsx(SettingsProvider,{children:jsxRuntimeExports.jsxs(SearchProvider,{children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsx("main",{className:"grow",children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx("div",{children:"Loading..."}),children:jsxRuntimeExports.jsx(Outlet,{})})})]})})}function Hero(){return jsxRuntimeExports.jsxs("div",{id:"hero",className:"h-3/6 text-white flex flex-col justify-end px-8 pb-4 bg-[url('/assets/background.jpg')]",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl",children:"Next Place"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Find homes and rentals around you and what matters most"})]})}function InputBox({inputType:e,placeholder:o,labelText:s,value:h,inputUpdate:d}){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1",children:[jsxRuntimeExports.jsx("input",{type:e,placeholder:o,value:h,onChange:g=>d(g.target.value),className:"bg-transparent border-b-2 border-white text-ellipsis"}),jsxRuntimeExports.jsx("label",{className:"text-xs",children:s})]})}class MissingKeyError extends Error{constructor(o){super(),this.message=o}}class InvalidParameterError extends Error{constructor(o){super(),this.message=o}}async function decodeGeolocation(e,o){var h,d,g,_,j,$,_t,_e;if(!o)throw new MissingKeyError("API key not provided. Go to settings to save your keys");if(!e)throw new InvalidParameterError("Enter in a valid address");const s=`https://geocoder.ls.hereapi.com/6.2/geocode.json?apiKey=${o}&searchtext=${e}`;try{const _r=await fetch(s),_n=await _r.json();if((_=(g=(d=(h=_n==null?void 0:_n.Response)==null?void 0:h.View[0])==null?void 0:d.Result[0])==null?void 0:g.Location)!=null&&_.NavigationPosition[0]&&((_e=(_t=($=(j=_n==null?void 0:_n.Response)==null?void 0:j.View[0])==null?void 0:$.Result[0])==null?void 0:_t.Location)!=null&&_e.Address)){let _o={label:_n.Response.View[0].Result[0].Location.Address.Label,position:{lat:_n.Response.View[0].Result[0].Location.NavigationPosition[0].Latitude,lng:_n.Response.View[0].Result[0].Location.NavigationPosition[0].Longitude}};return console.log(`Geocode data ${JSON.stringify(_o)}`),_o}else throw new Error(`Response did not send location data: ${JSON.stringify(_r)}`)}catch(_r){throw new Error(`Here request at 'decodeGeolocation' with url: ${s} and return an error: ${_r}`)}}const inputStyles={container:"flex flex-col gap-1",input:"px-2 py-1 text-black",label:"text-xs"};function Home(){const e=useNavigate(),{setAddresses:o}=reactExports.useContext(SearchContext),{hereKey:s}=reactExports.useContext(SettingsContext),[h,d]=reactExports.useState();let g,_;async function j(){d(void 0);try{const $=await decodeGeolocation(g,s);o([{label:$.label,position:{lat:$.position.lat,lng:$.position.lng},distance:_||10}]),e("/search")}catch($){($ instanceof MissingKeyError||$ instanceof InvalidParameterError)&&d($.message)}}return jsxRuntimeExports.jsxs("div",{className:"h-full",children:[jsxRuntimeExports.jsx(Hero,{}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-4 my-12",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx("div",{id:"address",className:inputStyles.container+" w-5/6",children:jsxRuntimeExports.jsx(InputBox,{inputType:"text",labelText:"Address",placeholder:"City, ZIP, Address",inputUpdate:$=>g=$})}),jsxRuntimeExports.jsx("div",{id:"distance",className:inputStyles.container+" w-1/6",children:jsxRuntimeExports.jsx(InputBox,{inputType:"text",labelText:"Distance (time)",placeholder:"10",inputUpdate:$=>_=Number($)})})]}),h&&jsxRuntimeExports.jsx("p",{className:"text-xs text-red-600",children:h}),jsxRuntimeExports.jsx("button",{className:"w-fit py-1 px-2 border",onClick:()=>j(),children:"Search"})]})]})}function TbError404(e){return GenIcon({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},child:[]},{tag:"path",attr:{d:"M3 7v4a1 1 0 0 0 1 1h3"},child:[]},{tag:"path",attr:{d:"M7 7v10"},child:[]},{tag:"path",attr:{d:"M10 8v8a1 1 0 0 0 1 1h2a1 1 0 0 0 1 -1v-8a1 1 0 0 0 -1 -1h-2a1 1 0 0 0 -1 1z"},child:[]},{tag:"path",attr:{d:"M17 7v4a1 1 0 0 0 1 1h3"},child:[]},{tag:"path",attr:{d:"M21 7v10"},child:[]}]})(e)}function NotFound(){return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col gap-4 justify-center items-center",children:[jsxRuntimeExports.jsx(TbError404,{size:64}),jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"Page Not Found"})]})}(function(){var p,aa=[];function ba(e){return function(){return aa[e].apply(this,arguments)}}function ca(e,o){return aa[e]=o}function da(e){var o=0;return function(){return o<e.length?{done:!1,value:e[o++]}:{done:!0}}}function ea(e){var o=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return o?o.call(e):{next:da(e)}}function fa(e){for(var o,s=[];!(o=e.next()).done;)s.push(o.value);return s}var ia=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,o,s){e!=Array.prototype&&e!=Object.prototype&&(e[o]=s.value)},ja=typeof window<"u"&&window===this?this:typeof global<"u"&&global!=null?global:this;function ka(e,o){if(o){var s=ja;e=e.split(".");for(var h=0;h<e.length-1;h++){var d=e[h];d in s||(s[d]={}),s=s[d]}e=e[e.length-1],h=s[e],o=o(h),o!=h&&o!=null&&ia(s,e,{configurable:!0,writable:!0,value:o})}}ka("Array.prototype.find",function(e){return e||function(o,s){t:{var h=this;h instanceof String&&(h=String(h));for(var d=h.length,g=0;g<d;g++){var _=h[g];if(o.call(s,_,g,h)){o=_;break t}}o=void 0}return o}});function la(){la=function(){},ja.Symbol||(ja.Symbol=ma)}function na(e,o){this.a=e,ia(this,"description",{configurable:!0,writable:!0,value:o})}na.prototype.toString=function(){return this.a};var ma=function(){function e(s){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new na("jscomp_symbol_"+(s||"")+"_"+o++,s)}var o=0;return e}();function oa(){la();var e=ja.Symbol.iterator;e||(e=ja.Symbol.iterator=ja.Symbol("Symbol.iterator")),typeof Array.prototype[e]!="function"&&ia(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return pa(da(this))}}),oa=function(){}}function pa(e){return oa(),e={next:e},e[ja.Symbol.iterator]=function(){return this},e}function qa(e,o){oa(),e instanceof String&&(e+="");var s=0,h={next:function(){if(s<e.length){var d=s++;return{value:o(d,e[d]),done:!1}}return h.next=function(){return{done:!0,value:void 0}},h.next()}};return h[Symbol.iterator]=function(){return h},h}ka("Array.prototype.keys",function(e){return e||function(){return qa(this,function(o){return o})}});var ra;if(typeof Object.setPrototypeOf=="function")ra=Object.setPrototypeOf;else{var sa;t:{var ta={Fg:!0},ua={};try{ua.__proto__=ta,sa=ua.Fg;break t}catch{}sa=!1}ra=sa?function(e,o){if(e.__proto__=o,e.__proto__!==o)throw new TypeError(e+" is not extensible");return e}:null}var va=ra;ka("Object.setPrototypeOf",function(e){return e||va}),ka("Object.values",function(e){return e||function(o){var s=[],h;for(h in o)Object.prototype.hasOwnProperty.call(o,h)&&s.push(o[h]);return s}}),ka("Object.is",function(e){return e||function(o,s){return o===s?o!==0||1/o===1/s:o!==o&&s!==s}}),ka("Array.prototype.includes",function(e){return e||function(o,s){var h=this;h instanceof String&&(h=String(h));var d=h.length;for(s=s||0,0>s&&(s=Math.max(s+d,0));s<d;s++){var g=h[s];if(g===o||Object.is(g,o))return!0}return!1}}),ka("Promise",function(e){function o(_){this.C=0,this.b=void 0,this.a=[];var j=this.c();try{_(j.resolve,j.reject)}catch($){j.reject($)}}function s(){this.a=null}function h(_){return _ instanceof o?_:new o(function(j){j(_)})}if(e)return e;s.prototype.b=function(_){if(this.a==null){this.a=[];var j=this;this.c(function(){j.g()})}this.a.push(_)};var d=ja.setTimeout;s.prototype.c=function(_){d(_,0)},s.prototype.g=function(){for(;this.a&&this.a.length;){var _=this.a;this.a=[];for(var j=0;j<_.length;++j){var $=_[j];_[j]=null;try{$()}catch(_t){this.f(_t)}}}this.a=null},s.prototype.f=function(_){this.c(function(){throw _})},o.prototype.c=function(){function _(_t){return function(_e){$||($=!0,_t.call(j,_e))}}var j=this,$=!1;return{resolve:_(this.m),reject:_(this.f)}},o.prototype.m=function(_){if(_===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(_ instanceof o)this.U(_);else{t:switch(typeof _){case"object":var j=_!=null;break t;case"function":j=!0;break t;default:j=!1}j?this.s(_):this.g(_)}},o.prototype.s=function(_){var j=void 0;try{j=_.then}catch($){this.f($);return}typeof j=="function"?this.u(j,_):this.g(_)},o.prototype.f=function(_){this.i(2,_)},o.prototype.g=function(_){this.i(1,_)},o.prototype.i=function(_,j){if(this.C!=0)throw Error("Cannot settle("+_+", "+j+"): Promise already settled in state"+this.C);this.C=_,this.b=j,this.l()},o.prototype.l=function(){if(this.a!=null){for(var _=0;_<this.a.length;++_)g.b(this.a[_]);this.a=null}};var g=new s;return o.prototype.U=function(_){var j=this.c();_.sf(j.resolve,j.reject)},o.prototype.u=function(_,j){var $=this.c();try{_.call(j,$.resolve,$.reject)}catch(_t){$.reject(_t)}},o.prototype.then=function(_,j){function $(_n,_o){return typeof _n=="function"?function(ga){try{_t(_n(ga))}catch(_l){_e(_l)}}:_o}var _t,_e,_r=new o(function(_n,_o){_t=_n,_e=_o});return this.sf($(_,_t),$(j,_e)),_r},o.prototype.catch=function(_){return this.then(void 0,_)},o.prototype.sf=function(_,j){function $(){switch(_t.C){case 1:_(_t.b);break;case 2:j(_t.b);break;default:throw Error("Unexpected state: "+_t.C)}}var _t=this;this.a==null?g.b($):this.a.push($)},o.resolve=h,o.reject=function(_){return new o(function(j,$){$(_)})},o.race=function(_){return new o(function(j,$){for(var _t=ea(_),_e=_t.next();!_e.done;_e=_t.next())h(_e.value).sf(j,$)})},o.all=function(_){var j=ea(_),$=j.next();return $.done?h([]):new o(function(_t,_e){function _r(ga){return function(_l){_n[ga]=_l,_o--,_o==0&&_t(_n)}}var _n=[],_o=0;do _n.push(void 0),_o++,h($.value).sf(_r(_n.length-1),_e),$=j.next();while(!$.done)})},o}),ka("Object.entries",function(e){return e||function(o){var s=[],h;for(h in o)Object.prototype.hasOwnProperty.call(o,h)&&s.push([h,o[h]]);return s}});var wa=typeof Object.assign=="function"?Object.assign:function(e,o){for(var s=1;s<arguments.length;s++){var h=arguments[s];if(h)for(var d in h)Object.prototype.hasOwnProperty.call(h,d)&&(e[d]=h[d])}return e};ka("Object.assign",function(e){return e||wa}),ka("Math.log2",function(e){return e||function(o){return Math.log(o)/Math.LN2}});var xa=this||self;function ya(e,o,s){e=e.split("."),s=s||xa,e[0]in s||typeof s.execScript>"u"||s.execScript("var "+e[0]);for(var h;e.length&&(h=e.shift());)e.length||o===void 0?s[h]&&s[h]!==Object.prototype[h]?s=s[h]:s=s[h]={}:s[h]=o}function za(){}function Aa(e){var o=typeof e;if(o=="object")if(e){if(e instanceof Array)return"array";if(e instanceof Object)return o;var s=Object.prototype.toString.call(e);if(s=="[object Window]")return"object";if(s=="[object Array]"||typeof e.length=="number"&&typeof e.splice<"u"&&typeof e.propertyIsEnumerable<"u"&&!e.propertyIsEnumerable("splice"))return"array";if(s=="[object Function]"||typeof e.call<"u"&&typeof e.propertyIsEnumerable<"u"&&!e.propertyIsEnumerable("call"))return"function"}else return"null";else if(o=="function"&&typeof e.call>"u")return"object";return o}function Ca(e){var o=Aa(e);return o=="array"||o=="object"&&typeof e.length=="number"}function Da(e){return Aa(e)=="function"}function Ea(e){var o=typeof e;return o=="object"&&e!=null||o=="function"}var Ga="closure_uid_"+(1e9*Math.random()>>>0),Ha=0;function Ia(e,o,s){return e.call.apply(e.bind,arguments)}function Ja(e,o,s){if(!e)throw Error();if(2<arguments.length){var h=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(d,h),e.apply(o,d)}}return function(){return e.apply(o,arguments)}}function Ka(e,o,s){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ka=Ia:Ka=Ja,Ka.apply(null,arguments)}function La(e,o){var s=Array.prototype.slice.call(arguments,1);return function(){var h=s.slice();return h.push.apply(h,arguments),e.apply(this,h)}}function t(e,o){ya(e,o,void 0)}function u(e,o){function s(){}s.prototype=o.prototype,e.j=o.prototype,e.prototype=new s,e.prototype.constructor=e,e.ap=function(h,d,g){for(var _=Array(arguments.length-2),j=2;j<arguments.length;j++)_[j-2]=arguments[j];return o.prototype[d].apply(h,_)}}function Ma(e){if(Error.captureStackTrace)Error.captureStackTrace(this,Ma);else{var o=Error().stack;o&&(this.stack=o)}e&&(this.message=String(e))}u(Ma,Error),Ma.prototype.name="CustomError";function Na(e,o){this.c=e,this.f=o,this.b=0,this.a=null}Na.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e},Na.prototype.put=function(e){this.f(e),100>this.b&&(this.b++,e.next=this.a,this.a=e)};function Oa(){this.b=this.a=null}var Qa=new Na(function(){return new Pa},function(e){e.reset()});Oa.prototype.add=function(e,o){var s=Qa.get();s.set(e,o),this.b?this.b.next=s:this.a=s,this.b=s},Oa.prototype.remove=function(){var e=null;return this.a&&(e=this.a,this.a=this.a.next,this.a||(this.b=null),e.next=null),e};function Pa(){this.next=this.b=this.a=null}Pa.prototype.set=function(e,o){this.a=e,this.b=o,this.next=null},Pa.prototype.reset=function(){this.next=this.b=this.a=null};var Ra=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Sa(e,o){return e.indexOf(o)!=-1}function Ta(e,o){return e<o?-1:e>o?1:0}function Ua(e,o){for(var s in e)if(o.call(void 0,e[s],s,e))return!0;return!1}function Va(e){for(var o in e)return!1;return!0}function Wa(e){var o={},s;for(s in e)o[s]=e[s];return o}var Xa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ya(e,o){for(var s,h,d=1;d<arguments.length;d++){h=arguments[d];for(s in h)e[s]=h[s];for(var g=0;g<Xa.length;g++)s=Xa[g],Object.prototype.hasOwnProperty.call(h,s)&&(e[s]=h[s])}}var Za;t:{var $a=xa.navigator;if($a){var ab=$a.userAgent;if(ab){Za=ab;break t}}Za=""}function bb(e){return Sa(Za,e)}var cb=Array.prototype.indexOf?function(e,o){return Array.prototype.indexOf.call(e,o,void 0)}:function(e,o){if(typeof e=="string")return typeof o!="string"||o.length!=1?-1:e.indexOf(o,0);for(var s=0;s<e.length;s++)if(s in e&&e[s]===o)return s;return-1};function db(e,o){this.b=e===eb&&o||"",this.a=fb}var fb={},eb={},gb=new db(eb,"");function hb(e,o){this.b=e===ib&&o||"",this.a=jb}hb.prototype.rc=function(){return 1};var jb={},ib={};function kb(){this.b="",this.c=lb,this.a=null}kb.prototype.rc=function(){return this.a};function mb(){var e=nb;return e instanceof kb&&e.constructor===kb&&e.c===lb?e.b:(Aa(e),"type_error:SafeHtml")}var lb={};function ob(e){var o=new kb;return o.b=e,o.a=0,o}ob("<!DOCTYPE html>");var nb=ob("");ob("<br>");function pb(e){var o=new hb(ib,gb instanceof db&&gb.constructor===db&&gb.a===fb?gb.b:"type_error:Const");o instanceof hb&&o.constructor===hb&&o.a===jb?o=o.b:(Aa(o),o="type_error:TrustedResourceUrl"),e.src=o.toString()}function qb(e){return qb[" "](e),e}qb[" "]=za;function sb(e,o){var s=tb;return Object.prototype.hasOwnProperty.call(s,e)?s[e]:s[e]=o(e)}var ub=bb("Opera"),vb=bb("Trident")||bb("MSIE"),wb=bb("Edge"),xb=bb("Gecko")&&!(Sa(Za.toLowerCase(),"webkit")&&!bb("Edge"))&&!(bb("Trident")||bb("MSIE"))&&!bb("Edge"),yb=Sa(Za.toLowerCase(),"webkit")&&!bb("Edge");function zb(){var e=xa.document;return e?e.documentMode:void 0}var Ab;t:{var Bb="",Cb=function(){var e=Za;if(xb)return/rv:([^\);]+)(\)|;)/.exec(e);if(wb)return/Edge\/([\d\.]+)/.exec(e);if(vb)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(yb)return/WebKit\/(\S+)/.exec(e);if(ub)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(Cb&&(Bb=Cb?Cb[1]:""),vb){var Db=zb();if(Db!=null&&Db>parseFloat(Bb)){Ab=String(Db);break t}}Ab=Bb}var tb={};function Eb(e){return sb(e,function(){for(var o=0,s=Ra(String(Ab)).split("."),h=Ra(String(e)).split("."),d=Math.max(s.length,h.length),g=0;o==0&&g<d;g++){var _=s[g]||"",j=h[g]||"";do{if(_=/(\d*)(\D*)(.*)/.exec(_)||["","","",""],j=/(\d*)(\D*)(.*)/.exec(j)||["","","",""],_[0].length==0&&j[0].length==0)break;o=_[1].length==0?0:parseInt(_[1],10);var $=j[1].length==0?0:parseInt(j[1],10);o=Ta(o,$)||Ta(_[2].length==0,j[2].length==0)||Ta(_[2],j[2]),_=_[3],j=j[3]}while(o==0)}return 0<=o})}var Fb;Fb=xa.document&&vb?zb():void 0,!xb&&!vb||vb&&9<=Number(Fb)||xb&&Eb("1.9.1"),vb&&Eb("9");function Gb(e){var o=document;return e=String(e),o.contentType==="application/xhtml+xml"&&(e=e.toLowerCase()),o.createElement(e)}function Hb(e){xa.setTimeout(function(){throw e},0)}var Ib;function Kb(){var e=xa.MessageChannel;if(typeof e>"u"&&typeof window<"u"&&window.postMessage&&window.addEventListener&&!bb("Presto")&&(e=function(){var d=Gb("IFRAME");d.style.display="none",pb(d),document.documentElement.appendChild(d);var g=d.contentWindow;d=g.document,d.open(),d.write(mb()),d.close();var _="callImmediate"+Math.random(),j=g.location.protocol=="file:"?"*":g.location.protocol+"//"+g.location.host;d=Ka(function($){(j=="*"||$.origin==j)&&$.data==_&&this.port1.onmessage()},this),g.addEventListener("message",d,!1),this.port1={},this.port2={postMessage:function(){g.postMessage(_,j)}}}),typeof e<"u"&&!bb("Trident")&&!bb("MSIE")){var o=new e,s={},h=s;return o.port1.onmessage=function(){if(s.next!==void 0){s=s.next;var d=s.bj;s.bj=null,d()}},function(d){h.next={bj:d},h=h.next,o.port2.postMessage(0)}}return typeof document<"u"&&"onreadystatechange"in Gb("SCRIPT")?function(d){var g=Gb("SCRIPT");g.onreadystatechange=function(){g.onreadystatechange=null,g.parentNode.removeChild(g),g=null,d(),d=null},document.documentElement.appendChild(g)}:function(d){xa.setTimeout(d,0)}}function Lb(e,o){Mb||Nb(),Ob||(Mb(),Ob=!0),Pb.add(e,o)}var Mb;function Nb(){if(xa.Promise&&xa.Promise.resolve){var e=xa.Promise.resolve(void 0);Mb=function(){e.then(Qb)}}else Mb=function(){var o=Qb;!Da(xa.setImmediate)||xa.Window&&xa.Window.prototype&&!bb("Edge")&&xa.Window.prototype.setImmediate==xa.setImmediate?(Ib||(Ib=Kb()),Ib(o)):xa.setImmediate(o)}}var Ob=!1,Pb=new Oa;function Qb(){for(var e;e=Pb.remove();){try{e.a.call(e.b)}catch(o){Hb(o)}Qa.put(e)}Ob=!1}function Rb(e){if(this.C=Sb,this.i=void 0,this.c=this.a=this.b=null,this.f=this.g=!1,e!=za)try{var o=this;e.call(void 0,function(s){Tb(o,Ub,s)},function(s){Tb(o,Vb,s)})}catch(s){Tb(this,Vb,s)}}var Sb=0,Ub=2,Vb=3;function Wb(){this.next=this.c=this.b=this.f=this.a=null,this.g=!1}Wb.prototype.reset=function(){this.c=this.b=this.f=this.a=null,this.g=!1};var Xb=new Na(function(){return new Wb},function(e){e.reset()});function Yb(e,o,s){var h=Xb.get();return h.f=e,h.b=o,h.c=s,h}function Zb(e){if(e instanceof Rb)return e;var o=new Rb(za);return Tb(o,Ub,e),o}function $b(e){return new Rb(function(o,s){s(e)})}function ac(){var e,o,s=new Rb(function(h,d){e=h,o=d});return new cc(s,e,o)}Rb.prototype.then=function(e,o,s){return dc(this,Da(e)?e:null,Da(o)?o:null,s)},Rb.prototype.$goog_Thenable=!0,Rb.prototype.cancel=function(e){if(this.C==Sb){var o=new ec(e);Lb(function(){fc(this,o)},this)}};function fc(e,o){if(e.C==Sb)if(e.b){var s=e.b;if(s.a){for(var h=0,d=null,g=null,_=s.a;_&&(_.g||(h++,_.a==e&&(d=_),!(d&&1<h)));_=_.next)d||(g=_);d&&(s.C==Sb&&h==1?fc(s,o):(g?(h=g,h.next==s.c&&(s.c=h),h.next=h.next.next):gc(s),hc(s,d,Vb,o)))}e.b=null}else Tb(e,Vb,o)}function ic(e,o){e.a||e.C!=Ub&&e.C!=Vb||jc(e),e.c?e.c.next=o:e.a=o,e.c=o}function dc(e,o,s,h){var d=Yb(null,null,null);return d.a=new Rb(function(g,_){d.f=o?function(j){try{var $=o.call(h,j);g($)}catch(_t){_(_t)}}:g,d.b=s?function(j){try{var $=s.call(h,j);$===void 0&&j instanceof ec?_(j):g($)}catch(_t){_(_t)}}:_}),d.a.b=e,ic(e,d),d.a}Rb.prototype.s=function(e){this.C=Sb,Tb(this,Ub,e)},Rb.prototype.m=function(e){this.C=Sb,Tb(this,Vb,e)};function Tb(e,o,s){if(e.C==Sb){e===s&&(o=Vb,s=new TypeError("Promise cannot resolve to itself")),e.C=1;t:{var h=s,d=e.s,g=e.m;if(h instanceof Rb){ic(h,Yb(d||za,g||null,e));var _=!0}else{if(h)try{var j=!!h.$goog_Thenable}catch{j=!1}else j=!1;if(j)h.then(d,g,e),_=!0;else{if(Ea(h))try{var $=h.then;if(Da($)){kc(h,$,d,g,e),_=!0;break t}}catch(_t){g.call(e,_t),_=!0;break t}_=!1}}}_||(e.i=s,e.C=o,e.b=null,jc(e),o!=Vb||s instanceof ec||lc(e,s))}}function kc(e,o,s,h,d){function g($){j||(j=!0,h.call(d,$))}function _($){j||(j=!0,s.call(d,$))}var j=!1;try{o.call(e,_,g)}catch($){g($)}}function jc(e){e.g||(e.g=!0,Lb(e.l,e))}function gc(e){var o=null;return e.a&&(o=e.a,e.a=o.next,o.next=null),e.a||(e.c=null),o}Rb.prototype.l=function(){for(var e;e=gc(this);)hc(this,e,this.C,this.i);this.g=!1};function hc(e,o,s,h){if(s==Vb&&o.b&&!o.g)for(;e&&e.f;e=e.b)e.f=!1;if(o.a)o.a.b=null,mc(o,s,h);else try{o.g?o.f.call(o.c):mc(o,s,h)}catch(d){nc.call(null,d)}Xb.put(o)}function mc(e,o,s){o==Ub?e.f.call(e.c,s):e.b&&e.b.call(e.c,s)}function lc(e,o){e.f=!0,Lb(function(){e.f&&nc.call(null,o)})}var nc=Hb;function ec(e){Ma.call(this,e)}u(ec,Ma),ec.prototype.name="cancel";function cc(e,o,s){this.Ak=e,this.resolve=o,this.reject=s}var x=this;function oc(){return Object.create(z,void 0)}var A=Ka,pc=String,qc=x.Object.freeze||function(e){return e};function rc(e){for(var o=Object.keys(e),s=o.length,h;s--;)h=e[o[s]],Ea(h)&&rc(h);return qc(e)}function sc(e){var o=Aa(e);if(o=="object"||o=="array"){if(Da(e.clone))return e.clone();o=o=="array"?[]:{};for(var s in e)e.hasOwnProperty(s)&&(o[s]=sc(e[s]));return o}return e}var B=[].pop(),z=/x/.exec("");function tc(e,o){return pc(e).split(o!==B?o:" ")}var uc="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(e,o,s,h,d){if(!(o=e instanceof o)&&s)throw new D(s,h,vc(d)?d:e);return o}function xc(e,o){if((C(e,o)&&e.constructor===o)===!0)throw new TypeError("Illegal constructor "+yc(o))}function zc(e,o,s,h,d){if(!(o=Ac(e)===o)&&s)throw new D(s,h,vc(d)?d:e);return o}function Bc(e,o,s,h){return zc(e,"Array",o,s,h)}t("H.lang.isArray",Bc);function vc(e){return e!==B}function Cc(e){return typeof e=="string"}t("H.lang.isString",Cc);var Dc=parseInt,Ec=parseFloat,E=isNaN;function Fc(e){return e===+e}t("H.lang.isNumber",Fc),t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(e){return typeof e=="number"&&e%1===0});function Gc(e){return!E(+e)}function Ac(e){var o=Object[uc[0]][uc[6]].call(e).match(/^\[object (\w+)\]$/);return o?o[1]:typeof e}var Hc=[];function Ic(e){0>Hc.indexOf(e)&&Hc.push(e)}Ic(Hc);function yc(e,o,s,h){var d="",g=2>arguments.length,_;return g&&(o={H:x.H},s="",h=Hc.slice()),Jc(o,!0,function(j,$){try{if(_=j[$],$=Kc(j,_),!(Ea(_)&&_.window===_&&_.self===_||Ea(_)&&0<_.nodeType&&Da(_.cloneNode))&&Ea(_)){if(_===e)return d=s+"."+$,!0;if(0>h.indexOf(_)&&(h.push(_),d=yc(e,_,s+"."+$,h)))return!0}}catch{}}),g&&(d=d?d.substr(1).replace("."+uc[0]+".","#"):"~"+(Da(e)?Lc(e)+"()":Ac(e))),d}function Kc(e,o){var s=[];return Jc(e,!1,function(h,d){h[d]===o&&s.push(d)}),s.sort(Mc)[0]}function Mc(e,o){return o.length-e.length}var Nc=Object[uc[0]][uc[2]];function Jc(e,o,s){var h;if(e){for(d in e)if((!o||Nc.call(e,d))&&s(e,d,!0))return;for(h=uc.length;h--;){var d=uc[h];if((!o||Nc.call(e,d))&&s(e,d,!1))break}}}function Lc(e){return(e=/^\s*function ([^\( ]+)/.exec(e))?e[1]:"anonymous"}function Oc(e,o,s){s[o]="#"+o}var Pc=!!x.__karma__;function Qc(){throw Error("unimplemented method")}function Rc(e,o){o=o||{},"status"in o&&(this.status=+o.status),"statusText"in o&&(this.statusText=o.statusText),this.ok=200<=this.status&&300>this.status,this.f=!1,e?typeof e=="string"?this.c=e:(o=x.ArrayBuffer)&&o.prototype.isPrototypeOf(e)?this.a=e:o&&e.buffer?this.a=e.buffer:x.Blob.prototype.isPrototypeOf(e)&&(this.b=e):this.c=""}t("H.net.Response",Rc),Rc.prototype.type="default",Rc.prototype.type=Rc.prototype.type,Rc.prototype.status=200,Rc.prototype.status=Rc.prototype.status,Rc.prototype.statusText="OK",Rc.prototype.statusText=Rc.prototype.statusText;function Sc(e){if(e.f)return $b(new TypeError("Already read"));e.f=!0}Rc.error=function(){return Rc.a||(Rc.a=new Rc(null,{status:0,statusText:""}),Rc.a.type="error"),Rc.a},Rc.error=Rc.error,Rc.prototype.text=function(){var e=Sc(this);if(!e)if(this.c)e=Zb(this.c);else if(this.a){e=new Uint8Array(this.a);var o=e.length,s=Array(o),h;for(h=0;h<o;h++)s[h]=String.fromCharCode(e[h]);e=Zb(s.join(""))}else this.b?e=Tc(this.b):e=$b("Unsupported response body");return e},Rc.prototype.json=function(){return this.text().then(x.JSON.parse)},Rc.prototype.blob=function(){var e,o=Sc(this);return o||(this.b?e=this.b:this.a&&(e=new Blob([this.a],{type:"application/octet-stream"}))),o||Zb(e)},Rc.prototype.arrayBuffer=function(){return this.a?Sc(this)||Zb(this.a.slice(0)):this.blob().then(Rc.b)},Rc.b=function(e){var o=new FileReader;return o.readAsArrayBuffer(e),new Rb(function(s,h){o.onload=function(){s(o.result)},o.onerror=function(){h(o.error)}})};function Tc(e){var o=new FileReader;return o.readAsText(e),new Rb(function(s,h){o.onload=function(){s(o.result)},o.onerror=function(){h(o.error)}})}!Pc&&x.Response&&x.Response.error&&(Rc=x.Response,Ic(Rc.prototype));function D(e,o,s){var h=arguments.length;if(o=o!==B?+o:o,o!==B){var d=(d=/^.*?\(([^\)]+)/.exec((""+e).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?tc(d[1].replace(/\s+/g,""),","):[];d.forEach(Oc),d=d[o]||"#"+o}var g=e?yc(e):"";return h=2<h?pc(s):"",(d||h)&&(g+=" (Argument "+(d||"")+(h?" "+h:"")+")"),h=Error(g),Object.setPrototypeOf(h,D.prototype),h}u(D,Error),t("H.lang.InvalidArgumentError",D),D.prototype.name="InvalidArgumentError";function Uc(e,o,s){function h(){var _e=A(_t.b,_t),_r=+$.timeout||0;Vc?(Wc(_t,"timeout",_e),d.timeout=_r):_r&&(_t.f=setTimeout(function(){d.abort(),_t.b({type:"timeout"})},_r)),Wc(_t,"error",_e),Wc(_t,"load",_e),d.send($.data)}var d,g,_,j=s&&s.headers||{},$={},_t=this;if(!Da(o))throw new D(Uc,1,"function required");Ya(j,Xc.headers,j),Ya($,Xc,s||{}),$.headers=j,this.c=o,this.a=d=new XMLHttpRequest,o=$.method;try{d.open(o,e,!0);for(g in j)j.hasOwnProperty(g)&&(_=j[g])&&d.setRequestHeader(g,_);d.withCredentials=!!$.withCredentials,h()}catch{this.b({type:"cors"})}}t("H.net.Xhr",Uc);var Xc={method:"GET",headers:{},data:null},Yc="withCredentials"in new XMLHttpRequest,Vc="timeout"in new XMLHttpRequest;function Wc(e,o,s){Yc?e.a.addEventListener(o,s):e.a["on"+o]=s}function Zc(e,o,s){Yc?e.a.removeEventListener(o,s):e.a["on"+o]=null}Uc.prototype.abort=function(){this.a&&(this.a.abort(),this.a&&this.b({type:"abort"}))},Uc.prototype.abort=Uc.prototype.abort,Uc.prototype.b=function(e){var o=e.type;e=this.a;var s;this.f&&clearTimeout(this.f),o==="load"?e instanceof XMLHttpRequest&&e.status!==200&&(s="network"):s=e.readyState===4&&e.status===0&&o=="error"?"cors":o!="error"?o:"network",o=this.b,Zc(this,"timeout",o),Zc(this,"error",o),Zc(this,"load",o),e=e.status===0||s&&s!=="network"?Rc.error():new Rc(e.responseText||null,e),s=this.c,delete this.b,delete this.c,delete this.a,s(e)};function $c(e,o){var s=[];return e&&s.push(yc(e)),1<arguments.length&&s.push(""+o),s=Error(s.join(" ")),Object.setPrototypeOf(s,$c.prototype),s}u($c,Error),t("H.lang.IllegalOperationError",$c),$c.prototype.name="IllegalOperationError";var bd,cd,dd;function ed(){if(this.constructor=this.constructor,!Cc("STATIC_DB"))throw new D(this.constructor,0);if(this.g=fd(),!this.g)throw new $c(this.constructor,"This browser does not support IndexedDB");this.a=[],this.c=[],this.Zh=A(this.Zh,this)}var gd,hd;p=ed.prototype,p.put=function(e,o,s,h){if(!Cc(e)&&!Fc(e))throw new D(this.put,0);if(!id(o))throw new D(this.put,1);jd(this,function(d){kd(d.put(o,e),s,h)},h)},p.get=function(e,o,s){var h;if(!Cc(e)&&!Fc(e))throw new D(this.get,0);if(!Da(o))throw new D(this.get,1);return jd(this,function(d){h=d.get(e),kd(h,o,s)},s),{cancel:function(){h&&(h.onsuccess=ld)}}},p.remove=function(e,o,s){if(!Cc(e)&&!Fc(e))throw new D(this.remove,0);jd(this,function(h){kd(h.delete(e),o,s)},s)},p.clear=function(e,o){jd(this,function(s){kd(s.clear(),e,o)},o)},p.Zh=function(){var e=this.b.result;e.objectStoreNames.contains("data")||e.createObjectStore("data")};function md(e,o,s){if(e.b)e.a?(e.a.push(o),s&&e.c.push(s)):e.f?s&&s(e.f):o(e.b.result);else{e.b=e.g.open("H_STATIC_DB",1),e.b.onupgradeneeded=e.Zh;var h=e.b.onerror=function(){clearTimeout(e.i),e.f=this.error,e.c.forEach(function(d){d(e.f)}),delete e.a,delete e.c};e.i=setTimeout(function(){h.call({error:Error("DbOpenTimeoutError")})},500),e.b.onsuccess=function(){clearTimeout(e.i),e.a?(e.a.forEach(function(d){d(this.result)},this),delete e.a,delete e.c):(delete e.b,delete e.f,e.a=[],e.c=[])},e.a.push(o),s&&e.c.push(s)}}function jd(e,o,s){md(e,function(h){h=h.transaction(["data"],"readwrite"),o(h.objectStore("data"))},s)}function kd(e,o,s){o&&(e.onsuccess=function(){o(this.result)}),s&&(e.onerror=function(){s(this.error)})}function id(e){var o=Object.prototype.toString.call(e);return o==="[object Blob]"||o==="[object ArrayBuffer]"||Cc(e)||Ea(e)}function nd(){return gd||(gd=new ed),gd}t("H.util.IndexedDBStorage.getInstance",nd);function fd(){return x.indexedDB||x.webkitIndexedDB||x.mozIndexedDB||x.msIndexedDB}function od(){var e="";if(!vc(hd))if(window.location.protocol==="file:"&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)hd=!1;else{try{var o=fd();e="H_TEST_DB";var s=o&&o.open(e,1)}catch{}hd=!!s&&s.onupgradeneeded===null,s&&o.deleteDatabase&&o.deleteDatabase(e)}return hd}t("H.util.IndexedDBStorage.isSupported",od);function qd(){this.zd=this.zd,this.mb=this.mb}var rd=0;qd.prototype.zd=!1,qd.prototype.F=function(){!this.zd&&(this.zd=!0,this.o(),rd!=0)&&(this[Ga]||(this[Ga]=++Ha))},qd.prototype.tb=function(e,o){this.zd?o!==void 0?e.call(o):e():(this.mb||(this.mb=[]),this.mb.push(o!==void 0?Ka(e,o):e))},qd.prototype.o=function(){if(this.mb)for(;this.mb.length;)this.mb.shift()()};function td(e){e&&typeof e.F=="function"&&e.F()}function ud(e,o){this.type=e,this.currentTarget=this.target=o,this.c=this.a=!1,this.Ik=!0}ud.prototype.stopPropagation=function(){this.a=!0},ud.prototype.preventDefault=function(){this.c=!0,this.Ik=!1},t("H.util.Event",ud),ud.prototype.stopPropagation=ud.prototype.stopPropagation,ud.prototype.stopPropagation=ud.prototype.stopPropagation,ud.prototype.CAPTURING_PHASE=1,ud.prototype.CAPTURING_PHASE=ud.prototype.CAPTURING_PHASE,ud.prototype.AT_TARGET=2,ud.prototype.AT_TARGET=ud.prototype.AT_TARGET,ud.prototype.BUBBLING_PHASE=3,ud.prototype.BUBBLING_PHASE=ud.prototype.BUBBLING_PHASE,ud.prototype.eventPhase=0,ud.prototype.eventPhase=ud.prototype.eventPhase;function vd(e,o,s){vd.j.constructor.call(this,e,s),this.data=o}u(vd,ud),t("H.util.DataEvent",vd);function wd(e,o,s){wd.j.constructor.call(this,e,s),this.message=o}u(wd,ud),t("H.util.ErrorEvent",wd);var xd=Math,yd=xd.min,zd=xd.max,Ad=xd.round,Bd=xd.floor,Cd=xd.ceil,Dd=xd.abs,Ed=xd.log,Fd=xd.sqrt,Gd=xd.pow,Hd=xd.exp,Id=xd.sin,Jd=xd.asin,Kd=xd.cos,Ld=xd.tan,Md=xd.atan,Nd=xd.atan2,Od=xd.LN2,Pd=xd.PI,Qd=Pd/2,Rd=Pd/4,Sd=2*Pd,Td=3*Pd,Ud=Pd/180,Vd=180/Pd,Wd=1/0,Xd=Gd(-2,53),Yd=Yd||function(e){return Ed(e)/Od};function Zd(e,o){var s;return 0>(s=e%o)==0>o?s:s+o}function $d(e,o,s){return o-=s=s||0,e-=s,e-Bd(e/o)*o+s}t("H.math.normalize",$d);function ae(e,o,s){return e>s?s:e<o?o:e}t("H.math.clamp",ae);function be(e,o,s,h){return h||(h=0),o<s?e>=o-h&&e<=s+h:e>=s-h&&e<=o+h}function ce(e,o,s,h,d,g){return Fd(Gd((e-d)*(h-g)-(o-g)*(s-d),2)/(Gd(s-d,2)+Gd(h-g,2)))}var de={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",de);function ee(e,o,s,h,d,g){var _=s.length,j=_,$=s[0],_t=0,_e=0,_r=0;h=h/2||0;var _n=g||2;g=_n*(d?0:1)+1;for(var _o=_n-2;_t!=1&&j>g;){j-=_o;var ga=s[--j];_n=s[--j];var _l=s[j?j-_o-1:(_+(j-_o-1))%_],_f=s[j?j-_o-2:(_+(j-_o-2))%_];_n>=e-h&&_n<=e+h&&ga>=o-h&&ga<=o+h||_f>=e-h&&_f<=e+h&&_l>=o-h&&_l<=o+h?_t=1:!_t&&_n===e?(_f===e&&(ga<o&&_l>o||ga>o&&_l<o)||($<=e&&_f>e||$>=e&&_f<e)&&(ga>=o?++_e:++_r),_t=be(o,ga,_l,h)&&ce(e,o,_n,ga,_f,_l)<=h?2:0):!_t&&be(e,_n,_f,h)&&((_n<e&&_f>e||_n>e&&_f<e)&&($=ga+(e-_n)/(_f-_n)*(_l-ga),_e+=$>o,_r+=$<o),_t=be(o,ga,_l,h)&&ce(e,o,_n,ga,_f,_l)<=h?2:0),$=_n}return!_t&&d&&_r!==0&&_e%2!==0&&(_t=3),_t}function fe(e,o){return ee(e.x,e.y,o,0,!0)!==de.NONE}t("H.math.isPointInsidePolygon",fe);function ge(e){for(var o=e.length,s=new Float64Array(2*o),h=o&&vc(e[0].x);o--;){var d=e[o],g=o<<1;s[g]=h?d.x:d[0],s[g+1]=h?d.y:d[1]}return s}t("H.math.flatten",ge);function he(){}t("H.util.ICancelable",he),he.prototype.cancel=function(){},he.prototype.cancel=he.prototype.cancel;function ie(e,o,s){this.type=e,this.data=o,this.c=ac(),this.resolve=A(this.resolve,this),this.reject=A(this.reject,this),this.priority=je,s!==B&&(this.priority=s),this.fh().add(this)}var je=1,ke={Vo:0,Yo:je,To:2};p=ie.prototype,p.then=function(e,o,s){return this.c.Ak.then(e,o,s)},p.resolve=function(e){this.Yd=3,this.c.resolve(e)},p.reject=function(e){this.Yd=5,this.c.reject(e)},p.Yd=0,p.cancel=function(){3>this.Yd&&(this.oe(),this.fh().remove(this),this.Yd=4)},ie.prototype.cancel=ie.prototype.cancel;function le(e){var o;this.a={};for(o in ke)this.a[ke[o]]=[];this.Ze=e,this.Ze.addEventListener("allocatable",A(this.b,this))}t("H.util.JobManager",le);var me=Object.keys(ke).map(function(e){return ke[e]}).sort().reverse();le.prototype.add=function(e){C(e,ie,this.add,0),this.a[e.priority].push(e),this.b()},le.prototype.contains=function(e){return-1<this.a[e.priority].indexOf(e)},le.prototype.remove=function(e){var o=e.priority,s=this.a[o].indexOf(e);return-1<s?(this.a[o].splice(s,1),!0):(e.Li&&this.Ze.yf(e.Li),!1)},le.prototype.b=function(){me.forEach(function(e){this.a[e]=this.a[e].filter(function(o){var s;if((s=this.Ze.Jg(o))!==z){var h=A(this.Ze.yf,this.Ze,s,o);o.Li=s,o.then(h,h),o.Yd=o.qj(s)?1:5}else return!0},this)},this)};function ne(e,o,s){var h=[],d=arguments.length;return e&&h.push(yc(e)),1<d&&(d=2<d&&Bc(s)?" out of ["+s[0]+"..."+s[1]+"]":"",h.push("("+o+d+")")),h=Error(h.join(" ")),Object.setPrototypeOf(h,ne.prototype),h}u(ne,Error),t("H.lang.OutOfRangeError",ne),ne.prototype.name="OutOfRangeError";var oe="closure_listenable_"+(1e6*Math.random()|0);function pe(e){return!(!e||!e[oe])}var qe=0;function re(e,o,s,h,d){this.listener=e,this.proxy=null,this.src=o,this.type=s,this.capture=!!h,this.Mf=d,this.key=++qe,this.be=this.rf=!1}function se(e){e.be=!0,e.listener=null,e.proxy=null,e.src=null,e.Mf=null}function te(e){this.src=e,this.a={},this.b=0}te.prototype.add=function(e,o,s,h,d){var g=e.toString();e=this.a[g],e||(e=this.a[g]=[],this.b++);var _=ue(e,o,h,d);return-1<_?(o=e[_],s||(o.rf=!1)):(o=new re(o,this.src,g,!!h,d),o.rf=s,e.push(o)),o},te.prototype.remove=function(e,o,s,h){if(e=e.toString(),!(e in this.a))return!1;var d=this.a[e];return o=ue(d,o,s,h),-1<o?(se(d[o]),Array.prototype.splice.call(d,o,1),d.length==0&&(delete this.a[e],this.b--),!0):!1};function ve(e,o){var s=o.type;if(!(s in e.a))return!1;var h=e.a[s],d=cb(h,o),g;return(g=0<=d)&&Array.prototype.splice.call(h,d,1),g&&(se(o),e.a[s].length==0&&(delete e.a[s],e.b--)),g}te.prototype.na=function(e){e=e&&e.toString();var o=0,s;for(s in this.a)if(!e||s==e){for(var h=this.a[s],d=0;d<h.length;d++)++o,se(h[d]);delete this.a[s],this.b--}return o},te.prototype.sh=function(e,o){var s=e!==void 0,h=s?e.toString():"",d=o!==void 0;return Ua(this.a,function(g){for(var _=0;_<g.length;++_)if(!(s&&g[_].type!=h||d&&g[_].capture!=o))return!0;return!1})};function ue(e,o,s,h){for(var d=0;d<e.length;++d){var g=e[d];if(!g.be&&g.listener==o&&g.capture==!!s&&g.Mf==h)return d}return-1}var we=!vb||9<=Number(Fb),xe=vb&&!Eb("9");!yb||Eb("528"),xb&&Eb("1.9b")||vb&&Eb("8")||ub&&Eb("9.5")||yb&&Eb("528"),xb&&!Eb("8")||vb&&Eb("9");var ye=function(){if(!xa.addEventListener||!Object.defineProperty)return!1;var e=!1,o=Object.defineProperty({},"passive",{get:function(){e=!0}});try{xa.addEventListener("test",za,o),xa.removeEventListener("test",za,o)}catch{}return e}();function ze(e,o){if(ud.call(this,e?e.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.b=null,e){var s=this.type=e.type,h=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.currentTarget=o,o=e.relatedTarget){if(xb){t:{try{qb(o.nodeName);var d=!0;break t}catch{}d=!1}d||(o=null)}}else s=="mouseover"?o=e.fromElement:s=="mouseout"&&(o=e.toElement);this.relatedTarget=o,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:Ae[e.pointerType]||"",this.b=e,e.defaultPrevented&&this.preventDefault()}}u(ze,ud);var Ae={2:"touch",3:"pen",4:"mouse"};ze.prototype.stopPropagation=function(){ze.j.stopPropagation.call(this),this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0},ze.prototype.preventDefault=function(){ze.j.preventDefault.call(this);var e=this.b;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,xe)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch{}};var Be="closure_lm_"+(1e6*Math.random()|0),Ce={};function Ee(e,o,s,h,d){if(h&&h.once)return Fe(e,o,s,h,d);if(Aa(o)=="array"){for(var g=0;g<o.length;g++)Ee(e,o[g],s,h,d);return null}return s=Ge(s),pe(e)?e.U.add(String(o),s,!1,Ea(h)?!!h.capture:!!h,d):He(e,o,s,!1,h,d)}function He(e,o,s,h,d,g){if(!o)throw Error("Invalid event type");var _=Ea(d)?!!d.capture:!!d,j=Ie(e);if(j||(e[Be]=j=new te(e)),s=j.add(o,s,h,_,g),s.proxy)return s;if(h=Je(),s.proxy=h,h.src=e,h.listener=s,e.addEventListener)ye||(d=_),d===void 0&&(d=!1),e.addEventListener(o.toString(),h,d);else if(e.attachEvent)e.attachEvent(Ke(o.toString()),h);else if(e.addListener&&e.removeListener)e.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return s}function Je(){var e=Le,o=we?function(s){return e.call(o.src,o.listener,s)}:function(s){if(s=e.call(o.src,o.listener,s),!s)return s};return o}function Fe(e,o,s,h,d){if(Aa(o)=="array"){for(var g=0;g<o.length;g++)Fe(e,o[g],s,h,d);return null}return s=Ge(s),pe(e)?e.U.add(String(o),s,!0,Ea(h)?!!h.capture:!!h,d):He(e,o,s,!0,h,d)}function Me(e,o,s,h,d){if(Aa(o)=="array"){for(var g=0;g<o.length;g++)Me(e,o[g],s,h,d);return null}return h=Ea(h)?!!h.capture:!!h,s=Ge(s),pe(e)?e.U.remove(String(o),s,h,d):e&&(e=Ie(e))&&(o=e.a[o.toString()],e=-1,o&&(e=ue(o,s,h,d)),s=-1<e?o[e]:null)?Ne(s):!1}function Ne(e){if(typeof e=="number"||!e||e.be)return!1;var o=e.src;if(pe(o))return ve(o.U,e);var s=e.type,h=e.proxy;return o.removeEventListener?o.removeEventListener(s,h,e.capture):o.detachEvent?o.detachEvent(Ke(s),h):o.addListener&&o.removeListener&&o.removeListener(h),(s=Ie(o))?(ve(s,e),s.b==0&&(s.src=null,o[Be]=null)):se(e),!0}function Ke(e){return e in Ce?Ce[e]:Ce[e]="on"+e}function Oe(e,o,s,h){var d=!0;if((e=Ie(e))&&(o=e.a[o.toString()]))for(o=o.concat(),e=0;e<o.length;e++){var g=o[e];g&&g.capture==s&&!g.be&&(g=Pe(g,h),d=d&&g!==!1)}return d}function Pe(e,o){var s=e.listener,h=e.Mf||e.src;return e.rf&&Ne(e),s.call(h,o)}function Le(e,o){if(e.be)return!0;if(!we){if(!o)t:{o=["window","event"];for(var s=xa,h=0;h<o.length;h++)if(s=s[o[h]],s==null){o=null;break t}o=s}if(h=o,o=new ze(h,this),s=!0,!(0>h.keyCode||h.returnValue!=null)){t:{var d=!1;if(h.keyCode==0)try{h.keyCode=-1;break t}catch{d=!0}(d||h.returnValue==null)&&(h.returnValue=!0)}for(h=[],d=o.currentTarget;d;d=d.parentNode)h.push(d);for(e=e.type,d=h.length-1;!o.a&&0<=d;d--){o.currentTarget=h[d];var g=Oe(h[d],e,!0,o);s=s&&g}for(d=0;!o.a&&d<h.length;d++)o.currentTarget=h[d],g=Oe(h[d],e,!1,o),s=s&&g}return s}return Pe(e,new ze(o,this))}function Ie(e){return e=e[Be],e instanceof te?e:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ge(e){return Da(e)?e:(e[Qe]||(e[Qe]=function(o){return e.handleEvent(o)}),e[Qe])}function F(){qd.call(this),this.U=new te(this),this.wn=this,this.Mg=null}u(F,qd),F.prototype[oe]=!0,p=F.prototype,p.Mb=function(){return this.Mg},p.ka=function(e){this.Mg=e},p.addEventListener=function(e,o,s,h){Ee(this,e,o,s,h)},p.removeEventListener=function(e,o,s,h){Me(this,e,o,s,h)},p.dispatchEvent=function(e){var o,s=this.Mb();if(s)for(o=[];s;s=s.Mb())o.push(s);s=this.wn;var h=e.type||e;if(typeof e=="string")e=new ud(e,s);else if(e instanceof ud)e.target=e.target||s;else{var d=e;e=new ud(h,s),Ya(e,d)}if(d=!0,o)for(var g=o.length-1;!e.a&&0<=g;g--){var _=e.currentTarget=o[g];d=_.jd(h,!0,e)&&d}if(e.a||(_=e.currentTarget=s,d=_.jd(h,!0,e)&&d,e.a||(d=_.jd(h,!1,e)&&d)),o)for(g=0;!e.a&&g<o.length;g++)_=e.currentTarget=o[g],d=_.jd(h,!1,e)&&d;return d},p.o=function(){F.j.o.call(this),this.U&&this.U.na(void 0),this.Mg=null},p.jd=function(e,o,s){if(e=this.U.a[String(e)],!e)return!0;e=e.concat();for(var h=!0,d=0;d<e.length;++d){var g=e[d];if(g&&!g.be&&g.capture==o){var _=g.listener,j=g.Mf||g.src;g.rf&&ve(this.U,g),h=_.call(j,s)!==!1&&h}}return h&&s.Ik!=0},p.sh=function(e,o){return this.U.sh(e!==void 0?String(e):void 0,o)},t("H.util.EventTarget",F),F.prototype.ka=F.prototype.ka,F.prototype.setParentEventTarget=F.prototype.ka,F.prototype.Mb=F.prototype.Mb,F.prototype.getParentEventTarget=F.prototype.Mb,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.F=F.prototype.F,F.prototype.dispose=F.prototype.F,F.prototype.tb=F.prototype.tb,F.prototype.addOnDisposeCallback=F.prototype.tb,F.prototype.xn=F.prototype.jd,F.prototype.jd=function(e,o,s){var h,d,g=!0,_=s[s.currentTarget===s.target?"AT_TARGET":o?"CAPTURING_PHASE":(h=!0,"BUBBLING_PHASE")];return(!h||(d=s.type)!=="pointerenter"&&d!=="pointerleave")&&(s.eventPhase=_,g=F.prototype.xn.apply(this,arguments),h&&this.Mb&&this.Mb()===null&&delete s.eventPhase),g},F.prototype.Tk=function(e){for(var o,s=this;s&&(o=s.Mb())&&o!==e;)s=o;o||s.ka(e)},F.prototype.setRootParentEventTarget=F.prototype.Tk;function Re(e){e=e||{};var o=e.callback;this.b=e.label,Da(o)&&(this.callback=o),this.a=!!e.disabled,Re.j.constructor.call(this)}u(Re,F),t("H.util.ContextItem",Re),Re.prototype.Ge=function(){return this.b},Re.prototype.getLabel=Re.prototype.Ge,Re.prototype.Jc=function(e){return this.b!==e&&(this.b=e,this.dispatchEvent("update")),this},Re.prototype.setLabel=Re.prototype.Jc,Re.prototype.dc=function(){return this.a},Re.prototype.isDisabled=Re.prototype.dc,Re.prototype.va=function(e){return e!==this.a&&(this.a=e,this.dispatchEvent("update")),this},Re.prototype.setDisabled=Re.prototype.va;var Se=new Re;Re.SEPARATOR=Se;function Te(e){if(x.document){var o=document.createElement("canvas");return o.width=o.height=1,o.getContext("2d",{fp:e})}return null}function Ue(){return window.devicePixelRatio||1}t("H.util.getPixelRatio",Ue);var Ve=/^rgba\(([^,]+),([^,]+),([^,]+),([^)]+)\)$/;function We(e){var o=Xe[e],s=x.RegExp;return o||(x.Uint8ClampedArray||(x.Uint8ClampedArray=function(h){return h instanceof Number?Array(h):h.map(function(d){return ae(Ad(d),0,255)})}),e==="none"?o=new Uint8ClampedArray([0,0,0,0]):(Ye.fillStyle="black",Ye.fillStyle=e,Ve.test(Ye.fillStyle)?o=new Uint8ClampedArray([s.$1,s.$2,s.$3,255*s.$4]):(Ye.clearRect(0,0,1,1),Ye.fillRect(0,0,1,1),o=Ye.getImageData(0,0,1,1).data)),Xe[e]=o),o}function Ze(e){return e!=="none"&&0<We(e)[3]}var Xe=oc(),$e=!!x.VBArray;t("H.util.eval",function(a){return eval(a)});function af(e,o){return e!==B?e:o}function bf(e){return/^<svg/.test(e)?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e):e}t("H.util.provide",function(e){var o=xa.$jscomp;if(o&&(typeof o.Vl=="function"&&o.Vl()))throw Error("goog.provide cannot be used within a module.");ya(e,void 0)});function cf(e){this.fc=0<+e?xd.round(e):0}cf.prototype.next=function(e){if(this.fc===9007199254740992)throw new ne(e,this.fc,[0,9007199254740991]);return this.fc++};var df=new cf,ef=A(df.next,df);function ff(){return!0}function gf(){return!1}function ld(){}var hf=qc([]),jf=qc({});function kf(e){return e.tagName==="CANVAS"?[e]:e.getElementsByTagName("CANVAS")}function lf(e,o,s){var h;if(o=e.ownerDocument===o?e.cloneNode(!0):o.importNode(e,!0),s)for(e=kf(e),s=kf(o),h=s.length;h--;)s[h].getContext("2d").drawImage(e[h],0,0);return o}var Ye=Te(!0),mf=Te(!1);function nf(e){var o=e.complete,s=0<e.naturalWidth;if(o&&!s&&$e)try{mf.drawImage(e,0,0),s=!0}catch{}return o&&s}var of=x.BlobBuilder||x.WebKitBlobBuilder||x.MozBlobBuilder;function pf(e,o){if(o=o||"",of){var s=new of;s.append(e),e=s.getBlob(o)}else e=new Blob([e],{type:o});return e}var qf=x.navigator;cd=/Edge\/\d+/.test(qf.appVersion),dd=/(A|a)ndroid/.test(qf.appVersion);function rf(){var e=rf.a;return e||(e=this,rf.a=e,Ic(rf.a),F.call(e),sf(this)),e}u(rf,F),rf.prototype.o=function(){rf.j.o.call(this),sf(this)};function sf(e){e.g=10,e.i=6,e.a=oc(),e.b=oc(),e.c=0}rf.prototype.Jg=function(e){e=e.type;var o=this.a[e]||0;if(this.c<this.g&&o<this.i){var s=++this.f;return this.c++,this.a[e]=o+1,this.b[s+""]=e,s}return z},rf.prototype.yf=function(e){var o=this.b[e];if(!vc(o)||!this.a[o])throw new $c(this.yf,"Unknown requestId");this.c--,this.a[o]--,this.a[o]||delete this.a[o],delete this.b[e],this.dispatchEvent("allocatable")},rf.prototype.f=-1;function tf(e,o,s,h){if(!uf[e])throw new D(tf,0,"Mime type is not supported");this.f=e,e=h?Wa(h):{},"crossOrigin"in e||(e.crossOrigin="anonymous"),this.a=e,vf.href=o.toString(),ie.call(this,vf.protocol+"//"+vf.hostname,o,s)}u(tf,ie),tf.prototype.qj=function(){return this.b=uf[this.f].call(this),!0},tf.prototype.oe=function(){this.b&&(this.b.abort(),delete this.b)};var uf={"application/json":function(){var e=this,o=wf(this.a),s=o.headers;return o.headers=s=s?Wa(s):{},s.Accept="application/json",new Uc(this.data,function(h){200<=h.status&&300>h.status?e.resolve(h.json()):e.reject(h)},o)},"text/plain":function(){var e=this;return new Uc(this.data,function(o){200<=o.status&&300>o.status?e.resolve(o.text()):e.reject(o)},wf(this.a))},image:function(){var e=x.document.createElement("img"),o=this,s=this.data;return e.onload=A(this.resolve,this,e),e.onerror=function(){o.reject(Rc.error())},e.crossOrigin=this.a.crossOrigin,e.src=s,{abort:function(){e.onerror=e.onload=null,$e&&nf(e)||e.removeAttribute("src")}}}};(function(){try{var e=new XMLHttpRequest;e.open("get","/",!0)}catch{e={}}"response"in e&&(uf.arraybuffer=function(){var o=new XMLHttpRequest,s=this,h=this.a,d=h.headers,g;if(o.open("GET",this.data),xf(o,h),o.responseType="arraybuffer",d)for(g in d)o.setRequestHeader(g,d[g]);return o.onerror=o.ontimeout=function(){s.reject(Rc.error())},o.onload=function(){s.resolve(new Rc(o.response))},o.send(),o})})();var yf=new le(new rf);tf.prototype.fh=function(){return yf};var vf=x.document.createElement("a");function wf(e){var o=Wa(e);return delete o.crossOrigin,xf(o,e),o}function xf(e,o){e.withCredentials=o.crossOrigin==="use-credentials"}function J(e,o){this.x=+e,this.y=+o}t("H.math.Point",J),J.prototype.set=J,J.prototype.set=J.prototype.set,J.prototype.clone=function(e){return e?(e.x=this.x,e.y=this.y):e=new J(this.x,this.y),e},J.prototype.clone=J.prototype.clone,J.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},J.prototype.add=J.prototype.add,J.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},J.prototype.sub=J.prototype.sub,J.prototype.scale=function(e,o){return this.x*=e,this.y*=o===void 0?e:o,this},J.prototype.scale=J.prototype.scale,J.prototype.round=function(){return this.x=Ad(this.x),this.y=Ad(this.y),this},J.prototype.round=J.prototype.round,J.prototype.floor=function(){return this.x=Bd(this.x),this.y=Bd(this.y),this},J.prototype.floor=J.prototype.floor,J.prototype.ceil=function(){return this.x=Cd(this.x),this.y=Cd(this.y),this},J.prototype.ceil=J.prototype.ceil,J.prototype.ia=function(e){return!(!e||this.x!==e.x||this.y!==e.y)},J.prototype.equals=J.prototype.ia,J.prototype.Cj=function(e,o){var s=o.x-e.x,h=o.y-e.y,d=e;if(s||h){var g=((this.x-e.x)*s+(this.y-e.y)*h)/(s*s+h*h);0>=g?d=e:1<=g?d=o:d=new J(e.x+g*s,e.y+g*h)}return d},J.prototype.getNearest=J.prototype.Cj,J.prototype.Wa=function(e){return Fd(Gd(this.x-e.x,2)+Gd(this.y-e.y,2))},J.prototype.distance=J.prototype.Wa;function zf(e){if(!e)throw Error("invalid argument");return e instanceof J?e:new J(e.x,e.y)}J.fromIPoint=zf;function Af(e){var o=Bf[e];if(!o)if(e in Cf)o=Bf[e]=e;else{o=Df.length;var s="",h=e.charAt(0).toUpperCase()+e.substr(1),d="",g=!1;for(Ef&&(d=Ef+h,g=d in Cf);o--&&!g;)s=Df[o],d=s+h,g=d in Cf;if(g&&(Ef=s),o=g?d:null)Bf[e]=o;else throw Error("Could not find any variant of CSS property ["+e+"]")}return o}t("H.dom.cssPrefixer.prefix",Af);var Df=["O","Ms","ms","Moz","Webkit"],Bf={},Ef="",Cf=document.createElement("span").style;function Ff(e,o,s,h){if(!e||!o||!s)throw new D(Ff,B,"Must specify name, version and revision parameter");this.name=e,this.version=o,this.revision=s,h&&Ya(this,h)}t("H.util.BuildInfo",Ff),Ff.prototype.toString=function(){var e,o=[];for(e in this)Cc(this[e])&&o.push(this[e]);return o.join(";")};var Gf={};function Hf(e,o,s,h){if(!e)throw new D(Hf,1,"Must specify a name parameter");return Gf[e]||(Gf[e]=new Ff(e,o,s,h))}Ff.get=Hf;function If(){If.j.constructor.call(this),this.a=Jf(this),this.f=oc(),this.c=A(this.c,this),this.a.addEventListener("message",this.c),this.b={}}u(If,F),If.prototype.o=function(){this.a.terminate()},If.prototype.g=function(e){var o=e.type,s=!!this.f[o],h=e.data,d=Kf++,g=h&&h.Mo?h.Mo:B,_=!0;return s?(this.b[d]=e,Lf(this,o,d,h&&h.message,g)):(e.reject(new D(this.g,0,"processor_not_found")),_=!1),_},If.prototype.c=function(e){e=e.data;var o=this.b[e.taskId],s=e.taskId,h=e.data,d=this;if(e.type===2)new tf("arraybuffer",h).then(function(g){return g.arrayBuffer()}).then(function(g){d.a.postMessage(["3",s,[g]],[g])},function(){d.a.postMessage(["3",s,[null,"ERROR"]])});else{if(o){switch(e.type){case 1:o.resolve(h);break;case 0:o.reject(h)}delete this.b[s]}this.dispatchEvent(new ud(this.A.IDLE))}};var Kf=0;function Mf(e,o,s){var h=Kf++,d;return e.b[h]=d=ac(),Lf(e,o,h,s),d.Ak}function Lf(e,o,s,h,d){h===B||Ca(h)||(h=[h]);try{e.a.postMessage([o,s,h],d)}catch(g){e=e.b[s],e.reject(g.message)}}If.prototype.A={IDLE:"idle",Ni:"error"},If.prototype.i=function(e,o){var s=this.l||(this.l=new ud(this.A.Ni));s.data=o,delete this.f[e],this.dispatchEvent(s)};function Jf(a){var b=x.H.__bootstrap__;if(b=Da(b)?(""+b).replace(/^[^{]+{((.|[\r\n])+?)}\s*$/,"$1"):""+b,x.Worker&&x.URL)try{var c=new x.Worker(x.URL.createObjectURL(pf(b,"application/javascript")))}catch{}return c||(a=new Nf(a),function(){eval("var self = arguments[0];"+b)}(),c=new Of(a)),c}function Of(e){F.call(this),this.a=e}u(Of,F),Of.prototype.postMessage=function(e){x.setTimeout(A(this.b,this,e),0)},Of.prototype.b=function(e){var o=new ud("message");o.data=e,this.a.dispatchEvent(o)},Of.prototype.terminate=function(){this.a.F(),this.F()};function Nf(e){F.call(this),this.a=e,this.addEventListener=A(this.addEventListener,this),this.removeEventListener=A(this.removeEventListener,this),this.postMessage=A(this.postMessage,this),this.eval=A(eval,this)}u(Nf,F),Nf.prototype.postMessage=function(e){var o=new ud("message");o.data=e,x.setTimeout(A(this.a.c,this.a,o),0)};function Pf(){var e=Qf;return e||(e=Qf=this,F.call(e),Rf(this)),e}var Qf;u(Pf,F),Pf.prototype.o=function(){Pf.j.o.call(this),Rf(this)};function Rf(e){var o=e.b,s;if(o)for(s=o.length;s--;)o[s].F();e.b=[],Ic(e.b),e.c={},e.f=oc()}Pf.prototype.Jg=function(e){var o;if(e=e.type,o=this.f[e]){var s=this.b,h=s[0];h||(h=s[0]=new If,this.tb(La(td,h)),Va(this.c)||(s=x.Object.keys(this.c),Mf(h,"0",s))),s=h,s.f[e]||(s.f[e]=o,Mf(s,"1",[e,Da(o)?o+"":o]).then(ld,A(s.i,s,e)))}else throw new $c(this.Jg,'Unknown type "'+e+'"');return h},Pf.prototype.yf=function(){},Pf.prototype.a=function(e,o){var s=this.f,h=s[e];if(h){if(o!==h)throw new $c(this.a,'Type "'+e+'" is already registered')}else s[e]=o};function Sf(e,o,s){ie.call(this,e,o,s)}var Tf;u(Sf,ie),Sf.prototype.fh=function(){return Tf||(Tf=new le(new Pf)),Tf},Sf.prototype.oe=function(){},Sf.prototype.qj=function(e){return e.g(this)};function Uf(e,o,s,h,d,g){var _,j,$=e.length,_t,_e;if($)for(_=[];$--;){var _r=e[$],_n=_r.length,_o=0;for(_t=1;_t<_n;_t++)if(_e=Vf(_r[_t-1],_r[_t],s,o,h,d)){var ga=_e[0],_l=_e[1];_o&&_o.ia(ga)?j.push(_l):_.push(j=_e),_o=_l,g&&(_t=_n,$=0)}}else _=e;return _}t("H.math.clipping.clipStrips",Uf);function Vf(e,o,s,h,d,g){var _=e.x;e=-e.y;var j=o.x;if(o=-o.y,s=-s,g=-g,_>j){if(j>d||_<h)return;var $=_,_t=e;_=j,e=o,j=$,o=_t,$=1}else if(_>d||j<h)return;if(e>o){if(o>s||e<g)return;var _e=1;e=-e,o=-o,_t=g,g=-s,s=-_t}else if(e>s||o<g)return;if(_<h){if((e+=(h-_)*(o-e)/(j-_))>s)return;_=h}if(e<g){if((_+=(g-e)*(j-_)/(o-e))>d)return;e=g}return j>d&&(o=e+(d-_)*(o-e)/(j-_),j=d),o>s&&(j=_+(s-e)*(j-_)/(o-e),o=s),_e&&(e=-e,o=-o),$?[new J(j,-o),new J(_,-e)]:[new J(_,-e),new J(j,-o)]}function Wf(e,o,s){e=Xf(e,!0),o=Xf(o,!1);var h,d,g={},_=h=1;switch(~~(s||0)){case 1:_=h=0;break;case 2:h=0,_=1;break;case 3:h=1,_=0}s=h;var j=_;if(o&&e){for(o.se=new Yf(o.x,o.y,null,Zf(o)),e.se=new Yf(e.x,e.y,null,Zf(e)),_=o;_.next;_=_.next)if(!_.Za){for(h=e;h.next;h=h.next)if(!h.Za){var $=$f(_.next),_t=$f(h.next);if(d=ag(_,$,h,_t,g)){d=g.pl;var _e=g.ql,_r=g.Po,_n=g.Qo;d=new Yf(_r,_n,null,null,null,null,!0,0,0,d),bg(d,_,$),$=new Yf(_r,_n,null,null,null,null,!0,0,0,_e),bg($,h,_t),d.Th=$,$.Th=d}}}for(g=fe(o,cg(e)),s&&(g=!g),_=o;_;_=_.next)_.Za&&(_.vh=g,g=!g);for(g=fe(e,cg(o)),j&&(g=!g),h=e;h.next;h=h.next)h.Za&&(h.vh=g,g=!g);for(dg(o),dg(e);(e=eg(o))!=o;){for(s=null;!e.yg;e=e.Th){for(g=e.vh;s=new Yf(e.x,e.y,s),s.artificial=e.Za||e.Sj,e.yg=1,e=g?e.next:e.gc,!!e;)if(e.Za){e.yg=1;break}if(!e)break}s.Uh=_o||null;var _o=s}return _o}}t("H.math.clipping.clipPolygon",Wf);function Yf(e,o,s,h,d,g,_,j,$,_t){this.x=e,this.y=o,this.next=s||null,this.gc=h||null,this.Uh=d||null,this.Th=g||null,this.Za=!!_,this.vh=!!j,this.yg=$||0,this.alpha=_t||0,h&&(h.next=this),s&&(s.gc=this),this.Sj=!1,this.se=null}function $f(e){for(;e&&e.Za;)e=e.next;return e}function Zf(e){if(e)for(;e.next;)e=e.next;return e}function eg(e){var o=e;if(o)do o=o.next;while(o!=e&&(!o.Za||o.Za&&o.yg));return o}function dg(e){var o=Zf(e);o.gc.next=e,e.gc=o.gc}function ag(e,o,s,h,d,g){var _,j=o.x-e.x,$=o.y-e.y,_t=h.x-s.x,_e=h.y-s.y,_r=j*_e-$*_t;return!_r||(_t=((s.x-e.x)*_e-(s.y-e.y)*_t)/_r,_r=($*(s.x-e.x)-j*(s.y-e.y))/_r,0>_t||1<_t||0>_r||1<_r)?0:(_t===0?_=e:_t===1?_=o:_r===0?_=s:_r===1&&(_=h),_&&!g?(_.x+=2480549651603763e-20,_.y+=7321997314118067e-20,_.se&&(_.se.x=_.x,_.se.y=_.y),ag(e,o,s,h,d)):(d.Po=e.x+_t*j,d.Qo=e.y+_t*$,d.pl=_t,d.ql=_r,1))}function cg(e){for(var o=[];e;)o.push(e.x,e.y),e=e.next;return o}function bg(e,o,s){for(o=o.next;o!==s&&o.alpha<=e.alpha;)o=o.next;e.next=o,e.gc=o.gc,e.next.gc=e,e.gc.next=e}function Xf(e,o){for(var s,h=null,d=0,g=e.length;d<g;d++)s=new Yf(e[d].x,e[d].y,h),s.Sj=o,(s.next=h)&&(h.gc=s),h=s;return h}function fg(e,o,s){var h=ae(+e,-90,90);if(o&&E(h))throw new D(o,s,e);return h}function gg(e,o,s){var h=+e;if((-180>h||180<h)&&(h=Zd(h+180,360)-180),o&&E(h))throw new D(o,s,e);return h}function hg(e,o,s){var h;if(e!==B&&E(h=+e)&&o)throw new D(o,s,e);return h}function ig(e,o){return 0>e!=0>o&&180<Dd(o-e)}t("H.geo.isDBC",ig);function jg(){xc(this,jg)}t("H.geo.AbstractGeometry",jg),jg.prototype.getBoundingBox=jg.prototype.K,jg.prototype.equals=jg.prototype.ia,jg.prototype.rb="",jg.prototype.Hb="",jg.prototype.toString=function(){return this.cd([this.rb.toUpperCase()," "]).join("")},jg.prototype.toString=jg.prototype.toString,jg.prototype.Kc=function(){return{type:this.Hb,coordinates:this.bd()}},jg.prototype.toGeoJSON=jg.prototype.Kc,jg.prototype.Y=function(){return{type:this.rb,coordinates:this.pc(),boundingBox:this.K().Y()}},jg.prototype.forWorkerMessage=jg.prototype.Y;function kg(e,o,s){this.lat=fg(e,kg,0),this.lng=gg(o,kg,1),s!==B&&(this.alt=hg(s,kg,2))}u(kg,jg),t("H.geo.Point",kg),kg.prototype.ia=function(e){return this===e||!!e&&this.lat===e.lat&&this.lng===e.lng&&(this.alt||0)===(e.alt||0)},kg.prototype.equals=kg.prototype.ia,kg.prototype.Wa=function(e){if(this===e||this.lat===e.lat&&this.lng===e.lng)e=0;else{var o=this.lat*Ud,s=e.lat*Ud;e=1274200158e-2*Jd(yd(1,Fd(Gd(Id((o-s)/2),2)+Kd(o)*Kd(s)*Gd(Id((this.lng*Ud-e.lng*Ud)/2),2))))}return e},kg.prototype.distance=kg.prototype.Wa,kg.prototype.zg=function(e,o,s){var h;if(s){if(h=o/637100079e-2){o=e*Ud,e=Ud*this.lat;var d=Id(e);s=Id(h);var g=Kd(h);h=Ud*this.lng;var _=Kd(e);e=Jd(_*Kd(o)*s+d*g),o=Nd(Id(o)*_*s,g-d*Id(e)),o=(h+o+Pd)%(2*Pd)-Pd,o*=Vd,d=new kg(e*Vd,(o+540)%360-180)}return d||this}return e=(e%360+360)%360,(e+90)%180===0?(e=this.lng+o/(637100079e-2*Sd*Kd(this.lat*Ud))*(e===270?-360:360),new kg(this.lat,(e+540)%360-180)):((o/=637100079e-2)&&(e*=Ud,d=this.lat*Ud,s=this.lng*Ud,h=d+o*Kd(e),g=h-d,_=Ed(Ld(h/2+Rd)/Ld(d/2+Rd)),_=E(g/_)?Kd(d):g/_,e=o*Id(e)/_,Dd(h)>Qd&&(h=0<h?Pd-h:-(Pd+h)),h=new kg(h*Vd,((s+e+Td+(Dd(d+g)>Qd?Pd:0))%Sd-Pd)*Vd)),h||this)},kg.prototype.walk=kg.prototype.zg,kg.prototype.K=function(){return new K(this.lat,this.lng,this.lat,this.lng)},kg.prototype.getBoundingBox=kg.prototype.K;function lg(e,o,s){var h=Ea(e)&&!(E(e.lat=fg(e.lat))||E(e.lng=gg(e.lng))||e.alt!==B&&E(e.alt=hg(e.alt)));if(!h&&o)throw new D(o,s,e);return h}kg.validate=lg;function ng(e){if(!e)throw new D(ng,0,e);return new kg(e.lat,e.lng,e.alt)}kg.fromIPoint=ng,p=kg.prototype,p.rb="Point",p.cd=function(e){return e.push("(",this.lng," ",this.lat,")"),e},p.Hb="Point",p.bd=function(){return[this.lng,this.lat,this.alt||0]},p.pc=function(){return[this.lat,this.lng,this.alt||0]};function K(e,o,s,h){og(this,fg(e,K,0),gg(o,K,1),fg(s,K,2),gg(h,K,3))}u(K,jg),t("H.geo.Rect",K),K.prototype.rb="Polygon",K.prototype.cd=function(e){var o=this.c,s=this.a,h=this.f,d=this.b;return e.push("(","(",s," ",o,",",d," ",o,",",d," ",h,",",s," ",h,",",s," ",o,")",")"),e},K.prototype.ia=function(e){var o=this===e;return!o&&C(e,K)&&(o=this.c===e.c&&this.a===e.a&&this.f===e.f&&this.b===e.b),o},K.prototype.equals=K.prototype.ia,K.prototype.clone=function(){return new K(this.c,this.a,this.f,this.b)},K.prototype.clone=K.prototype.clone;function og(e,o,s,h,d){return e.a=s,e.b=d,o<h&&(s=o,o=h,h=s),e.c=o,e.f=h,e.l=e.g=e.i=null,e}K.prototype.Nb=function(){return this.l||(this.l=new kg(this.c,this.a)),this.l},K.prototype.getTopLeft=K.prototype.Nb,K.prototype.Jb=function(){return this.g||(this.g=new kg(this.f,this.b)),this.g},K.prototype.getBottomRight=K.prototype.Jb,K.prototype.bn=function(){return this.c},K.prototype.getTop=K.prototype.bn,K.prototype.Pl=function(){return this.f},K.prototype.getBottom=K.prototype.Pl,K.prototype.xm=function(){return this.a},K.prototype.getLeft=K.prototype.xm,K.prototype.Sm=function(){return this.b},K.prototype.getRight=K.prototype.Sm,K.prototype.bb=function(){return this.i||(this.i=new kg(this.f+(this.c-this.f)/2,pg(this.a,this.Ab()))),this.i},K.prototype.getCenter=K.prototype.bb,K.prototype.Ab=function(){return qg(this.a,this.b)},K.prototype.getWidth=K.prototype.Ab,K.prototype.Ld=function(){return this.c-this.f},K.prototype.getHeight=K.prototype.Ld,K.prototype.Bb=function(){return this.a>this.b},K.prototype.isCDB=K.prototype.Bb,K.prototype.Rf=function(){return!this.Ab()&&!this.Ld()},K.prototype.isEmpty=K.prototype.Rf,K.prototype.K=function(){return new K(this.c,this.a,this.f,this.b)},K.prototype.getBoundingBox=K.prototype.K,K.prototype.uf=function(e,o,s){var h=this.bb();return s||(e=fg(e,this.uf,0),o=gg(o,this.uf,1)),o=this.Xc(e,o,s),e=o.bb(),e.lat===h.lat&&e.lng===h.lng&&this.Ld()===o.Ld()&&this.Ab()===o.Ab()},K.prototype.containsLatLng=K.prototype.uf,K.prototype.gd=function(e,o){return o||lg(e,this.gd,0),this.uf(e.lat,e.lng,o)},K.prototype.containsPoint=K.prototype.gd,K.prototype.Qg=function(e,o){var s=this.bb();if(!o&&!C(e,K))throw new D(this.Qg,0,e);return o=this.ec(e,o),e=o.bb(),e.lat===s.lat&&e.lng===s.lng&&this.Ld()===o.Ld()&&this.Ab()===o.Ab()},K.prototype.containsRect=K.prototype.Qg,K.prototype.Xc=function(e,o,s,h){if(!s){if(E(e=fg(e)))throw new D(this.Xc,0,e);if(E(o=gg(o)))throw new D(this.Xc,1,o)}return rg(this.c,this.a,this.f,this.b,e,o,e,o,h)},K.prototype.mergeLatLng=K.prototype.Xc,K.prototype.jk=function(e,o,s){return o||lg(e,this.jk,0),this.Xc(e.lat,e.lng,o,s)},K.prototype.mergePoint=K.prototype.jk,K.prototype.ec=function(e,o,s){if(!o&&!C(e,K))throw new D(this.ec,0,e);return rg(this.c,this.a,this.f,this.b,e.c,e.a,e.f,e.b,s)},K.prototype.mergeRect=K.prototype.ec,K.prototype.Bc=function(e,o,s,h,d,g){return d||(e=fg(e,this.Bc,0),o=gg(o,this.Bc,1),s=fg(s,this.Bc,2),h=gg(h,this.Bc,3)),rg(this.c,this.a,this.f,this.b,e,o,s,h,g)},K.prototype.mergeTopLeftBottomRight=K.prototype.Bc,K.prototype.nd=function(e,o){var s=this.a<=this.b,h=e.a<=e.b,d=this.a<e.b,g=e.a<this.b;if(!o&&!C(e,K))throw new D(this.nd,0,e);return this.f<=e.c&&e.f<=this.c&&(!s&&(!h||d||g)||!h&&(d||g)||d&&g)},K.prototype.intersects=K.prototype.nd;function qg(e,o){return e=o-e,e+(0>e?360:0)}function pg(e,o){return e+=o/2,e-(180<e?360:0)}function rg(e,o,s,h,d,g,_,j,$){s=yd(s,_),e=zd(e,d),d=qg(o,h);var _t=pg(o,d);_=qg(g,j);var _e=pg(g,_)-_t;if(_e+=0>_e-1e-6?360:0,180>_e-1e-6){_t=o;var _r=j}else _e=360-_e,_t=g,_r=h;return _e=_e+d/2+_/2,360<=_e+5e-7?(_t=-180,_r=180):_e-5e-7<d?(_t=o,_r=h):_e-5e-7<_&&(_t=g,_r=j),$?og($,e,_t,s,_r):new K(e,_t,s,_r)}K.merge=rg;function sg(e,o,s){return s||(lg(e,sg,0),lg(o,sg,1)),new K(e.lat,e.lng,o.lat,o.lng)}K.fromPoints=sg;function tg(e,o){var s=1,h=e.length,d=null;if(!Ca(e))throw new D(tg,0,e);if(0<h){var g=e[0];for(d=sg(g,g,o);s<h;s++)g=e[s],d.Xc(g.lat,g.lng,o,d)}return d}K.coverPoints=tg;function ug(e,o){var s=3,h=e.length,d;if(!(o||e&&e.length!=null))throw new D(ug,0,e);if(0<h)for(d=new K(e[0],e[1],e[0],e[1]);s<h;s+=3)d.Xc(e[s],e[s+1],o,d);return d}K.coverLatLngAlts=ug;function vg(e,o){var s=1,h=e.length,d;if(o&&(!e||e.length==null))throw new D(vg,0,e);if(0<h)for(d=new K(e[0].c,e[0].a,e[0].f,e[0].b);s<h;s++)d.ec(e[s],o,d);return d}K.coverRects=vg,K.prototype.Hk=function(e,o){var s=this.a,h=this.c,d=this.b,g=this.f,_=this.bb().lng;lg(e,this.Hk,0);var j=e.lat-g-(h-g)/2,$=e.lng-_;return $=180<$||-180>$?-(_+e.lng):$,e=s+(0>$?2*$:0),e=-180>e?360+e:e,d+=0<$?2*$:0,d=180<d?d-360:d,h=0<j?h+2*j:h,90<=h&&(h=90),g=0>j?g+2*j:g,-90>=g&&(g=-90),o?og(o,h,e,g,d):new K(h,e,g,d)},K.prototype.resizeToCenter=K.prototype.Hk,K.prototype.Hb="Polygon",K.prototype.bd=function(){return[[this.a,this.c,0],[this.b,this.c,0],[this.b,this.f,0],[this.a,this.f,0],[this.a,this.c,0]]},K.prototype.Y=function(){return this.pc()},K.prototype.pc=function(){return[this.c,this.a,this.f,this.b]};function wg(e,o,s,h,d,g){xc(this,wg),this.c=e||10,this.b=null,this.f=h||0,this.g=d||0,this.i=o||1,this.l=s||1,this.m=!!g,this.flush()}function xg(e){var o=e.b;if(e.m&&!o){var s=e.head;(s.entries||s[0]||s[1]||s[2]||s[3])&&(o=[s],o=yg([o,o,o,o],[s[6],s[7],s[4],s[5]]),e.b=o)}return o}function yg(e,o){var s,h,d,g,_=0;for(s=3;0<=s;s--){var j=s+4,$=0<s%3,_t=[],_e=o[s],_r=e[s];for(h=_r.length;h--;){var _n=_r[h];if(d=_n.entries)for(g=d.length;g--;){var _o=d[g].a(s);($?_o>_e:_o<_e)&&(_e=_o)}for(g=4;g--;)(d=_n[g])&&($?d[j]>_e:d[j]<_e)&&_t.push(d)}_+=_t.length,o[s]=_e,e[s]=_t}return _&&(o=yg(e,o)),o}function zg(e,o,s){var h,d;if(e.m&&(h=e.b))for(d=3;0<=d;d--){var g=o.a(d);if(d%3?g>=h[d]:g<=h[d])if(s)h[d]=g;else{e.b=null;break}}}wg.prototype.remove=function(e){var o,s,h,d=!1;return e&&(o=e.node)&&o.b===this&&(s=o.entries)&&0<=(h=s.indexOf(e))&&(s.splice(h,1),this.s(o),zg(this,e,!1),d=!0),d},wg.prototype.flush=function(){var e=new Ag(B,NaN,this.f-this.i,this.g-this.l,this.f+this.i,this.g+this.l);e.b=this,this.head=this.a=e,this.b=null};function Bg(e,o){var s=e.head,h;if(o){var d=o;if(d!==s)for(s=d;d=d.parent;)(d.entries||1<d.a)&&(s=d)}else for(;!s.entries&&2>(h=s.a)&&h;)s=d;e.head=s}wg.prototype.Za=function(e,o,s,h,d,g){var _=[],j=this.head,$=this.a;return e<=j[5]&&o<=j[6]&&(d?s>=j[7]:s>j[7])&&(g?h>=j[4]:h>j[4])&&Cg(this,j,_,e,o,s,h,g||h>=$[6],d||s>=$[5]),_};function Cg(e,o,s,h,d,g,_,j,$){var _t=o.entries,_e=o[7],_r=o[4],_n=o[5],_o=o[6],ga=o[8],_l=o[9],_f;if(_t){var _c=_t.length;if(d>_r||h>_e||_<_o||g<_n)for(;_c--;){_e=_t[_c],_r=_e.a(3),_n=_e.a(0),_o=_e.a(1);var _p=_e.a(2);_p>=d&&_o>=h&&(_n<_||j&&_n==_)&&(_r<g||$&&_r==g)&&s.push(_e)}else for(;_c--;)s.push(_t[_c])}(g>ga||$&&g==ga)&&(d<_l&&(_f=o[1])&&Cg(e,_f,s,h,d,g,_,j,$),(_>_l||j&&_==_l)&&(_f=o[3])&&Cg(e,_f,s,h,d,g,_,j,$)),h<ga&&(d<_l&&(_f=o[0])&&Cg(e,_f,s,h,d,g,_,j,$),(_>_l||j&&_==_l)&&(_f=o[2])&&Cg(e,_f,s,h,d,g,_,j,$))}wg.prototype.Lc=ba(1);var Dg=0;function Ag(e,o,s,h,d,g){this.c=o,e&&(this.parent=e,this.b=e.b,o&1?(s=e[8],d=e[5]):(s=e[7],d=e[8]),o&2?(h=e[9],g=e[6]):(h=e[4],g=e[9])),this[7]=s,this[5]=d,this[8]=(s+d)/2,this[4]=h,this[6]=g,this[9]=(h+g)/2}Ag.prototype.a=0;function Eg(e,o){return e[o]||(++e.a,e[o]=new Ag(e,o))}Ag.prototype.removeChild=function(e){var o=e.c;this[o]===e&&(delete this[o],delete e.parent,--this.a)},Ag.prototype.Lc=ba(0);function Fg(e,o){(e.entries||(e.entries=[])).push(o),o.node=e}function Gg(e,o,s,h,d){var g=e[5],_=e[6];return e[7]<=o&&e[4]<=s&&(g>h||g===h&&g===e.b.a[5])&&(_>d||_===d&&_===e.b.a[6])}function Hg(e,o,s,h,d,g){Hg.j.constructor.apply(this,arguments)}u(Hg,wg),Hg.prototype.s=function(e){for(var o,s,h=this.head;e;){if((!(o=e.entries)||!o.length)&&(o&&delete e.entries,!e.a&&(s=e.parent))){s.removeChild(e),h===e&&(h=s),e=s;continue}break}this.head!==h&&(this.head=h,Bg(this))};function Ig(e,o,s,h,d){if(Gg(e.a,o,s,h,d))return Jg(e,e.a,o,s,h,d,e.c);throw Error("Coordinates out of bounds")}Hg.prototype.yc=function(e,o){return Ig(this,e,o,e,o)};function Jg(e,o,s,h,d,g,_){var j=o[8],$=o[9],_t=0,_e=0;return _&&(d<j||(_t=+(s>=j)))&&(g<$||(_e=+(h>=$)))?s=Jg(e,Eg(o,_t|_e<<1),s,h,d,g,_-1):(Fg(o,s=new Kg(s,h,d,g)),zg(e,s,!0),Bg(e,o)),s}function Kg(e,o,s,h){this.id=Dg++,this[0]=o,this[1]=s,this[2]=h,this[3]=e}Kg.prototype.a=function(e){return this[e]};function Lg(e){this.g=new Hg(+e||10,180,90,0,0,!0),this.f=[],this.i=!1,this.a=this.b=this.c=null}t("H.geo.QuadTree",Lg),p=Lg.prototype,p.Eh=0,p.Rc=function(){return this.Eh},p.Bb=function(){return this.i},p.K=function(){var e,o;if(!this.c){var s=[];!this.b&&(e=xg(this.g))&&(this.b=new K(-e[0],e[3],-e[2],e[1])),(o=this.b)&&s.push(o);var h,d,g;if(!this.a&&(g=(d=this.f).length)){e=90;var _=360,j=-90;for(h=0;g--;){var $=d[g];e=yd(e,$[0]),_=yd(_,$[3]),j=zd(j,$[2]),h=zd(h,$[1])}this.a=new K(-e,_,-j,h-360)}(o=this.a)&&s.push(o),(o=s[0])&&(s[1]&&(o=o.ec(s[1],!0)),this.c=o)}return this.c};function Mg(e,o,s,h,d,g){return g?(g=new Kg(d,-o,s+360,-h),e.f.push(g),e.i=!0,e.a&&e.a.Bc(o,s,h,d,!0,e.a)):(g=Ig(e.g,s,-o,d,-h),e.b&&e.b.Bc(o,s,h,d,!0,e.b)),++e.Eh,e.c=null,g}p.yc=function(e){var o=e.lng;return e=e.lat,Mg(this,e,o,e,o,!1)},p.Pj=function(e){var o=e.Nb(),s=e.Jb();return(e=e.Bb())?Mg(this,o.lat,s.lng,s.lat,o.lng,e):Mg(this,o.lat,o.lng,s.lat,s.lng,e)},Lg.prototype.insertBoundingBox=Lg.prototype.Pj,Lg.prototype.remove=function(e){var o;if(e.node){var s=this.g.remove(e);this.b=null}else e=(o=this.f).indexOf(e),(s=0<=e)&&(o.splice(e,1),this.i=0<o.length,this.a=null);return s&&(--this.Eh,this.c=null),s},Lg.prototype.remove=Lg.prototype.remove;function Ng(e,o,s,h,d,g,_){e=e.f;var j=e.length,$=[],_t;if(j){var _e=s+360;for(_t=d+360;j--;){var _r=e[j];(Og(_r,o,s,h,d,g,_)||Og(_r,o,_e,h,_t,g,_))&&$.push(_r)}}return $}function Og(e,o,s,h,d,g,_){var j=e[3],$=e[0],_t=e[1];return e=e[2],(g?$<=h:$<h)&&(_?j<=d:j<d)&&e>=o&&_t>=s}function Pg(e,o){var s,h,d;if(s=o.length){var g=e.length;for(h={};g--;)h[e[g].id]=1;for(;s--;)(d=o[s]).id in h||e.push(d)}}Lg.prototype.Pf=function(e,o,s){var h=this.g,d=e.Nb(),g=e.Jb(),_=-d.lat;d=d.lng;var j=-g.lat;return g=g.lng,!o&&_===j||!s&&d===g?e=[]:e.Bb()?(e=h.Za(-180,_,g,j,s,o),Pg(e,h.Za(d,_,180,j,!1,o)),Pg(e,Ng(this,_,g,j,d+360,o,s))):(e=h.Za(d,_,g,j,s,o),Pg(e,Ng(this,_,d,j,g,o,s))),e},Lg.prototype.intersectBoundingBox=Lg.prototype.Pf;var Qg=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Rg=typeof BigInt<"u"?BigInt:Number;function Sg(e){var o=Rg(0),s=Rg(0),h=[];if(e.split("").forEach(function(d){d=Rg(Qg[d.charCodeAt(0)-45]),o|=(d&Rg(31))<<s,(d&Rg(32))===Rg(0)?(h.push(o),o=Rg(0),s=Rg(0)):s+=Rg(5)}),0<s)throw Error("Invalid encoding");return h}function Tg(e){return e&Rg(1)&&(e=~e),e>>=Rg(1),+e.toString()}function Ug(e){var o=e.precision===void 0?5:e.precision,s=e.hf===void 0?0:e.hf,h=e.jf===void 0?0:e.jf;e=e.ci;var d=Math.pow(10,o),g=Math.pow(10,h);o=Vg(o,s,h);var _=[],j=Rg(0),$=Rg(0),_t=Rg(0);return e.forEach(function(_e){var _r=Rg(Math.round(_e[0]*d));_.push(Wg(_r-j)),j=_r,_r=Rg(Math.round(_e[1]*d)),_.push(Wg(_r-$)),$=_r,s&&(_e=Rg(Math.round(_e[2]*g)),_.push(Wg(_e-_t)),_t=_e)}),(o instanceof Array?o:fa(ea(o))).concat(_ instanceof Array?_:fa(ea(_))).join("")}function Vg(e,o,s){if(0>e||15<e)throw Error("precision out of range. Should be between 0 and 15");if(0>s||15<s)throw Error("thirdDimPrecision out of range. Should be between 0 and 15");if(0>o||7<o||o===4||o===5)throw Error("thirdDim should be between 0, 1, 2, 3, 6 or 7");return e|=s<<7|o<<4,Xg(1)+Xg(e)}function Xg(e){var o="";for(e=Rg(e);31<e;){var s=e&Rg(31)|Rg(32);o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[s],e>>=Rg(5)}return o+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[e]}function Wg(e){e=Rg(e);var o=0>e;return e<<=Rg(1),o&&(e=~e),Xg(e)}function Yg(e){return Ug({ci:e.polyline,precision:e.precision,hf:e.thirdDim,jf:e.thirdDimPrecision})}t("H.util.flexiblePolyline.encode",Yg);function Zg(e){if(e=Sg(e),+e[0].toString()!=1)throw Error("Invalid format version");var o=+e[1].toString();o={precision:o&15,hf:o>>4&7,jf:o>>7&15};for(var s=Math.pow(10,o.precision),h=Math.pow(10,o.jf),d=o.hf,g=0,_=0,j=0,$=[],_t=2;_t<e.length;){var _e=Tg(e[_t])/s,_r=Tg(e[_t+1])/s;g+=_e,_+=_r,d?(_e=Tg(e[_t+2])/h,j+=_e,$.push([g,_,j]),_t+=3):($.push([g,_]),_t+=2)}if(_t!==e.length)throw Error("Invalid encoding. Premature ending reached");return e=Object.assign({},o,{ci:$}),{polyline:e.ci,precision:e.precision,thirdDim:e.hf,thirdDimPrecision:e.jf}}t("H.util.flexiblePolyline.decode",Zg);function L(e){L.j.constructor.call(this),e&&$g(e,L,0),this.$=e||[],this.a=ah(this,0,this.$.length)}u(L,jg),t("H.geo.LineString",L);function ah(e,o,s){e=e.$;var h=0;for(o=zd(o,0),s=yd(s,e.length),s-=2,o+=1;o<s;)h+=ig(e[o],e[o+=3]);return h}L.prototype.gi=function(e,o,s){bh(this,e,o,s,this.gi)},L.prototype.pushLatLngAlt=L.prototype.gi;function bh(e,o,s,h,d){var g=e.$.length;o=fg(o,d),s=gg(s,d),e.$.push(fg(o,d),gg(s,d),h===B?0:hg(h,d)),g&&(e.a+=ig(e.$[g-2],s)),delete e.b,delete e.c}L.prototype.ff=function(e,o,s){s&&$g(s,this.ff,2),o===void 0&&(o=this.$.length),o&&(this.a-=ah(this,e-3,e+o+3));var h=s?this.$.splice.apply(this.$,[e,o].concat(s)):this.$.splice(e,o);return s&&(this.a+=ah(this,e-3,e+s.length+3)),o&&!s&&(this.a+=ah(this,e-3,e-3)),delete this.b,delete this.c,h},L.prototype.spliceLatLngAlts=L.prototype.ff,L.prototype.Qj=function(e,o,s,h){this.ff(e,0,[o,s,h])},L.prototype.insertLatLngAlt=L.prototype.Qj,L.prototype.Dk=function(e){this.ff(e,3)},L.prototype.removeLatLngAlt=L.prototype.Dk,L.prototype.qd=function(e){bh(this,e.lat,e.lng,e.alt,this.qd)},L.prototype.pushPoint=L.prototype.qd,L.prototype.yc=function(e,o){this.Qj(3*e,o.lat,o.lng,o.alt)},L.prototype.insertPoint=L.prototype.yc,L.prototype.Xe=function(e){this.Dk(3*e)},L.prototype.removePoint=L.prototype.Xe,L.prototype.ye=function(e,o){var s=this.$,h=3*e;e=s[h];var d=s[h+1];return s=s[h+2],o&&(o.lat=e,o.lng=d,o.alt=s),o||new kg(e,d,s)},L.prototype.extractPoint=L.prototype.ye,L.prototype.El=function(e,o,s){var h=this.$;o=o||0,s=af(s,h.length/3);for(var d=3*o;o<s;)e(h[d++],h[d++],h[d++],o++)},L.prototype.eachLatLngAlt=L.prototype.El,L.isDBC=ig,L.prototype.eh=function(e){var o=this.a;return e&&(e=this.$,o+=ig(e[e.length-2],e[1])),o},L.prototype.getDBCs=L.prototype.eh,L.prototype.Ie=function(){return this.$.length/3},L.prototype.getPointCount=L.prototype.Ie,L.prototype.um=function(){return this.$},L.prototype.getLatLngAltArray=L.prototype.um,L.prototype.b=z,L.prototype.K=function(){var e;if(!(e=this.b)){e=this.$;var o=e.length,s=3,h,d,g=z;if(3<=o){var _=h=e[0],j=d=e[1];for(g=new K(_,j,h,d);s<o;s+=3){if(_=e[s-3],j=e[s-2],h=e[s],d=e[s+1],j>d&&180<d-j||j<d&&-180>j-d||d<j&&180>Dd(d-j)){var $=j;j=d,d=$}_<h&&($=_,_=h,h=$),rg(g.c,g.a,g.f,g.b,_,j,h,d,g)}}e=this.b=g}return e},L.prototype.getBoundingBox=L.prototype.K,L.prototype.nn=function(){return this.b!==z},L.prototype.hasBoundingBox=L.prototype.nn;function $g(e,o,s){for(var h=e.length,d=!(h%3),g;d&&h;)d=!(E(e[--h]=hg((g=e[h])===B?0:g))||E(e[--h]=gg(e[h]))||E(e[--h]=fg(e[h])));if(!d&&o)throw new D(o,s,e)}function ch(e){var o=new L,s=0,h=e.length;if(h%2)throw new D(ch,0,e);for(;s<h;)bh(o,e[s++],e[s++],0,ch);return o}L.fromLatLngArray=ch,L.prototype.ia=function(e){var o=this===e,s;if(!o&&(o=C(e,L))){var h=this.$;for(e=e.$,o=(s=h.length)===e.length;o&&s--;)o=h[s]==e[s]}return o},L.prototype.equals=L.prototype.ia;function dh(e,o){return e.b-o.b}function eh(e,o){var s=e.$,h=-2,d=[],g,_=e.c;if(!_){_=e.c=new Lg;var j=0,$=e.$,_t=$.length;for(g=0;g<_t;g+=3){var _e=$[g],_r=$[g+1];if(g){if(_o<_r)var _n=_o,_o=_r;else _n=_r;if(_l<_e)var ga=_e;else{ga=_l;var _l=_e}_n=Mg(_,ga,_n,_l,_o,180<_o-_n),_n.b=j++}_l=_e,_o=_r}}for(_=_.Pf(o).sort(dh),$=_.length,o=0;o<$;o++){if(j=_[o],j=j.b,_t=3*j,j>h+1){var _f=[s[_t],s[_t+1]];d.push(_f)}h=j,_f.push(s[_t+3],s[_t+4])}if(e.a){for(s=[],h=d.length,o=0;o<h;o++)if(_f=d[o],_=_f.length){for($=[],e=0;e<_;e+=2)j=_f[e],_t=_f[e+1],$.push(j,_t),g=_f[e-1],e&&ig(_t,g)&&(s.push($),$=[],g+=0>g?360:-360,$.push(_f[e-2],g,j,_t));s.push($)}d=s}return d}p=L.prototype,p.rb="LineString",p.cd=function(e,o){var s=this.$,h=s.length,d;if(h){for(e.push("("),d=0;d<h;d+=3)d&&e.push(","),e.push(s[d+1]," ",s[d]);o&&(s[0]!==s[h-3]||s[1]!==s[h-2])&&e.push(",",s[1]," ",s[0]),e.push(")")}else e.push("EMPTY");return e},p.Hb="LineString",p.bd=function(){var e=[],o=this.$,s=o.length,h;for(h=0;h<s;h+=3)e.push([o[h+1],o[h],o[h+2]]);return e},p.pc=function(){var e=this.$,o;if(this.K().Bb()){e=e.slice();var s=1;for(o=e.length;s<o;s+=3)0>e[s]&&(e[s]+=360)}return e},p.Ko=function(e){e=e===void 0?5:e;for(var o=this.$,s=o.length,h=[],d=0;d<s;d+=3)h.push([o[d],o[d+1],o[d+2]]);return Yg({polyline:h,precision:e,thirdDim:2,thirdDimPrecision:e})},L.prototype.toFlexiblePolyline=L.prototype.Ko;function fh(e){var o=Zg(e);e=o.polyline;var s=o.thirdDim;if(o=s===2||s===3,s=s===0,!e)throw new D(fh,0,"data");if(o||s){s=e.length;for(var h=Array(3*s),d=0,g=0;d<s;d++){var _=e[d];h[g++]=_[0],h[g++]=_[1],h[g++]=o?_[2]:0}}if(!h)throw new D(fh,0,"only ABSENT, ALTITUDE or ELEVATION are supported as type of the 3rd dimension");return new L(h)}L.fromFlexiblePolyline=fh;function gh(e){xc(this,gh),gh.j.constructor.call(this),this.la=hh(this,e,this.constructor,0)}u(gh,jg),t("H.geo.MultiGeometry",gh),gh.prototype.splice=function(e,o,s){return e=[e],o!==B&&e.push(o),s&&(o=hh(this,s,this.splice,2),e=e.concat(o)),this.a=z,this.la.splice.apply(this.la,e)},gh.prototype.splice=gh.prototype.splice,gh.prototype.hc=function(e){var o=this.la.length;if(!(0<=e&&e<o))throw new ne(this.hc,e,[0,o-1]);return this.a=z,this.la.splice(e,1)[0]},gh.prototype.removeAt=gh.prototype.hc,gh.prototype.remove=function(e){if(e=this.la.indexOf(e),0<=e){var o=this.la.splice(e,1)[0];this.a=z}return o||z},gh.prototype.remove=gh.prototype.remove,gh.prototype.mm=function(){return this.la},gh.prototype.getGeometries=gh.prototype.mm,gh.prototype.push=function(e){var o=hh(this,[e],this.push,0)[0];this.a&&(this.a=this.a.ec(e.K())),this.la.push(o)},gh.prototype.push=gh.prototype.push,gh.prototype.K=function(){var e;if(!(e=this.a)){e=z;var o,s;if(this.la.length)for(e=this.la[0].K(),s=1;s<this.la.length;s++)(o=this.la[s].K())&&(e=e?e.ec(o):o)}return this.a=e},gh.prototype.getBoundingBox=gh.prototype.K,gh.prototype.a=z;function hh(e,o,s,h){var d,g=[];if(!Bc(o))throw new D(s,h);for(d=0;d<o.length;d++)if(e.b(o[d]))g.push(e.c(o[d]));else throw new D(s,h);return g}gh.prototype.c=function(e){return e},gh.prototype.ia=function(e){var o=this===e,s;if(!o&&(o=C(e,this.constructor))){var h=this.la;for(e=e.la,o=(s=h.length)===e.length;o&&s--;)o=h[s].ia(e[s])}return o},gh.prototype.equals=gh.prototype.ia,gh.prototype.cd=function(e){var o=this.la,s=o.length,h,d,g=!1;if(s){for(e.push("("),h=0;h<s;h++)(d=0<h&&g)&&e.push(","),o[h].cd(e),e[e.length-1]==="EMPTY"?e.splice(-1-+d,1+ +d):g=!0;g?e.push(")"):e.splice(-1,1,"EMPTY")}else e.push("EMPTY");return e},gh.prototype.pc=function(){for(var e=[],o=this.la,s=o.length;s--;)e[s]=o[s].pc();return e},gh.prototype.Y=function(){var e=gh.j.Y.call(this);return e.type=this.rb,e},gh.prototype.bd=function(){for(var e=[],o=this.la,s=o.length;s--;)e[s]=o[s].bd();return e};function ih(e){ih.j.constructor.call(this,e)}u(ih,gh),t("H.geo.MultiLineString",ih),ih.prototype.b=function(e){return C(e,L)},ih.prototype.rb="Multi"+L.prototype.rb,ih.prototype.Hb="Multi"+L.prototype.Hb;function jh(){}t("H.map.provider.Invalidations",jh),jh.MARK_INITIAL=Xd,jh.prototype.update=function(e,o){o!==kh.NONE&&(this.a=e,o&kh.SPATIAL&&(this.f=e),o&kh.VISUAL&&(this.g=e),o&kh.ADD&&(this.b=e),o&kh.REMOVE&&(this.c=e),o&kh.Z_ORDER&&(this.l=e),o&kh.VOLATILITY&&(this.i=e))},jh.prototype.update=jh.prototype.update,jh.prototype.Bm=function(){return this.a},jh.prototype.getMark=jh.prototype.Bm,jh.prototype.a=Xd,jh.prototype.rn=function(e){return this.a>e},jh.prototype.isAny=jh.prototype.rn,jh.prototype.g=Xd,jh.prototype.Vd=function(e){return this.g>e},jh.prototype.isVisual=jh.prototype.Vd,jh.prototype.f=Xd,jh.prototype.yh=function(e){return this.f>e},jh.prototype.isSpatial=jh.prototype.yh,jh.prototype.b=Xd,jh.prototype.Rj=function(e){return this.b>e},jh.prototype.isAdd=jh.prototype.Rj,jh.prototype.c=Xd,jh.prototype.Sf=function(e){return this.c>e},jh.prototype.isRemove=jh.prototype.Sf,jh.prototype.l=Xd,jh.prototype.zh=function(e){return this.l>e},jh.prototype.isZOrder=jh.prototype.zh,jh.prototype.i=Xd,jh.prototype.vn=function(e){return this.i>e},jh.prototype.isVolatility=jh.prototype.vn;var kh={NONE:0,VISUAL:1,SPATIAL:2,ADD:4,REMOVE:8,Z_ORDER:16,VOLATILITY:32};jh.Flag=kh;function lh(e){lh.j.constructor.call(this),e!==void 0&&(this.data=e)}u(lh,F),t("H.map.Feature",lh),lh.prototype.getData=function(){return this.data},lh.prototype.getData=lh.prototype.getData,lh.prototype.o=function(){lh.j.o.call(this),delete this.data};function M(e){if(xc(this,M),M.j.constructor.call(this,e?e.data:B),this.ea=mh.next(),e){var o="min";Fc(e[o])&&(this.m=e[o]),o="max",Fc(e[o])&&(this.s=e[o]),o="visibility",o in e&&(this.u=!!e[o]),o="volatility",o in e&&(this.P=!!e[o]),o="zIndex",o in e&&(this.l=+e[o]||0),o="provider",o in e&&!C(e[o],N)&&(this.ma=e[o],this.ra(kh.ADD))}}u(M,lh),t("H.map.Object",M);var mh=new cf(1),nh={ANY:31,OVERLAY:1,SPATIAL:2,MARKER:4,DOM_MARKER:8,GROUP:16};M.Type=nh,M.prototype.cb=function(){return this.ea},M.prototype.getId=M.prototype.cb,M.prototype.Ai=function(e){if(!Fc(e)&&!Cc(e))throw new D(this.Ai,0,"id must be a number or a string");return this.i=e,this},M.prototype.setRemoteId=M.prototype.Ai,M.prototype.Rm=function(){return this.i},M.prototype.getRemoteId=M.prototype.Rm,M.prototype.m=-1/0,M.prototype.s=1/0,M.prototype.zj=function(e){var o=this.s;if(e)for(e=this;e=e.Fa;)o=yd(o,e.s);return o},M.prototype.getMax=M.prototype.zj,M.prototype.Bj=function(e){var o=this.m;if(e)for(e=this;e=e.Fa;)o=zd(o,e.m);return o},M.prototype.getMin=M.prototype.Bj,M.prototype.u=!0,M.prototype.qb=function(e){var o=this.u;return(e=!!e)!==o&&(this.u=e,this.invalidate(kh.VISUAL)),this},M.prototype.setVisibility=M.prototype.qb,M.prototype.wc=function(e){for(var o=this,s;(s=o.u)&&e&&(o=o.Fa););return s},M.prototype.getVisibility=M.prototype.wc,M.prototype.P=!1,M.prototype.Lf=function(e){for(var o=this,s;!(s=o.P)&&e&&(o=o.Fa););return s},M.prototype.getVolatility=M.prototype.Lf,M.prototype.Vk=function(e){var o=this.P;return o!==!!e&&(this.P=!o,this.invalidate(kh.VOLATILITY)),this},M.prototype.setVolatility=M.prototype.Vk,M.prototype.l=B,M.prototype.Ij=function(){return this.l},M.prototype.getZIndex=M.prototype.Ij,M.prototype.fe=function(e){return e!==this.l&&(this.Ye(),this.l=e,this.invalidate(kh.Z_ORDER)),this},M.prototype.setZIndex=M.prototype.fe,M.prototype.L=B,M.prototype.Uc=function(){var e=this.L,o,s;if(!e){var h=+((o=this.l)!==B);(e=this.Fa)?(e=e.Uc().slice(),e[0]|=h):e=[h],e.push(o||0,0>(s=this.Di)?this.ea:s),this.L=e}return e},M.prototype.getZInfo=M.prototype.Uc,M.prototype.Ye=function(){this.L=B};function oh(e,o,s){var h,d;if(!s||e[0]|o[0]){var g=e.length,_=o.length,j=yd(g,_),$=1;for(d=1+ +s;$<j;$+=d)if(h=e[$]-o[$])return h}return s?0:g-_}M.compareZInfo=oh;function ph(e,o){return e.cj(o)}M.compareZOrder=ph,M.prototype.cj=function(e){return this.T-e.T||oh(this.Uc(),e.Uc(),!1)},M.prototype.compareZOrder=M.prototype.cj,p=M.prototype,p.previousSibling=z,p.nextSibling=z,p.Di=-1,p.Fa=z,p.Fm=function(){return this.Fa},M.prototype.getParentGroup=M.prototype.Fm,M.prototype.bc=function(){for(var e=this,o;o=e.Fa;)e=o;return e},M.prototype.getRootGroup=M.prototype.bc,M.prototype.contains=function(e){return this===e},M.prototype.contains=M.prototype.contains,M.prototype.ka=function(e){if(this.Fa)throw new $c(this.ka,"Not allowed for a child of a group");M.j.ka.call(this,e)},M.prototype.setParentEventTarget=M.prototype.ka,M.prototype.draggable=!1,M.prototype.ma=z,M.prototype.ca=function(){return this.ma},M.prototype.getProvider=M.prototype.ca,M.prototype.ee=function(e,o){var s=this.ma,h;if(h=s!==e){if(o&&(s&&!C(s,N)||e&&!C(e,N)))throw new $c(o,"Only LocalObjectProvider allows an object transfers");o=this.type!==nh.GROUP,s&&(this.invalidate(kh.REMOVE),o&&s.Ga(this)),(this.ma=e)&&(o&&e.fa(this),this.ta=z,this.invalidate(kh.ADD))}return h},M.prototype.ta=z,M.prototype.Kb=function(){return this.ta||(this.ta=new jh)},M.prototype.getInvalidations=M.prototype.Kb,M.prototype.ra=function(e){var o=this.ca(),s;return(s=!!o)&&o.invalidateObject(this,e),s},M.prototype.invalidate=M.prototype.ra,M.prototype.o=function(){this.Fa&&this.Fa.Ga(this),M.j.o.call(this)},M.prototype.setData=function(e){return this.data=e,this},M.prototype.setData=M.prototype.setData,M.prototype.Kc=function(e){var o;if(e&&!Da(e))throw new D(M.prototype.Kc,0,"opt_callback must be a function");return e=qh(this,e?e(this.data):this.data,!!e),this instanceof rh||this instanceof sh||this instanceof th||this instanceof uh?o={type:"Feature",properties:e,geometry:this.ga().Kc()}:o={type:"FeatureCollection",features:hf},this.i&&(o.id=this.i),o},M.prototype.toGeoJSON=M.prototype.Kc;function qh(e,o,s){if(o===null||o===B)return null;if(0<=Object.keys(o).length&&Object.prototype.toString.call(o)!=="[object Object]")throw Error(vh(e,s));try{return JSON.stringify(o),o}catch{throw Error(vh(e,s))}}function vh(e,o){return"Object Remote-Id: "+e.i+" - "+(o?"The value returned by the callback is not a valid JSON object and cannot be set as Feature properties.":"The given object data is not a valid JSON object and cannot be set as Feature properties.")}M.prototype.Y=function(){return{id:this.ea,properties:{min:this.Bj(),max:this.zj(),zIdx:this.l,sIdx:this.Di,parent:this.Fa?this.Fa.cb():0,visible:this.wc(),volatile:this.Lf()},type:"Feature"}},M.prototype.forWorkerMessage=M.prototype.Y;function wh(e){var o;if(e){var s=xh;for(o=C(e,wh);s--;){var h=yh[s];if(e.hasOwnProperty(h)){var d=e[h];if(o)this[h]=d;else{if((d=zh[s](d))===Ah)throw new D(wh,0,h+": "+e[h]);d!==this[h]&&d!==B&&(this[h]=d)}}}s=o?e.b:this.lineWidth&&Ze(this.strokeColor),s||(this.b=s),s=o?e.Ob:Ze(this.fillColor),s||(this.Ob=s),s=o?e.a:this.strokeColor!=="none"&&this.lineWidth,s||(this.a=s)}qc(this)}t("H.map.SpatialStyle",wh),wh.prototype.Ob=!0,wh.prototype.b=!0,wh.prototype.a=!0;var yh="strokeColor fillColor lineWidth lineCap lineJoin miterLimit lineDash lineDashOffset lineDashImage lineHeadCap lineTailCap".split(" ");wh.prototype.strokeColor="rgba(0,85,170,.6)",wh.prototype.strokeColor=wh.prototype.strokeColor,wh.prototype.fillColor="rgba(0,85,170,.4)",wh.prototype.fillColor=wh.prototype.fillColor,wh.prototype.lineWidth=2,wh.prototype.lineWidth=wh.prototype.lineWidth,wh.prototype.lineCap="round",wh.prototype.lineCap=wh.prototype.lineCap,wh.prototype.lineJoin="miter",wh.prototype.lineJoin=wh.prototype.lineJoin,wh.prototype.miterLimit=1,wh.prototype.miterLimit=wh.prototype.miterLimit,wh.prototype.Bn=hf,wh.prototype.lineDash=wh.prototype.Bn,wh.prototype.lineDashOffset=0,wh.prototype.lineDashOffset=wh.prototype.lineDashOffset,wh.prototype.Cn=B,wh.prototype.lineDashImage=wh.prototype.Cn,wh.prototype.Dn=B,wh.prototype.lineHeadCap=wh.prototype.Dn,wh.prototype.En=B,wh.prototype.lineTailCap=wh.prototype.En;var xh=yh.length;wh.prototype.ia=function(e){var o=this===e;if(!o&&e){for(o=0;o<xh;o++){var s=yh[o];if(this[s]!==e[s])break}o=o===xh}return o},wh.prototype.equals=wh.prototype.ia,wh.prototype.vj=function(e){if(e){var o={};Ya(o,this,e)}else o=this;return new wh(o)},wh.prototype.getCopy=wh.prototype.vj;var Ah=qc({}),zh=[function(e){return e?pc(e):Ah},function(e){return e?pc(e):Ah},function(e){return 0<=e&&100>=e?+e:Ah},function(e){return e=pc(e),e==="butt"||e==="square"||e==="round"||e==="arrow-head"||e==="arrow-tail"?e:Ah},function(e){return e==="round"||e==="bevel"||e==="miter"?e:Ah},function(e){return 0<e&&100>=e?+e:Ah},function(e){return e&&e.every&&e.every(Gc)?e:Ah},function(e){return E(+e)?Ah:+e},function(e){return e===B||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||Object.values(Bh).includes(e)?e:Ah},function(e){return vc(e)?zh[3](e):B},function(e){return vc(e)?zh[3](e):B}],Ch=new Image().src="data:image/svg+xml;base64,"+btoa('<svg width="128" height="128" viewBox="0 0 128 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><g id="arrow"><path style="fill:#ff0000" d="M 0,0 32,64 2,128 128,64 Z"/></g></svg> '),Dh=new Image().src="data:image/svg+xml;base64,"+btoa('<svg width="128" height="128" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg"><circle style="fill:#ffffff" cx="64" cy="64" r="64" /></svg>'),Bh={ARROW:Ch,CIRCLE:Dh};wh.DashImage=Bh,wh.MAX_LINE_WIDTH=100;var Eh=new wh;wh.DEFAULT_STYLE=Eh;var Fh="fillColor strokeColor lineWidth lineCap lineJoin miterLimit lineDashOffset lineDash lineTailCap lineHeadCap".split(" ");wh.prototype.Y=function(){for(var e={},o=Fh.length,s;o--;)s=Fh[o],e[s]=this[s];return e},wh.prototype.forWorkerMessage=wh.prototype.Y;function Gh(e){var o;if(e){var s=C(e,Gh);for(o in e)if(o in this){var h=e[o];h!==this[o]&&(o==="fillColor"||0<(h=+h))&&(this[o]=h)}e=s?e.Ob:!!(Ze(this.fillColor)&&this.width&&this.width),e||(this.Ob=e)}qc(this)}t("H.map.ArrowStyle",Gh),Gh.prototype.Ob=!0,Gh.prototype.fillColor="rgba(255,255,255,.75)",Gh.prototype.width=1.2,Gh.prototype.length=1.6,Gh.prototype.frequency=5,Gh.prototype.uj=function(){return new Gh(this)},Gh.prototype.ia=function(e){var o=this===e;return!o&&e&&(o=e.width===this.width&&e.fillColor===this.fillColor&&e.length===this.length&&e.frequency===this.frequency),o},Gh.prototype.equals=Gh.prototype.ia;function Hh(e,o){var s;Hh.j.constructor.call(this,o),o&&this.gb(o.style),e&&(this.g=!0),o&&(s=o.arrows)&&this.Mk(s)}u(Hh,M),t("H.map.Spatial",Hh),Hh.prototype.type=nh.SPATIAL,Hh.prototype.T=0,Hh.prototype.style=Eh,Hh.prototype.V=function(){return this.style},Hh.prototype.getStyle=Hh.prototype.V,Hh.prototype.gb=function(e){var o=!0;return e?this.style=C(e,wh)?e:new wh(e):this.style?delete this.style:o=!1,o&&this.invalidate(kh.VISUAL),this},Hh.prototype.setStyle=Hh.prototype.gb,Hh.prototype.Ml=function(){return this.c},Hh.prototype.getArrows=Hh.prototype.Ml,Hh.prototype.Mk=function(e){var o=this.c,s=!1;return!e&&o?(delete this.c,s=!0):!e||o&&o.ia(e)||(this.c=new Gh(e),s=!0),s&&this.style.strokeColor!=="none"&&this.ra(1),this},Hh.prototype.setArrows=Hh.prototype.Mk;function Ih(e,o){var s=!1,h=!1,d;if(o.length){for(s=0;s<o.length;s++)if(o[s]!==Jh){h=!0;break}o=e.style,s=h?o.b||o.Ob&&e.g||(d=e.c||!1)&&o.a&&d.Ob:o.Ob}return s&&e.wc(!0)}Hh.prototype.g=!1,Hh.prototype.sn=function(){return this.g},Hh.prototype.isClosed=Hh.prototype.sn,Hh.prototype.getGeometriesForTile=Hh.prototype.Kd,Hh.prototype.gh=function(){return B},Hh.prototype.getLabels=Hh.prototype.gh;function Kh(e,o){Kh.j.constructor.call(this,e,o)}u(Kh,Hh),t("H.map.GeoShape",Kh),Kh.prototype.getBoundingBox=Kh.prototype.K;function Lh(e,o,s,h){var d=[],g=o.length,_;for(_=0;_<g;_++){var j=o[_];j.length&&d.push(Mh(e,j,s,h))}return d}function Mh(e,o,s,h){var d,g=[],_=o.length,j=0;for(e.xa=0,d=d||0;j<_;)g.push(Nh(e,o[j++],o[j++],d,h));return s&&g.push(Nh(e,o[0],o[1],d,h)),g}function Nh(e,o,s,h,d){var g=e.xa;return g&&180<Dd(g-s)&&(s+=0>g?-360:360),e.xa=s,d.Ah(o,s+h)}function Oh(e,o,s){for(var h=o,d,g=e.length+o,_,j;h--;){for(o=e[h],_=o.length,d=Array(_);_--;)j=o[_],d[_]=new J(j.x+s,j.y);e[--g]=d}}function Ph(e,o,s){this.paths=this.a=e,o!==B&&(this.interiorsIndex=this.b=o),s!==B&&(this.outlinesIndex=this.c=s)}Ph.prototype.b=Wd,Ph.prototype.interiorsIndex=Ph.prototype.b,Ph.prototype.c=Wd,Ph.prototype.outlinesIndex=Ph.prototype.c;var Jh=rc(new Ph([])),Qh=qc([]);function th(e,o){th.j.constructor.call(this,!1,o),this.da(e)}u(th,Kh),t("H.map.Polyline",th),th.prototype.K=function(){return this.a.K()},th.prototype.getBoundingBox=th.prototype.K,th.prototype.da=function(e){var o=this.da,s,h;if(C(e,ih)){var d=e.la;if(s=d.length)for(h=0;h<s;h++)Rh(d[h],o);else throw new D(o,0)}else Rh(e,o);return this.b=!!d,this.a=e,this.ra(kh.SPATIAL),this},th.prototype.setGeometry=th.prototype.da,th.prototype.ga=function(){return this.a},th.prototype.getGeometry=th.prototype.ga,th.prototype.clip=function(e){var o=this.a;return eh(this.b?o.la[0]:o,e)},th.prototype.clip=th.prototype.clip,th.prototype.Kd=function(e){var o=this.a,s,h=[];if(this.b)for(o=o.la,s=o.length;s--;)Sh(this,o[s],e,h);else Sh(this,o,e,h);return h.length?h:B},th.prototype.getGeometriesForTile=th.prototype.Kd;function Rh(e,o){if(!C(e,L)||2>e.Ie())throw new D(o,0)}function Sh(e,o,s,h){var d=eh(o,s.Hf());if(d.length&&(o=s.Jf(),e=Lh(e,d,!1,o),d=e.length)){var g=s.Le();o=o.w,s.x||Oh(e,d,-o),s.x===(1<<s.z)-1&&Oh(e,d,o),s=Uf(e,g.left,g.top,g.right,g.bottom,!1),s.length&&h.push(new Ph(s))}}th.prototype.Y=function(){var e=th.j.Y.call(this),o=e.properties;return e.geometry=this.ga().Y(),o.style=this.V().Y(),o.height=0,e},th.prototype.forWorkerMessage=th.prototype.Y;var Th;function Uh(e,o){if(x.URL)return new x.URL(e,o).toString();if(!e||!Vh(e))return e;if(!o||Vh(o))throw new TypeError("Failed to construct 'URL': Invalid base URL");Th||(Th=document.createElement("a"),Ic(Th));var s=Th;return s.href=o,e[0]!=="/"?e=s.href.replace(/\/[^\/]*$/,"/")+e:((o=s.origin)||(o=s.protocol+"//"+s.host),e=o+e),e}function Vh(e){var o=!1;return typeof e=="string"&&(o=!(-1<e.search(/^(http|https|data|blob):/)||e.substr(0,2)==="//")),o}function Wh(e,o){if(Wh.j.constructor.call(this),o&&Vh(o))throw new D(Wh,1,"Base URL must be absolute");this.C=Xh.INIT,this.Ca=null,this.Yb=o}u(Wh,F),t("H.map.render.Style",Wh),Wh.prototype.load=Wh.prototype.load,Wh.prototype.getState=function(){return this.C},Wh.prototype.getState=Wh.prototype.getState,Wh.prototype.O=function(e){this.C=e},Wh.prototype.setState=Wh.prototype.O,Wh.prototype.Ib=function(){return this.Yb},Wh.prototype.getBaseUrl=Wh.prototype.Ib,Wh.prototype.qc=function(){return sc(this.Ca)},Wh.prototype.getConfig=Wh.prototype.qc,Wh.prototype.Tl=function(){return this.Ca},Wh.prototype.getConfigReference=Wh.prototype.Tl,Wh.prototype.vd=function(e){this.Ca=e},Wh.prototype.setConfig=Wh.prototype.vd,Wh.prototype.Gb=function(e){this.Ca=null,this.O(Xh.ERROR),this.sh(Yh)?this.dispatchEvent(new wd(Yh,e,this)):console.error(e)},Wh.prototype.dispatchError=Wh.prototype.Gb,Wh.prototype.o=function(){Wh.j.o.call(this),this.Ca=null};var Yh="error",Zh={ed:"change",Ni:Yh},Xh={ERROR:-1,INIT:0,LOADING:1,READY:2};Wh.State=Xh;function $h(e,o){var s,h=arguments.length,d,g;for(s=1;s<h;s++)if((d=arguments[s])&&d!==e&&d!==_){var _=d;for(g in d){var j=d[g];e[g]!==j&&(ai(j)?ai(e[g])?e[g]=$h(e[g],j):e[g]=sc(j):j!==void 0&&(e[g]=sc(j)))}}return e}t("H.util.webgl.mergeObjects",$h);var bi=oc();function ci(e,o,s){var h=s[e];return o&&h in o&&0>uc.indexOf(h)?(o=o[h],++e<s.length?ci(e,o,s):o):bi}var di=ci.bind(null,0),ei={polygons:1,lines:1,"pattern-lines":1,points:1,text:1,raster:1,custom_icons:1,overlays:1},fi={data:1,draw:1,enabled:1,filter:1,properties:1},gi=Object.keys(fi);function hi(e,o,s,h,d,g){var _=h[e],j=s[_];if(++e<h.length){var $=o[_]||{};for(s=gi.length;s--;){var _t=gi[s];if(_t!=="draw"||!g){var _e=j[_t];_e!==B&&($[_t]=sc(_e))}}hi(e,$,j,h,d,g)}else d?$=sc(j):($=j,delete s[_]);o[_]=o[_]?$h(o[_],$):$}var ii=hi.bind(null,0);function ji(e,o){e in ei&&(o[e]=1)}function ki(e,o,s){var h,d,g;for(h in e)if(fi[h]){if(h==="draw"){var _=e[h];for(d in _){var j=_[d];(g=j.style)?(j.style=o+g,ji(g,s)):(delete _[d],_[o+d]=j,ji(d,s))}}}else ki(e[h],o,s)}function li(e,o){var s={},h,d,g,_;if(o+="_",e=$h({},e),h=e.styles)for(d in h){var j=h[d];if(delete h[d],h[o+d]=j,g=j.mix)for(Cc(g)&&(g=[g]),_=g.length;_--;)ji(g[_],s),g[_]=o+g[_];(_=j.base)&&(g||(g=j.mix=[]),g.unshift(o+_),delete j.base,ji(_,s)),ji(d,s)}else h=e.styles={};if(j=e.layers)for(d in j)g=j[d],delete j[d],(_=g.data)&&!_.layer&&(_.layer=d),j[o+d]=g,ki(g,o,s);for(d in s)h[o+d]={base:d};return e}function mi(e,o){var s=e.sources,h=Object.keys(s)[0],d=$h(s[h],{uid:o});s=e.layers;var g;e.sources={},e.sources[o]=d;for(g in s)e=s[g],e.data?e.data.source===h&&(e.data.source=o):e.data={source:o}}function ni(e,o){var s,h=e.textures;e=e.fonts;for(s in h){var d=h[s];d.url&&(d.url=Uh(d.url,o))}for(s in e)if(d=e[s],Bc(d))for(h=0;h<d.length;h++){var g=d[h];g.url=g.url&&Uh(g.url,o)}else g=d,g.url=g.url&&Uh(g.url,o)}function oi(e,o){return"function(){return "+("feature."+e+(o||""))+";}"}function pi(e){return oi("style."+e,void 0)}function qi(e,o,s,h){return e={base:e,blend:o,blend_order:s},h&&(e.clean_depth=!!h),e}function ri(e){var o={};return o["translucent-"+(e?"extruded-":"")+"polygons"]={color:pi("fillColor"),order:1,interactive:!0,extrude:e},o}function si(e,o,s,h){return e={data:{source:e,layer:o}},s&&(e.draw=s),h&&(e.filter=h),e}function ai(e){return Ea(e)&&!Bc(e)}function ti(e,o){if(ti.j.constructor.call(this,e,o),Cc(e))ui.test(e)&&e.indexOf("import:")===-1?(this.b=e,o||(this.g=Vh(this.b)?B:this.b)):this.c=e;else if(Ea(e))this.vd(sc(e));else throw new D(ti,0,"invalid style configuration")}u(ti,Wh),t("H.map.render.webgl.Style",ti),ti.prototype.load=function(){var e=this,o=this.Ib();this.b?(this.O(Xh.LOADING),new tf("text/plain",this.b).then(function(s){var h={};return vi(s,o,!1,(h[o]=!0,h))}).then(function(s){return e.vd(s)},function(s){return e.Gb(s.message)}),delete this.b):this.c&&(this.O(Xh.LOADING),vi(this.c,o).then(function(s){return e.vd(s)},function(s){return e.Gb(s.message)}),delete this.c)},ti.prototype.load=ti.prototype.load,ti.prototype.Rk=function(e,o,s){var h;for(wi(this),e=xi(this,e,this.Rk,s),s=0;s<e.length;s++){var d=e[s].eb.draw;for(h in d){var g=d[h];ai(g)&&(g.interactive=!!o)}}yi(this)},ti.prototype.setInteractive=ti.prototype.Rk,ti.prototype.setProperty=function(e,o,s){var h,d=e.split("."),g=0,_=d.length;if(wi(this),!vc(o))throw new D(this.setProperty,1,"value");if(h=zi(this.Ca,d)){if(!(h.parent instanceof Object)||h.parent instanceof Array)if(s)d.pop(),d=zi(this.Ca,d),h.parent=d.parent[d.fg]={};else throw new D(this.setProperty,0,e+" property is not primitive type");h.parent[h.fg]=o}else{for(h=this.Ca;g!==_-1;)h[d[g]]={},h=h[d[g++]];h[d[g]]=o}Ai(this)&&yi(this)},ti.prototype.setProperty=ti.prototype.setProperty,ti.prototype.kh=function(e){return wi(this),(e=zi(this.Ca,e.split(".")))?sc(e.node):void 0},ti.prototype.getProperty=ti.prototype.kh,ti.prototype.removeProperty=function(e){wi(this),(e=zi(this.Ca,e.split(".")))&&e.parent&&e.parent.hasOwnProperty(e.fg)&&(delete e.parent[e.fg],Ai(this)&&yi(this))},ti.prototype.removeProperty=ti.prototype.removeProperty,ti.prototype.xe=function(e,o,s){var h;wi(this);var d=this.Ca,g=d.layers,_=xi(this,e,this.xe,!1);for(e=_.length,h={};e--;)ii(h,g,_[e].id,!!o,!!s);for(s={},_=Object.keys(d),e=_.length;e--;){var j=_[e],$=d[j];s[j]=$===g?h:sc($)}return o||yi(this),s},ti.prototype.extractConfig=ti.prototype.xe,ti.prototype.Oe=function(e){if(wi(this),!Ea(e))throw new D(this.Oe,0,"config");this.vd($h(this.Ca,e))},ti.prototype.mergeConfig=ti.prototype.Oe,ti.prototype.a=ba(2),ti.prototype.toString=function(){return this.getState()===Xh.READY?x.H.gl.yaml.safeDump(this.Ca,{lineWidth:120}):""},ti.prototype.o=function(){ti.j.o.call(this),delete this.c,delete this.b};function Ai(e){var o=e.Ca,s;if(Ea(o)){var h;if(h=e.f){o=o&&o.sources,h=!1;for(var d in o)if(o[d].type===e.f){h=!0;break}h=!(!o||h)}h&&(s="invalid source, the only valid type is "+e.f)}else s="invalid style configuration";return s&&e.Gb(s),!s}function yi(e){e.dispatchEvent(new ud("change",e))}function wi(e){if(e.getState()!==Xh.READY)throw new $c(e.Oe,"style is not ready yet")}function xi(e,o,s,h){var d=[],g=Bc(o)?o:[o],_,j;for(h===void 0&&(h=!0),g=g.sort().reverse();_=g.pop();){o=String(_).split(".");t:{for(var $=e.Ca,_t=o.length;_t--&&!fi[o[_t]];);if($&&0>_t&&($=di($.layers,o),ai($)))break t;$=bi}if($===bi)throw new D(s,0,'Unresolvable layer ID "'+_+'"');if(d.push({id:o,eb:$}),h)for(j in $)!fi[j]&&ai($[j])&&g.push(_+"."+j)}return d}function zi(e,o){var s=0,h;for(h=o.length;s!==h;){var d=o[s++],g=e;if(e=g[d],!e)break}return s===h?{node:e,parent:g,fg:d}:void 0}var ui=/^(http[s]?)?.*\.ya?ml/i;function vi(e,o,s,h){s=s===void 0?!1:s,h=h===void 0?{}:h;try{var d=x.H.gl.yaml.safeLoad(e,{json:!0})}catch(g){return Promise.reject(g)}return d&&(e=d.import,Cc(e)&&(e=[e]),s&&o&&Bi(d,o),delete d.import,Bc(e)&&e.length)?(s=e.reduce(function(g,_){var j=o?Uh(_,o):_;return h[j]||(h[j]=!0,g.push(new tf("text/plain",j).then(function($){return vi($,j,!0,h)}))),g},[]),Promise.all(s).then(function(g){var _={};return g.forEach(function(j){return j&&$h(_,j)}),$h(_,d),_})):Promise.resolve(d)}function Bi(e,o){function s(_){_.url&&(_.url=Uh(_.url,o))}var h=e&&e.fonts;if(h)for(var d in h)Bc(h[d])?h[d].forEach(s):s(h[d]);if(e=e&&e.textures)for(var g in e)s(e[g])}ti.normalize=Bi,ti.prototype.vd=function(e){ti.j.vd.call(this,e),Ai(this)&&(this.O(Xh.READY),yi(this))},ti.prototype.qc=function(){return ti.j.qc.call(this)},ti.prototype.getConfig=ti.prototype.qc,ti.prototype.Ib=function(){return this.g||ti.j.Ib.call(this)},ti.prototype.getBaseUrl=ti.prototype.Ib,t("H.map.Style",ti),ti.State=Xh;function O(e,o){var s;if(O.j.constructor.call(this),C(e,L,O,0),o!==B&&Bc(o,O,1)){for(s=0;s<o.length;s++)C(o[s],L,O,1,"index "+s);this.a=o}else this.a=[];this.b=e,this.c=[]}u(O,jg),t("H.geo.Polygon",O);function Ci(e){var o=O,s=L,h=e.c,d=e.a,g=e.f,_=e.b;return d=[h,d,B,h,_,B,g,_,B,g,d,B],180<=e.Ab()&&(d.splice(9,0,g,e=e.bb().lng,B),d.splice(3,0,h,e,B)),new o(new s(d))}O.fromRect=Ci;var Di={NORTH:90,SOUTH:-90};O.Direction=Di,O.prototype.pd=Di.NORTH,O.prototype.Sk=function(e){return this.pd!==e&&(this.f=z,this.c.length=0,this.pd=e),this},O.prototype.setPoleCovering=O.prototype.Sk,O.prototype.Km=function(){return this.pd},O.prototype.getPoleCovering=O.prototype.Km,O.prototype.fm=function(){return this.b},O.prototype.getExterior=O.prototype.fm,O.prototype.Pk=function(e){if(!C(e,L))throw new D(this.Pk,0,e);this.b=e,this.f=z},O.prototype.setExterior=O.prototype.Pk,O.prototype.rm=function(){return this.a},O.prototype.getInteriors=O.prototype.rm,O.prototype.xg=function(e,o,s){var h=arguments.length,d;for(d=2;d<h;d++)C(arguments[d],L,this.xg,d);var g=this.a.splice.apply(this.a,arguments);for(d=2;d<h;d++)arguments[d]=B;return this.c.splice.apply(this.c,arguments),g},O.prototype.spliceInteriors=O.prototype.xg,O.prototype.no=function(e){return this.xg(e,1)[0]},O.prototype.removeInteriorAt=O.prototype.no,O.prototype.mo=function(e){return e=this.a.indexOf(e),0>e?B:this.xg(e,1)[0]},O.prototype.removeInterior=O.prototype.mo,O.prototype.Bk=function(e){if(!C(e,L))throw new D(this.Bk,0,e);this.a.push(e)},O.prototype.pushInterior=O.prototype.Bk,O.prototype.K=function(){var e=this.f;return e||(this.f=e=Ei(this.b,this.pd)),e},O.prototype.getBoundingBox=O.prototype.K,p=O.prototype,p.tj=function(e){var o=this.a.length;if(0>e||e>=o)throw new ne(this.tj,e,[0,o-1]);return(o=this.c[e])||(this.c[e]=o=Ei(this.a[e],this.pd)),o};function Ei(e,o){var s,h,d;return(d=e.K())&&((s=e.eh(!0))&&(h=e.Ie())&&(d=d.ec(tg([e.ye(0),e.ye(h-1)],!0),!0)),d.Ab()===360&&s%2===1&&(d=d.Xc(o,0))),d}p.rb="Polygon",p.cd=function(e){var o=this.a,s=o.length,h;if(this.b.Ie()){for(e.push("("),this.b.cd(e,!0),h=0;h<s;h++)o[h].Ie()&&(e.push(","),o[h].cd(e,!0));e.push(")")}else e.push("EMPTY");return e},p.Hb="Polygon",p.bd=function(){var e,o=[],s=this.a,h=this.b.bd();for(h[0].toString()!==h[h.length-1].toString()&&h.push(h[0]),o.push(h),e=0;e<s.length;e++)h=s[e].bd(),h[0].toString()!==h[h.length-1].toString()&&h.push(h[0]),o.push(h);return o},p.Y=function(){var e=O.j.Y.call(this);return this.K().Bb()&&(e.type="Multi"+e.type),e},p.pc=function(){var e=[],o=this.a,s=o.length;for(e.push(this.b.pc());s--;)e[s+1]=o[s].pc();return this.K().Bb()?[e]:e},p.ia=function(e){var o=!1;if(C(e,O)){var s=e.a,h=this.a.length;o=s.length;var d=0;for(o=this.b.ia(e.b)&&h===o;o&&d<h;)o=o&&this.a[d].ia(s[d]),d++}return o},O.prototype.equals=O.prototype.ia;function Fi(e,o,s,h){h=h===void 0?!0:h;var d=e.a,g=Gi.bind(null,o,s);return ee(o,s,e.b.$,0,!0,3)!==de.NONE?h?!d.some(g):!0:!1}function Gi(e,o,s){return ee(e,o,s.$,0,!0,3)===de.SURFACE}function Hi(e,o){o=o.$,e=e.b.$;var s,h,d=o.length-3,g=e.length-3,_={};for(s=0;s<d;s+=3){var j=o[s],$=o[s+1],_t=o[s+3],_e=o[s+4];for(h=0;h<g;h+=3){var _r=e[h],_n=e[h+1],_o=e[h+3],ga=e[h+4];if(ag(new Yf($,j),new Yf(_e,_t),new Yf(_n,_r),new Yf(ga,_o),_,!0))return!0}}return!1}function Ii(e,o){var s=o.b,h=o.a,d=h.length,g=s.$,_=g.length,j=e.b.$,$=j.length;if(Hi(e,s))return!0;for(s=0;s<_;s+=3)if(Fi(e,g[s],g[s+1]))return!0;for(s=0;s<$;s+=3)if(Fi(o,j[s],j[s+1]))return!0;for(s=0;s<d;s++)if(Hi(e,h[s]))return!0;return!1}function Ji(e){Ji.j.constructor.call(this,e)}u(Ji,gh),t("H.geo.MultiPolygon",Ji),Ji.prototype.b=function(e){return C(e,O)},Ji.prototype.rb="Multi"+O.prototype.rb,Ji.prototype.Hb="Multi"+O.prototype.Hb;function uh(e,o){var s=o&&(+o.extrusion||+o.extrude)||0,h=o&&+o.elevation||0,d=0;if(uh.j.constructor.call(this,!0,o),0<h&&(d+=h,this.b=h),0<s&&(d+=s,this.f=s),2047<d)throw new ne(uh,d,[0,2047]);C(e,L)?this.da(new O(e)):this.da(e)}u(uh,Kh),t("H.map.Polygon",uh);var Ki=new O(new L([0,0,0,0,0,0,0,0,0]));uh.prototype.f=0,uh.prototype.b=0,uh.prototype.a=Ki,uh.MAX_EXTRUDE_HEIGHT=2047,uh.prototype.pi=function(e){var o=+e;if(o!==e)throw new D(this.pi,0,e);if(0>o||2047<this.b+o)throw new ne(this.pi,this.b+o,[0,2047]);this.f=o,this.ra(kh.SPATIAL)},uh.prototype.setExtrusion=uh.prototype.pi,uh.prototype.gm=function(){return this.f},uh.prototype.getExtrusion=uh.prototype.gm,uh.prototype.oi=function(e){var o=+e;if(o!==e)throw new D(this.oi,0,e);if(0>o||2047<this.f+o)throw new ne(this.oi,this.f+o,[0,2047]);this.b=o,this.ra(kh.SPATIAL)},uh.prototype.setElevation=uh.prototype.oi,uh.prototype.bm=function(){return this.b},uh.prototype.getElevation=uh.prototype.bm,uh.prototype.ga=function(){return this.a},uh.prototype.getGeometry=uh.prototype.ga,uh.prototype.da=function(e){if(C(e,O))var o=!1;else C(e,Ji,this.da,0),o=!0;return this.J=o,o=this.a,this.a=e,o!==Ki&&this.ra(kh.SPATIAL),this},uh.prototype.setGeometry=uh.prototype.da,uh.prototype.K=function(){return this.ga().K()},uh.prototype.getBoundingBox=uh.prototype.K,uh.prototype.Kd=function(e){var o,s=this.ga(),h,d;if(this.J){s=s.la;var g=0;for(d=s.length;g<d;g++)(h=Li(this,s[g],e,s[g].pd))&&(o||(o=[]),o.push(h))}else h=this.ab,h===B&&(h=this.J?Di.NORTH:this.ga().pd),(h=Li(this,s,e,h))&&(o=[h]);return o},uh.prototype.getGeometriesForTile=uh.prototype.Kd;function Li(e,o,s,h){var d,g,_=0,j=!0;if(d=Mi(e,o.b,s,h,o.K())){var $=new Ph(d),_t=o.a;if(g=_t.length)for($.b=$.a.length;_<g;_++)(d=Mi(e,_t[_],s,h,o.tj(_)))&&($.a=$.a.concat(d));for(g=$.a.length,_=0;_<g;_++)if($.a[_]!==Qh){j=!1;break}j&&($=_%2?Jh:B)}return $}function Mi(e,o,s,h,d){var g=s.Le(),_=d,j=_.Ab(),$=[[]],_t=o.$,_e=[],_r=_t.length,_n,_o=!1;for(_n=0;_n<_r;_n+=3){var ga=_t[_n],_l=_t[_n+1];_o||Dd(_l)!=180||(_e.push(ga),_e.push(_l),_e.push(ga),_e.push(-_l),_o=!0),_e.push(ga),_e.push(_l)}if(_t=_e,360>j&&_.a==-180&&(_=new K(_.c,180,_.f,_.b)),360>j&&_.b==180&&(_=new K(_.c,_.a,_.f,-180)),_.Bb()){for(j=_t,ga=j.length,_t=-1,_e=0;_e<ga-2;_e+=2)if(ig(j[_e+1],j[_e+3])){_t=_e+2;break}_t===-1&&ig(j[ga-1],j[1])&&(_t=ga),_t!==-1&&(_r=j[_t-2],_e=j[_t-1],_n=j[_t%ga],_o=j[(_t+1)%ga],Dd(_r)!==180&&Dd(_n)!==180&&(_l=Dd(_n-_r),ga=Dd(_o-_e),ga+=180<ga?-360:0,_o=Dd(180-_o),_o+=180<_o?-360:0,ga&&_o&&(_l/=Dd(ga)/Dd(_o),_r=_n+(_n>_r?-_l:_l),_e=0<_e?180:-180,j.splice(_t,0,_r,_e,_r,-_e)))),_t=j}if($[0]=Ni(_t.concat(),_.a),360>_.Ab()&&_.gd(new kg(_.c,180))&&(_t=Ni(_t.concat(),_.b),$.push(_t)),_=s.Jf(),e=Lh(e,$,!0,_),d.Ab()===360&&o.eh(!0)%2===1){for(o=e,e=s.Le(),o[0][1].x>o[0][o[0].length-1].x&&(o[0]=o[0].reverse()),_t=[],j=o[0].length-1,$=0;$<j;$++)_e=o[0][$],_t[$]=new J(_e.x-2*_.w,_e.y),_t[$+j]=new J(_e.x-_.w,_e.y),_t[$+2*j]=new J(_e.x,_e.y),_t[$+3*j]=new J(_e.x+_.w,_e.y),_t[$+4*j]=new J(_e.x+2*_.w,_e.y);o[0]=_t,$=_.Ah(h,0),$.y=2*e[h===Di.NORTH?"top":"bottom"],h=$.clone(),$.x=o[0][o[0].length-1].x+1,h.x=o[0][0].x-1,o[0].push($,h),e=o}if(h=g.left,o=g.top,$=g.right,g=g.bottom,Uf(e,h,o,$,g,!0).length){if(!s.Hf().Qg(d)){for(s=e,d=[new J(h,o),new J($,o),new J($,g),new J(h,g)],g=[],e=s.length;e--;)if(h=Wf(d,s[e]))for(o=Oi(h),g.push(o);h.Uh;)h=h.Uh,o=Oi(h),g.push(o);e=g}}else s=Pi(h,o,e[0]),e[1]&&(s=s!==Pi(h,o,e[1])),e=s?[Qh]:B;return e}function Pi(e,o,s){var h,d,g,_=h=s[0].x,j=d=s[0].y,$=1;for(g=s.length;$<g;$++){var _t=s[$].x,_e=s[$].y;_t>h?h=_t:_t<_&&(_=_t),_e>d?d=_e:_e<j&&(j=_e)}return _<=e&&e<=h&&j<=o&&o<=d&&fe({x:e,y:o},ge(s.concat(s[0])))}function Oi(e){var o=[],s=e;do{var h=Ad(100*(s.eo?s.eo:s.x))/100,d=Ad(100*(s.fo?s.fo:s.y))/100;if(!g||.01<Fd(Gd(g.x-h,2)+Gd(g.y-d,2))){var g=new J(h,d);o.push(g)}s=s.next}while(s&&s!==e);return o}uh.prototype.aa=z;function Ni(e,o){var s,h=Number.POSITIVE_INFINITY,d=-1,g=e.length;for(s=0;s<g;s+=2){var _=Dd(e[s+1]-o);_+=180<_?360-_:_,_<h&&(h=_,d=s)}return 0<s?(o=e.splice(d,e.length-d),o.concat(e)):e}uh.prototype.Y=function(){var e=uh.j.Y.call(this),o=this.ga(),s=this.J?o.la:[o],h,d=e.properties,g=e.geometry=o.Y();if(d.style=this.V().Y(),d.height=this.f+this.b,d.min_height=this.b,this.K().Bb()&&(g.type="MultiPolygon",this.J)){var _=[];s.forEach(function(j,$){h=g.coordinates[$],j.K().Bb()?_=_.concat(h):_.push(h)}),g.coordinates=_}return e},uh.prototype.forWorkerMessage=uh.prototype.Y;function Qi(e,o,s){Qi.j.constructor.call(this,Ki,s),this.tg(e),this.zi(o),s&&"precision"in s&&this.yi(s.precision)}u(Qi,uh),t("H.map.Circle",Qi),Qi.prototype.tg=function(e){(e=ng(e)).ia(this.R)||(this.R=e,Ri(this))},Qi.prototype.setCenter=Qi.prototype.tg,Qi.prototype.bb=function(){return this.R},Qi.prototype.getCenter=Qi.prototype.bb,Qi.prototype.zi=function(e){if(E(e=ae(e,0,637100079e-2*Pd/2)))throw new D(this.zi,0,e);this.wa!==e&&(this.wa=e,Ri(this))},Qi.prototype.setRadius=Qi.prototype.zi,Qi.prototype.Qm=function(){return this.wa},Qi.prototype.getRadius=Qi.prototype.Qm,Qi.prototype.D=60,Qi.prototype.yi=function(e){if(!Fc(e))throw new D(this.yi,0,e);this.D!==(e=ae(Ad(e),4,360))&&(this.D=e,Ri(this))},Qi.prototype.setPrecision=Qi.prototype.yi,Qi.prototype.Nm=function(){return this.D},Qi.prototype.getPrecision=Qi.prototype.Nm,Qi.prototype.da=function(){return this},Qi.prototype.setGeometry=Qi.prototype.da,Qi.prototype.ga=function(){return this.a===Ki&&Qi.j.da.call(this,Si(this)),this.a},Qi.prototype.getGeometry=Qi.prototype.ga;function Ri(e){e.a!==z&&Qi.j.da.call(e,Si(e))}function Si(e){var o=e.R,s=o.lat,h=e.wa,d=0,g=new L;if(Dd(s)===90)for(s=o.zg(0,h,!0).lat;360>d;d+=120)g.gi(s,d-180,B);else for(e=e.D,e=360/e;360>d;d+=e)g.qd(o.zg(d,h,!0));return o=new O(g),0>s&&o.Sk(Di.SOUTH),o}function Ti(e,o){if(!C(e,Element)){if(Ui.innerHTML=e,e=Ui.firstElementChild,!e)throw new D(Ti,0,"No element data");Ui.removeChild(e);var s=!0;Ui.innerHTML=""}this.a=kf(e).length!==0,this.f=s?e:lf(e,x.document,this.a),o&&(s="onAttach",s in o&&zc(e=o[s],"Function",Ti,1,s)&&(this.Vh=e),s="onDetach",s in o&&zc(e=o[s],"Function",Ti,1,s)&&(this.b=e))}t("H.map.DomIcon",Ti);var Ui=document.createElement("DIV");Ti.prototype.Vh=null,Ti.prototype.b=null,Ti.prototype.uj=function(e){return lf(this.f,e,this.a)},Ti.prototype.a=!1;function Vi(e){Vi.j.constructor.call(this,e)}u(Vi,gh),t("H.geo.MultiPoint",Vi),Vi.prototype.b=function(e){return lg(e)},Vi.prototype.c=function(e){return C(e,kg)?e:ng(e)},Vi.prototype.rb="Multi"+kg.prototype.rb,Vi.prototype.Hb="Multi"+kg.prototype.Hb;function Wi(e,o){this.w=+e,this.h=+o}t("H.math.Size",Wi);function Xi(e,o){var s,h=e,d=o||[];if(e!==Yi.NONE){if(o=s=d.length,Zi.indexOf(h)===-1)throw new D(Xi,0,e);if(!d)throw new D(Xi,1,d);for(;s--;)if(E(d[s]))throw new D(Xi,1,d);if(h===Yi.RECT&&3<o&&(d=[d[0],d[1],d[2],d[1],d[2],d[3],d[0],d[3]],h=Yi.POLYGON),h===Yi.CIRCLE&&2<o&&(e=d[2],0<e)){h=d[0];var g=d[1];s=yd(2*Cd(e),40);var _=360/s;for(d=[];s--;){var j=_*s*Ud;d.push(h+Id(j)*e,g+Kd(j)*e)}h=Yi.POLYGON}if(h!==Yi.POLYGON||!o||d.length%2)throw new D(Xi,1,d);this.a=d}}t("H.map.HitArea",Xi);var Yi={NONE:0,RECT:1,CIRCLE:2,POLYGON:3};Xi.ShapeType=Yi;var Zi=[Yi.RECT,Yi.CIRCLE,Yi.POLYGON];Xi.prototype.Of=function(e,o,s){return this.a?ee(e,o,this.a,s,!0):de.NONE},Xi.prototype.hitTest=Xi.prototype.Of;function rh(e,o){var s;xc(this,rh),rh.j.constructor.call(this,o),this.da(e),o&&"icon"in o&&(s=o.icon),this.Ic(s||$i(this))}u(rh,M),t("H.map.AbstractMarker",rh),rh.prototype.ga=function(){return this.a},rh.prototype.getGeometry=rh.prototype.ga,rh.prototype.da=function(e){var o=this.a;return C(e,kg)||C(e,Vi)?this.a=e:(lg(e,this.da,0),this.a=ng(e)),o&&this.ra(kh.SPATIAL),this},rh.prototype.setGeometry=rh.prototype.da,rh.prototype.K=function(){return this.a.K()},rh.prototype.xb=function(){return this.icon},rh.prototype.getIcon=rh.prototype.xb,rh.prototype.Ic=function(e){var o=this.icon,s=!o;if(o!==e){if(!this.Uj(e))throw s?new D(this.constructor,1,e):new D(this.Ic,0,e);this.icon=e,s||this.ra(kh.VISUAL)}return this},rh.prototype.setIcon=rh.prototype.Ic;function $i(e){var o=e.c;return o||(o=e.constructor.prototype.c=e.b(aj)),o}var aj={svg:'<svg xmlns="http://www.w3.org/2000/svg" width="38" height="47" viewBox="0 0 38 47"><g fill="none"><path fill="#0F1621" fill-opacity=".4" d="M15 46c0 .317 1.79.574 4 .574s4-.257 4-.574c0-.317-1.79-.574-4-.574s-4 .257-4 .574z"></path><path fill="#01b6b2" d="M33.25 31.652A19.015 19.015 0 0 0 38 19.06C38 8.549 29.478 0 19 0S0 8.55 0 19.059c0 4.823 1.795 9.233 4.75 12.593L18.975 46 33.25 31.652z"></path><path fill="#6A6D74" fill-opacity=".5" d="M26.862 37.5l4.714-4.77c3.822-3.576 5.924-8.411 5.924-13.62C37.5 8.847 29.2.5 19 .5S.5 8.848.5 19.11c0 5.209 2.102 10.044 5.919 13.614l4.719 4.776h15.724zM19 0c10.493 0 19 8.525 19 19.041 0 5.507-2.348 10.454-6.079 13.932L19 46 6.079 32.973C2.348 29.495 0 24.548 0 19.04 0 8.525 8.507 0 19 0z"></path></g></svg>',size:new Wi(38,47),anchor:new J(19,45),hitArea:new Xi(Yi.POLYGON,[19,46,2,27,0,18,5,6,19,0,32,5,38,15,36,27,19,47])};rh.prototype.Y=function(){var e=rh.j.Y.call(this),o=this.xb(),s=o.yb(),h=o.kd();return e.geometry=this.ga().Y(),s&&(o=e.properties.icon={id:o.uid},o.size={w:s.w,h:s.h},o.offset=[s.w/2-(h?h.x:0),s.h/2-(h?h.y:0)]),e},rh.prototype.forWorkerMessage=rh.prototype.Y;function bj(e,o){bj.j.constructor.call(this,e,o)}u(bj,rh),t("H.map.DomMarker",bj),bj.prototype.type=nh.DOM_MARKER,bj.prototype.T=2,bj.prototype.b=function(e){var o=new Ti(e.svg,e);return e=e.anchor,o.f.style.margin=-e.y+"px 0 0 -"+e.x+"px",o},bj.prototype.Uj=function(e){return C(e,Ti)};function cj(e,o,s){cj.j.constructor.call(this,e),this.oldValue=s,this.newValue=o}u(cj,ud),t("H.util.ChangeEvent",cj);function dj(e,o,s,h){dj.j.constructor.call(this,e,o,s),this.modifiers=h}u(dj,cj),t("H.map.ChangeEvent",dj);var ej={SIZE:1,POSITION:2,HEADING:4,TILT:8,INCLINE:16,ZOOM:32,BOUNDS:64};dj.Type=ej,dj.prototype.ll=ej.SIZE,dj.prototype.SIZE=dj.prototype.ll,dj.prototype.Ui=ej.POSITION,dj.prototype.POSITION=dj.prototype.Ui,dj.prototype.Oi=ej.HEADING,dj.prototype.HEADING=dj.prototype.Oi,dj.prototype.Wi=ej.TILT,dj.prototype.TILT=dj.prototype.Wi,dj.prototype.Pi=ej.INCLINE,dj.prototype.INCLINE=dj.prototype.Pi,dj.prototype.Xi=ej.ZOOM,dj.prototype.ZOOM=dj.prototype.Xi,dj.prototype.Mi=ej.BOUNDS,dj.prototype.BOUNDS=dj.prototype.Mi;function fj(){this.a=[],fj.j.constructor.call(this)}u(fj,F),t("H.util.OList",fj);function gj(e,o,s){if(e=e.a.length,s)var h=e;else if(E(h=0>(h=+o)?zd(0,e+h):yd(e,h)))throw new ne(fj,o,[0,e-1]);return h}fj.prototype.add=function(e,o){o=gj(this,o,E(o)),this.a.splice(o,0,e),this.dispatchEvent(new hj(this,this.A.he,o,e,null,null))},fj.prototype.add=fj.prototype.add;function ij(e,o){var s=e.a.splice(o,1)[0];return e.dispatchEvent(new hj(e,e.A.je,o,null,s,null)),s}fj.prototype.hc=function(e){return this.get(e),ij(this,e)},fj.prototype.removeAt=fj.prototype.hc,fj.prototype.remove=function(e){return e=this.indexOf(e),0<=e?(ij(this,e),!0):!1},fj.prototype.remove=fj.prototype.remove,fj.prototype.set=function(e,o){if(this.a.length!==0||e!==0){this.get(e),e=gj(this,e,!1);var s=this.a[e]}return this.a[e]=o,this.dispatchEvent(new hj(this,this.A.ke,e,o,s,null)),s},fj.prototype.set=fj.prototype.set,fj.prototype.indexOf=function(e){return this.a.indexOf(e)},fj.prototype.indexOf=fj.prototype.indexOf,fj.prototype.get=function(e){var o=gj(this,e,!1),s=this.a;if(o>=s.length)throw new ne(this.get,e,[0,s.length-1]);return s[o]},fj.prototype.get=fj.prototype.get,fj.prototype.ym=function(){return this.a.length},fj.prototype.getLength=fj.prototype.ym,fj.prototype.La=function(){return this.a.concat()},fj.prototype.asArray=fj.prototype.La,fj.prototype.flush=function(){for(var e=this.a.length;e--;)ij(this,e)},fj.prototype.flush=fj.prototype.flush,fj.prototype.o=function(){this.flush(),fj.j.o.call(this)},fj.prototype.A={he:"add",je:"remove",ke:"set",Xo:"move"};function hj(e,o,s,h,d,g){hj.j.constructor.call(this,o,e),this.idx=s,this.added=h,this.removed=d,this.moved=g}u(hj,ud),fj.Event=hj;function jj(){}function kj(e){return yd(1,zd(0,.5-Ed(Ld(Rd+Qd*e/180))/Pd/2))}jj.prototype.Tf=function(e,o,s){return s?(s.x=o/360+.5,s.y=kj(e)):s=new J(o/360+.5,kj(e)),s},jj.prototype.latLngToPoint=jj.prototype.Tf,jj.prototype.Pc=function(e,o){return this.Tf(e.lat,e.lng,o)},jj.prototype.geoToPoint=jj.prototype.Pc;function lj(e){return 0>=e?90:1<=e?-90:Vd*(2*Md(Hd(Pd*(1-2*e)))-Qd)}jj.prototype.Ra=function(e,o,s){return s?(s.lat=lj(o),s.lng=360*(e===1?1:Zd(e,1))-180):s=new kg(lj(o),360*(e===1?1:Zd(e,1))-180),s},jj.prototype.xyToGeo=jj.prototype.Ra,jj.prototype.dg=function(e,o){return this.Ra(e.x,e.y,o)},jj.prototype.pointToGeo=jj.prototype.dg;var mj=new jj;t("H.geo.mercator",mj),t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0),t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function nj(e,o){this.projection=e||mj,this.b=0,this.a=this.exp=Ed(o||256)/Od,oj(this),this.y=this.x=0}t("H.geo.PixelProjection",nj);var pj=Dd(24)+Dd(-8);nj.prototype.eg=mj,nj.prototype.projection=nj.prototype.eg,nj.prototype.x=0,nj.prototype.x=nj.prototype.x,nj.prototype.y=0,nj.prototype.y=nj.prototype.y,nj.prototype.Oo=Gd(2,pj),nj.prototype.w=nj.prototype.Oo,nj.prototype.ln=Gd(2,pj),nj.prototype.h=nj.prototype.ln,nj.prototype.Oa=function(e){if(E(e))throw new D(this.Oa,0,e);var o=this.x/this.w,s=this.y/this.h;this.b=e,this.a=this.exp+e,oj(this),this.x=o*this.w,this.y=s*this.h},nj.prototype.rescale=nj.prototype.Oa;function oj(e){e.a>pj&&(e.a=pj),e.w=Gd(2,e.a),e.h=Gd(2,e.a)}nj.prototype.Jj=function(){return this.b||0},nj.prototype.getZoomScale=nj.prototype.Jj,nj.prototype.ib=function(e,o){return e=this.projection.Tf(e.lat,e.lng,o),e.x=e.x*this.w-this.x,e.y=e.y*this.h-this.y,e},nj.prototype.geoToPixel=nj.prototype.ib,nj.prototype.Re=function(e,o){return this.projection.Ra((e.x+this.x)/this.w,(e.y+this.y)/this.h,o)},nj.prototype.pixelToGeo=nj.prototype.Re,nj.prototype.Ra=function(e,o,s){return this.projection.Ra((e+this.x)/this.w,(o+this.y)/this.h,s)},nj.prototype.xyToGeo=nj.prototype.Ra,nj.prototype.Ah=function(e,o,s){return e=this.projection.Tf(e,o,s),e.x=e.x*this.w-this.x,e.y=e.y*this.h-this.y,e},nj.prototype.latLngToPixel=nj.prototype.Ah,nj.prototype.Zd=function(e){return new J(e.x*this.w-this.x,e.y*this.h-this.y)},nj.prototype.pointToPixel=nj.prototype.Zd;function qj(e){e=e||{},qj.j.constructor.call(this),this.min=0,this.max=22,this.yl=this.dark=!!e.dark,e.min&&this.ui(e.min),e.max&&this.si(e.max),this.pixelProjection=new nj(e.projection,e.minWorldSize),e.provider&&(this.ma=e.provider,this.Va=A(this.Va,this),this.ma.addEventListener(P.prototype.A.za,this.Va,!1,this),this.hb=A(this.hb,this),this.ma.addEventListener(P.prototype.A.ie,this.hb,!1,this))}u(qj,F),t("H.map.layer.Layer",qj),qj.prototype.min=0,qj.prototype.min=qj.prototype.min,qj.prototype.max=22,qj.prototype.max=qj.prototype.max,qj.prototype.A={za:"update",ie:"configchange",Ti:"minchange",Si:"maxchange"},qj.prototype.ca=function(){return this.ma},qj.prototype.getProvider=qj.prototype.ca,qj.prototype.un=function(e){return this.min<=e&&e<=this.max},qj.prototype.isValid=qj.prototype.un;function rj(e,o,s){var h=e[o],d=o==="min",g=d?e.ui:e.si;if(s!==h)if(d?s<=e.max:s>=e.min)e[o]=s,e.Va(),e.hb(),e.dispatchEvent(new cj(d?e.A.Ti:e.A.Si,s,h));else throw new D(g,0,"Invalid condition min <= max");return e}qj.prototype.ui=function(e){return rj(this,"min",+e)},qj.prototype.setMin=qj.prototype.ui,qj.prototype.si=function(e){return rj(this,"max",+e)},qj.prototype.setMax=qj.prototype.si,qj.prototype.Va=function(){this.dispatchEvent(this.A.za)},qj.prototype.hb=function(e){e=new cj(this.A.ie,e&&e.newValue,e&&e.oldValue),this.dispatchEvent(e)},qj.prototype.o=function(){qj.j.o.call(this)},qj.prototype.ba=function(){return null},qj.prototype.getCopyrights=qj.prototype.ba;function sj(e){var o;if(sj.j.constructor.call(this),this.dispatchEvent=A(this.dispatchEvent,this),e){var s=e.length;for(o=0;o<s;o++)this.add(e[o])}}u(sj,fj),t("H.map.DataModel",sj);function tj(e,o){var s=o.getProvider&&o.getProvider();s&&(uj[s.uid]=s),o.ka(e)}function vj(e){var o=e.getProvider&&e.getProvider();o&&delete uj[o.uid],e.ka(null)}sj.prototype.add=function(e,o){C(e,qj,this.add,0),tj(this,e),sj.j.add.call(this,e,o)},sj.prototype.add=sj.prototype.add,sj.prototype.set=function(e,o){return C(o,qj,this.set,0),tj(this,o),(e=sj.j.set.call(this,e,o))&&vj(e),e},sj.prototype.set=sj.prototype.set,sj.prototype.hc=function(e){var o;return(o=sj.j.hc.call(this,e))&&vj(o),o},sj.prototype.removeAt=sj.prototype.hc,sj.prototype.remove=function(e){var o;return(o=sj.j.remove.call(this,e))&&vj(e),o},sj.prototype.remove=sj.prototype.remove,sj.prototype.flush=function(){for(var e=this.a.length;e--;)this.hc(e);sj.j.flush.call(this)},sj.prototype.flush=sj.prototype.flush;var uj={};Ic(uj);function wj(e,o,s){if(e=uj[e])return C(e[o],Function,wj,1,"invalid method"),e[o].apply(e,s)}sj.invoke=wj;function xj(e,o){Da(e)&&(this.i=e),Fc(o)&&(this.a=o)}t("H.util.Request",xj),xj.State={PENDING:0,PROCESSING:1,COMPLETE:2,CANCELLED:3,ERROR:4};var yj=[0,1,2,3,4];xj.prototype.C=0,xj.prototype.getState=function(){return this.C},xj.prototype.getState=xj.prototype.getState,xj.prototype.O=function(e){if(0>yj.indexOf(e))throw new D(this.O,0,e);(this.C!==e||e===1&&1<this.a)&&(this.C=e,this.i&&this.i(this))},xj.prototype.a=1,xj.prototype.cn=function(){return this.a},xj.prototype.getTotal=xj.prototype.cn,xj.prototype.b=0,xj.prototype.Om=function(){return this.b},xj.prototype.getProcessed=xj.prototype.Om,xj.prototype.g=0,xj.prototype.hm=function(){return this.g},xj.prototype.getFailed=xj.prototype.hm;function zj(e,o){e.b<e.a&&(vc(o)||(o=2),o===0||o===1||e.C!==0&&e.C!==1||(e.b++,o!==2&&e.g++,e.O(e.b<e.a?1:2)))}xj.prototype.oe=function(){},xj.prototype.cancel=function(){this.C!==3&&(this.oe(),this.O(3))},xj.prototype.cancel=xj.prototype.cancel;function Aj(){}t("H.util.ICapturable",Aj),Aj.prototype.capture=function(){},Aj.prototype.capture=Aj.prototype.capture,t("H.util.Disposable",qd),qd.prototype.tb=qd.prototype.tb,qd.prototype.addOnDisposeCallback=qd.prototype.tb,t("H.util.dispose",td),qd.prototype.F=qd.prototype.F,qd.prototype.dispose=qd.prototype.F,qd.prototype.o=qd.prototype.o,qd.prototype.disposeInternal=qd.prototype.o;function Bj(e,o){var s=e.N(),h=s.ownerDocument;Bj.j.constructor.call(this),this.a=e,this.S=s=s.appendChild(Cj(h,"DIV","position:absolute;bottom:0;right:0;left:0px;z-index:1;direction:ltr;pointer-events:none;height:40px-webkit-touch-callout: none;-webkit-user-select:none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select:none;",null,"H_imprint")),this.qf=Cj(h,"DIV","margin: 0 0 16px 16px;display:inline-block;",'<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>',"H_logo"),s.appendChild(this.qf),s=s.appendChild(Cj(h,"DIV","right:0;bottom:0;position:absolute;background-color:rgba(255,255,255,.8);color:#0F1621;padding:2px 16px",null,"H_copyright")),this.i=s.appendChild(Cj(h,"A","color:inherit; margin:0px 8px; text-decoration:none; pointer-events:all;","Terms of use")),this.i.target="_blank",this.g=s.appendChild(Cj(h,"SPAN","margin:0px 8px")),this.c=s.appendChild(Cj(h,"SPAN")),this.s=Wa(Dj),this.vi(o),this.f=A(this.f,this),this.b=A(this.b,this),this.a.addEventListener(this.a.A.Ri,this.f),this.a.a.addEventListener("add",this.b),this.a.a.addEventListener("remove",this.b),this.a.a.addEventListener("set",this.b),this.b()}var Ej;u(Bj,qd),t("H.map.Imprint",Bj);var Dj={font:'11px "Lucida Grande", Arial, Helvetica, sans-serif',href:"https://legal.here.com/{LN}/terms/serviceterms/{CN}",invert:!1,reportHref:"https://wego.here.com/",locale:"en-US",mark:""};Bj.prototype.vi=function(e){var o,s=this.qf.firstElementChild.firstElementChild.children;e||(this.s=Wa(Dj));var h=this.s;for(o in h)e&&o in e&&(h[o]=e[o]);e=(this.wh=e=h.invert)?Fj:Gj,s[0].style.fill=e.Wk,s[0].style.fillOpacity=""+e.Xk,s[1].style.fill=e.al,s[1].style.fillOpacity=""+e.bl,e=h.locale,Hj[e]||(e="en-US",h.locale=e),this.i.innerHTML=Hj[e],e=e.split("-"),this.i.href=h.href.replace("{LN}",e[0]).replace("{CN}",e[1].toLowerCase()),h.mark?(this.c.innerHTML=h.mark,this.c.style.margin="0px 8px"):(this.c.innerHTML="",this.c.style.margin="0px"),this.S.style.font=h.font},Bj.prototype.setOptions=Bj.prototype.vi;function Cj(e,o,s,h,d){return e=e.createElement(o),s&&(e.style.cssText=s),h&&(e.innerHTML=h),d&&(e.className=d),e}Bj.prototype.N=function(){return this.S},Bj.prototype.f=function(){this.g.innerHTML=this.l+" "+this.ba()},Bj.prototype.b=function(){this.f(),setTimeout(this.f,5e3)};var Gj={al:"#0F1621",bl:.3,Wk:"#fff",Xk:.6},Fj={al:"#fff",bl:1,Wk:"#0F1621",Xk:.7},Ij="1987&ndash;"+zd(2015,new Date().getFullYear())+" HERE";Bj.prototype.ba=function(){var e=this.a,o=e.pb(),s=e.c.jb().bounds;e=e.a;var h=e.a.length,d={},g=0,_,j,$,_t=[Ij];if(s){for(;g<h;g++)if(j=e.get(g).getCopyrights(s.K(),o))for(_=0;_<j.length;_++)d[$=j[_].label]||(_t.push($),d[$]=1)}return _t.join(", ")},Bj.prototype.getCopyrights=Bj.prototype.ba,Bj.prototype.V=function(){return this.S.style},Bj.prototype.l="©",Bj.prototype.o=function(){if(this.a.removeEventListener(this.a.A.Ri,this.f),this.a.a.removeEventListener("add",this.b),this.a.a.removeEventListener("remove",this.b),this.a.a.removeEventListener("set",this.b),this.S.parentNode){var e=this.S;e.parentNode.removeChild(e)}},Bj.prototype.disposeInternal=Bj.prototype.o,Bj.prototype.capture=function(e,o,s,h){var d=e.getContext("2d"),g=window.getComputedStyle(this.g.parentElement),_=2*Dc(g.paddingLeft,10),j=(this.g.offsetWidth+2*_)*o,$=this.g.offsetHeight*o,_t=this.c.innerHTML.length!==0?this.c.offsetWidth*o:0,_e=Ec(g.getPropertyValue("font-size")),_r=this.S.ownerDocument,_n=+e.width,_o=+e.height,ga=16*o,_l=this.qf.childNodes[0].getBoundingClientRect(),_f=_l.width*o,_c=_l.height*o,_p=ld;Da(h)&&(_p=function(){h("capture_error")}),d.fillStyle=g.backgroundColor,d.fillRect(_n-j-_t,_o-$,j+_t,$),j=this.c.innerHTML,j=this.l+" "+function(_g){return _g=Cj(_r,"div",null,_g),_g.textContent||_g.innerText||""}(this.ba())+(j?" "+j:""),d.font=_e*o+"px "+g.getPropertyValue("font-family"),d.fillStyle=g.getPropertyValue("color"),d.textBaseline="bottom",d.textAlign="right",d.fillText(j,_n-_*o,_o),Jj(this,d.font,function(_g){new tf("image",_g).then(function(ty){d.drawImage(ty,ga,_o-(_c+ga),_f,_c),s(e)},_p)},_p)},Bj.prototype.capture=Bj.prototype.capture;function Jj(e,o,s,h){Kj(A(function(d){d?this.wh?s("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAADNklEQVRYR82XW6hVVRSGv7+rmJfSMKSnSkMEfY7EogcJC7tilGRopBAiSaI+SBARQSCIIqgFISih2YW0oAgLCsKXojA0RB+81VugZEFZv/yHuWTt7d7Hfc4+6+h4OWefNfcc3xlj/v+YS1zjoab5bE8DZgGngB8keSg5GwO0PQ54F3i2BnQIWCLpx14hGwG0fT3wOfBwB5DzwOOSDvQC2RTgM8Ae4D/gaeA3YDdwN5AWvyxp+6gD2r4OmAq8AbwInAMmA/OAT4CbgBWStvYClzUjWkHbrwHLgF8LVHJ8DDxah7P9JHCil7M40oA/A7OBC8ANtSqlrQOVs30/8CWQat8r6cxg1RwRQNvPA88Bk4D7gJzBV4A5teSp5MlS4VuA/ZIeu1Kr+wa0/QTwIRDlRhT5eTswBvi2CKOd42AULilndNAYCcA7gK+BmbVMiyXtsh3Qt4FFBTgW8w6wXtLfV4LrSyS2FwAvAWOBX+JtwF0laUDmS/oun23fDNwJnJb0Ty9g1ZphVdB2qrK2LdFfBbb685/AIxXkUKDqa4cMaDs2kjalRe8Fola57J3qRQSJviGHA3gMuAdYI2lDUfDOArQLWAd8VTuTOW9vjUoFy6TIGYpS9wKfAjuK5wVuSfn91iKcvZJeHy5ci0hsZwzNk5Qh3xIFbLyks7aPAtPLgv+L4VZwDwLvA6uKz6XdfcVAi22PBz4q4+lVSRurXW2vKYKIZfwEHCmmXC35HngAyITYD0ys2t8XWflyBfhmvKm24QCk7aVFCPVc7WMszzKucknI+NoHPCUppt13VICZm2nNwjoksByY0SXL72Vi3FieZ97mgrpyqF432H9xScW2O0H+W6oSE/4D2FYuA9kzlUzVTwO3Ad9IOtx3ydo2aLGZLpABm5KW2Z4AfAbMLfsEcpGkKLqRuMwHu0CukrSpCCrvGlF6hBEVL5MUw24kOhp1B8gc+FTqgxpkFLuzSbjk6jpJOkC2tDPeKCkVbDRkO67fDTTC2VK7vgfyBUlfNEpV2zyAK4HNXRLmZfshScdHC6g9T+WDGU2XpkdZdNXhWs6g7dXAhmsJ7jKR2M77bG4kV7Wt9TZfBLgYEC7PSpcIAAAAAElFTkSuQmCC"):s("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIMSURBVFiFzdZPiE1RGADwXzPTTPIMQoodVpbKgpoUG5qExUi8DSVJQv4slJJsbNjYWFhNETWLUUosRDRLUVLCYhIiojFojHkW997uvefNGIuZc99Xp/fOO6/Or++c75xDi0d7hDlWYQNqeB9hvv+OGq6jUWjPsKZKVBbtuKOMy9p3bKqOlsROCWYc27AWr9PfJnCgKlgbluNqivmGDmzBrxR3sCocnMEw7sqXdEAzboeK9uLTFPVbed8VcesxglFJtqNEHbcxlIL68ChADuCSpEgauBULt11SDI3C5yJJdrLCCNsQumMBl+J5AKinY4slBfNTfsRcxJwYsK0YxD3J0r1RPut6Cv/twgp0xoDBBc3LNhr0RwJktNifAn7gsnLmsuxVinyVTn4i7dcLoH4sU96Tp2Pi2uSVehN75Gdev+QO7pIXztmZnLwTvf+AzU+/v5Rn50+A24gP2IW5M4mbJ7+ejgVjJ/EpHXuCa8p77nGK68FX5eWfsTgfTJoh92qu1vAaa+CtPJuDZuEh3CHZUyHyxSSYrL3DWKE/gStm8aybDDkmKYperJM/BrJMnsJuHMLq2YJNh/wsX7JuPAyQfTFg0yGPFMZreCCv4n2xgTQjxyXP+CxquK8iXBYhMlzOtliQBVg4RVuCG/iSto/YHAuWxWFTHyXDWBkbNFkc1cK4LI5rYVwW57QY7i/pZeJv8QQJRQAAAABJRU5ErkJggg=="):(d=this.qf.cloneNode(!0),d.firstChild.setAttribute("style","font:"+o),s(bf(d.innerHTML)))},e),h)}Bj.prototype.wh=!1;function Kj(e,o){var s="data:image/svg+xml;charset=utf-8,"+encodeURIComponent('<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>'),h=Ej;vc(h)?e(h):new tf("image",s).then(function(d){Ye.drawImage(d,0,0);try{Ye.getImageData(0,0,1,1),h=!1}catch(g){h=g.code===18}finally{Ej=h,e(h)}},o)}Bj.prototype.nl=function(e,o){Hj[e]=o},Bj.prototype.addL11NString=Bj.prototype.nl;var Hj={"de-DE":"Nutzungsbedingungen","en-US":"Terms of use","en-GB":"Terms of use","es-ES":"Condiciones de uso","fi-FI":"Palveluehdot","fr-FR":"Conditions d'utilisation","it-IT":"Condizioni di utilizzo","nl-NL":"Dienstvoorwaarden","pl-PL":"Warunki świadczenia usługi","pt-BR":"Termos de serviço","pt-PT":"Termos do serviço","ru-RU":"Условия использования","tr-TR":"Servis Koşulları","zh-CN":"使用条款"};function R(e){var o={};this.f=o.previousSibling=o.nextSibling=o,this.g=new cf,R.j.constructor.call(this,e),e&&"objects"in e&&this.Xb(e.objects)}u(R,M),t("H.map.Group",R),R.prototype.type=nh.GROUP,R.prototype.ee=function(e,o){return this.b=!0,e=R.j.ee.call(this,e,o),this.b=!1,e&&this.forEach(Lj,!0),e},R.prototype.setProvider=R.prototype.ee;function Lj(e,o,s){e.ee(s.ma)}R.prototype.contains=function(e){var o=this===e;if(!o&&this.a&&C(e,M))for(;!o&&e;)e===this?o=!0:e=e.Fa;return o},R.prototype.contains=R.prototype.contains,R.prototype.Ye=function(){this.L=B,this.forEach(Mj,!0)},R.prototype.resetZInfo=R.prototype.Ye;function Mj(e){e.Ye()}R.prototype.b=!1,R.prototype.ra=function(e){var o=R.j.ra.call(this,e);return o&&!this.b&&(this.c=e,this.forEach(Nj,!0),delete this.c),o},R.prototype.invalidate=R.prototype.ra;function Nj(e,o,s){e.ra(s.c)}R.prototype.forEach=function(e,o,s){var h;if(this.a){var d=this.f,g=d.nextSibling;for(h=0;g!==d;){var _=g.nextSibling;e.call(s,g,h++,this),o&&C(g,R)&&g.forEach(e,o,s),g=_}}},R.prototype.forEach=R.prototype.forEach,R.prototype.Ua=function(e){var o=[];return this.forEach(Oj,e,o),o},R.prototype.getObjects=R.prototype.Ua,R.prototype.K=function(){var e=null;return this.a&&this.forEach(function(o){o.K&&(o=o.K())&&(e?e=e.ec(o):e=o)}),e},R.prototype.getBoundingBox=R.prototype.K;function Oj(e){this.push(e)}R.prototype.a=0,R.prototype.Rl=function(){return this.a},R.prototype.getChildCount=R.prototype.Rl,R.prototype.fa=function(e){var o=this.f,s=o.previousSibling;if(C(e,M,this.fa,0),e.contains(this))throw new $c(this.fa,"The new object contains the parent group");var h=e.Lf(!0),d=e.Fa;if(d!==this){if(d){d=e.previousSibling;var g=e.nextSibling;d.nextSibling=g,g.previousSibling=d}e.Fa=this,M.j.ka.call(e,this),s.nextSibling=e,e.previousSibling=s,e.nextSibling=o,o.previousSibling=e,this.a++}return e.Di=this.g.next(),e.Ye(),o=e.ee(this.ma,this.fa),e.Lf(!0)!==h&&e.ra(kh.VOLATILITY),o||e.ra(kh.Z_ORDER),e},R.prototype.addObject=R.prototype.fa,R.prototype.Xb=function(e){var o;Bc(e,this.Xb,0);var s=e.length;for(o=0;o<s;o++)this.fa(e[o])},R.prototype.addObjects=R.prototype.Xb,R.prototype.Ga=function(e){if(!e||e.Fa!==this)throw new $c(this.Ga,"object not found");var o=e.previousSibling,s=e.nextSibling;return o.nextSibling=s,s.previousSibling=o,e.Fa=null,M.j.ka.call(e,null),delete e.previousSibling,delete e.nextSibling,C(e.ma,N)&&e.ee(null,this.Ga),this.a--,e},R.prototype.removeObject=R.prototype.Ga,R.prototype.rd=function(e){var o;Bc(e,this.rd,0);var s=e.length;for(o=0;o<s;o++)this.Ga(e[o])},R.prototype.removeObjects=R.prototype.rd,R.prototype.na=function(){var e=this.Ua();this.rd(e)},R.prototype.removeAll=R.prototype.na,R.prototype.Kc=function(e){for(var o=this.Ua(),s=0,h=o.length,d=[],g,_,j;s<h;s++)j=o[s],j instanceof R?(g=e?e(j.getData()):j.getData(),_=qh(this,g,!!e),g={type:"Feature"},g.properties=_,j.i&&(g.id=j.i),g.geometry={},g.geometry.type="GeometryCollection",g.geometry.geometries=Pj(this,j.Ua()),d.push(g)):d.push(j.Kc(e));return{type:"FeatureCollection",features:d}},R.prototype.toGeoJSON=R.prototype.Kc;function Pj(e,o){for(var s=0,h=o.length,d,g,_=[];s<h;s++)d=o[s],d instanceof R?g={type:"GeometryCollection",geometries:Pj(e,d.Ua())}:d instanceof rh||d instanceof sh||d instanceof th||d instanceof uh?g=d.ga().Kc():g={type:"FeatureCollection",features:hf},_.push(g);return _}R.prototype.Y=function(){var e=R.j.Y.call(this);return e.type="Group",e},R.prototype.forWorkerMessage=R.prototype.Y;var Qj={PROVIDES_BY_VIEWPORT:1,PROVIDES_RASTERS:2,PROVIDES_SPATIALS:4,PROVIDES_OVERLAYS:8,PROVIDES_MARKERS:16,PROVIDES_DOM_MARKERS:32,PROVIDES_GEOJSON:64,PROVIDES_OMV:128,CROP_LINES_BY_TILE:256,CROP_POLYGONS_BY_TILE:512,HAS_VOLATILE_DATA:1024};t("H.map.provider.Capabilities",Qj),Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS=Qj.PROVIDES_SPATIALS|Qj.PROVIDES_OVERLAYS|Qj.PROVIDES_MARKERS;function Rj(e,o,s,h,d){switch(o&&(this.f=o),vc(s)&&(this.c=!!s),this.c&&h&&(this.Lg=new Wi(h.w,h.h)),vc(d)&&(this.g={crossOrigin:d}),Sj[Ac(e)]){case 2:this.a=e,Tj(this,1);break;case 1:if(nf(e)){this.a=e,Uj(this),Tj(this,1);break}e=e.src;case 0:if(e){e=bf(e),this.b=new tf("image",e,B,this.g),this.b.then(A(this.$n,this),A(this.Zn,this));break}default:throw Tj(this,-1),new D(Rj,0,"No image data")}}Rj.prototype.C=0,Rj.prototype.getState=function(){return this.C};function Tj(e,o){e.C=o,delete e.b,e.f&&e.f(o,e)}Rj.prototype.c=!0;function Uj(e){if(e.c){var o=e.a,s=Vj(e),h=s&&s.w||+o.width,d=s&&s.h||+o.height,g=Ue();if(C(o,x.HTMLCanvasElement))s=o;else{s=o.ownerDocument.createElement("canvas"),s.width=Cd(h*g),s.height=Cd(d*g);var _=s.getContext("2d");_.scale(g,g),_.drawImage(o,0,0,h,d),cd&&(_.clearRect(0,0,h,d),_.drawImage(o,0,0,h,d))}e.a=s}}Rj.prototype.getData=function(){return this.a||z};var Sj={String:0,HTMLImageElement:1,HTMLCanvasElement:2};p=Rj.prototype,p.Lg=z,p.yb=function(){return this.C===1?Vj(this):z};function Vj(e){var o=e.Lg,s;if(!o){var h=e.a;if(o=h.naturalWidth||h.width,o===0&&$e&&Sj[Ac(h)]===1){var d=!0;if(s=h.parentNode)var g=h.nextSibling;document.body.appendChild(h)}e.Lg=o=new Wi(h.naturalWidth||h.width,h.naturalHeight||h.height),d&&(s?s.insertBefore(h,g):document.body.removeChild(h))}return o}p.$n=function(e){this.a=e,Uj(this),Tj(this,1)},p.Zn=function(){Tj(this,-1)},p.cancel=function(){this.b&&this.b.cancel()};function Wj(e,o){var s,h="anonymous";if(this.uid=Xj.next(),Wj.j.constructor.call(this),o){var d="size";if(d in o){var g=o[d];if(!g||isNaN(g.w)||isNaN(g.h))throw new D(Wj,1,d);this.g=new Wi(g.w,g.h)}if(d="anchor",d in o){if(g=o[d],!g||isNaN(g.x)||isNaN(g.y))throw new D(Wj,1,d);this.f=new J(g.x,g.y)}d="hitArea",d in o&&(g=o[d],C(g,Xi,Wj,1),this.c=o[d]),d="asCanvas",d in o&&(s=o[d]),d="crossOrigin",d in o&&(h=o[d]),g=o.stickHeight,g===+g&&0<g&&(this.Fo=g),d="stickColor",g=o[d],d in o&&Cc(g)&&(this.Eo=g)}e=new Rj(e,A(this.i,this),s,this.g,h),o=this.C=e.getState(),o!==0?this.i(o,e):this.b=e}u(Wj,F),t("H.map.Icon",Wj);var Xj=new cf;Wj.State={ERROR:-1,LOADING:0,READY:1},Wj.prototype.getState=function(){return this.C},Wj.prototype.getState=Wj.prototype.getState,Wj.prototype.i=function(e,o){if(this.a=o.getData(),e===1){var s=this.g;s||(s=this.g=o.yb()),this.f||(this.f=new J(s.w/2|0,s.h))}this.b&&(this.C=e,delete this.b,this.dispatchEvent("statechange"))},Wj.prototype.a=z,Wj.prototype.Qc=function(){return this.a},Wj.prototype.getBitmap=Wj.prototype.Qc,Wj.prototype.yb=function(){return this.g||z},Wj.prototype.getSize=Wj.prototype.yb,Wj.prototype.f=z,Wj.prototype.kd=function(){return this.f},Wj.prototype.getAnchor=Wj.prototype.kd,Wj.prototype.c=z,Wj.prototype.nm=function(){return this.c},Wj.prototype.getHitArea=Wj.prototype.nm,Wj.prototype.o=function(){Wj.j.o.call(this),this.a?(this.a.removeAttribute("src"),delete this.a):(this.b.cancel(),delete this.b)};function Yj(e,o,s,h,d,g){Yj.j.constructor.call(this,isNaN(e)?15:e,o,s,h,d,g)}u(Yj,wg),Yj.prototype.s=function(e){for(var o,s,h=this.head,d=e;d;){if(e=d.entries){if(o=e.length){if(2>o&&(s=d.parent)&&s.a===1){s.removeChild(d),h===d&&(h=s),s.entries=e,d=e[0].node=s;continue}}else if(delete d.entries,(s=d.parent)&&(s.removeChild(d),h===d&&(h=s),s.a===1)){d=s.a?s[0]||s[1]||s[2]||s[3]:null;continue}}break}this.head!==h&&(this.head=h,Bg(this))},Yj.prototype.yc=function(e,o){if(Gg(this.a,e,o,e,o))return Zj(this,this.a,e,o,this.c);throw Error("Coordinates out of bounds")};function Zj(e,o,s,h,d){var g=o.entries;if(d)if(o.a)g=ak(e,o,s,h,d);else if(g){g=g[0];var _=Eg(o,+(g[1]>=o[8])|+(g[0]>=o[9])<<1);_.entries=o.entries,delete o.entries,g.node=_,Bg(e,_),g=ak(e,o,s,h,d)}else Fg(o,g=new bk(s,h)),Bg(e,o),zg(e,g,!0);else g||Bg(e,o),Fg(o,g=new bk(s,h)),zg(e,g,!0);return g}function ak(e,o,s,h,d){return Zj(e,Eg(o,+(s>=o[8])|+(h>=o[9])<<1),s,h,d-1)}function bk(e,o){this.id=Dg++,this[0]=o,this[1]=e}bk.prototype.a=function(e){return this[e%2]};function ck(){this.a=new Yj(10,180,90,0,0,!0)}p=ck.prototype,p.Dh=0,p.Rc=function(){return this.Dh},p.Uf=null,p.K=function(){var e=this.Uf,o;return!e&&(o=xg(this.a))&&(this.Uf=e=new K(-o[0],o[3],-o[2],o[1])),e},p.yc=function(e){return++this.Dh,this.Uf=null,this.a.yc(e.lng,-e.lat)},p.remove=function(e){return(e=this.a.remove(e))&&(--this.Dh,this.Uf=null),e},p.Pf=function(e,o,s){var h=this.a,d=e.Nb(),g=e.Jb(),_=-d.lat;d=d.lng;var j=-g.lat;g=g.lng;var $;return e.Bb()?$=h.Za(-180,_,g,j,s,o).concat(h.Za(d,_,180,j,s,o)):$=h.Za(d,_,g,j,s,o),$};function dk(e){this.a=e}function ek(e,o,s){this.c=e,this.a=o,this.g=s,this.f=this.c&Qj.PROVIDES_BY_VIEWPORT?"function(){return sources[$source].isInMinMaxRange(feature, $zoom) && feature.ref.effectiveVisibility;}":B,this.b={}}function fk(e,o,s,h){this.a=e,this.b=o,this.c=s,this.kf=h}function gk(e,o,s,h){return e={type:o,uid:e.b,tiled:s,max_zoom:e.c},h&&Ya(e,h),e}function hk(e,o,s,h,d){this.a=e,this.b=o,this.c=s,this.f=h,this.kf=d}function ik(e){if(e.a&Qj.PROVIDES_DOM_MARKERS&&!(e.a&Qj.PROVIDES_MARKERS))return{};var o=new fk(e.a,e.b,e.c,e.kf),s=new dk(e.a);e=new ek(e.a,e.b,e.f);var h={},d=o.b;if(o=o.a&Qj.PROVIDES_BY_VIEWPORT?gk(o,"ObjectSource",!1,{progressiveUpdate:!0,has_volatile_data:!!(o.a&Qj.HAS_VOLATILE_DATA)}):o.a&Qj.PROVIDES_RASTERS?gk(o,"RemoteRasterTileSource",!0,{url:""}):gk(o,"ObjectTileSource",!0,{tile_size:o.kf}),h[d]=o,o={},s.a&Qj.PROVIDES_RASTERS&&(o={"translucent-raster":qi("raster","inlay",1)}),s.a&Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS){d=!!(s.a&Qj.CROP_LINES_BY_TILE);var g={"translucent-polygons":qi("polygons","inlay",2),"translucent-extruded-polygons":qi("polygons","translucent",3),"translucent-pattern-lines":qi("pattern-lines","translucent",4),"translucent-overlays":qi("overlays","inlay",5),markers:qi("custom_icons","overlay",6,!1)};g["translucent-polygons"].crop_by_tile=!!(s.a&Qj.CROP_POLYGONS_BY_TILE),g["translucent-pattern-lines"].crop_by_tile=d,g.markers.suppress_fade=!0,g.markers.stick=!0,Ya(o,g)}if(e.c&Qj.PROVIDES_RASTERS&&(e.b["tile_layer_"+e.a]=si(e.a,"_default",{"translucent-raster":{color:[1,1,1,e.g],order:0}})),e.c&Qj.PROVIDES_SPATIALS){s={"translucent-pattern-lines":{color:pi("strokeColor"),width:pi("lineWidth * $meters_per_pixel"),join:pi("lineJoin"),cap:pi("lineCap"),tail_cap:pi("lineTailCap"),head_cap:pi("lineHeadCap"),miter_limit:pi("miterLimit"),order:"function() { return 2 + feature.effectiveZIdx / 2; }",interactive:!0,dash:pi("lineDash"),extrude:!0,dash_phase:pi("lineDashOffset")}},d=e.b,g="polygon_layer_"+e.a;var _=si(e.a,"polygons",void 0,e.f);_.flat={filter:"function(){return !feature.height && !feature.min_height;}",draw:ri(!1)},_.extruded={filter:"function(){return feature.height || feature.min_height;}",draw:ri(!0)},d[g]=_,e.b["outline_layer_"+e.a]=si(e.a,"outlines",s,e.f),e.b["polyline_layer_"+e.a]=si(e.a,"polylines",s,e.f)}return e.c&Qj.PROVIDES_OVERLAYS&&(e.b["overlay_layer_"+e.a]=si(e.a,"overlays",{"translucent-overlays":{color:[1,1,1,e.g],order:8190,interactive:!0}})),e.c&Qj.PROVIDES_MARKERS&&(e.b["marker_layer_"+e.a]=si(e.a,"markers",{markers:{sprite:oi("icon.id"),offset:oi("icon.offset"),collide:!1,priority:8191,elevate_by_altitude:!0,interactive:!0,stick:{color:oi("icon.stick_color"),height:oi("icon.stick_height")}}},e.f)),{sources:h,styles:o,layers:e.b}}function P(e){var o=""+ef(),s;if(P.j.constructor.call(this),e=e||{},this.min=e.min||0,this.max=e.max||22,s=e.uri){if(/_/.test(s))throw new D(P,0,"uri "+s)}else s=o;if(this.uri=s||o,this.uid=o,e.getCopyrights&&zc(e.getCopyrights,"Function",P)&&(this.getCopyrights=e.getCopyrights),this.hb=this.hb.bind(this),this.ta=!0,this.b=e.engineType||jk,this.b===kk.HARP&&!H.map.render.harp)throw new D(P,0,"HARP engine is not supported, module not found")}u(P,F),t("H.map.provider.Provider",P),p=P.prototype,p.A={ie:"configchange",za:"update"},p.Va=function(e,o){this.dispatchEvent(new vd(this.A.za,o,e))},p.hb=function(e){e=new cj(this.A.ie,e&&e.newValue,e&&e.oldValue),this.dispatchEvent(e)},p.o=function(){F.prototype.o.call(this),this.a&&(this.a.removeEventListener("change",this.hb),this.a.F(),delete this.a)},p.ba=function(){return null},P.prototype.getCopyrights=P.prototype.ba,P.prototype.getCapabilities=function(){var e=0;return this.di()&&(e|=Qj.PROVIDES_BY_VIEWPORT),this.providesRasters()&&(e|=Qj.PROVIDES_RASTERS),this.providesSpatials()&&(e|=Qj.PROVIDES_SPATIALS),this.providesOverlays()&&(e|=Qj.PROVIDES_OVERLAYS),this.providesMarkers()&&(e|=Qj.PROVIDES_MARKERS),this.providesDomMarkers()&&(e|=Qj.PROVIDES_DOM_MARKERS),this.providesGeoJSON()&&(e|=Qj.PROVIDES_GEOJSON),this.providesOMV()&&(e|=Qj.PROVIDES_OMV),e},P.prototype.getCapabilities=P.prototype.getCapabilities,P.prototype.di=gf,P.prototype.Ve=gf,P.prototype.providesRasters=P.prototype.Ve,P.prototype.Cc=gf,P.prototype.providesSpatials=P.prototype.Cc,P.prototype.fi=gf,P.prototype.providesOverlays=P.prototype.fi,P.prototype.Rb=gf,P.prototype.providesMarkers=P.prototype.Rb,P.prototype.Qb=gf,P.prototype.providesDomMarkers=P.prototype.Qb,P.prototype.ei=gf,P.prototype.providesGeoJSON=P.prototype.ei,P.prototype.Sb=gf,P.prototype.providesOMV=P.prototype.Sb,P.prototype.dm=function(){return this.b},P.prototype.getEngineType=P.prototype.dm,P.prototype.wo=function(e){this.b=e},P.prototype.setEngineType=P.prototype.wo,P.prototype.Ue=ld,P.prototype.preprocessData=P.prototype.Ue,P.prototype.g=1;function lk(e,o){o=ae(o,0,1),E(o)&&(o=1),e.g!==o&&(e.g=o,e.ta&&mk(e),e.hb(),e.Va())}P.prototype.Em=function(){return this.g},P.prototype.getOpacityInternal=P.prototype.Em,P.prototype.Qa=function(e,o){var s=this;if(this.b===kk.WEBGL&&!C(e,ti)||this.b===kk.HARP&&!C(e,H.map.render.harp.Style))throw e=Object.entries(kk).find(function(h){return h[1]===s.b}),new D(this.Qa,0,"Invalid style for engineType "+e);this.a&&(this.a.removeEventListener("change",this.hb),this.a.removeEventListener(Yh,this.hb),this.a.F()),this.a=e,this.a.addEventListener("change",this.hb),this.a.addEventListener(Yh,this.hb),o||this.hb(),this.ta=!1},P.prototype.setStyleInternal=P.prototype.Qa,P.prototype.Ya=function(){return this.a||mk(this),this.a},P.prototype.getStyleInternal=P.prototype.Ya;function mk(e){if(e.b===kk.WEBGL){var o=new hk(e.getCapabilities(),e.uid,e.max,e.g,e.tileSize);e.a=new ti(ik(o))}else e.b===kk.HARP&&H.map.render.harp&&(e.a=new H.map.render.harp.Style({}));e.ta=!0}P.prototype.Ej=function(){var e=this.getCapabilities(),o=nk.FEATURE;return e&Qj.PROVIDES_BY_VIEWPORT?o=nk.SOURCE:e&Qj.PROVIDES_RASTERS?o=null:e&Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS&&(o=nk.PROVIDER),o},P.prototype.getPickingMode=P.prototype.Ej,P.prototype.im=function(){return!1},P.prototype.getFeatureProxy=P.prototype.im;function ok(e){var o;xc(this,ok),ok.j.constructor.call(this,e),this.wa=e=[];for(o in nh)e[nh[o]]=new jh}u(ok,P),t("H.map.provider.ObjectProvider",ok),ok.prototype.di=ff,ok.prototype.providesByViewport=ok.prototype.di,ok.prototype.Kb=function(e){return this.wa[e||nh.ANY]},ok.prototype.getInvalidations=ok.prototype.Kb,ok.prototype.Td=function(e,o){if(o!==kh.NONE){var s=this.wa[nh.ANY],h=s.a+1;s.update(h,o),s=this.wa[e.type],s.update(h,o),e.Kb().update(h,o),this.Va(e)}},ok.prototype.invalidateObject=ok.prototype.Td,ok.prototype.requestOverlays=ok.prototype.sd,ok.prototype.requestSpatials=ok.prototype.kg,ok.prototype.requestSpatialsByTile=ok.prototype.mg,ok.prototype.qa=!1,ok.prototype.requestMarkers=ok.prototype.Ec,ok.prototype.requestDomMarkers=ok.prototype.Dc;function N(e){e=e||{},N.j.constructor.call(this,e),this.f=e=new R({min:e.min,max:e.max}),e.ma=this,e.ka(this),e.ra(kh.ADD),this.J=new Lg,this.i=new Lg,this.m=new ck,this.u=new Lg,this.P=new ck,this.T=new Lg}u(N,ok),t("H.map.provider.LocalObjectProvider",N),N.prototype.getCapabilities=function(){return Qj.PROVIDES_BY_VIEWPORT|Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS|Qj.PROVIDES_DOM_MARKERS|Qj.CROP_LINES_BY_TILE},N.prototype.Ya=function(){if(!this.l&&(this.l=N.j.Ya.call(this),this.l instanceof ti)){var e=new hk(this.getCapabilities()|Qj.HAS_VOLATILE_DATA,this.uid+"_vol",this.max,this.g,this.tileSize);this.l.Oe(ik(e))}return this.l},N.prototype.getStyleInternal=N.prototype.Ya,N.prototype.Qa=function(e,o){N.j.Qa.call(this,e,o),this.l=null},N.prototype.setStyleInternal=N.prototype.Qa,N.prototype.bc=function(){return this.f},N.prototype.getRootGroup=N.prototype.bc,N.prototype.Td=function(e,o){o&kh.SPATIAL&&this.fa(e),N.j.Td.call(this,e,o)},N.prototype.invalidateObject=N.prototype.Td,N.prototype.fa=function(e){var o;if(C(e,M,this.fa,0),e.ma!==this)throw new $c(this.fa,"foreign object");this.Ga(e);var s=e.type;if(s===nh.MARKER)if((o=e.ga())instanceof kg){var h=!0;s=this.m}else s=this.u;else s===nh.DOM_MARKER?(o=e.ga())instanceof kg?(h=!0,s=this.P):s=this.T:s=s===nh.OVERLAY?this.J:this.i;h=h?s.yc(o):s.Pj(e.K()),h.c=e,e.qa=h},N.prototype.Ga=function(e){var o;if(e){if(e.ma!==this){if(C(e,M))throw new $c(this.Ga,"foreign object")}else if(o=e.qa){var s=e.type;s===nh.MARKER?this.m.remove(o)||this.u.remove(o):s===nh.DOM_MARKER?this.P.remove(o)||this.T.remove(o):s===nh.OVERLAY?this.J.remove(o):this.i.remove(o),delete o.c,delete e.qa}}},N.prototype.removeObject=N.prototype.Ga;function pk(e,o,s,h,d,g,_){if(_=_||[],o.Rc())for(e=o!==e.m&&o!==e.u,d=!d,o=o.Pf(s,g,g),s=o.length,g=0;g<s;g++){var j=o[g].c,$;if($=h!==void 0){for(var _t=Bd(h),_e=j;($=_e.m<=_t&&_e.s>=_t)&&(_e=_e.Fa););$=!$}$||!d&&!j.wc(!0)||(e||j.xb().getState()===1)&&_.push(j)}return _}N.prototype.fi=function(){return 0<this.J.Rc()},N.prototype.providesOverlays=N.prototype.fi,N.prototype.sd=function(e,o,s){return pk(this,this.J,e,o,s,!1).filter(function(h){return h.Qc()})},N.prototype.requestOverlays=N.prototype.sd,N.prototype.Cc=function(){return 0<this.i.Rc()},N.prototype.providesSpatials=N.prototype.Cc,N.prototype.kg=function(e,o,s){return pk(this,this.i,e,o,s,!1)},N.prototype.requestSpatials=N.prototype.kg,N.prototype.mg=function(e,o){return pk(this,this.i,e.Hf(),e.zL,o,!1)},N.prototype.requestSpatialsByTile=N.prototype.mg,N.prototype.Rb=function(){return 0<this.m.Rc()+this.u.Rc()},N.prototype.providesMarkers=N.prototype.Rb,N.prototype.Ec=function(e,o,s){return qk(this,e,o,s,!1)},N.prototype.requestMarkers=N.prototype.Ec;function qk(e,o,s,h,d){var g=pk(e,e.m,o,s,h,d);return pk(e,e.u,o,s,h,d,g),g}N.prototype.Qb=function(){return 0<this.P.Rc()+this.T.Rc()},N.prototype.providesDomMarkers=N.prototype.Qb,N.prototype.Dc=function(e,o,s){return rk(this,e,o,s,!1)},N.prototype.requestDomMarkers=N.prototype.Dc;function rk(e,o,s,h,d){var g=pk(e,e.P,o,s,h,d);return pk(e,e.T,o,s,h,d,g),g}function sk(e,o,s){var h=s.ga(),d,g=tk.bind(null,e);e=uk.bind(null,e),C(s,th)?d=C(h,L)?g(h):h.la.some(g):C(s,uh)?d=C(h,O)?e(h):h.la.some(e):C(s,sh)&&(d=e(Ci(h))),d&&o.push(s)}function tk(e,o){t:{var s=o.$,h=Hi(e,o);if(!h){o=o.$.length;for(var d=0;d<o;d+=3)if(Fi(e,s[d],s[d+1])){e=!0;break t}}e=h}return e}function uk(e,o){return Ii(e,o)}function vk(e,o,s){for(var h=e.length;h--;){var d=e[h],g=d.ga();if(C(g,Vi)){g=g.la;for(var _=g.length,j;_--;)if(j=g[_],Fi(o,j.lat,j.lng)){s.push(d);break}}else Fi(o,g.lat,g.lng)&&s.push(d)}}N.prototype.Ua=function(e,o,s,h,d){var g=this,_=e.K(),j=[],$=Zb(),_t=1;if(_)for(;_t&nh.ANY;){if(_t&h)switch(_t){case nh.MARKER:$=$.then(function(){return qk(g,_,s,o,!0)}).then(function(_e){return vk(_e,e,j)});break;case nh.DOM_MARKER:$=$.then(function(){return rk(g,_,s,o,!0)}).then(function(_e){return vk(_e,e,j)});break;case nh.SPATIAL:$=$.then(function(){return pk(g,g.i,_,s,o,!0)}).then(function(_e){_e.forEach(sk.bind(null,e,j))});break;case nh.OVERLAY:$=$.then(function(){return pk(g,g.J,_,s,o,!0)}).then(function(_e){_e.forEach(sk.bind(null,e,j))})}_t<<=1}$.then(function(){return d(j)})},N.prototype.ld=function(e,o,s){s=s||jf;var h=s.zoom,d=s.visiblesOnly;s=s.types;var g=nh.ANY;C(e,O,this.ld,0,"area"),zc(o,"Function",this.ld,1,"callback"),zc(h,"Number",this.ld,2,"options"),this.Ua(e,vc(d)?!!d:!0,h,vc(s)?s&g:g,o)},N.prototype.getObjectsWithin=N.prototype.ld,N.prototype.o=function(){N.j.o.call(this),this.f.na()};var wk={PENDING:0,ACTIVE:1,DONE:2};t("H.map.render.RenderState",wk);function xk(e,o){o=o||{};var s;if(!C(e,Element))throw new D(xk,0,e);var h=e.ownerDocument.createElement("div");this.S=e,xk.j.constructor.call(this),this.padding=new yk(0,0,0,0),this.center=new J(0,0),this.margin=0,this.element=h,h.style.zIndex=0,h.style.height=h.style.width="100%",h.style.direction="ltr",h.style.position=e.style.position==="relative"?"absolute":"relative",this.resize(),e.appendChild(h),(s=o.padding)!==B&&this.wi(s.top,s.right,s.bottom,s.left),this.ri((s=o.margin)!==B?s:0)}u(xk,F),t("H.map.ViewPort",xk),xk.prototype.A={za:"update",le:"sync"},xk.prototype.ri=function(e){if(this.margin!==+e){if(E(this.margin=+e))throw new D(this.ri,0,e);zk(this),this.dispatchEvent(this.A.za)}},xk.prototype.setMargin=xk.prototype.ri,xk.prototype.wi=function(e,o,s,h){var d=this.padding;if(d.top!==e||d.right!==o||d.bottom!==s||d.left!==h){if(E(e+o+s+h))throw new D(this.wi);d.top=e,d.right=o,d.bottom=s,d.left=h,zk(this),this.dispatchEvent(this.A.za)}},xk.prototype.setPadding=xk.prototype.wi;function zk(e){var o=e.padding;e.center.set((e.width+o.left-o.right)/2<<0,(e.height+o.top-o.bottom)/2<<0)}xk.prototype.resize=function(){var e=this.S.offsetWidth,o=this.S.offsetHeight;(this.width!==e||this.height!==o)&&(this.a=new Wi(this.width,this.height),this.width=e,this.height=o,zk(this),this.dispatchEvent(this.A.za))},xk.prototype.resize=xk.prototype.resize,xk.prototype.$a=function(e){this.dispatchEvent(new dj(this.A.le,this.a,e,ej.SIZE))},xk.prototype.synchronize=xk.prototype.$a,xk.prototype.o=function(){this.S.removeChild(this.element),delete this.S,delete this.element,xk.j.o.call(this)},xk.prototype.lc=Qc,xk.prototype.startInteraction=xk.prototype.lc,xk.prototype.cc=Qc,xk.prototype.interaction=xk.prototype.cc,xk.prototype.wb=Qc,xk.prototype.endInteraction=xk.prototype.wb;function Ak(e,o,s,h,d,g){var _;for(_=[];h<=d;h++)_=_.concat(Bk(e,s,h));for(e=_.length,xj.call(this,g,e),this.l=s=[],this.f=A(this.f,this),this.c=A(this.c,this),this.O(1);e--;)g=_[e],s.push(Ck(o,g[0],g[1],g[2],this.f,this.c))}u(Ak,xj),Ak.prototype.f=function(){zj(this,2)},Ak.prototype.c=function(){zj(this,4)},Ak.prototype.oe=function(){for(var e=this.l,o=e.length;o--;)e[o].cancel();delete this.l};function Dk(e,o){var s=this;if(!Da(o))throw new D(Ek,1,o);if(!Da(e.next||Da(e.cycle)))throw new D(Dk,2,'Argument "mode" must implement H.util.AsyncQueue.Mode');this.b=[],this.c=[],this.g=e,this.i=o,this.l=function(){Fk(s)},this.a=null,this.f=function(){s.a||(s.a=x.setTimeout(s.l,1))}}t("H.util.AsyncQueue",Dk),Dk.prototype.push=function(e,o){if(!Da(o))throw new D(this.push,1,o);return e=Gk(new Hk,e,this.f,o),this.b.push(e),this.f(),e},Dk.prototype.push=Dk.prototype.push;function Fk(e){var o=e.c,s=0,h=e.g;for(h.a(),e.a=null;s<o.length;){var d=o[s];d.Tj?o.splice(s,1):s++}for(;d=h.next(e.b,e.c);)d.cancelled?d.done(null,"cancelled"):(o.push(d),e.i(d,d.data))}function Hk(){Gk(this,null,null,null)}Dk.Task=Hk;function Gk(e,o,s,h){return e.data=o,e.cancelled=!1,e.Tj=!1,e.b=s,e.c=h,e.a=null,e}Hk.prototype.done=function(e,o){this.Tj=!0,this.b(),this.c(this,e,o)},Hk.prototype.done=Hk.prototype.done,Hk.prototype.cancel=function(){this.a&&this.a(),this.cancelled=!0},Hk.prototype.cancel=Hk.prototype.cancel,Hk.prototype.vo=function(e){return this.a=e,this},Hk.prototype.setCancelFn=Hk.prototype.vo;function Ik(){}Dk.Mode=Ik,Ik.prototype.next=function(){},Ik.prototype.a=function(){};var Jk,Kk=function(){function e(){}for(var o,s,h,d=tc("o ms moz webkit "),g=5;g--&&!o;)o=d[g],o=(s=x[o+(o?"R":"r")+"equestAnimationFrame"])&&!E(s.call(window,e))&&(h=x[o+(o?"C":"c")+"ancelAnimationFrame"]);return Jk=o?function(_){return s.call(x,_)}:function(_){return x.setTimeout(_,25)},o?function(_){return h.call(x,_)}:function(_){return x.clearTimeout(_)}}(),Lk=x.performance&&x.performance.now?function(){return x.performance.now()}:function(){return x.Date.now()};function Mk(e,o){Mk.j.constructor.call(this,new Nk(e),o)}u(Mk,Dk),t("H.util.SequentialQueue",Mk);function Nk(e){if(isNaN(e)||0>e)throw new D(Mk,1,'Argument "maxTime" must be a positive number');this.c=e,this.b=Lk()}Nk.prototype.next=function(e){return e.length&&Lk()-this.b<this.c?e=e.shift():null},Nk.prototype.a=function(){this.b=Lk()};function Ok(e){if(xc(this,Ok),Ok.j.constructor.call(this,e),e&&"tileSize"in e){var o=Ed(+e.tileSize)/Od;if(isNaN(o)||o%1||0>o||30<o)throw new D(Ok,0,"tileSize: "+e.tileSize);this.tileSize=+e.tileSize}}u(Ok,P),t("H.map.provider.TileProvider",Ok);function Pk(e,o){return Yd(e)-8-Ad(Yd(o))}Ok.getZoomLevelOffset=Pk,Ok.prototype.requestTile=Ok.prototype.Ha,Ok.prototype.cancelTile=Ok.prototype.mc,Ok.prototype.cancelTileByKey=Ok.prototype.pe,Ok.prototype.createTileInternal=Ok.prototype.ac,Ok.prototype.uc=function(e,o,s){return this.uri.concat("_",e,"_",o,"_",s)},Ok.prototype.getTileKey=Ok.prototype.uc,Ok.prototype.kf=256,Ok.prototype.tileSize=Ok.prototype.kf;function Qk(){}t("H.util.ICache",Qk),Qk.prototype.add=function(){},Qk.prototype.add=Qk.prototype.add,Qk.prototype.get=function(){},Qk.prototype.get=Qk.prototype.get,Qk.prototype.zf=function(){},Qk.prototype.drop=Qk.prototype.zf,Qk.prototype.forEach=function(){},Qk.prototype.forEach=Qk.prototype.forEach,Qk.prototype.na=function(){},Qk.prototype.removeAll=Qk.prototype.na,Qk.prototype.$d=function(){},Qk.prototype.registerOnDrop=Qk.prototype.$d,Qk.prototype.Ug=function(){},Qk.prototype.deRegisterOnDrop=Qk.prototype.Ug;function Rk(e,o,s){if(this.g=[],o&&this.$d(o),s&&!Da(s))throw new D(Rk,2,s);this.b=0,this.filter=s,this.a={},this.f=this.c=null,this.ti(e)}t("H.util.Cache",Rk),Rk.prototype.add=function(e,o,s){var h,d;if(s=+s,!Fc(s)||0>s)throw new D(this.add,2,s);return e=String(e),(d=this.filter?this.filter(e,o,s):!0)&&((h=this.a[e])?(h.data!==o&&Sk(this,h),this.b+=s-h.size,h.size=s,h.data=o,Tk(this,h)):this.a[e]=Uk(this,{id:e,data:o,size:s,fc:null,Zc:null},this.c),Vk(this)),d},Rk.prototype.add=Rk.prototype.add,Rk.prototype.$d=function(e){if(!Da(e))throw new D(this.$d,0,e);this.g.push(e)},Rk.prototype.registerOnDrop=Rk.prototype.$d,Rk.prototype.Ug=function(e){this.g=this.g.filter(function(o){return o!==e})},Rk.prototype.deRegisterOnDrop=Rk.prototype.Ug,Rk.prototype.get=function(e,o){return(e=o?this.a[e]:Tk(this,this.a[e]))&&e.data},Rk.prototype.get=Rk.prototype.get,Rk.prototype.zf=function(e){var o;(o=this.a[e])&&Wk(this,o,!0)},Rk.prototype.drop=Rk.prototype.zf,Rk.prototype.forEach=function(e,o,s){var h;for(h in this.a){var d=this.a[h];(!s||s(h,d.data,d.size))&&e.call(o,h,d.data,d.size)}},Rk.prototype.forEach=Rk.prototype.forEach,Rk.prototype.na=function(e){var o;for(o in this.a){var s=this.a[o];(!e||e(o,s.data,s.size))&&Wk(this,this.a[o],!0)}},Rk.prototype.removeAll=Rk.prototype.na,Rk.prototype.ti=function(e){if(!(0<+e))throw new D(Rk.prototype.ti,0,e);return this.i=+e,Vk(this),this},Rk.prototype.setMaxSize=Rk.prototype.ti,Rk.prototype.Cm=function(){return this.i},Rk.prototype.getMaxSize=Rk.prototype.Cm,Rk.prototype.Xl=function(){return this.b},Rk.prototype.getCurrentSize=Rk.prototype.Xl;function Tk(e,o){return o&&(e.c=Uk(e,o,e.c)),o}function Vk(e){for(;e.b>e.i&&e.f;)Wk(e,e.f,!0)}function Uk(e,o,s){return s!==o&&((o.fc||o.Zc)&&Wk(e,o,!1),(o.fc=s)&&(o.Zc=s.Zc,s.Zc=o),o.Zc||(e.c=o),o.fc||(e.f=o),e.b+=o.size),o}function Wk(e,o,s){var h=o.Zc,d=o.fc;(h||d||o==e.c&&o==e.f)&&(h?h.fc=d:e.c=d,d?d.Zc=h:e.f=h,e.b-=o.size,s&&(delete e.a[o.id],Sk(e,o))),o.fc=o.Zc=null}function Sk(e,o){for(var s=e.g.length;s--;)e.g[s].call(e,o.id,o.data,o.size)}function Xk(e,o,s,h){this.key="",this.x=e,this.y=o,this.z=s,this.data=h,this.valid=!0}t("H.map.provider.Tile",Xk);function Yk(e,o,s,h){return e-=s,o-=h,e*e+o*o}function Zk(e,o,s){return $k(e,o*o,s||0,0,e.length-1)}t("H.math.simplifyDP",Zk);function $k(e,o,s,h,d){var g=0,_=h,j=e[h].x,$=e[h].y,_t=e[d].x,_e=e[d].y,_r=h+1,_n=Yk(j,$,_t,_e);if(_n)for(;_r<d;){var _o=e[_r++],ga=_o.x;_o=_o.y;var _l=((ga-j)*(_t-j)+(_o-$)*(_e-$))/_n;ga=0>_l?Yk(ga,_o,j,$):1<_l?Yk(ga,_o,_t,_e):Yk(ga,_o,j+_l*(_t-j),$+_l*(_e-$)),ga>g&&(g=ga,_=_r-1)}else for(;_r<d;)_o=e[_r++],ga=_o.x,_o=_o.y,ga=Yk(ga,_o,j,$),ga>g&&(g=ga,_=_r-1);return g>=o||0<s&&_-h?(--s,1<_-h?(h=$k(e,o,s,h,_),h.splice(h.length-1,1)):h=[e[h]],h=1<d-_?h.concat($k(e,o,s,_,d)):h.concat(e.slice(_,d+1))):h=[e[h],e[d]],h}function al(e,o,s,h,d,g,_,j){al.j.constructor.call(this,o,s,h,null),this.key=e,this.U=j,this.a=d,this.g=g,this.i={},this.zL=_,this.m=Cd(wh.MAX_LINE_WIDTH/2*this.g+1)}u(al,Xk),t("H.map.provider.SpatialTile",al),al.prototype.c=Xd,al.prototype.u=Xd,al.prototype.b=Xd;function bl(e){return e.U.getInvalidations(nh.SPATIAL)}function cl(e){var o=bl(e),s=o.a,h=e.c,d=h===s,g;if(!(d||o.Rj(h)||o.yh(h))){d=e.f;var _=e.i;if(o.Sf(h))for(g=d.length;g--;){var j=d[g];if(j.Kb().Sf(h)){d.splice(g,1);var $=$||dl(e,j.cb())}}if(o.zh(h)){for(g=d.length;g--;)if(j=d[g],j.Kb().zh(h)){var _t=1;if((j=_[j.cb()])&&j.a){$=1;break}}_t&&d.sort(el)}if(!$&&o.Vd(h)){for(g=d.length;g--;)if(d[g].Kb().Vd(h)){var _e=1;break}}e.u!==h||_e||(e.u=s,e.b!==h||$||(e.b=s)),e.c=s,d=!0}return d}al.prototype.Ud=function(){var e=bl(this),o=e.a,s=this.b,h=s===o;return h||(this.U.qa&&!e.Vd(s)?h=!0:cl(this)&&(h=this.b===o)),h},al.prototype.isCanvasValid=al.prototype.Ud,Object.defineProperty(al.prototype,"valid",{get:function(){return this.Ud()},set:ld,configurable:!0});function fl(e,o){this.b=e,this.a=o}function dl(e,o){e=e.i;var s=e[o];if(s)return delete e[o],s.a}al.prototype.f=hf;function gl(e){var o=bl(e),s=e.c,h=e.f,d;if(!cl(e)){for(d=h.length;d--;){var g=h[d],_=g.Kb();(_.Sf(s)||_.yh(s))&&dl(e,g.cb())}e.f=e.U.requestSpatialsByTile(e,!1,!1).sort(el),e.c=o.a}}function el(e,o){return oh(e.Uc(),o.Uc(),!1)}al.prototype.Ua=function(){return this.f},al.prototype.getObjects=al.prototype.Ua,al.prototype.$m=function(){return this.a},al.prototype.getTileSize=al.prototype.$m;var hl={};al.prototype.Le=function(){var e=this.a+"_"+this.g,o=hl[e];if(!o){o=-this.m;var s=this.a-o;o=hl[e]=new yk(o,o,s,s)}return o},al.prototype.getPxClipRect=al.prototype.Le,al.prototype.Hf=function(){var e=this.mb;if(!e){var o=this.Jf();e=0;var s=this.a;this.z&&(s-=e+=this.Le().top),e=this.mb=sg(o.Re(new J(e,e)),o.Re(new J(s,s)))}return e},al.prototype.getGeoClipRect=al.prototype.Hf,al.prototype.Jf=function(){var e=this.J;if(!e){var o=this.a;e=this.J=new nj(B,o),e.Oa(this.z),e.x=this.x*o,e.y=this.y*o}return e},al.prototype.getPxProj=al.prototype.Jf,al.prototype.Xa=function(){return this.g},al.prototype.getPixelRatio=al.prototype.Xa,al.prototype.gg=function(){var e=this.data;return e&&(this.data=null,this.b=Xd),e},al.prototype.releaseCanvas=al.prototype.gg,al.prototype.hg=function(){this.i={},delete this.f,this.c=Xd},al.prototype.releaseData=al.prototype.hg,al.prototype.W=function(e){var o=e.getContext("2d"),s,h,d,g,_=0;if(gl(this),this.b<this.c){var j=this.f;if(s=j.length){e.width=e.height=this.a,o.clearRect(0,0,this.a,this.a);var $=this.i;for(h=0;h<s;h++){var _t=j[h],_e=_t.cb();if(g=(d=$[_e])?d.b:_t.getGeometriesForTile(this)){if(d)_t.Kb().Vd(this.b)&&(d.a=Ih(_t,g)),d=d.a;else{d=Ih(_t,g);for(var _r,_n=g,_o=_t.g?2:0,ga=_n.length;ga--;){var _l=_n[ga];if(_l!==Jh){var _f=_l.a;for(_r=_f.length;_r--;)_l=_f[_r],4<_l.length&&(_f[_r]=Zk(_l,.6,_o))}}this.i[_e]=new fl(g,d)}if(d){for(o.save(),_n=_t.g?this.D:this.P,_e=0;_e<g.length;_e++)_n.call(this,_t,g[_e],_t.V(),o);if(g=_t.getLabels(this))for(_t=o,_e=g.length;_e--;)for(_o=g[_e],_n=_o.size,_t.font=_n+"px "+_o.font,_t.fillStyle=_o.color,_t.textAlign="center",_t.translate(_o.x,_o.y),_t.rotate(_o.angle),_n=_o.lineHeight||1.375*_n,ga=_o.lines,_o=ga.length;_o--;)_t.fillText(ga[_o],0,_o*_n);o.restore()}_|=+d}}}this.data=_?e:null,this.u=this.b=this.c}else this.data&&(_=1);return 0<_},al.prototype.render=al.prototype.W,al.prototype.data=null,al.prototype.P=function(e,o,s,h){var d;s.b&&(il(h,s,this.g),jl(o,h,!1,!0,!1,this.a,this.m)),s.a&&(d=e.c)&&d.Ob&&(kl(h,d),ll(this,h,o,d,s.lineWidth))},al.prototype.D=function(e,o,s,h){var d=s.Ob,g=s.b,_,j=this.a,$=this.m;if(o===Jh)d&&(kl(h,s),h.fillRect(0,0,j,j));else{if(g&&il(h,s,this.g),s.a&&(_=e.c)){var _t=s.lineWidth;_.Ob||(_=null)}e=o.c,e===Wd?((g||d)&&(kl(h,s),jl(o,h,!0,g,d,j,this.m)),_&&(kl(h,_),ll(this,h,o,_,_t,0))):(d&&(kl(h,s),jl(o,h,!0,!1,d,j,$,0,e)),g&&jl(o,h,!1,g,!1,j,$,e),_&&(kl(h,_),ll(this,h,o,_,_t,e)))}};function jl(e,o,s,h,d,g,_,j,$){var _t=e.a,_e=-_;if(_=g+_,j=j||0,$===B&&($=_t.length),d&&e===Jh)o.fillRect(0,0,g,g);else if($>j){for(o.beginPath(),g=j;g<$;g++){var _r=_t[g],_n=_r.length;if(_r===Qh)o.moveTo(_e,_e),o.lineTo(_e,_),o.lineTo(_,_),o.lineTo(_,_e);else{var _o=_r[0];for(o.moveTo(_o.x,_o.y),j=1;j<_n;j++)_o=_r[j],o.lineTo(_o.x,_o.y)}s&&o.closePath()}s&&d&&o.fill(e.b!==Wd?"evenodd":"nonzero"),h&&o.stroke()}}function il(e,o,s){var h;e.strokeStyle=o.strokeColor,e.lineWidth=o.lineWidth*s,e.lineCap=o.lineCap,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.setLineDash&&(h=o.lineDash)!==hf&&(e.setLineDash(h),e.lineDashOffset=o.lineDashOffset)}function kl(e,o){e.fillStyle=o.fillColor}function ll(e,o,s,h,d,g){var _=d*h.width/2;d=d*h.length/2;var j=d/2;h=2*d*h.frequency;var $=Fd(Gd(d,2)+Gd(_,2));e=e.a-$,e=new yk($,$,e,e),s=s.a;var _t,_e,_r,_n,_o,ga,_l,_f=Pd/2;for(g=g||0,$=s.length;$-- >g;){var _c=0,_p=s[$];if(_e=_t=_p.length){var _g=_p;for(_e=_g.length,_r=0;--_e;)_r+=_g[_e].Wa(_g[_e-1]);_e=(_g=_r)>=h}if(_e)for(_e=yd(Bd(_g/h),1e3),_e=_g/(_e+1),_r=_e/2;--_t;){for(_n=(_o=_p[_t]).Wa(ga=_p[_t-1]);_r<=_c+_n;){var ty=_o.x+(ga.x-_o.x)*(_l=(_r-_c)/_n);_l=_o.y+(ga.y-_o.y)*_l,e.vf(ty,_l)&&(o.save(),o.translate(ty,_l),o.rotate(-Md((ga.y-_o.y)/(_o.x-ga.x))+(_o.x<ga.x?_f:-_f)),o.beginPath(),o.moveTo(-_,-d),o.lineTo(0,d),o.lineTo(_,-d),o.lineTo(0,-j),o.closePath(),o.fill(),o.restore()),_r+=_e}_c+=_n}}}var ml=[];al.prototype.Ea=function(e,o,s){for(var h=this.f,d=h.length,g,_,j,$,_t,_e,_r=hf,_n,_o=this.g;d--;)if(_=h[d],_.wc(!0)&&(j=this.i[_.cb()])&&($=j.b)){for(g=_.V(),_e=g.fillColor!=="none"&&_.g,_n=g.strokeColor==="none"?0:g.lineWidth*_o,g=$.length;g--;){_t=$[g];var ga;if(!(ga=_e&&_t===Jh)&&(ga=_e||_n)){var _l;ga=e;var _f=o,_c=_e,_p=_n,_g=_t.b,ty=_t.c,oy=ty!==Wd,ry=_t.a,ly=ry.length,py=0,gy=0,by=!1;for(_t=0;_t<ly;_t++){var wy=ry[_t],Cy=_t>=ty,Gy=!Cy&&_t>=_g;if(wy===Qh&&_c)Gy?py++:gy++;else{var Ly=wy.length;for(ml.length=2*Ly,_l=0;_l<Ly;_l++){var d0=wy[_l];ml[2*_l]=d0.x,ml[2*_l+1]=d0.y}if(_l=_c&&!Cy,Cy=oy&&!Cy?0:_p,_l||Cy){if(Cy=ee(ga,_f,ml,Cy,_l),Cy===de.EDGE||Cy===de.VERTEX){by=!0;break}else if(Cy===de.SURFACE){if(Gy)py++;else if(gy++,_g===Wd)break}}}}ga=by||0<gy&&!(py%2)}if(ga){_r===hf&&(_r=[]),_r.push(_);break}}if(s&&_r.length)break}return _r};function nl(e,o){var s;nl.j.constructor.call(this,o),this.D=e,this.P=e=o.pixelRatio,this.tileSize=s=1<<Ad(Yd((o.tileSize||256)*e)),this.L=Pk(s,e),this.Gh=A(this.Gh,this),this.Wh=A(this.Wh,this),this.Hh=A(this.Hh,this),this.Fh=A(this.Fh,this),this.m=A(this.m,this),this.D.addEventListener(P.prototype.A.za,this.m,!1,this),this.f=[],this.i=new Rk(o.tileCacheSize||256,this.Gh),this.l=new Rk(o.dataCacheSize||512,this.Wh),this.J=new Mk(20,this.Hh),this.c={},this.u=Lk()}u(nl,Ok),nl.prototype.m=function(e){e=e.target,e.type===nh.SPATIAL&&this.Va(e)},nl.prototype.Ha=function(e,o,s,h){var d=this.getTileKey(e,o,s),g;if(g=this.i.get(d,h)){if(h||g.Ud())return g;h||this.i.zf(d)}if((g=this.l.get(d,h))&&(h||cl(g)))return e=this.f.pop()||document.createElement("canvas"),g.W(e)||this.f.push(e),this.i.add(d,g,1),g;h||((g=this.c[d])?g.count++:(g=this.J.push([d,e,o,s],this.Fh),g.count=1,this.c[d]=g))},nl.prototype.requestTile=nl.prototype.Ha,nl.prototype.ac=function(){},nl.prototype.createTileInternal=nl.prototype.ac,nl.prototype.mc=function(e,o,s){this.pe(this.getTileKey(e,o,s))},nl.prototype.cancelTile=nl.prototype.mc,nl.prototype.pe=function(e){var o;(o=this.c[e])&&(o.count--,o.count||(o.cancel(),delete this.c[e]))},nl.prototype.cancelTileByKey=nl.prototype.pe,p=nl.prototype,p.Hh=function(e,o){var s=o[0],h=o[1],d=o[2],g=o[3];s=this.i.get(s)||new al(s,h,d,g,this.tileSize,this.P,g+this.L,this.D),h=s.data||this.f.pop()||document.createElement("canvas"),s.W(h)||this.f.push(h),o.push(s),e.done(s)},p.Fh=function(e,o){e=e.data[0],o&&this.i.add(e,o,1),delete this.c[e],this.Va()},p.Gh=function(e,o){o.data&&this.f.push(o.gg()),this.l.add(e,o,1)},p.Wh=function(e,o){o.hg()},p.o=function(){for(var e in this.c)this.c[e].cancel();this.i.na(),this.l.na(),this.f.length=0,nl.j.o.call(this)};function yk(e,o,s,h){this.left=+e,this.top=+o,this.right=+s,this.bottom=+h}t("H.math.Rect",yk),yk.prototype.set=yk,yk.prototype.set=yk.prototype.set,yk.prototype.Nb=function(){return this.b||(this.b=new J(this.left,this.top))},yk.prototype.getTopLeft=yk.prototype.Nb,yk.prototype.Jb=function(){return this.a||(this.a=new J(this.right,this.bottom))},yk.prototype.getBottomRight=yk.prototype.Jb,yk.prototype.vf=function(e,o){return this.left<=e&&this.right>=e&&this.top<=o&&this.bottom>=o},yk.prototype.containsXY=yk.prototype.vf;function ol(e,o){return new yk(e.x,e.y,o.x,o.y)}yk.fromPoints=ol,yk.prototype.clone=function(){return new yk(this.left,this.top,this.right,this.bottom)},yk.prototype.clone=yk.prototype.clone;function pl(e,o){if(o=o||{},!e)throw new D(pl,0,e);this.tileSize=e.tileSize,this.a={},qj.call(this,{min:o.min!==void 0?o.min:e.min,max:o.max!==void 0?o.max:e.max,minWorldSize:this.tileSize,projection:o.eg,dark:o.dark,provider:e})}u(pl,qj),t("H.map.layer.BaseTileLayer",pl),pl.prototype.Ae=function(e,o){var s=this.pixelProjection;if(!C(e,K))throw new D(this.Ae,0,e);if(!E(o)){var h=s.Jj();s.Oa(o)}return e=ol(s.ib(e.Nb()),s.ib(e.Jb())),!E(h)&&s.Oa(h),e},pl.prototype.geoRectToRect=pl.prototype.Ae,pl.prototype.Sd=function(e,o){var s=Gd(2,Bd(o)),h=this.tileSize;if(!C(e,yk))throw new D(this.Sd,0,e);if(E(o=+o))throw new D(this.Sd,1,o);o=Bd(e.left/h),o===s&&--o;var d=Bd(e.right/h);return d===s&&--d,new yk(o,ae(Bd(e.top/h),0,s-1),d,ae(Bd(e.bottom/h),0,s-1))},pl.prototype.getTileBounds=pl.prototype.Sd,pl.prototype.Ha=function(e,o,s,h){return this.ma.requestTile(e,o,s,h)},pl.prototype.requestTile=pl.prototype.Ha,pl.prototype.mc=function(e,o,s){this.ma.cancelTile(e,o,s)},pl.prototype.cancelTile=pl.prototype.mc,pl.prototype.ba=function(e,o){return this.ma.getCopyrights?this.ma.getCopyrights(e,o):null},pl.prototype.getCopyrights=pl.prototype.ba;function ql(e,o,s,h,d){h=Bd(h);var g=Gd(2,h),_=o.left,j=o.top,$=o.right;s=$+(s?g+($===o.left?0:1):1);var _t=o.bottom,_e=[];if(d)var _r=_+(1+$-_)/2+d.x/e.tileSize-.5,_n=j+(1+_t-j)/2+d.y/e.tileSize-.5;for(;_<s;){for(j=o.top;j<=_t;)e=_%g,_e.push([e,j,h,d?Dd(_r-_)+Dd(_n-j):0]),j++;_++}return _e}function Bk(e,o,s){s=Bd(s),e.pixelProjection.Oa(s),o=e.Ae(o);var h=e.Sd(o,s);return ql(e,h,o.left>o.right,s)}pl.prototype.Ke=function(e,o,s,h,d,g){var _,j=[],$,_t=this.ma;g=g??"__default__";var _e=_t.requestTile;if(!C(e,yk))throw new D(this.Ke,0,e);if(E(s=+s))throw new D(this.Ke,1,s);if(h||(_={}),o=ql(this,e,o,s,d),e=o.length)for(h||o.sort(rl),s=e;s--;)d=o[s],h||(_[_t.uc.apply(_t,d)]=!0),d[3]=+h,($=_e.apply(_t,d))&&j.push($);if(!h){h=_;var _r;_=this.a[g]||{};for(_r in _)_.hasOwnProperty(_r)&&_[_r]&&!h[_r]&&this.ma.cancelTileByKey(_r);this.a[g]=h}return{total:e,tiles:j}},pl.prototype.getProviderTiles=pl.prototype.Ke;function rl(e,o){return o[3]-e[3]}function sl(e,o){pl.call(this,e,o)}u(sl,pl),t("H.map.layer.TileLayer",sl),sl.prototype.td=function(e,o,s,h,d){if(!C(e,K))throw new D(this.td,0,e);if(E(o=+o))throw new D(this.td,1,o);o=Bd(o),this.pixelProjection.Oa(o),e=this.Ae(e);var g=this.Sd(e,o);return this.Ke(g,e.left>e.right,o,s,h,d)},sl.prototype.requestTiles=sl.prototype.td;function tl(e,o){o=o?Wa(o):{},o.tileSize=o.tileSize||256,o.pixelRatio=o.pixelRatio||Ue(),o.max=24,this.a=new nl(e,o),this.b=new sl(this.a),o.minWorldSize=this.a.tileSize,o.provider=e,tl.j.constructor.call(this,o),this.tileSize=this.b.tileSize,this.c=A(this.c,this),this.a.addEventListener(this.a.A.za,this.c),e.addEventListener(e.A.za,this.c)}u(tl,qj),t("H.map.layer.ObjectLayer",tl),tl.prototype.c=function(e){e.currentTarget!==this.a&&e.target.type===nh.SPATIAL||this.Va()};var ul={markers:hf,total:0};tl.prototype.Ec=function(e,o,s){var h=this.ma,d;return h.providesMarkers()&&(d=h.requestMarkers(e,o,!0,s)).length?{markers:d,total:d.length}:ul},tl.prototype.requestMarkers=tl.prototype.Ec,tl.prototype.Dc=function(e,o,s){var h=this.ma,d;return h.providesDomMarkers()&&(d=h.requestDomMarkers(e,o,!0,s)).length?{markers:d,total:d.length}:ul},tl.prototype.requestDomMarkers=tl.prototype.Dc;var vl={tiles:hf,total:0};tl.prototype.td=function(e,o,s,h){if(this.ma.providesSpatials()){var d=this.b.td(e,o,s,h);s||(s=this.a,d=Lk(),33<d-s.u&&(Fk(s.J),s.u=d),d=this.b.td(e,o,!0,h))}else d=vl;return d},tl.prototype.requestTiles=tl.prototype.td,tl.prototype.Ha=function(e,o,s,h){return this.b.Ha(e,o,s,h)},tl.prototype.requestTile=tl.prototype.Ha,tl.prototype.mc=function(e,o,s){this.b.mc(e,o,s)},tl.prototype.cancelTile=tl.prototype.mc;var wl={overlays:hf,total:0};tl.prototype.sd=function(e,o,s){var h=this.ma,d=wl;return h.providesOverlays&&h.providesOverlays()&&(e=h.requestOverlays(e,o,!0,s),o=e.length)&&(d={overlays:e,total:o}),d},tl.prototype.requestOverlays=tl.prototype.sd,tl.prototype.o=function(){this.a.F(),this.b.F(),this.ma.dispose(),tl.j.o.call(this)};function S(e){xc(this,S),S.j.constructor.call(this,e),this.sb=new xl,this.ub=A(this.ub,this),this.P=yl,this.createTileInternal=this.ac.bind(this)}u(S,Ok),t("H.map.provider.RemoteTileProvider",S),S.prototype.em=function(){return 1},S.prototype.getEntryWeight=S.prototype.em;var yl,zl=screen.width,Al=screen.height,Bl=Ue();Bl=zd(Bl,1);var Cl=Cd(zl*Bl*Al*Bl/1e6);yl=new Rk(Gd(2,zd(8,yd(12,7+Cl))));var Dl={},El={};S.prototype.nb=function(){return this.P},S.prototype.getCache=S.prototype.nb,S.prototype.J=ba(3),S.prototype.ub=function(e){var o=this.uri;return!e.indexOf(o)&&e.charAt(o.length)==="_"},S.prototype.cacheFilter=S.prototype.ub,S.prototype.wa=function(e,o){o.valid=!1},S.prototype.reload=function(e){var o=this.getCache();e?o.na(this.ub):o.forEach(this.wa,this,this.ub),Fl(this),this.Va(this,{isReload:!0})},S.prototype.reload=S.prototype.reload,S.prototype.l=function(){return!1},S.prototype.MAX_STORE_TIME=1/0,S.prototype.c=function(){return this.sb},S.prototype.ea=function(e,o){o(e)};function Ck(e,o,s,h,d,g){return h=~~h,e.requestInternal(o,s,h,function(_,j){e.c().put(e.uc(o,s,h),{raw:j&&j.raw||_,timestamp:x.Date.now()},d,g)},g,0)}S.prototype.requestInternal=S.prototype.B,S.prototype.Ha=function(e,o,s,h){var d=this,g=this.getCache();if(E(e=+e))throw new D(this.Ha,0,e);if(E(o=+o))throw new D(this.Ha,0,o);if(E(s=+s))throw new D(this.Ha,0,s);s=~~s;var _=this.getTileKey(e,o,s);return g=g.get(_),g&&g.valid||h||Dl[_]||(g=B,this.requestTileAsPromise(e,o,s,h).then(function(j){d.Va(j)},ld)),g},S.prototype.requestTile=S.prototype.Ha,S.prototype.Gk=function(e,o,s,h){var d=this,g=this.getCache(),_=this.getTileKey(e,o,s),j,$,_t=this.c();return El[_]?El[_]:(El[_]=j=new Rb(function(_e,_r){function _n(_o){var ga=0,_l,_f=function(_c,_p){_l=d.createTileInternal(e,o,s,_c,_p),_l.key=_,g.add(_,_l,1),_e(_l),Gl(_)};_o&&(ga=x.Date.now()-_o.timestamp),_o&&ga<d.MAX_STORE_TIME?d.ea(_o.raw,_f):(0<ga&&_t.remove(_),(_l=g.get(_))&&_l.valid||h?_e(_l||null):Dl[_]=d.requestInternal(e,o,s,_f,_r))}$=_t.get(_,_n,_n)}),Dl[_]||(Dl[_]=$),j.then(function(){Gl(_)},function(){Gl(_)}),j)},S.prototype.requestTileAsPromise=S.prototype.Gk,S.prototype.Fk=function(e,o){var s=this,h=e.id,d=e.tile.coords;return new Rb(function(g,_){s.Gk(d.x,d.y,d.z,o).then(function(j){var $=z;j=j.Ua?j.Ua():j.data;for(var _t=j.length,_e;_t--;)if(_e=j[_t],_e.cb()===h){$=_e;break}g($)},_)})},S.prototype.requestObjectAsPromise=S.prototype.Fk;function Gl(e){delete Dl[e],delete El[e]}function Fl(e){for(var o in Dl)e.ub(o)&&e.cancelTileByKey(o)}var Hl={cancel:ld};S.prototype.ac=function(e,o,s,h){return new Xk(e,o,s,h)},S.prototype.createTileInternal=S.prototype.ac,S.prototype.pe=function(e){var o=Dl[e];o&&(o.cancel(),Gl(e))},S.prototype.cancelTileByKey=S.prototype.pe,S.prototype.mc=function(e,o,s){this.cancelTileByKey(this.getTileKey(e,o,s))},S.prototype.cancelTile=S.prototype.mc,S.prototype.o=function(){S.j.o.call(this),this.getCache().na(this.ub),Fl(this)};function xl(){}S.NullStorage=xl,xl.prototype.get=function(e,o){return o(),Hl},xl.prototype.get=xl.prototype.get,xl.prototype.put=function(e,o,s){s&&s()},xl.prototype.put=xl.prototype.put,xl.prototype.clear=function(e){e&&e()},xl.prototype.clear=xl.prototype.clear,xl.prototype.remove=function(e,o){o&&o()},xl.prototype.remove=xl.prototype.remove;function Ek(e){if(Ek.j.constructor.call(this,e),e&&(this.u={crossOrigin:e.crossOrigin||"anonymous",headers:e.headers||{}},this.m=e.getURL),this.b===kk.HARP&&H.map.render.harp){var o;e&&e.style&&e.style instanceof H.map.render.harp.Style?o=e.style:o=new H.map.render.harp.Style({styles:[{technique:"raster",attr:{gamma:1,brightness:1}}]}),this.Qa(o)}if(!Da(this.m))throw new D(Ek,0,"getURL");if(lk(this,e.opacity),this.f=x.URL||x.webkitURL,e=this.u.crossOrigin,!(e=e==="anonymous"||e==="use-credentials")){e=this.m(0,0,0),o=window.location;var s=document.createElement("a");s.href=e,e=s.hostname===o.hostname&&s.port===o.port&&s.protocol===o.protocol}(this.T=e&&!!uf.arraybuffer&&!!this.f)&&this.nb().$d(A(this.aa,this))}u(Ek,S),t("H.map.provider.ImageTileProvider",Ek),Ek.prototype.ic=function(e){lk(this,e)},Ek.prototype.setOpacity=Ek.prototype.ic,Ek.prototype.Tc=function(){return this.g},Ek.prototype.getOpacity=Ek.prototype.Tc,Ek.prototype.Ve=ff,Ek.prototype.providesRasters=Ek.prototype.Ve,Ek.prototype.B=function(e,o,s,h,d,g){var _=this,j=this.m(e,o,s),$;if(e=Hl,j){var _t=x.setTimeout(function(){_.T?($=new tf("arraybuffer",j,g,_.u),$.then(function(_e){return _e.blob()}).then(function(_e){var _r=new Image;_r.onload=A(h,null,_r,{raw:_e}),_r.onerror=A(d,null,"bad url");try{_r.src=_.f.createObjectURL(_e)}catch{}},d)):($=new tf("image",j,g,_.u),$.then(h,d))},150);e={cancel:function(){$?$.cancel():x.clearTimeout(_t)}}}else h(null);return e},Ek.prototype.requestInternal=Ek.prototype.B,Ek.prototype.ea=function(e,o){var s=new Image;s.onload=function(){o(this)},s.src=this.f.createObjectURL(e)},Ek.prototype.aa=function(e,o){(e=o.data)&&e instanceof HTMLImageElement&&this.f.revokeObjectURL(e.src)},Ek.prototype.V=function(){return this.Ya()},Ek.prototype.getStyle=Ek.prototype.V,Ek.prototype.gb=function(e){H.map.render.harp&&this.b===kk.HARP&&e instanceof H.map.render.harp.Style&&this.Qa(e)},Ek.prototype.setStyle=Ek.prototype.gb,t("H.util.events.listenOnce",Fe),t("H.util.events.dispatchEvent",function(e,o){return e.dispatchEvent(o)}),t("H.util.events.fireListeners",function(e,o,s,h){return pe(e)?e.jd(o,s,h):Oe(e,o,s,h)}),t("H.util.events.listen",Ee),t("H.util.events.unlisten",Me);var Il=Pe;Pe=function(e,o){var s,h,d=!0,g=o[o.currentTarget===o.target?"AT_TARGET":e.capture?"CAPTURING_PHASE":(s=!0,"BUBBLING_PHASE")];return(!s||(h=o.type)!=="pointerenter"&&h!=="pointerleave")&&(o.eventPhase=g,d=Il(e,o),s&&e.src&&e.src.Mb&&e.src.Mb()===null&&delete o.eventPhase),d};function Jl(e,o,s,h){var d=new yk(0,0,0,0);if(Jl.j.constructor.call(this),!e)throw new D(Jl,0,e);if(!o)throw new D(Jl,1,o);if(!s)throw new D(Jl,2,s);if(typeof h!="object")throw new D(Jl,3,h+" is not an object");if(typeof h.pixelRatio!="number")throw new D(Jl,3,h.pixelRatio+" is not a number");this.oa=h.pixelRatio,this.zoom=0,this.fb=Ed(this.oa)/Od,this.b=new nj,this.wa={1:d.clone(),2:d.clone(),4:d.clone()},this.s=new J(.5,.5),this.f=e,Kl(this,this.oa),this.lc=A(this.lc,this),this.cc=A(this.cc,this),this.wb=A(this.wb,this),e.startInteraction=this.lc,e.interaction=this.cc,e.endInteraction=this.wb,e.addEventListener(e.A.za,this.T,!1,this),this.getCapabilities=this.getCapabilities,this.capture=this.capture,this.zoomAt=this.xd,this.relaunch=this.ha,this.dispose=this.F,this.screenToGeo=this.Pa,this.geoToScreen=this.Da,this.screenToLookAtData=this.qg,this.J=o,this.kc=A(this.kc,this),this.control=A(this.control,this),this.vb=A(this.vb,this),o.startControl=this.kc,o.control=this.control,o.endControl=this.vb,o.addEventListener(o.A.za,this.Kg,!1,this),this.c=s,this.Zf=A(this.Zf,this),this.Me=A(this.Me,this),this.Ne=A(this.Ne,this),this.Yf=A(this.Yf,this),s.addEventListener(qj.prototype.A.za,this.Zf,!1,this),s.addEventListener(s.A.he,this.Me,!1,this),s.addEventListener(s.A.je,this.Ne,!1,this),s.addEventListener(s.A.ke,this.Yf,!1,this)}u(Jl,F),t("H.map.render.RenderEngine",Jl),Jl.prototype.xd=function(){};function Kl(e,o){var s=e.f,h=s.width,d=s.height,g=s.padding,_=g.top,j=g.left,$=g.bottom;g=g.right,s=s.margin;var _t=-(h+j-g)/2<<0,_e=-(d+_-$)/2<<0;h+=_t,d+=_e,e=e.wa,e[1].set((_t-s)*o,(_e-s)*o,(h+s)*o,(d+s)*o),e[2].set(_t*o,_e*o,h*o,d*o),e[4].set((_t+j)*o,(_e+_)*o,(h-g)*o,(d-$)*o)}Jl.prototype.T=function(){Kl(this,this.oa)},Jl.prototype.o=function(){var e=this.f,o=this.J,s=this.c;e.removeEventListener(e.A.za,this.T,!1,this),e.startInteraction===this.lc&&(e.startInteraction=xk.prototype.lc),e.interaction===this.cc&&(e.interaction=xk.prototype.cc),e.endInteraction===this.wb&&(e.endInteraction=xk.prototype.wb),o.removeEventListener(o.A.za,this.Kg,!1,this),o.startControl===this.kc&&(o.startControl=Ll.prototype.kc),o.control===this.control&&(o.control=Ll.prototype.control),o.endControl===this.vb&&(o.endControl=Ll.prototype.vb),s.removeEventListener(qj.prototype.A.za,this.Zf,!1,this),s.removeEventListener(s.A.he,this.Me,!1,this),s.removeEventListener(s.A.je,this.Ne,!1,this),s.removeEventListener(s.A.ke,this.Yf,!1,this)},Jl.prototype.mi=function(e){this.me=e},Jl.prototype.setAnimationCallback=Jl.prototype.mi,Jl.prototype.hi=function(){this.me=void 0},Jl.prototype.resetAnimationCallback=Jl.prototype.hi,Jl.prototype.control=function(){},Jl.prototype.capture=function(){return $b(Error("not implemented"))};function Ml(e,o){e.style.transition="opacity 1.5s",Fe(e,"transitionend",o,!1),e.style.opacity=0}var Nl={ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16};Jl.InteractionModifiers=Nl,p=Jl.prototype,p.A={Vi:"render"},p.Zf=function(e){this.nk(e),this.ha()},p.Me=function(e){this.Pe(e.idx,e.added)},p.Ne=function(e){this.Xh(e.idx,e.removed,e.type===this.c.A.ke)},p.Yf=function(e){e.removed&&this.Ne(e),this.Me(e)},p.nk=ld,p.Pe=function(e,o){this.th(e,o),e===0&&this.Eb(),C(o,qj)&&Ol(this,o,!0),this.ce(),this.ha()},p.Eb=function(){var e=this.c.La();if(0<e.length){var o=e[0].max;this.Eg=e[0].min,this.Dg=o}else e=this.getCapabilities().lookAt.zoom,o=e.max,this.Eg=e.min,this.Dg=o;e=Pl(this,this.zoom),e!==this.zoom&&(this.zoom=e,this.b.Oa(e),this.$a())},p.$a=function(e){this.P=this.jb(),e&&(this.P.position=e),this.P.zoom=this.zoom-this.fb,this.P.position.alt=0},p.dl=0,p.heading=180,p.jb=function(){return Ql(this,{position:this.b.projection.dg(this.s),zoom:this.zoom,tilt:this.dl,heading:this.heading})};function Ql(e,o){return o.tilt=Rl(e,o.tilt),o.heading=Sl(e,o.heading),o.incline=e.getCapabilities().lookAt.incline.min,o}function Pl(e,o){var s=e.getCapabilities().lookAt.zoom;return ae(o,zd(s.min,e.Eg),yd(s.max,e.Dg))}function Rl(e,o){return e=e.getCapabilities().lookAt.tilt,ae(o,e.min,e.max)}function Sl(e,o){return e=e.getCapabilities().lookAt.heading,ae((o%360+360)%360,e.min,e.max)}function Ol(e,o,s){s=s?o.addEventListener:o.removeEventListener,s.call(o,o.A.Ti,e.Yh,!1,e),s.call(o,o.A.Si,e.Yh,!1,e)}p.th=ld,p.Xh=ld,p.xo=function(e,o){this.D={before:e,after:o}},Jl.prototype.setOnRenderCallbacks=Jl.prototype.xo;var Tl={P2D:0,WEBGL:1,HARP:2};Jl.EngineType=Tl;var Ul={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:85},incline:{min:0,max:0},heading:{min:0,max:360}},interaction:{ZOOM:Nl.ZOOM,COORD:Nl.COORD},capture:!0};t("H.map.render.webgl.capabilities",Ul);function Vl(e){var o,s=this,h=x.H.gl;Vl.j.constructor.call(this),this.a=o=h.Scene.create(x.URL.createObjectURL(pf(JSON.stringify(Wl))),{viewport:e.viewport,container:e.Zb,disableRenderLoop:!0,devicePixelRatio:e.devicePixelRatio,logLevel:"error"}),e.ao&&o.subscribe({load:e.ao}),o.subscribe({view_complete:function(){s.ji=!0,e.qk()}});var d=o.requestRedraw;o.requestRedraw=function(){d.apply(o),e.qk()},this.ki=A(this.ki,this),this.jg=A(this.jg,this),this.f=0,this.c={},this.b={}}u(Vl,qd),p=Vl.prototype,p.ji=!1;function Xl(e){e=e.a.sources;var o;for(o in e){var s=e[o];if(s.hasPendingCommands&&s.hasPendingCommands())return!0}return x.H.gl.Task.hasPendingTasks()}p.W=function(){var e=x.H.gl.Task;return this.a.immediateRedraw(),e.setState({user_moving_view:this.a.view.user_input_active}),e.processAll(),this.ji&&!this.a.dirty&&!this.a.building&&!Xl(this)&&!Object.keys(this.b).length};function Yl(e){e.ji=!1,e.a.resetViewComplete()}function Zl(e){return e.a.view}function $l(e,o){function s(){var d=o.La(),g={},_={},j,$,_t,_e=++e.f,_r,_n;for($h(_,Wl),$=0;$<d.length;$++){var _o=d[$];if(j=_o.ca()){var ga=j.Ya();if(ga.getState()===Xh.READY){var _l=ga.qc();if(!Va(_l)){delete _l.cameras,delete _l.camera,g[$]=_l=li(_l,$),!C(_o,tl)&&_l.sources&&mi(_l,j.uid);for(_t in _l.sources){var _f=_l.sources[_t];_f.max_zoom=yd(j.max,Ul.lookAt.zoom.max),_f.max_display_zoom=_o.max,_f.min_display_zoom=_o.min,(_n=j.tileSize)&&(2<=h&&256<_n&&j instanceof Ek&&(_n/=2),_f.tile_size=_n)}(_r=ga.Ib())&&ni(_l,_r),$h(_,_l)}}}}return $h(_.layers.skybox.draw.skybox.color,_.scene.sky),e.a.config=_,e.a.updateConfig().then(function(){var _c={},_p,_g;if(_e!==e.f)return!1;e.f=0;for(_g in g){_o=d[+_g];var ty=g[_g].sources;for(_p in ty)(ty=e.a.sources[_p])&&(_c[_p]=ty,ty.initialize&&_o.getProvider()&&ty.initialize(_o.getProvider(),e.ki,e.a.getWorkers().length,ty.tiled?B:e.a.tile_manager.getWorkerForTile(z,ty)))}for(_p in e.c)!_c[_p]&&e.c[_p].dispose&&e.c[_p].dispose();return e.c=_c,!0})}var h=e.a.pixelRatio();e.a.initialized?s():e.a.load(z,{blocking:!1}).then(s)}p.ki=function(e,o,s){var h=this,d=this.a.sources[e],g=s&&s.isReload;o?this.b[e]!==!0&&(this.b[e]||(this.b[e]={cl:{},aj:[]}),C(o,Xk)?this.b[e].cl[o.x+"/"+o.y+"/"+o.z]=!0:(o=o.boundingBox,this.b[e].aj.push(new K(o[0],o[1],o[2],o[3])))):this.b[e]=!0,d&&d.has_volatile_data?am(this,g):(x.clearTimeout(this.g),this.g=x.setTimeout(function(){return am(h,g)},100))},p.jg=function(e){var o=!1,s=this.b[e.source.name],h=x.H.gl;if(s)if(s===!0)o=!0;else{var d=h.Tile.coord(h.Geo.wrapTile(e.coords));if(o=!!s.cl[d.key],!o){var g=h.Geo.getTileBoundingBox(d,e.source.tile_size,wh.MAX_LINE_WIDTH/2);g=sg(g.getTopLeft(),g.getBottomRight()),o=s.aj.some(function(_){return _.nd(g,!0)||g.gd(_.bb(),!0)})}}return o};function am(e,o){var s=e.a.tile_manager;s.removeTiles(e.jg),s.updateTilesForView(),o&&s.removeCachedTiles(e.jg),Yl(e),e.b={}}p.qc=function(){return this.a.config};function bm(e,o,s,h){e.a.getFeatureAt(o,s,h),e.a.update()}function cm(e){return e.a.screenshot(void 0).then(function(o){return new Rb(function(s,h){new Rj(URL.createObjectURL(o.blob),function(d,g){d===1?s(g.getData()):h()},!1)})})}p.Xa=function(){return this.a.pixelRatio()},p.o=function(){var e=this.c;Vl.j.o.call(this),this.a.destroy(),this.b={},e&&Object.keys(e).forEach(function(o){e[o].dispose()}),x.clearTimeout(this.g),delete this.c,delete this.a},Vl.prototype.disposeInternal=Vl.prototype.o;var Wl={scene:{background:{color:"#FFFFFF"},sky:{zenith:"#347BC0",horizon:"#EDF2F9",fog:"#FFFFFF"}},lights:{default_light:{type:"directional",name:"default_light",visible:!0}},camera:{type:"perspective"},styles:{},fonts:{},sources:{skybox:{type:"SkyBox"}},layers:{skybox:{data:{source:"skybox"},draw:{skybox:{color:{}}}}},global:{}},nk={FEATURE:1,SOURCE:2,PROVIDER:3};t("H.map.provider.PickingMode",nk);function dm(e){return e}t("H.util.animation.ease.LINEAR",dm),t("H.util.animation.ease.EASE_IN_QUAD",function(e){return e*e});function em(e){return-e*(e-2)}t("H.util.animation.ease.EASE_OUT_QUAD",em),t("H.util.animation.ease.EASE_IN_OUT_QUINT",function(e){return e*=2,1>e?Gd(e,5)/2:(e-=2,Gd(e,5)/2+1)});function fm(e){return 1-Math.sqrt(1-e*e)}function gm(e){return Fd(2*e-e*e)}t("H.util.animation.ease.EASE_OUT_CIRC",gm);function hm(e){return 1-Math.cos(e*Math.PI/2)}function im(e){return Math.sin(e*Math.PI/2)}function jm(e,o){this.a={tilt:km(e.tilt,o.tilt),heading:km(e.heading,o.heading),zoom:o.zoom-e.zoom};var s=this.b=ng(e.position),h=o.position;e=h.lat*Ud;var d=s.lat*Ud;h=h.lng*Ud-s.lng*Ud,s=Id(h)*Kd(e),e=Kd(d)*Id(e)-Id(d)*Kd(e)*Kd(h),e=Math.atan2(s,e),this.i=(0<=e?e:Sd+e)*Vd,this.c=this.b.Wa(o.position),o=this.a.zoom,this.g=o===0?lm:Object.assign({},lm,{zoom:0>o?gm:fm,position:0>o?hm:im}),this.f=Object.assign({},{tilt:0,heading:0,zoom:0})}function km(e,o){return e=o-e,-180<e&&180>=e?e:180<e?e-360:e+360}var lm={tilt:dm,heading:dm,zoom:dm,position:dm};function mm(e,o){if(E(this.x=+e))throw new D(mm,0,e);if(E(this.y=+o))throw new D(mm,1,o)}mm.prototype.add=function(e){return new mm(this.x+e.x,this.y+e.y)},mm.prototype.a=function(e){if(!C(e,mm))throw new D(this.a,0,e);return e=this.b(e),e.x+e.y},mm.prototype.b=function(e){if(!C(e,mm))throw new D(this.b,0,e);return new mm(this.x*e.x,this.y*e.y)},mm.prototype.Oa=function(e){return new mm(this.x*e,this.y*e)};function nm(e){return Fd(e.a(e))}function om(e){e=e||jf,this.mb=vc(e.Wn)?e.Wn:3,this.U=vc(e.Un)?e.Un:300,this.u=vc(e.No)?e.No:3,this.J=vc(e.Io)?e.Io:50,this.c=[],this.clear()}t("H.map.render.InteractionUtils",om),om.prototype.tn=function(){return this.b},om.prototype.isGestureDetected=om.prototype.tn,om.prototype.start=function(e,o){var s=Nl.HEADING,h=Nl.TILT;this.s&&this.clear(),this.g=e,this.l=!!o,this.s=!0,this.b=!(e&(s|h))||e===s||e===h},om.prototype.start=om.prototype.start,om.prototype.store=function(e,o,s,h,d){var g=!1;if(this.s){if(e=new pm(e,o,s,h,d),g=e.c,this.m=this.a,this.a=e,this.f){if(this.i=!0,g){o=this.g;var _=this.b;if(!_&&this.i){d=Nl.HEADING;var j=Nl.TILT;s=Nl.COORD,h=Nl.ZOOM;var $=o&(s|j)?this.Nd(!0):qm,_t=o&h?this.Cf(!0):1,_e=o&d?Dd(this.bh(!0)):0,_r=Dd($.x),_n=Dd($.y);$=10<_r||10<_n,_r=10<_n&&_n>3*_r,_t=.8>_t||1.2<_t,_e=7<_e,o&j&&(_e||_t||$&&!_r?rm(this,j):_r&&(rm(this,~j>>>0),_=!0)),!_&&o&d&&o&(s|h)&&(_t||$?(rm(this,d),_=!0):_e&&(rm(this,j),_=!0)),this.b=_}}}else this.f=e,g||(this.b=!0);this.l&&this.c.push(e)}return g},om.prototype.store=om.prototype.store,om.prototype.clear=function(){this.c.length=0,this.s=this.l=this.i=this.b=!1,this.f=this.m=this.a=void 0},om.prototype.clear=om.prototype.clear,om.prototype.Ac=function(e){return 0<(this.g&e)},om.prototype.isModifierEnabled=om.prototype.Ac;function rm(e,o){e.g^=e.g&o}om.prototype.sa=function(){return this.s},om.prototype.isRunning=om.prototype.sa;var qm=qc(new mm(0,0));om.prototype.rc=function(){var e;if(this.l){var o=this.c,s=o.length,h=0;for(e=new mm(0,0);--s&&h<this.u;)e=e.add(sm(o[s-1],o[s])),h++}else e=this.Nd();return o=e,s=nm(o),s!==0?new mm(o.x/s,o.y/s):o},om.prototype.getDirection=om.prototype.rc,om.prototype.zb=function(e){e=e||Lk();var o,s;if(this.l){var h=this.c,d=this.c.length,g=this.c[d-1];for(s=o=0;--d&&o<this.u;)s+=nm(sm(h[d],h[d-1])),o++;h=s/o}else g=this.a,h=nm(this.Nd());return h=h>=this.mb&&e-g.timestamp<=this.J?h>this.U?this.U:h:0},om.prototype.getSpeed=om.prototype.zb,om.prototype.Bf=function(){return this.a?tm(this.a):B},om.prototype.getBifocalCenter=om.prototype.Bf,om.prototype.Nd=function(e){return(e=e?this.f:this.m)?sm(e,this.a):new mm(0,0)},om.prototype.getMoveVector=om.prototype.Nd,om.prototype.Cf=function(e){var o=1;if(this.i){var s=this.a;e=e?this.f:this.m,(e=um(e))&&(s=um(s))&&(o=s/e)}return o},om.prototype.getBifocalScaling=om.prototype.Cf,om.prototype.bh=function(e){if(this.i){var o=e?this.f:this.m,s=this.a;e=o.b;var h=s.b,d=0;e&&h&&(o=o.a,s=s.a,d-=Nd(h.y-s.y,h.x-s.x)*Vd-Nd(e.y-o.y,e.x-o.x)*Vd),e=d}else e=0;return e},om.prototype.getBifocalRotation=om.prototype.bh;function pm(e,o,s,h,d){this.a=new J(e,o),s!==B&&(this.b=new J(s,h),this.c=!0),this.timestamp=d!==B?d:Lk()}pm.prototype.c=!1;function tm(e){var o=e.a;return(e=e.b)?new J(o.x-(o.x-e.x)/2,o.y-(o.y-e.y)/2):B}function vm(e,o){var s=e.a;return(e=e.b)&&e.Wa(o)<s.Wa(o)?e:s}function sm(e,o){var s=e.b,h=o.b;return h&&s?(o=tm(o),e=tm(e)):s?(o=o.a,e=vm(e,o)):h?(e=e.a,o=vm(o,e)):(o=o.a,e=e.a),new mm(o.x-e.x,o.y-e.y)}function um(e){var o=e.b;return o?e.a.Wa(o):0}function wm(){F.call(this),this.reset()}u(wm,F),wm.prototype.start=function(e,o){this.c&&this.reset(),E(e-o)||(this.a=+e,this.b=+o),this.c=!0},wm.prototype.reset=function(){this.c=!1,this.a=this.b=B,this.f=new xm(0,0,0,0,0,0)},wm.prototype.sa=function(){return this.c},wm.prototype.A={Cg:"animationupdate"};function ym(e){ym.j.constructor.call(this,wm.prototype.A.Cg),this.b=e}u(ym,ud),wm.prototype.set=function(e,o,s,h,d,g){var _=this.f;this.c&&(e=new xm(e/1e3,o/1e3,s/1e3,h/1e3,d/1e3,g/1e3),_.ia(e)||(this.f=e,this.dispatchEvent(new ym(zm(this)))))};function zm(e){return x.Object.create(e.f)}wm.prototype.zb=function(){return zm(this).zb()},wm.prototype.rc=function(){var e=zm(this),o=this.zb()||1;return new xm(e.a/o,e.b/o,e.c/o,e.f,e.g,e.i)},wm.prototype.o=function(){this.reset(),wm.j.o.call(this)};function xm(e,o,s,h,d,g){this.a=e,this.b=o,this.c=s,this.f=h,this.g=d,this.i=g}xm.prototype.zb=function(){return Fd(this.a*this.a+this.b*this.b+this.c*this.c)},xm.prototype.rc=function(){var e=this.zb()||1;return new xm(this.a/e,this.b/e,this.c/e,this.f,this.g,this.i)},xm.prototype.ia=function(e){var o=e===this;return!o&&(o=C(e,xm))&&(o=this.a===e.a&&this.b===e.b&&this.c===e.c&&this.f===e.f&&this.g===e.g&&this.i===e.i),o};function Am(e,o,s,h){Am.j.constructor.call(this),this.Zb=e,this.oa=h,this.a=e.appendChild(this.createElement(e.ownerDocument)),this.cf(o,s)}u(Am,qd),Am.prototype.N=function(){return this.a},Am.prototype.cf=function(e,o){this.size?(this.size.w=e,this.size.h=o):this.size=new Wi(e,o),this.Uk(this.a,this.a.style,e,o,this.oa)},Am.prototype.setSize=Am.prototype.cf,p=Am.prototype,p.yb=function(){return this.size},p.Xa=function(){return this.oa},p.Vj=!0,p.qb=function(e){e!==this.Vj&&(this.a.style.display=e?"block":"none",this.Vj=e)},p.Ih=1,p.ic=function(e){this.Ih!==e&&(this.Yj(e),this.Ih=e)},p.Tc=function(){return this.Ih},p.fe=function(e){this.a.style.zIndex=e},Am.prototype.setZIndex=Am.prototype.fe,Am.prototype.Ij=function(){return+this.a.style.zIndex},Am.prototype.Oc=function(){},Am.prototype.clear=function(){},Am.prototype.o=function(){this.clear(),this.Zb.removeChild(this.a),this.cf(0,0),delete this.a,delete this.Zb,Am.j.o.call(this)},Am.prototype.disposeInternal=Am.prototype.o,Am.prototype.f=0,Am.prototype.pg=function(){++this.f},Am.prototype.release=function(){--this.f||this.F()};function Bm(e,o,s,h,d,g){var _=d||"2d";Bm.j.constructor.apply(this,arguments),this.b=this.a.getContext(_,g),this.c=_==="2d",this.g=_,this.In=g}u(Bm,Am),p=Bm.prototype,p.createElement=function(e){e=e.createElement("canvas");var o=e.style;return o.position="absolute",o.top=o.left="0",e},p.Uk=function(e,o,s,h,d){e.width=zd(s,1),e.height=zd(h,1),o.width=Ad(s/d)+"px",o.height=Ad(h/d)+"px"},p.Yj=function(e){this.b.globalAlpha=e},p.Oc=function(e,o,s,h,d){this.c&&this.b.drawImage(e,o,s,h,d)},p.Id=function(){return this.g},p.clear=function(e){var o,s;this.c&&(e?this.b.clearRect(o=e.left,s=e.top,e.right-o,e.bottom-s):this.a.width=this.size.w)},p.o=function(){var e=this.a;e.width=e.height=0,delete this.b,Bm.j.o.call(this)},Bm.prototype.disposeInternal=Bm.prototype.o;function Cm(e){this.eb=e}u(Cm,qd),Cm.prototype.ob=function(){return this.eb},Cm.prototype.getLayer=Cm.prototype.ob,Cm.prototype.Ym=function(){return this.lb},Cm.prototype.getSurface=Cm.prototype.Ym,Cm.prototype.ad=function(e){var o=this.lb;e!==o&&(this.lb=e,e.pg(),o&&o.release())},Cm.prototype.setSurface=Cm.prototype.ad,Cm.prototype.o=function(){this.lb.release()},Cm.prototype.disposeInternal=Cm.prototype.o,Cm.prototype.Rd=function(){},Cm.prototype.render=Cm.prototype.W;function Dm(e){var o="dom";Dm.j.constructor.call(this,e),C(this.eb,Em)&&(o=e.Id()==="2d"?"2d":"webgl"),this.a=o}u(Dm,Cm),Dm.prototype.W=function(e,o,s,h,d,g,_,j){_=this.eb;var $=this.lb,_t=!(C($,Bm)&&$.Id()==="2d");return h>=_.min&&h<=_.max?(_t&&$.qb(!0),_.W($.N(),{boundingBox:e,zoom:h,screenCenter:o,priorityCenter:g,projection:s,cacheOnly:d,size:$.yb(),pixelRatio:$.Xa(),cameraMatrix:j})):(_t&&$.qb(!1),wk.DONE)},Dm.prototype.Rd=function(){return this.a};function Fm(e,o,s,h,d){if(!Da(e.mi)||!Da(e.hi))throw new D(Fm,0,e);if(this.b=e,!Da(this.l=o))throw new D(Fm,1,o);if(E(this.i=+s))throw new D(Fm,2,s);if(!Da(this.g=h)&&h!=null)throw new D(Fm,3,h);if(!Da(this.c=d)&&d!=null)throw new D(Fm,4,d);this.id=new cf().next(),this.a=!1}t("H.util.animation.Animation",Fm),Fm.prototype.start=function(){var e=this;this.f=Lk(),this.a=!0;var o=this.f;this.b.mi(function(){if(e.a){var s=Lk(),h=s-e.f,d=h/e.i,g=!1;1<=d&&(d=1,g=!0),e.l(e.c?e.c(d):d,h,s-o,s),o=s,g&&e.stop()}else e.stop()})},Fm.prototype.start=Fm.prototype.start,Fm.prototype.stop=function(e){this.a=!1,this.b.hi(),e||this.g&&this.g(this)},Fm.prototype.stop=Fm.prototype.stop,Fm.prototype.sa=function(){return this.a},Fm.prototype.isRunning=Fm.prototype.sa;function Gm(e,o){Gm.j.constructor.call(this,e),this.oc=!(!o||!o.oc),this.f={}}u(Gm,Cm),Gm.prototype.ad=function(e){Gm.j.ad.call(this,e),this.l=e.Zb.ownerDocument},Gm.prototype.setSurface=Gm.prototype.ad;var Hm=(function(e,o){return o=o.ga(),C(o,gh)?o.la:(e[0]=o,e)}).bind(null,[]);Gm.prototype.W=function(e,o,s,h,d,g,_){var j=this.eb,$,_t,_e,_r;if(this.s=o=this.f,this.f=s={},h>=j.min&&h<=j.max){var _n=this.rj(e,h,d,g),_o=_n.markers;if(e=_o.length){for(h=[],d=this.lb,g=0;g<e;g++){j=_o[g];var ga=Hm(j);for($=ga.length;$--;)(_t=_(ga[$]))&&((_r=o[_e=j.cb()+"_"+$])?delete o[_e]:_r={ik:j},s[_e]=_r,h.push([_r,j,j.xb(),d,_t.x,_t.y]))}for(h.sort(Im),e=h.length,g=0;g<e;g++)this.Ek.apply(this,h[g])}}return!_n||_n.requested&&_n.requested===_n.total||!_n.requested&&_o.length===_n.total?wk.DONE:wk.PENDING},Gm.prototype.render=Gm.prototype.W;function Im(e,o){var s=e[1].Uc(),h=o[1].Uc();return oh(s,h,!0)||e[5]-o[5]||oh(s,h,!1)}Gm.prototype.Ea=function(){},Gm.prototype.getObjectsAt=Gm.prototype.Ea;function Jm(e,o){Jm.j.constructor.apply(this,arguments),this.c=0,this.a=[],this.b=A(this.b,this)}u(Jm,Gm),t("H.map.render.dom.MarkerRenderer",Jm),Jm.prototype.rj=function(){return this.eb.Dc.apply(this.eb,arguments)},Jm.prototype.W=function(e,o,s,h,d,g,_){this.b(),this.i=0;var j=Jm.j.W.apply(this,arguments),$=this.lb,_t=this.s,_e;for(_e in _t)Km(this,$,_t[_e]);return this.a.length===0&&j?wk.DONE:wk.PENDING},Jm.prototype.render=Jm.prototype.W,Jm.prototype.ad=function(e){Jm.j.ad.call(this,e),this.g=e.Xa()},Jm.prototype.setSurface=Jm.prototype.ad,Jm.prototype.b=function(){for(var e=this.a.length,o,s,h;e--;)h=this.a[e],o=h.Ag,s=o.xb(),s.Vh(h,s,o);this.a.length=0},Jm.prototype.Ek=function(e,o,s,h,d,g){var _,j=h.Xa(),$=o.Kb();d*=j,g*=j,this.oc||(d=Ad(d),g=Ad(g)),e.detail&&($.Vd(e.qn)?Km(this,h,e):_=e.detail),_||(e.detail=_=s.uj(this.l),this.c++,Da(s.Vh)&&this.a.push(_)),e.qn=$.a,_.style.zIndex=this.i++,_.Ag=o,h.Oc(_,d,g,0,0)};var Lm,Mm="pointer-events",Nm;if($e){var Om;$e&&bd!==z&&(bd=(Om=/(MSIE\s+|rv:)([^\);]+)(\)|;)/.exec(navigator.userAgent))?+Om[2]:z),Nm=bd,Nm===9?Mm="display":Nm===10&&(Mm="visibility")}Lm=Mm,Jm.prototype.Ea=function(e,o,s){var h=this.g,d=hf,g,_,j,$,_t;if(this.c){e/=h,o/=h,h=this.lb.Zb.getRootNode();var _e=h.documentElement,_r=this.lb.N(),_n=_r.getBoundingClientRect();for(e+=_n.left,o+=_n.top;(_=j=h.elementFromPoint(e,o))&&_!==_r&&_!==_e&&_!==h.host&&j!==_o;){for(;($=_.parentNode)&&(!Da($.contains)||!$.contains(_r));)_=$;if($===_r&&(_!==j||_.nodeName!=="svg")&&0>d.indexOf(_t=_.Ag)&&(d===hf&&(d=[]),d.push(_t),s))break;g||(g=[]);var _o=_.style;g.push({fj:_o.getPropertyValue(Lm),pn:_o.getPropertyPriority(Lm),style:_o}),_o.setProperty(Lm,Lm==="visibility"?"hidden":"none","important"),_o=j}if(g)for(o=g.length;o--;)e=g[o],e.style.removeProperty(Lm),Cc(e.fj)&&e.style.setProperty(Lm,e.fj,e.pn)}return d},Jm.prototype.getObjectsAt=Jm.prototype.Ea,Jm.prototype.Rd=function(){return"dom"};function Km(e,o,s){o.clear(o=s.detail),delete o.Ag,e.c--,s=(e=s.ik).xb(),s.b&&s.b(o,s,e)}Jm.prototype.o=function(){this.a.length=0;var e=this.lb,o=this.f,s;for(s in o)Km(this,e,o[s]);this.lb.F(),Jm.j.o.call(this)},Jm.prototype.disposeInternal=Jm.prototype.o;function Em(e,o){var s=o||{},h=s.contextType;if(s=s.contextAttributes,Em.j.constructor.call(this,o),zc(e,"Function",Em,0,"invalid render callback"),h){if(Pm.indexOf(h)===-1)throw new D(Em,1,"invalid context type");this.b=h}s&&(this.c=s),this.f=e}u(Em,qj),t("H.map.layer.CanvasLayer",Em);var Pm=["2d","webgl","webgl2","experimental-webgl"];Em.prototype.b="2d",Em.prototype.Id=function(){return this.b},Em.prototype.W=function(e,o){return this.a&&this.a.canvas===e||(this.a=e.getContext(this.b,this.c)),this.f(this.a,o)},Em.prototype.o=function(){Em.j.o.call(this),delete this.a};function Qm(e,o){Qm.j.constructor.call(this,o),zc(e,"Function",Qm,0,"invalid render callback"),this.a=e}u(Qm,qj),t("H.map.layer.DomLayer",Qm),Qm.prototype.W=function(e,o){return this.a(e,o)};function Rm(e,o){if(E(this.b=+e))throw new D(Rm,0,e);this.a=0,o&&this.Qk(o)}t("H.util.kinetics.KineticMove",Rm),Rm.prototype.Qk=function(e){return this.a=e,this},Rm.prototype.setInitialSpeed=Rm.prototype.Qk,Rm.prototype.am=function(){return Math.abs(this.a/this.b)},Rm.prototype.getDuration=Rm.prototype.am,Rm.prototype.De=function(e){return this.a+this.b*e},Rm.prototype.getCurrentSpeed=Rm.prototype.De,Rm.prototype.Wl=function(e){return this.a*e+this.b*e*e/2},Rm.prototype.getCurrentPath=Rm.prototype.Wl;function Sm(e,o,s,h){Sm.j.constructor.apply(this,arguments)}u(Sm,Am),t("H.map.render.dom.Surface",Sm),p=Sm.prototype,p.Id=function(){return"dom"},p.createElement=function(e){return e=e.createElement("DIV"),e.style.position="absolute",e.style.pointerEvents="none",e},p.Uk=function(e,o,s,h){o.width=s+"px",o.height=h+"px"},p.Yj=function(e){this.a.style.opacity=e},p.Oc=function(e,o,s){var h=this.oa,d=e.style;d[Af("transform")]="matrix(1,0,0,1,"+o/h+","+s/h+")",e.parentNode!==this.a&&(d.position="absolute",this.a.appendChild(e),this.a.style.pointerEvents="auto",getComputedStyle(e).pointerEvents==="auto"&&(e.style.pointerEvents="all"),this.a.style.pointerEvents="none")},p.clear=function(e){e?this.a.removeChild(e):this.a.innerHTML=""};function Tm(e,o){this.a=e,this.b=o}function Um(e,o,s){var h=[],d={Zb:e.a,width:o.w,height:o.h,oa:e.b};for(e=0;e<s.length;e++){o=s[e];var g=o.Rd(),_={};Ya(_,d);var j=o.lb;switch(g){case"2d":if(C(o.ob(),Em)&&(_.Rg=o.ob().c),g=_e&&_e.Id()==="2d"){g=_.Rg;var $=_e.In;g=$===g?!0:$&&!g?!$.alpha&&!$.willReadFrequently:g&&!$?!g.alpha&&!g.willReadFrequently:!g.alpha==!g.alpha&&!$.willReadFrequently==!g.willReadFrequently}if(g)var _t=!1;else if(j&&!_t){var _e=j;_t=!1}else _e=new Bm(_.Zb,_.width,_.height,_.oa,"2d",_.Rg),_t=!0;break;case"dom":_e=j||new Sm(_.Zb,_.width,_.height,_.oa),_t=!j;break;default:_e=j||new Bm(_.Zb,_.width,_.height,_.oa,o.ob().Id(),_.Rg),_t=!j}h[h.length-1]!==_e&&(_e.fe(h.length),h.push(_e)),o.ad(_e)}return h}function Ll(){Ll.j.constructor.call(this),this.b={},this.a={position:new kg(0,0),zoom:0,heading:180,incline:0,tilt:0,bounds:new O(ch([90,-180,90,0,90,180,-90,180,-90,-180]))}}u(Ll,F),t("H.map.ViewModel",Ll),Ll.prototype.A={za:"update",le:"sync"},Ll.prototype.Wb=function(e,o){if(!e)throw new D(this.Wb,0,e);var s=e[Vm];if(vc(s)&&!lg(s))throw new D(this.Wb,0,Vm);if(s=e[Wm],vc(s)&&E(+s))throw new D(this.Wb,0,Wm);if(s=e[Xm],vc(s)&&!C(s,jg))throw new D(this.Wb,0,Xm);return e=x.Object.assign({},e),s=Ym(e,this.b,this.a),Zm(this,this.b,e),this.dispatchEvent(new $m(this.b,s,o)),this},Ll.prototype.setLookAtData=Ll.prototype.Wb,Ll.prototype.jb=function(){var e={};return e[Vm]=ng(this.a[Vm]),Zm(this,e,this.a,!0),e},Ll.prototype.getLookAtData=Ll.prototype.jb;var Vm="position",Wm="zoom",Xm="bounds",an={Ui:Vm,Xi:Wm,Oi:"heading",Wi:"tilt",Pi:"incline",Mi:Xm},bn=Object.keys(an).map(function(e){return an[e]});function Zm(e,o,s,h){e.g={},e.f={},e.c=[];for(var d=e.l,g=e.i,_=bn.length,j,$,_t;_--;)if(j=bn[_],_t=s[j],$=o[j],$==null||!h)if(_t!=null){vc(d)&&d.call(e,j,$,_t);var _e=j,_r;if((_r=j!=="position")||(_r=_t,_r=!(!_r||E(_r.lat)||E(_r.lng))),o[_e]=_r?_t:ng(_t),vc(g)){switch(j){case"position":$=_t&&$&&(_t.lat!==$.lat||_t.lng!==$.lng);break;case"bounds":$=_t&&$&&!_t.ia($);break;default:$=_t!==$}$&&g.call(e,j)}}else delete o[j]}Ll.prototype.l=function(e,o,s){this.g[e]=o,this.f[e]=s},Ll.prototype.i=function(e){this.c.push(cn[e])};var cn=bn.reduce(function(e,o){return e[o]=ej[o.toUpperCase()],e},{});function Ym(e,o,s){var h=0;return["tilt","incline","heading",Wm].forEach(function(d){if(E(e[d])){var g=E(o[d])?s[d]:o[d];e[d]=g}else h|=cn[d]}),[Vm,Xm].forEach(function(d){e[d]?h|=cn[d]:e[d]=o[d]||s[d]}),h}Ll.prototype.$a=function(e){var o={},s={};Zm(this,this.a,e),this.b={},o.lookAt=this.f,s.lookAt=this.g,e=this.c,e=e.length?e.reduce(dn):0,this.dispatchEvent(new dj(this.A.le,o,s,e))},Ll.prototype.synchronize=Ll.prototype.$a;function dn(e,o){return e|o}Ll.prototype.df=function(e,o){if(E(e=+e))throw new D(this.df,0,Wm);this.Wb({zoom:e},o)},Ll.prototype.pb=function(){return this.a.zoom},Ll.prototype.kc=Qc,Ll.prototype.startControl=Ll.prototype.kc,Ll.prototype.control=Qc,Ll.prototype.control=Ll.prototype.control,Ll.prototype.vb=Qc,Ll.prototype.endControl=Ll.prototype.vb;function $m(e,o,s){$m.j.constructor.call(this,Ll.prototype.A.za,e,null,o),this.b=this.animate=Fc(s)&&0<s&&1/0>s?s:!!s}u($m,dj);function T(e,o,s,h){if(T.j.constructor.call(this,e,o,s,h),this.qa=new Rk(100),this.R=new J(0,0),this.Af=!!h.enableSubpixelRendering,this.ab=en,this.m=new om,this.g=h=new wm,this.sb=A(this.sb,this),h.addEventListener(h.A.Cg,this.sb),h=e.element,this.L=e=h.ownerDocument.createElement("div"),e.style.position="absolute",e.style.width=e.style.height="100%",e.style.zIndex=0,h.insertBefore(e,h.firstChild),this.Ad=new Tm(this.L,this.oa),this.ta=o.jb().position,o=x.H.gl,!o)throw new $c(T,'"H-webgl" module is missing');for(this.a=new Vl({viewport:this.f,Zb:this.L,devicePixelRatio:this.oa,qk:A(this.ha,this)}),o.WorkerBroker.addTarget("model",sj),o=this.c.La(),e=0,h=o.length,this.l={Nc:[],ja:[]},this.xa=o;e<h;e++){var d=o[e];this.Pe(e,d),Ol(this,d,!0)}this.Eb(),this.fd=A(this.fd,this),this.Kh=A(this.Kh,this),this.Da=A(this.Da,this),s.addEventListener(qj.prototype.A.ie,this.fd),this.C=fn,this.zoom=Pl(this,this.J.pb()),this.Eb(),this.T()}u(T,Jl),t("H.map.render.webgl.RenderEngine",T),T.prototype.jb=function(){var e=this.ta;return Ql(this,{position:{An:e.An,Fn:e.Fn},zoom:this.zoom,tilt:this.dl,heading:this.heading})},T.prototype.fd=function(e){e=(e=e.target.ca())&&e.Ya(),(e&&e.getState())===Xh.INIT?e.load():(Yl(this.a),$l(this.a,this.c),this.ha())},T.prototype.type=Tl.WEBGL;var fn=2;T.prototype.getState=function(){return this.C},T.prototype.getState=T.prototype.getState;function gn(e,o,s){return o=s-o,e=Gd(2,8+e.zoom),o<e/2?o:o-e*s/Dd(s)}function hn(e,o,s){function h(j){return d[j]+km(d[j],o[j])/2}if(!(s&ej.POSITION||s&ej.BOUNDS))return null;var d=Zl(e.a).getLookAtData();s=d.position;var g=o.position,_=o.bounds;return Fi(d.bounds,g.lat,g.lng,!1)||_&&Fi(_,s.lat,s.lng,!1)?null:(s=jn(e,{tilt:h("tilt"),heading:h("heading"),incline:0,bounds:tg([s,g])}),s.zoom=Pl(e,s.zoom-.5),delete s.bounds,s)}T.prototype.dd=!1;function kn(e,o,s,h){return e=e.getCapabilities().lookAt[h],e=e.max-e.min,Dd(h==="zoom"?s[h]-o[h]:km(o[h],s[h]))/e||0}function ln(e,o,s){return e=zd(8*kn(e,o,s,"zoom"),kn(e,o,s,"heading"),kn(e,o,s,"tilt")/2),ae(3e3*e,300,4e3)}T.prototype.Kg=function(e){var o=this,s=e.newValue,h=e.modifiers,d=Zl(this.a);mn(this),this.R.set(0,0);var g=nn(this,s);if(bn.forEach(function(_e){h&e[_e.toUpperCase()]||delete g[_e]}),e.b){d=Zl(this.a).getLookAtData();var _=jn(this,g);s=hn(this,_,h);var j=1;Fc(e.b)&&(j=1/e.b);var $=function(){return o.dd=!1};if(delete _.bounds,this.dd=!0,s){d=ln(this,d,s);var _t=ln(this,s,_);on(this,s,d*j,function(){return on(o,_,_t*j,$)})}else s=ln(this,d,_),on(this,_,s*j,$)}else pn(g),d.setLookAtData(g);qn(this),Yl(this.a),this.ha()};function jn(e,o){return pn(o),Zl(e.a).getBestLookAtData(o)}function pn(e){var o=e.bounds;!o||o instanceof O||(e.bounds=Ci(o.K()))}function rn(e,o,s){Zl(e.a).setLookAtData(o),Yl(e.a),qn(e),e.ha(),s&&setTimeout(s,0)}function on(e,o,s,h){var d=Zl(e.a).getLookAtData(),g=new jm(d,o);g.a.tilt+g.a.heading+g.a.zoom+g.c!==0?sn(e,function(_){for(var j in g.a)if(g.a[j]!==0){var $=g.g[j](_);d[j]+=g.a[j]*($-g.f[j]),g.f[j]=$}return g.c!==0&&(d.position=g.b.zg(g.i,g.c*g.g.position(_),!0)),rn(e,d)},s,function(){return rn(e,o,h)}):rn(e,o,h)}T.prototype.rg=function(){},T.prototype.setAnimationDuration=T.prototype.rg,T.prototype.$g=function(){},T.prototype.getAnimationDuration=T.prototype.$g,T.prototype.sg=function(){},T.prototype.setAnimationEase=T.prototype.sg,T.prototype.ah=function(){},T.prototype.getAnimationEase=T.prototype.ah,T.prototype.ng=function(){},T.prototype.resetAnimationDefaults=T.prototype.ng;function tn(e,o){e.qa.na(function(s,h){return h.Mb()===o})}p=T.prototype,p.nk=function(e){tn(this,e.target.ca()),Yl(this.a),this.ha()},p.Pe=function(e,o){T.j.Pe.call(this,e,o),un(o)&&(Yl(this.a),(e=(e=o.ca())&&e.Ya())&&e.getState()===Xh.INIT&&e.load())},p.Xh=function(e,o,s){var h;if(this.ve=Lk(),tn(this,o.ca()),o.requestDomMarkers||C(o,Em)||C(o,Qm)){var d=this.l.ja;for(h=d.length;h--;){var g=d[h];if(g.ob()===o){d.splice(h,1),g.F();break}}}un(o)&&$l(this.a,this.c),this.xa=this.c.La(),e===0&&(Ol(this,o,!1),this.Eb()),Um(this.Ad,vn(this),this.l.ja.filter(vc)),this.ce(),s||this.ha()};function un(e){return!(C(e,Qm)||C(e,Em))}p.Yh=function(){this.Eb()},p.Eb=function(){T.j.Eb.call(this);var e=this.getCapabilities().lookAt.zoom;Zl(this.a).setZoomConstraints(zd(e.min,this.Eg),yd(e.max,this.Dg))},p.th=function(e,o){var s;if(o){if(e={oc:this.Af,fb:this.fb},o.W?C(o,Em)?s=new Dm(o):C(o,Qm)&&(s=new Dm(o)):o.requestDomMarkers&&(s=new Jm(o,e)),s){this.l.ja.push(s);var h=this.c.La();this.l.ja.sort(function(d,g){return h.indexOf(d.eb)-h.indexOf(g.eb)}),Um(this.Ad,vn(this),this.l.ja.filter(vc))}un(o)&&$l(this.a,this.c)}this.xa=this.c.La()};function nn(e,o){var s=o.position;return Ql(e,{zoom:Pl(e,o.zoom),position:new kg(s.lat,s.lng),tilt:o.tilt,heading:o.heading,bounds:o.bounds})}function qn(e){var o=Zl(e.a).getLookAtData();e.zoom=o.zoom,e.ta=o.position}function wn(e,o){return e=Zl(e.a).geoToMeters(o),new J(e.x/4007501668557849e-8+.5,1-(e.y/4007501668557849e-8+.5))}function xn(e,o){return o.sub(wn(e,e.ta)).scale(Gd(2,8+e.zoom))}p.Da=function(e){return Zl(this.a).geoToPixel(e)},T.prototype.geoToScreen=T.prototype.Da,T.prototype.Pa=function(e,o){return Zl(this.a).xyToGeo(e,o)},T.prototype.screenToGeo=T.prototype.Pa,T.prototype.qg=function(e,o){return e=this.Pa(e,o),o=this.J.jb(),o.position=e,o};function yn(e,o,s,h,d,g,_,j){var $,_t,_e=0,_r,_n=function(){--_e===0&&g(d)};if(j&&j.features)for(_e=_t=j.features.length,_r=0;_r<_t;_r++){var _o=j.features[_r],ga=_o.id;if($=e.a.a.sources[_o.source_name]){var _l=$.provider,_f=_l.Ej();if(_f===nk.SOURCE){var _c=_o.source_layer;if(_c==="overlays")zn(e,o,s,h,d,$,_o.properties.overlays_config);else if($=$.getMapObjectById(ga)){if(_c!=="markers")d.push($);else if(An(e,o,s,$))d.push($);else if(h&&!_){var _p=!0;bm(e.a,{x:o,y:s},{radius:3.5,top_most_only:!1},function(_g){yn(e,o,s,h,d,g,!0,_g)})}}_e--}else _f===nk.FEATURE?(_c=_o.tile.coords,_p=_l.getFeatureProxy(_o.properties,_c,function(_g){_g&&(_g.Tk(_l),d.push(_g)),_n()}),_p||($=e.qa.get(ga),$||($=new lh(_o),$.ka(_l),e.qa.add(ga,$,1)),d.push($),_e--)):_f===nk.PROVIDER&&(_p=!0,_l.Fk(_o,!1).then(function(_g){_g&&(!(_g instanceof rh)||An(this,o,s,_g))&&d.push(_g),_n()},function(){_n()},e))}}_f&&(_p||_e!==0)||g(d)}function zn(e,o,s,h,d,g,_){var j;for(e=e.Pa(o,s),o=_.length;o--&&(!(j=g.getMapObjectById(_[o].id))||0<=d.indexOf(j)||!j.ga().gd(e)||(d.push(j),!h)););}function An(e,o,s,h){var d=h.xb(),g=d.c,_,j=!g;if(g)if(d=d.kd(),o+=d.x,s+=d.y,d=h.ga(),C(d,Vi))for(h=d.la,_=h.length;_--&&!j;)d=e.Da(h[_]),j=g.Of(o-d.x,s-d.y,0)!==de.NONE;else d=e.Da(d),j=g.Of(o-d.x,s-d.y,0)!==de.NONE;return j}T.prototype.Ea=function(e,o,s,h){var d=this,g=[];g=Bn(g,this.l.ja,e*this.oa,o*this.oa,s),s&&g.length?h(g):this.a.a.initialized?bm(this.a,{x:e,y:o},{radius:3.5,top_most_only:s},function(_){yn(d,e,o,s,g,h,!1,_)}):h(g)},T.prototype.getObjectsAt=T.prototype.Ea;function Bn(e,o,s,h,d){for(var g=o.length,_;g--&&!((_=o[g])&&_.Ea&&(e=e.concat(_.Ea(s,h,d)),e.length&&d)););return e}T.prototype.aa=z;function vn(e){return e=e.wa[2],{w:e.right-e.left,h:e.bottom-e.top}}T.prototype.T=function(){var e=this.l.ja.length;Kl(this,this.oa),this.R.set(0,0);var o=vn(this),s=o.w,h=o.h;for(this.a.a.handleViewportUpdate();e--;){o=this.l.ja[e].lb;var d=o.yb();d.w===s&&d.h===h||o.cf(s,h)}this.aa=new Wi(s,h),Yl(this.a),this.ha()},T.prototype.getCapabilities=function(){return Ul},T.prototype.getCapabilities=T.prototype.getCapabilities;function Cn(e){e.i&&e.i.sa()||(Xl(e.a)||Lk()-e.ve<e.ab)&&!e.ea?e.Vf||(e.Vf=Jk(e.Kh)):(e.ea&&(e.ce(),Dn(e)),e.C=fn)}p=T.prototype,p.Vf=0,p.ce=function(){this.l.Nc.length=0},p.Kh=function(){this.Vf=0,this.D&&this.D.before();var e=Zl(this.a),o=e.getLookAtData(!1),s=e.getLookAtData(!0);e=this.f.center.clone(),s=s.bounds.K();var h=this.zoom,d=this.R,g=this.xa,_=g.length;for(this.ab=en;_--;){var j=g[_];C(j,qj)&&j.ca()&&j.ca().Ue(s,h)}this.ea=this.a.W(),this.J.$a(o),o=this.l,g=o.ja.length;var $=!0,_t;for(_t=0;_t<g;_t++){_=o.ja[_t];var _e=o.Nc;_&&(j=_.W(s,e,void 0,h,!1,d,this.Da,this.a.a.getCameraMatrix()),j===wk.ACTIVE&&(this.ab=1/0),j!==wk.DONE||_e[_t]||(Dn(this,_.ob()),_e[_t]=!0),_e[_t]||($=!1))}this.ea=$&&this.ea,this.aa&&(this.f.$a(this.aa),this.aa=z),this.i&&this.i.sa()&&this.me(),this.D&&this.D.after(),Cn(this)};function Dn(e,o){e.dd||setTimeout(A(e.dispatchEvent,e,{type:e.A.Vi,target:o||e}),1)}p.o=function(){var e=this.c.La()[0],o=this.f;Kk(this.Vf),En(this),e&&Ol(this,e,!1),this.l.ja.filter(vc).forEach(function(s){s.F()}),o.element&&o.element.removeChild(this.L),delete this.L,this.C=3,this.a.F(),T.j.o.call(this)},p.ha=function(){this.ve=Lk(),this.C===fn&&(this.ea=!1,this.C=1,Cn(this))};function Fn(e,o,s){Zl(e.a).applyPxOffset([o,s]),qn(e),e.R.set(0,0),Yl(e.a),e.ha()}p.xd=function(e,o,s){e=Pl(this,Pl(this,e)),Gn(this,e,o,s)},T.prototype.zoomAt=T.prototype.xd;function Gn(e,o,s,h){Zl(e.a).setLookAtData({zoom:o},Fc(s)&&Fc(s)?[s,h]:B),qn(e),Yl(e.a),e.ha()}function mn(e){En(e),e.g.sa()&&e.vb(!0),e.m.sa()&&e.wb(!0)}function Hn(e,o){if(o){var s={};s.Te=o.power,s.we=o.ease,s.duration=o.duration,e.u=s}}T.prototype.lc=function(e,o){var s=!!(o||e&(Nl.HEADING|Nl.TILT));mn(this),Hn(this,o),this.m.start(e,s),Zl(this.a).setPanning(!0)},T.prototype.startInteraction=T.prototype.lc,T.prototype.cc=function(e,o,s,h,d){var g=this.m,_=!1;if(g.sa()){var j=Zl(this.a),$=j.getLookAtData(),_t=this.f.center;_t=[_t.x,_t.y],o=g.store(e,o,s,h,d),s=g.Bf(),e=g.Nd(),d=this.m.Cf(),h=this.m.bh(),g.b&&(g.Ac(Nl.TILT)&&(j.setLookAtData({tilt:Rl(this,$.tilt+e.y/this.f.height*-180)},_t),_=!0),o&&d!==1&&g.Ac(Nl.ZOOM)&&(_=g.Bf(),d=Ed(Gd(2,this.zoom)*d)/Od,Gn(this,Pl(this,d),_.x,_.y),_=!0),g.Ac(Nl.COORD)&&0<nm(e)&&(Fn(this,-e.x,-e.y),_=!0),g.Ac(Nl.HEADING)&&(o?j.setLookAtData({heading:$.heading+Sl(this,h)},[s.x,s.y]):e.x&&j.setLookAtData({heading:Sl(this,$.heading+e.x/this.f.width*360)},_t),_=!0),_&&(Yl(this.a),this.ha()))}},T.prototype.interaction=T.prototype.cc,T.prototype.wb=function(e){var o=this;if(this.m.sa()&&!e){if(this.u){e=this.m.zb();var s=this.m.rc(),h=this.u.duration,d=(this.u.Te||1)*e,g=new Rm(-d/(0<h?h:1),d);!E(s.x)&&!E(s.y)&&0<d&&o.m.Ac(Nl.COORD)&&sn(this,function(_){d=g.De(_*h),E(d)||Fn(o,Ad(-s.x*d),Ad(-s.y*d))},h,void 0,this.u.we)}delete this.u,this.m.clear()}Zl(this.a).setPanning(!1),this.ha()},T.prototype.endInteraction=T.prototype.wb,T.prototype.kc=function(e,o,s){mn(this),this.g.start(o,s),Hn(this,e),Zl(this.a).setPanning(!0)},T.prototype.startControl=T.prototype.kc,T.prototype.control=function(e,o,s,h,d,g){for(var _=0,j;_<arguments.length;_++)if(j=+arguments[_],j!==j)throw new D(this.control,_,j);this.g.sa()&&this.g.set(e,o,s,h,d,g)},T.prototype.control=T.prototype.control,T.prototype.vb=function(e,o){var s=this,h;if(this.g.sa()){En(this);var d=Lk(),g=d-this.Ed;if(1<=g){var _=zm(this.g);In(this,_,g)}if(!this.u||e||o)typeof o=="function"&&(e=Zl(this.a),e=e.getLookAtData(),o(e),Jn(this,e));else{o=this.g.zb();var j=this.g.rc(),$=this.u.duration,_t=(this.u.Te||1)*o,_e=new Rm(-_t/(0<$?$:1),_t);!E(j.a)&&!E(j.b)&&0<_t&&sn(this,function(_r,_n,_o,ga){d&&(_o=ga-d,d=0),_t=_e.De(_r*$)*_o,E(_t)||((h=j.c*_t)&&Gn(s,Pl(s,s.zoom+h),s.g.a,s.g.b),Fn(s,Ad(j.a*_t),Ad(j.b*_t)))},$,void 0,this.u.we)}this.g.reset(),Zl(this.a).setPanning(!1),this.ha()}},T.prototype.endControl=T.prototype.vb;function Jn(e,o){var s=xn(e,wn(e,o.position)),h=s.y;s=s.x;var d=o.zoom,g=xn(e,wn(e,e.ta));o=g.y;var _=g.x;g=e.zoom;var j=e.g.zb(),$=e.g.a,_t=e.g.b,_e=0;if(s=gn(e,_,s),s-=_,h-=o,g=d-g,o=Fd(s*s+h*h+g*g),j!==0&&o!==0){var _r=s/o,_n=h/o,_o=g/o,ga=j*j/(2*o);sn(e,function(_l,_f){var _c;_l!==1?(_l=j*_f-ga*_f*_f/2,_f=_l-_e,(_c=_o*_f)&&(_c=Pl(e,e.zoom+_c),Gn(e,_c,$,_t)),Fn(e,Ad(_r*_f),Ad(_n*_f)),_e=_l):(Gn(e,Pl(e,d),$,_t),e.ha())},2*o/j)}}T.prototype.sb=function(e){var o=this,s=e.b;this.R.set(0,0),s.a||s.b||s.c||s.f||s.g||s.i?(this.Ed=Lk(),sn(this,function(h,d,g,_){o.Ed=_,In(o,s,g)},Wd),this.ha()):En(this)};function In(e,o,s){s=s||0;var h=e.g,d=Zl(e.a),g=d.getLookAtData();o.c&&Gn(e,Pl(e,g.zoom+o.c*s),h.a,h.b),d.setLookAtData({heading:Sl(e,g.heading+o.g*s),tilt:Rl(e,g.tilt+o.f*s)}),qn(e),Fn(e,o.a*s,o.b*s)}function sn(e,o,s,h,d){e.i&&e.i.sa()&&e.i.stop(!0),e.i=new Fm(e,o,s,h,d),e.i.start()}function En(e){e.i&&e.i.sa()&&e.i.stop(!0)}T.prototype.Wg=function(){},T.prototype.enter=T.prototype.Wg,T.prototype.Xg=function(e){Ml(this.L,e)},T.prototype.exit=T.prototype.Xg,T.prototype.capture=function(e,o,s,h){var d=this;return cm(d.a).then(function(g){var _=d.L.ownerDocument.createElement("canvas"),j=d.oa,$=_.getContext("2d"),_t=d.a.Xa()/j,_e=(s-e)*j;return j*=h-o,_.width=_e,_.height=j,$.drawImage(g,e*_t,o*_t,_e*_t,j*_t,0,0,_e,j),_})},T.prototype.Il=function(e){return Zl(this.a).geoToMeters(e)},T.prototype.geoToMeters=T.prototype.Il,T.prototype.Vn=function(e){return Zl(this.a).metersToGeo(e)},T.prototype.metersToGeo=T.prototype.Vn;var en=5e3;function U(e,o,s){var h={};if(!(e instanceof HTMLElement))throw new D(U,0);if(U.j.constructor.call(this),this.i=Kn(s,U),this.c=s=new Ll,this.D=!1,s.addEventListener(s.A.le,this.R,!1,this),!C(e,Element))throw new D(U,0,e);s=this.S=e.ownerDocument.createElement("div");var d=s.style;if(d.position="relative",d.height=s.style.width="100%",d.overflow="hidden",d.webkitTapHighlightColor="transparent",d.webkitTapHighlightColor!=="transparent"&&(d.webkitTapHighlightColor="rgba(0,0,0,0)"),e.appendChild(s),this.b=new xk(this.S,this.i),this.b.addEventListener(this.b.A.le,this.R,!1,this),e=this.a=new sj(this.i.layers),e.addEventListener(e.A.ke,this.P,!1,this),e.addEventListener(e.A.he,this.P,!1,this),e.addEventListener(e.A.je,this.P,!1,this),!this.l&&Ln(this),this.g=null,this.a.add(o,0),this.f=this.u(this.i.engineType!=null?this.i.engineType:jk,this.i),this.J=A(this.J,this),o=this.i.imprint,o!==B&&typeof o!="object")throw new D(U,1,"imprint");Mn&&(o||(o={}),o.mark=o.mark||"GS (2022) 5659"),this.s=o===null?o:new Bj(this,o),o=this.i.autoColor,this.L=o===B||!!o,Nn(this),(o=this.i.zoom)&&(h.zoom=o),(o=this.i.bounds)&&(h.bounds=o),(o=this.i.center)&&(h.position=o),this.c.Wb(h)}u(U,F),t("H.Map",U),U.prototype.draggable=!1;function Kn(e,o){if(e){var s=e.pixelRatio;if(s===B)e.pixelRatio=Ue();else if(!(0<s))throw new D(o,0,"pixelRatio: "+s)}else e={},e.pixelRatio=Ue();return e.renderBaseBackground||(e.renderBaseBackground={lower:3,higher:2}),e}U.prototype.o=function(){this.L=!1,this.s&&this.s.F(),this.f.dispose(),this.c.F(),this.b.F(),this.l.F(),this.m.F(),this.a.F();var e=this.S;e.parentNode.removeChild(e),delete this.S,F.prototype.o.call(this)},U.prototype.N=function(){return this.S},U.prototype.getElement=U.prototype.N,U.prototype.Xa=function(){return this.i.pixelRatio},U.prototype.getPixelRatio=U.prototype.Xa;function Nn(e){e.s&&e.L&&e.s.vi({invert:e.g&&e.g.yl})}U.prototype.P=function(e){var o=e.added,s=e.removed;o&&o.ca()&&o.ca().ka(this),s&&s.ca()&&s.ca().ka(null),s===this.l&&(delete this.l,delete this.m),s===this.g&&(this.g=null),e.idx===0&&(this.dispatchEvent(new cj(this.A.lf,this.g=e.type!==this.a.A.je?o:0<this.a.a.length?this.a.get(0):z,e.type!==this.a.A.he?s:1<this.a.a.length?this.a.get(1):z)),Nn(this))},U.prototype.R=function(e){e.modifiers&&(this.D||(On(this,"start"),this.D=!0),On(this,"",e),this.T&&x.clearTimeout(this.T),this.T=x.setTimeout(this.J,333))};function On(e,o,s){e.dispatchEvent(s?new dj(e.A.Qi,s.newValue,s.oldValue,s.modifiers):e.A.Qi+o)}U.prototype.J=function(){On(this,"end"),this.D=!1},U.prototype.tg=function(e,o){return this.f.getCapabilities().lookAt&&this.c.Wb({position:e},!!o),this},U.prototype.setCenter=U.prototype.tg,U.prototype.bb=function(){var e=this.c.jb();return e?e.position:z},U.prototype.getCenter=U.prototype.bb,U.prototype.df=function(e,o){return this.c.df(e,!!o),this},U.prototype.setZoom=U.prototype.df,U.prototype.pb=function(){return this.c.pb()},U.prototype.getZoom=U.prototype.pb,U.prototype.xd=function(e,o,s){this.f.zoomAt(e,o,s)},U.prototype.zoomAt=U.prototype.xd,U.prototype.hn=function(){return this.b},U.prototype.getViewPort=U.prototype.hn,U.prototype.gn=function(){return this.c},U.prototype.getViewModel=U.prototype.gn,U.prototype.wm=function(){return this.a},U.prototype.getLayers=U.prototype.wm,U.prototype.qm=function(){return this.s},U.prototype.getImprint=U.prototype.qm,U.prototype.capture=function(e,o,s,h,d,g){function _(_p,_g){_n?_p.cancel():(_l.save(),_g.capture(ga,_e,function(ty){_l.restore(),_p.done(ty)},function(ty){_p.done(null,ty),j(null)}))}function j(_p){_n||(_n=!0,e(_p))}var $=this.f,_t=$.getCapabilities(),_e=this.i.pixelRatio,_r=this.b,_n=!1,_o=this,ga,_l;if(!Da(e))throw new D(this.capture,0,e);s=s||0,h=h||0,d=d||_r.width,g=g||_r.height;var _f=zd(0,yd(s,d)),_c=zd(0,yd(h,g));s=yd(_r.width,zd(s,d)),h=yd(_r.height,zd(h,g)),_t.capture?$.capture(_f,_c,s,h).then(function(_p){var _g=_o.s,ty=o||[];ga=_p,_l=ga.getContext("2d"),ga.style.width=ga.width/_e+"px",ga.style.height=ga.height/_e+"px";var oy=new Mk(10,_);ty=ty.concat(_g).filter(function(ry){return Da(ry&&ry.capture)}),ty.length?(_p=ty.pop(),ty.forEach(function(ry){oy.push(ry,ld)}),oy.push(_p,A(j,_o,ga)),Fk(oy)):j(ga)},function(){j(z)}):e(null)},U.prototype.capture=U.prototype.capture,U.prototype.cm=function(){return this.f},U.prototype.getEngine=U.prototype.cm,U.prototype.u=function(e,o){if(o=o?Kn(o,this.u):this.i,Nn(this),e===kk.P2D)return new x.H.map.render.p2d.RenderEngine(this.b,this.c,this.a,o);if(e===kk.WEBGL)return new T(this.b,this.c,this.a,o);if(e===kk.HARP)return new x.H.map.render.harp.RenderEngine(this.b,this.c,this.a,o);throw new D(this.u,0,e)},U.prototype.gf=function(e,o,s,h,d){if(o=vc(o)?C(o,K,this.gf,1,o)&&o:this.c.jb().bounds.K(),d=d||this.g,!C(d,pl))throw new D(this.gf,4);var g=d.ca(),_=this.Xa(),j=d.tileSize;if(2<=_&&256<j&&g instanceof Ek&&(j/=2),_=this.pb(),j=Math.log2(j)-8,s=vc(s)?+s:_,h=vc(h)?+h:_,!(s<=h))throw new D(this.gf,B,"!(min <= max)");_=g.min;var $=g.max,_t=this.f.type===kk.WEBGL?Bd:Ad;if(s=ae(_t(s)-j,_,$),h=ae(_t(h)-j,_,$),!(g&&C(g,S)&&od()&&g.l()))throw new $c(this.gf,"Storing is not supported");return new Ak(d,g,o,s,h,e)},U.prototype.storeContent=U.prototype.gf;function Pn(e){xj.call(this,e)}u(Pn,xj),Pn.prototype.f=function(){zj(this,2)},Pn.prototype.c=function(){zj(this,4)},U.prototype.xl=function(e){return e=new Pn(e),nd().clear(A(e.f,e),A(e.c,e)),e},U.prototype.clearContent=U.prototype.xl,U.prototype.nf=function(e,o){var s=this.a,h=s.indexOf(e),d=o!==+o;return o=d?s.a.length-1:o,0>h?s.add(e,o):h-o&&(s.hc(h),s.add(e,d?o-1:o)),this},U.prototype.addLayer=U.prototype.nf,U.prototype.ae=function(e){var o=this.a.indexOf(e);return e!==this.g&&e!==this.l&&o!==-1&&this.a.hc(o),this},U.prototype.removeLayer=U.prototype.ae,U.prototype.ud=function(e){return this.g!==e&&(this.a.a.length&&this.a.get(0)!==this.l?this.a.set(0,e):this.a.add(e,0),this.g=e),this},U.prototype.setBaseLayer=U.prototype.ud,U.prototype.Ol=function(){return this.g},U.prototype.getBaseLayer=U.prototype.Ol,U.prototype.Da=function(e){if(!lg(e))throw new D(this.Da,0,e);return(e=this.f.geoToScreen(e))?zf(e):z},U.prototype.geoToScreen=U.prototype.Da,U.prototype.Pa=function(e,o){var s;if(s=+E(e)||2*+E(o))throw new D(this.Pa,s-1,arguments[s-1]);return(s=this.f.screenToGeo(e,o))?ng(s):z},U.prototype.screenToGeo=U.prototype.Pa,U.prototype.qg=function(e,o){return this.f.screenToLookAtData(e,o)},U.prototype.screenToLookAtData=U.prototype.qg,U.prototype.fa=function(e){if(!C(e,M))throw new D(this.fa,0,e);return!this.l&&Ln(this),this.m.bc().fa(e),e},U.prototype.addObject=U.prototype.fa,U.prototype.Ga=function(e){if(!C(e,M))throw new D(this.Ga,0,e);return!this.l&&Ln(this),this.m.bc().Ga(e),e},U.prototype.removeObject=U.prototype.Ga,U.prototype.Ua=function(e){return!this.l&&Ln(this),this.m.bc().Ua(e)},U.prototype.getObjects=U.prototype.Ua,U.prototype.Xb=function(e){var o;Bc(e,this.Xb,0,e),!this.l&&Ln(this);var s=e.length;for(o=0;o<s;o++)this.fa(e[o]);return this},U.prototype.addObjects=U.prototype.Xb,U.prototype.rd=function(e){var o;Bc(e,this.rd,0,e),!this.l&&Ln(this);var s=e.length;for(o=0;o<s;o++)this.Ga(e[o]);return this},U.prototype.removeObjects=U.prototype.rd,U.prototype.Od=function(e,o,s){var h;if(h=+E(e)||2*+E(o))throw new D(this.Od,h-1,arguments[h-1]);this.f.getObjectsAt(e,o,!0,function(d){s(d[0])})},U.prototype.getObjectAt=U.prototype.Od,U.prototype.Ea=function(e,o,s,h){var d;if(d=+E(e)||2*+E(o))throw new D(this.Od,d-1,arguments[d-1]);this.f.getObjectsAt(e,o,!1,s,!!h)},U.prototype.getObjectsAt=U.prototype.Ea,U.prototype.ld=function(e,o,s){s=s||{};var h=s.zoom;s.zoom=vc(h)?h:this.c.pb(),this.m.ld(e,o,s)},U.prototype.getObjectsWithin=U.prototype.ld;function Ln(e){e.m=new N({max:24,engineType:e.i.engineType}),e.l=new tl(e.m,e.i),e.a.add(e.l)}var Qn=Tl.HARP,kk={P2D:Tl.P2D,WEBGL:Tl.WEBGL,HARP:Qn};U.EngineType=kk,U.prototype.A={Wo:"mapviewchangestart",Qi:"mapviewchange",Ri:"mapviewchangeend",lf:"baselayerchange"};function Rn(e,o){Rn.j.constructor.call(this,e,o)}u(Rn,rh),t("H.map.Marker",Rn),Rn.prototype.type=nh.MARKER,Rn.prototype.T=1,Rn.prototype.ra=function(e){if(e!==kh.VISUAL||this.zk===1||this.icon.getState()===1)var o=Rn.j.ra.call(this,e);return o||!1},Rn.prototype.invalidate=Rn.prototype.ra,p=Rn.prototype,p.zk=0,p.Uj=function(e){return C(e,Wj)},p.xh=!1,p.mk=function(){this.ra(kh.VISUAL)},p.Ic=function(e){var o=this.icon;return this.xh&&(o.removeEventListener("statechange",this.mk,!1,this),delete this.xh),o&&(this.zk=o.getState()),Rn.j.Ic.call(this,e),e.getState()===0&&(this.xh=!0,Fe(e,"statechange",this.mk,!1,this)),this},Rn.prototype.setIcon=Rn.prototype.Ic,Rn.prototype.b=function(e){return new Wj(e.svg,e)},Rn.prototype.Y=function(){var e=this.getIcon(),o=e.Fo||0,s=Rn.j.forWorkerMessage.call(this),h=s.properties.icon;return h&&0<o&&Ya(h,{stick_color:e.Eo,stick_height:o}),s},Rn.prototype.forWorkerMessage=Rn.prototype.Y;function sh(e,o,s){var h="anonymous",d=1;this.c=A(this.c,this),M.call(this,s),this.da(e),s&&(e="crossOrigin",e in s&&(h=s[e]),e="opacity",e in s&&(d=s[e])),this.Ok(o,h),this.ic(d)}u(sh,M),t("H.map.Overlay",sh),sh.prototype.type=nh.OVERLAY,sh.prototype.K=function(){return this.a},sh.prototype.getBoundingBox=sh.prototype.K,sh.prototype.de=function(e){return C(e,K,this.de,0,e),this.da(e)},sh.prototype.setBoundingBox=sh.prototype.de,sh.prototype.ga=function(){return this.a},sh.prototype.getGeometry=sh.prototype.ga,sh.prototype.da=function(e){var o=this.a,s=!o;return C(e,K,this.da,0,e),(s||!o.ia(e))&&(this.a=e,s||this.ra(kh.SPATIAL)),this},sh.prototype.setGeometry=sh.prototype.da,sh.prototype.Qc=function(){return this.b.getData()},sh.prototype.getBitmap=sh.prototype.Qc,sh.prototype.Ok=function(e,o){var s=this.b;return s&&s.getState()!==1&&s.cancel(),this.b=new Rj(e,this.c,!0,B,o),this},sh.prototype.setBitmap=sh.prototype.Ok,sh.prototype.c=function(e,o){this.b=o,e===1&&this.ra(kh.VISUAL)},sh.prototype.Tc=function(){return this.f},sh.prototype.getOpacity=sh.prototype.Tc,sh.prototype.ic=function(e){var o=this.f,s=2>o;if(0<=e&&1>=e)e!==o&&(this.f=e,s&&this.ra(kh.VISUAL));else throw new D(this.ic,0);return this},sh.prototype.setOpacity=sh.prototype.ic,sh.prototype.Y=function(){var e=sh.j.Y.call(this);return e.geometry=Ci(this.a).Y(),e.properties.overlay=!0,e},sh.prototype.forWorkerMessage=sh.prototype.Y;function Sn(e,o){Sn.j.constructor.call(this,e,o)}u(Sn,pl),t("H.map.layer.MarkerTileLayer",Sn);var Tn={markers:[],total:0,requested:0};function Un(e,o,s,h,d){var g=Bd(s);e.pixelProjection.Oa(g),o=e.Sd(e.Ae(o),g),s=e.Ke(o,o.left>o.right,~~s,h,d),e=s.tiles,s=s.total,h=e.length,d=[];var _;for(_=0;_<h;_++)for(o=e[_],g=o.data.length;g--;)d.push(o.data[g]);return{markers:d,total:e.length,requested:s}}Sn.prototype.Ec=function(e,o,s,h){return this.ma.providesDomMarkers()?Tn:Un(this,e,o,s,h)},Sn.prototype.requestMarkers=Sn.prototype.Ec,Sn.prototype.Dc=function(e,o,s,h){return this.ma.providesDomMarkers()?Un(this,e,o,s,h):Tn},Sn.prototype.requestDomMarkers=Sn.prototype.Dc;function Vn(e,o,s){var h,d=6;if(o){for(h=' expected close to: "'+o;d--;)o=e.a.next(),o!==-1&&(h+=String.fromCharCode(o));h+='"'}throw new D(Wn,0,"- Malformed WKT: "+(h?s+h:"unexpected end of stream"))}function Xn(e,o){var s=e.next();o=o?")":"(",s!==o&&Vn(e,s,'"'+o+'"')}function Yn(e){return Zn(e)===","?(e.next(),!0):!1}function $n(e,o,s,h,d){var g,_,j=2+o+s;for(_=1;_<=j;_++)(s=e.next())?(g=+s)!==g?Vn(e,s,"number"):_===1?h[d+1]=g:_===2?h[d]=g:_===3&&(h[d+2]=g):Vn(e,s);o||(h[d+2]=0)}var ao=[];function bo(e,o,s,h){return h||Xn(e,0),$n(e,o,s,ao,0),h||Xn(e,1),new kg(ao[0],ao[1],o?ao[2]:B)}function co(e,o,s){var h=[];Xn(e,0);do $n(e,o,s,h,h.length);while(Yn(e));return Xn(e,1),new L(h)}function eo(e,o,s){Xn(e,0);var h=co(e,o,s);if(Yn(e)){var d=[];do d.push(co(e,o,s));while(Yn(e))}return Xn(e,1),new O(h,d)}var fo=[],go=[eo],ho=[bo],io={POINT:ho,LINESTRING:[co],POLYGON:go,MULTIPOINT:[bo,Vi],MULTILINESTRING:[co,ih],MULTIPOLYGON:[eo,Ji],GEOMETRY:fo,GEOMETRYCOLLECTION:fo,CIRCULARSTRING:fo,COMPOUNDCURVE:fo,CURVEPOLYGON:fo,MULTICURVE:fo,MULTISURFACE:fo,CURVE:fo,SURFACE:fo,POLYHEDRALSURFACE:fo,TIN:fo,TRIANGLE:fo},jo={Z:1,M:2,ZM:3};function Wn(e){e=new ko(e);var o,s=e.next();if((o=io[s.toUpperCase()])||Vn(e,s,"type name"),o!==fo){s=Zn(e),s=jo[s.toUpperCase()];var h=s&1,d=s>>1;if(h|d&&e.next(),s=Zn(e),s==="EMPTY")if(e.next(),h=o[1])var g=new h([]);else o!==ho&&(g=new L([]),o===go&&(g=new O(g)));else if(s==="("){if(g=o[0],o=o[1],o){var _=[];if(Xn(e,0),g===bo){var j=Zn(e)!=="(";do _.push(g(e,h,d,j));while(Yn(e))}else do _.push(g(e,h,d));while(Yn(e));Xn(e,1),h=new o(_)}else h=g(e,h,d);g=h}else Vn(e,s,'"Z", "M", "ZM", "(" or "EMPTY"');e.next()&&Vn(e,s,"end of stream")}return g||z}function ko(e){this.a=e}function Zn(e){var o=e.b;if(o===B){for(o=e.a;o.Pb()===lo;)o.next();if(mo[o.Pb()])o=o.next(),o=o===no?"":String.fromCharCode(o);else{o.ge();do o.next();while(!mo[o.Pb()]);o=String.fromCharCode.apply(null,o.Gd())}e.b=o}return o}ko.prototype.next=function(){var e=Zn(this);return e!==""&&delete this.b,e};var lo=32,no=-1,oo={$o:lo,Uo:40,Zo:41,Ro:44,So:no},mo=Object.keys(oo).reduce(function(e,o){return e[oo[o]]=!0,e},oc());function po(){}t("H.util.ICharStream",po),po.prototype.next=function(){},po.prototype.ge=function(){},po.prototype.Gd=function(){},po.prototype.Pb=function(){};function qo(e){this.c=String(e),this.f=0,this.a=[],this.b=!1}t("H.util.CharStream",qo),qo.prototype.next=function(){var e=this.c.charCodeAt(this.f++);return e=isNaN(e)?-1:e,this.b&&this.a.push(e),e},qo.prototype.ge=function(){this.b=!0,this.a=[]},qo.prototype.Gd=function(){var e=this.a.slice();return this.b=!1,this.a=[],e},qo.prototype.Pb=function(){var e=this.c.charCodeAt(this.f);return isNaN(e)?-1:e},t("H.util.wkt.toGeometry",function(e){return Wn(new qo(e))});function ro(e,o){ro.j.constructor.call(this,Ki,o),this.de(e)}u(ro,uh),t("H.map.Rect",ro),ro.prototype.de=function(e){if(!C(e,K))throw new D(this.de,0,e);e.ia(this.aa)||(this.aa=this.D=e,this.a!==z&&ro.j.da.call(this,Ci(e)))},ro.prototype.setBoundingBox=ro.prototype.de,ro.prototype.K=function(){return this.D},ro.prototype.getBoundingBox=ro.prototype.K,ro.prototype.da=function(){return this},ro.prototype.setGeometry=ro.prototype.da,ro.prototype.ga=function(){return this.a===Ki&&ro.j.da.call(this,Ci(this.aa)),this.a},ro.prototype.getGeometry=ro.prototype.ga;function so(){return Hf("H-core","1.49.1","74e5afb",{region:"row"})}t("H.buildInfo",so);var Mn=so().region==="cn",jk=kk[Mn?"HARP":"WEBGL"],to,uo="maps".concat("js-"),vo,wo,xo,yo,zo;if(vo=x.document.querySelector('script[src*="'+uo+'"]'),!vo){for(wo=x.document.getElementsByTagName("script"),yo=new RegExp("^.*"+uo),zo=0,xo=wo.length;zo<xo;zo++)if(yo.test(wo[zo].src)){vo=wo[zo];break}}to=vo?vo.src.replace(/\/[^\/]*$/,"/"):"",t("H.getScriptPath",function(){return to});function Ao(){var e=decodeURIComponent(to);if(e){e=e[e.length-1]==="/"?e.substring(0,e.length-1):e;var o=x.document,s="";o?(o=o.createElement("a"),o.href=e,s=o.href):/[\w]+:\/\//.test(e)&&(s=e),e=new URL(s),e.pathname+=e.pathname[e.pathname.length-1]==="/"?"styles":"/styles",e=e.toString()}else e="https://js.api.here.com/v3/3.1.49.1/styles";return e}t("H.getStylePath",Ao);function Bo(e){var o=e.ownerDocument;o=o.documentElement||o.body.parentNode||o.body;try{var s=e.getBoundingClientRect()}catch{s={top:0,right:0,bottom:0,left:0,height:0,width:0}}return{x:s.left+(typeof window.pageXOffset=="number"?window.pageXOffset:o.scrollLeft),y:s.top+(typeof window.pageYOffset=="number"?window.pageYOffset:o.scrollTop)}}var Co=(function(){return this}).apply(null);function Do(e,o,s,h,d,g){if(isNaN(e))throw Error("x needs to be a number");if(isNaN(o))throw Error("y needs to be a number");if(isNaN(s))throw Error("pointer must have an id");this.viewportX=e,this.viewportY=o,this.target=null,this.id=s,this.type=h,this.dragTarget=null,this.button=vc(d)?d:-1,this.buttons=vc(g)?g:0,this.a=this.button}t("H.mapevents.Pointer",Do);function Eo(e,o,s){if(isNaN(o))throw Error("x needs to be a number");if(isNaN(s))throw Error("y needs to be a number");e.viewportX=o,e.viewportY=s}Do.prototype.tm=function(){return this.a},Do.prototype.getLastChangedButton=Do.prototype.tm;function Fo(e,o){e.a=o,e.buttons|=Go[+o]||0}function Ho(e,o){e.a=o,e.buttons&=~(Go[+o]||0)}var Go=[1,4,2],Io={NONE:-1,LEFT:0,MIDDLE:1,RIGHT:2};Do.Button=Io;function Jo(e,o,s,h,d,g,_){Jo.j.constructor.call(this,e),this.pointers=o,this.changedPointers=s,this.targetPointers=h,this.currentPointer=d,this.originalEvent=_,this.target=g}u(Jo,ud),t("H.mapevents.Event",Jo);function Ko(e){this.a=e instanceof Array?e.slice(0):[]}p=Ko.prototype,p.clear=function(){this.a.splice(0,this.a.length)},p.length=function(){return this.a.length},p.indexOf=function(e){for(var o=this.a.length;o--;)if(this.a[o].id===e)return o;return-1};function Lo(e,o){return o=e.indexOf(o),o!==-1?e.a[o]:null}p.remove=function(e){return e=this.indexOf(e),e!==-1?this.a.splice(e,1)[0]:null};function Mo(e,o){for(var s=e.a.length,h=[];s--;)e.a[s].type!==o&&h.push(e.a[s]);e.a=h}function No(e,o){for(var s=e.a.length;s--;)if(e.a[s].dragTarget===o)return!0;return!1}p.push=function(e){if(e instanceof Do)return this.a.push(e);throw Error("list needs a pointer")},p.La=function(){return this.a},p.clone=function(){return new Ko(this.a)};function Oo(e,o,s){if(s=s||{},!(e instanceof U))throw Error("events: map instance required");if(!(o instanceof Array))throw Error("events: map array required");qd.call(this),this.Tg=s.Tg||300,this.gj=s.gj||50,this.Zk=s.Zk||50,this.$k=s.$k||500,this.Ch=s.Ch||900,this.Bh=s.Bh||8,this.map=e,this.m=this.map.b,this.f=this.m.element,this.D=o,this.a=new Ko,this.b=new Ko,this.l={},this.c=null,this.u=!0,this.U={},this.g={},this.s=null,this.te=A(this.te,this),this.P={pointerdown:this.Bl,pointermove:this.Cl,pointerup:this.Dl,pointercancel:this.Al},Po(this)}u(Oo,qd);function Po(e,o){var s,h=e.D.length;for(s=0;s<h;s++){var d=e.D[s],g=d.listener;typeof g=="function"&&(o?(d.target||e.f).removeEventListener(d.Sa,g):(d.target||e.f).addEventListener(d.Sa,g))}}function Qo(e,o,s){var h;if(typeof e.P[o]=="function"){o!=="pointermove"&&(e.u=!0);var d=0;for(h=e.b.length();d<h;d++){var g=e.b.a[d]||null;e.f.contains(s.composedPath()[0])?Ro(e,g,e.nj.bind(e,s,o,g)):e.nj(s,o,g,null)}}e.b.clear()}p=Oo.prototype,p.nj=function(e,o,s,h){So(s.id,this.U),this.P[o].call(this,s,h,e)};function Ro(e,o,s){if(e.c===o)s(o.target);else{var h=e.m,d=o.viewportX;if(o=o.viewportY,0>d||0>o||d>=h.width||o>=h.height)s(z);else{var g=e.map;g.Od(d,o,function(_){s(_||g)})}}}p.Dl=function(e,o,s){var h=e.id;e.target=o,To(this,e,s),Uo(this,o,"pointerup",s,e),e.type!=="mouse"&&Uo(this,o,"pointerleave",s,e),o=this.l[e.id];var d={x:e.viewportX,y:e.viewportY},g=s.timeStamp,_=e.target,j=this.s;o&&o.target===_&&o.Se.Wa(d)<this.Zk&&g-o.Hi<this.$k?(Uo(this,_,"tap",s,e),j&&j.target===_&&g-j.Hi<this.Tg?j.Se.Wa({x:e.viewportX,y:e.viewportY})<this.gj&&(Uo(this,_,"dbltap",s,e),this.s=null):this.s={target:_,Se:new J(e.viewportX,e.viewportY),Hi:s.timeStamp}):this.s=null,this.l={},So(h,this.g)};function To(e,o,s){o===e.c&&(Uo(e,o.dragTarget,"dragend",s,o),e.c=null,So(o.id,e.U)),o.dragTarget=null}p.te=function(e,o){var s=this;Uo(this,e.dragTarget,"drag",o,e),So(e.id,this.U),this.U[e.id]=setTimeout(function(){s.te(e,o)},150)};function So(e,o){o[e]&&(o[e].timeout?clearTimeout(o[e].timeout):clearTimeout(o[e]),delete o[e])}function Vo(e,o,s){var h=o.target,d=new J(o.viewportX,o.viewportY),g=o.id;So(g,e.g);var _=setTimeout(function(){h&&h===o.target&&d.Wa({x:o.viewportX,y:o.viewportY})<e.Bh&&(Uo(e,h,"longpress",s,o),delete e.l[o.id])},e.Ch);e.g[g]={timeout:_,Se:d}}p.Cl=function(e,o,s){var h=e.dragTarget,d=e.id,g=e.target;e.target=o,g!==o&&(Uo(this,g,"pointerleave",s,e),Uo(this,o,"pointerenter",s,e)),h?this.c?(this.te(e,s),this.g[d]&&this.g[d].Se.Wa({x:e.viewportX,y:e.viewportY})>this.Bh&&So(d,this.g)):this.u?this.u=!1:(this.c=e,Uo(this,h,"dragstart",s,e),this.te(e,s),delete this.l[d],this.u=!0):(!this.c||this.c&&this.c.dragTarget!==o&&this.c.dragTarget!==this.map)&&Uo(this,o,"pointermove",s,e)},p.Bl=function(e,o,s){var h=!(/^(?:mouse|pen)$/.test(e.type)&&s.button!==0);if(o){e.target=o,this.l[e.id]={Se:new J(e.viewportX,e.viewportY),target:e.target,Hi:s.timeStamp},e.type!=="mouse"&&Uo(this,o,"pointerenter",s,e);var d=Uo(this,o,"pointerdown",s,e);!this.c&&h&&(o.draggable&&!No(this.a,o)?e.dragTarget=o:!this.map.draggable||d.defaultPrevented||No(this.a,this.map)||(e.dragTarget=this.map)),Vo(this,e,s)}},p.Al=function(e,o,s){var h=e.id;e.target=null,o?(Uo(this,o,"pointerleave",s,e),Uo(this,o,"pointercancel",s,e)):Uo(this,this.map,"pointercancel",s,e),To(this,e,s),this.l={},So(h,this.g)};function Uo(e,o,s,h,d){if(o&&typeof o.dispatchEvent=="function"){var g=Jo,_=e.a.La(),j=e.b.La();e=e.a;var $,_t=e.a.length,_e=[];for($=0;$<_t;$++)e.a[$].target===o&&_e.push(e.a[$]);g=new g(s,_,j,_e,d,o,h),d.button=/^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(s)?d.a:Io.NONE,o.dispatchEvent(g)}return g}p.o=function(){Po(this,!0),this.a.clear(),this.b.clear();var e=this.U,o;for(o in e)So(o,e);e=this.g;for(var s in e)So(s,e);delete this.f,delete this.D,delete this.a,delete this.b,delete this.map,this.s=null,delete this.l,this.c=null,qd.prototype.o.call(this)};function Wo(e){this.i=A(this.i,this),Oo.call(this,e,[{Sa:"touchstart",listener:this.i},{Sa:"touchmove",listener:this.i},{Sa:"touchend",listener:this.i},{Sa:"touchcancel",listener:this.i}]),this.L={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},this.J=(e=(e=e.s)?e.N():null)?Array.prototype.slice.call(e.querySelectorAll("a"),0):[]}u(Wo,Oo),Wo.prototype.i=function(e){var o=e.touches,s=this.a.length(),h;if(e.type==="touchstart"&&s>=o.length){for(s=this.a.clone(),h=o.length;h--;)s.remove(o[h].identifier);for(h=s.length();h--;)this.a.remove((s.a[h]||null).id);this.b=s,Qo(this,"pointercancel",e),this.b.clear()}if(this.L[e.type]){o=Bo(this.m.element),s=e.type,h=e.changedTouches;var d=h.length,g;for(this.b.clear(),g=0;g<d;g++){var _=h[g],j=Lo(this.a,_.identifier),$=_.pageX-o.x,_t=_.pageY-o.y;if(j)if(s==="touchmove"){_=Math.abs(j.viewportX-$);var _e=Math.abs(j.viewportY-_t);(1<_||1<_e||_===1&&_e===1)&&(Eo(j,$,_t),this.b.push(j))}else s==="touchend"&&(this.a.remove(j.id),this.b.push(j),Ho(j,Io.LEFT));else j=new Do($,_t,_.identifier,"touch",Io.LEFT,1),this.a.push(j),this.b.push(j)}Qo(this,this.L[e.type],e),this.J.indexOf(e.target)===-1&&e.preventDefault()}},Wo.prototype.o=function(){this.J=null,Oo.prototype.o.call(this)};function Xo(e){var o=Yo(this);(window.PointerEvent||window.MSPointerEvent)&&o.push({Sa:"MSHoldVisual",listener:"prevent"}),Oo.call(this,e,o)}u(Xo,Oo);function Yo(e){var o=!!window.PointerEvent,s,h,d=[];return e.i=A(e.i,e),"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach(function(g){s=g.toLowerCase().replace(/ms/g,""),h=o?s:g,d.push({Sa:h,listener:e.i,target:/^pointer(up|move)$/.test(s)?window:null})}),d}var Zo={2:"touch",3:"pen",4:"mouse"};Xo.prototype.i=function(e){var o=window.PointerEvent?e.type:e.type.toLowerCase().replace(/ms/g,""),s=Bo(this.f),h=Lo(this.a,e.pointerId),d=e.pageX-s.x;s=e.pageY-s.y;var g=Zo[e.pointerType]||e.pointerType;if(cd&&x.getComputedStyle(this.m.element).direction==="rtl"&&(d-=(x.devicePixelRatio-1)*this.m.width),!(h||/^pointer(up|out|cancel)$/.test(o)||g==="touch"&&o!=="pointerdown")){h={x:d,y:s};var _=e.pointerType;typeof _=="number"&&(_=Zo[_]),h=new Do(h.x,h.y,e.pointerId,_,e.button,e.buttons),this.a.push(h)}h&&(/^pointer(up|cancel)$/.test(o)?(g==="touch"&&this.a.remove(h.id),Ho(h,e.button)):o==="pointerdown"&&(e.pointerType==="touch"&&(Mo(this.a,"mouse"),Mo(this.a,"pen")),Fo(h,e.button)),this.b.push(h),o!=="pointermove"?(Eo(h,d,s),Qo(this,/^pointer(over|out)$/.test(o)?"pointermove":o,e)):(h.viewportX!==d||h.viewportY!==s)&&(Eo(h,d,s),Qo(this,o,e))),this.b.clear()};function $o(e,o,s,h){$o.j.constructor.call(this,"contextmenu"),this.items=[],this.viewportX=e,this.viewportY=o,this.target=s,this.originalEvent=h}u($o,ud),t("H.mapevents.ContextMenuEvent",$o);function ap(e){this.ph=A(this.ph,this),this.rh=A(this.rh,this),this.qh=A(this.qh,this),this.J=!1,this.i=-1,this.L=0,ap.j.constructor.call(this,e,[{Sa:"contextmenu",listener:this.ph},{target:e,Sa:"longpress",listener:this.rh},{target:e,Sa:"dbltap",listener:this.qh}])}u(ap,Oo),p=ap.prototype,p.rh=function(e){var o=e.currentPointer;o.type==="touch"&&e.pointers.length===1&&bp(this,o.viewportX,o.viewportY,e.originalEvent,e.target)},p.qh=function(e){e.currentPointer.type==="touch"&&(this.L=Date.now())},p.ph=function(e){var o=this;this.i===-1?this.i=setTimeout(function(){var s=Bo(o.f),h=e.pageX-s.x;s=e.pageY-s.y,o.i=-1,bp(o,h,s,e)},this.Tg):(clearInterval(this.i),this.i=-1),e.preventDefault()};function bp(e,o,s,h,d){var g=e.map,_=Date.now()-e.L;d?!e.J&&_>e.Ch&&(e.J=!0,d.dispatchEvent(new $o(o,s,d,h)),Fe(g.N(),cp,e.mj,!1,e)):g.Od(o,s,e.Jn.bind(e,o,s,h))}p.Jn=function(e,o,s,h){h=h&&Da(h.dispatchEvent)?h:this.map,bp(this,e,o,s,h)},p.mj=function(){this.J&&(this.J=!1,this.map.dispatchEvent(new ud("contextmenuclose",this.map)))},p.o=function(){var e=this.map.N();clearInterval(this.i),e&&Me(e,cp,this.mj,!1,this),Oo.prototype.o.call(this)};var cp=["mousedown","touchstart","pointerdown","wheel"];function dp(e,o,s,h,d){dp.j.constructor.call(this,"wheel"),this.delta=e,this.viewportX=o,this.viewportY=s,this.target=h,this.originalEvent=d}u(dp,ud),t("H.mapevents.WheelEvent",dp);function ep(e){var o="onwheel"in document;this.T=o,this.L=(o?"d":"wheelD")+"elta",this.i=A(this.i,this),ep.j.constructor.call(this,e,[{Sa:(o?"":"mouse")+"wheel",listener:this.i}]),this.J=this.map.b}u(ep,Oo),ep.prototype.i=function(e){if(!e.kl){var o=Bo(this.f),s=e.pageX-o.x;o=e.pageY-o.y;var h=this.L,d=e[h+(h+"Y"in e?"Y":"")],g;if(cd&&x.getComputedStyle(this.J.element).direction==="rtl"&&(s-=(x.devicePixelRatio-1)*this.J.width),d){var _=Math.abs,j=_(d);d=(!(g=e[h+"X"])||3<=j/_(g))&&(!(g=e[h+"Z"])||3<=j/_(g))?(+(0<d)-+(0>d))*(this.T?1:-1):0}s=new dp(d,s,o,null,e),s.delta&&(e.stopImmediatePropagation(),e.preventDefault(),this.map.Od(s.viewportX,s.viewportY,this.R.bind(this,s)))}},ep.prototype.R=function(e,o){var s=e.target=o||this.map,h,d;setTimeout(function(){s.dispatchEvent(e),e.c||(h=e.originalEvent,d=new x.WheelEvent("wheel",h),d.kl=!0,h.target.dispatchEvent(d))},0)};function fp(e){this.i=A(this.i,this),Oo.call(this,e,[{Sa:"mousedown",listener:this.i},{Sa:"mousemove",listener:this.i,target:window},{Sa:"mouseup",listener:this.i,target:window},{Sa:"mouseover",listener:this.i},{Sa:"mouseout",listener:this.i},{Sa:"dragstart",listener:this.J}])}u(fp,Oo),fp.prototype.i=function(e){var o=e.type,s=Bo(this.f);s={x:e.pageX-s.x,y:e.pageY-s.y};var h;(h=this.a.a[0]||null)||(h=new Do(s.x,s.y,1,"mouse"),this.a.push(h)),this.b.push(h),Eo(h,s.x,s.y),/^mouse(?:move|over|out)$/.test(o)?Qo(this,"pointermove",e):(/^mouse(down|up)$/.test(o)&&(s=e.which-1,Co.RegExp.$1==="up"?Ho(h,s):Fo(h,s)),Qo(this,o.replace("mouse","pointer"),e)),this.b.clear()},fp.prototype.J=function(e){e.preventDefault()};function gp(e){var o=e.b.element.style;if(hp.indexOf(e)!==-1)throw Error("InvalidArgument: map is already in use");this.a=e,hp.push(e),o.msTouchAction=o.touchAction="none",dd||!window.PointerEvent&&!window.MSPointerEvent?(this.c=new Wo(this.a),this.b=new fp(this.a)):this.c=new Xo(this.a),this.g=new ep(this.a),this.f=new ap(this.a),this.a.tb(this.F,this),qd.call(this)}u(gp,qd),t("H.mapevents.MapEvents",gp);var hp=[];Ic(hp),gp.prototype.F=function(){delete this.a,this.c.F(),this.g.F(),this.f.F(),this.b&&this.b.F(),hp.splice(hp.indexOf(this.a),1),qd.prototype.F.call(this)},gp.prototype.dispose=gp.prototype.F,gp.prototype.Nl=function(){return this.a},gp.prototype.getAttachedMap=gp.prototype.Nl;function ip(e,o){o=o===void 0?{}:o;var s;if(ip.j.constructor.call(this),jp.indexOf(e)!==-1)throw new D(ip,0,"events are already used");this.b=s=e.a,this.l=e,jp.push(e),s.draggable=!0,this.i=o.kinetics||{duration:600,ease:em},this.s=o.modifierKey||"Alt",this.enable(o.enabled),this.c=s.b,this.f=this.c.element,this.g=0,s.addEventListener("dragstart",this.Mh,!1,this),s.addEventListener("drag",this.bk,!1,this),s.addEventListener("dragend",this.Lh,!0,this),s.addEventListener("wheel",this.rk,!1,this),s.addEventListener("dbltap",this.lk,!1,this),s.addEventListener("pointermove",this.ck,!1,this),Ee(this.f,"contextmenu",this.ak,!1,this),e.tb(this.F,this)}u(ip,qd),t("H.mapevents.Behavior",ip);var jp=[];Ic(jp),ip.prototype.a=0;var kp={PANNING:1,PINCH_ZOOM:2,WHEEL_ZOOM:4,DBL_TAP_ZOOM:8,FRACTIONAL_ZOOM:16,TILT:32,HEADING:64};ip.Feature=kp;var lp=kp.PANNING,mp=kp.PINCH_ZOOM,np=kp.WHEEL_ZOOM,op=kp.DBL_TAP_ZOOM,pp=kp.FRACTIONAL_ZOOM,qp=kp.TILT,rp=kp.HEADING,sp=lp|mp|np|op|pp|qp|rp;ip.DRAGGING=lp,ip.WHEELZOOM=np,ip.DBLTAPZOOM=op,ip.FRACTIONALZOOM=pp;function tp(e,o){if(e!==+e||e%1||0>e||2147483647<e)throw new D(o,0,"integer in range [0...0x7FFFFFFF] required")}ip.prototype.disable=function(e){var o=this.a;e!==B?(tp(e,this.disable),o^=o&e):o=0,this.c.endInteraction(!0),this.a=o,this.b.draggable=0<(o&(lp|qp|rp|mp))},ip.prototype.disable=ip.prototype.disable,ip.prototype.enable=function(e){var o=this.a;e!==B?(tp(e,this.enable),o|=e&sp):o=sp,this.a=o,this.b.draggable=0<(o&(lp|qp|rp|mp))},ip.prototype.enable=ip.prototype.enable,ip.prototype.isEnabled=function(e){return tp(e,this.isEnabled),e===(this.a&e)},ip.prototype.isEnabled=ip.prototype.isEnabled;function up(e,o,s){var h=o.currentPointer.type==="touch",d=0,g;if(g=!h){g=e.s;var _,j=o.originalEvent;j.getModifierState?_=j.getModifierState(g):_=!!j[g.replace(/^Control$/,"ctrl").toLowerCase()+"Key"],g=_}return g?d|=qp|rp:(d|=lp,h&&(o=o.pointers,o.length===2&&(d|=mp|rp,s?55>Dd(o[0].viewportY-o[1].viewportY)&&(d|=qp):e.uh&Nl.TILT&&(d|=qp)))),d&=e.a,(d&qp?Nl.TILT:0)|(d&rp?Nl.HEADING:0)|(d&mp?Nl.ZOOM:0)|(d&lp?Nl.COORD:0)}function vp(e){var o=e.pointers;return e=o[0],o=o[1],e=[e.viewportX,e.viewportY],o&&e.push(o.viewportX,o.viewportY),e}p=ip.prototype,p.uh=0,p.Mh=function(e){var o=up(this,e,!0);if(this.uh=o){var s=this.c;if(e=vp(e),s.startInteraction(o,this.i),s.interaction.apply(s,e),this.a&np&&!(this.a&pp)&&(o=e[0],s=e[1],this.g)){e=this.b.pb();var h=(0>this.g?Cd:Bd)(e);e!==h&&(this.g=0,wp(this,e,h,o,s))}}},p.bk=function(e){var o=up(this,e,!1);if(o!==this.uh)e.originalEvent.type!=="pointerout"&&e.originalEvent.type!=="pointerover"&&(this.Lh(e),this.Mh(e));else if(o){o=this.c;var s=vp(e);o.interaction.apply(o,s),e.originalEvent.preventDefault()}},p.Lh=function(e){up(this,e,!1)&&this.c.endInteraction(!this.i)};function wp(e,o,s,h,d){var g=+s-+o;if(e=e.b.c,isNaN(+o))throw Error("start zoom needs to be a number");if(isNaN(+s))throw Error("to zoom needs to be a number");g!==0&&(e.startControl(null,h,d),e.control(0,0,6,0,0,0),e.endControl(!0,function(_){_.zoom=s}))}p.rk=function(e){if(!e.defaultPrevented&&this.a&np){var o=e.delta,s=this.b.pb(),h=this.b,d=h.f.type;h=this.a&pp?s-o:(0>-o?Cd:Bd)(s)-o,(d===kk.P2D||d===kk.WEBGL||d===kk.HARP)&&(wp(this,s,h,e.viewportX,e.viewportY),this.g=o),e.preventDefault()}},p.ck=function(){},p.lk=function(e){var o=e.currentPointer,s=this.b.pb(),h=e.currentPointer.type,d=this.b.f.type;(d===kk.P2D||d===kk.WEBGL||d===kk.HARP)&&this.a&op&&(e=h==="mouse"?e.originalEvent.button===0?-1:1:0<e.pointers.length?1:-1,e=this.a&pp?s-e:(0>-e?Cd:Bd)(s)-e,wp(this,s,e,o.viewportX,o.viewportY))},p.ak=function(e){return this.a&op?(e.preventDefault(),!1):!0},p.F=function(){var e=this.b;e&&(e.draggable=!1,e.removeEventListener("dragstart",this.Mh,!1,this),e.removeEventListener("drag",this.bk,!1,this),e.removeEventListener("dragend",this.Lh,!0,this),e.removeEventListener("wheel",this.rk,!1,this),e.removeEventListener("dbltap",this.lk,!1,this),e.removeEventListener("pointermove",this.ck,!1,this),delete this.b),this.f&&(this.f.style.msTouchAction="",Me(this.f,"contextmenu",this.ak,!1,this),delete this.f),delete this.c,delete this.i,jp.splice(jp.indexOf(this.l),1),delete this.l,qd.prototype.F.call(this)},ip.prototype.dispose=ip.prototype.F,t("H.mapevents.buildInfo",function(){return Hf("H-mapevents","1.49.1","74e5afb",{region:"row"})}),S.prototype.J=ca(3,function(e){var o=this.getCache(),s=this;if(e!==z){C(e,Rk,S.prototype.J,0);var h=e}else h=yl;h!==o&&o.na(function(d,g,_){return s.ub(d)?(h.add(d,g,_),!0):!1}),this.P=h}),ti.prototype.a=ca(2,function(e){this.f=e,e=this.getState(),e!==Xh.INIT&&e!==Xh.LOADING&&Ai(this)});function xp(e){return e=e.uc("_#-;,:","_#-;,:","_#-;,:"),new RegExp("^"+e.replace(/[.*+?^${}()|[\]\\\/]/g,"\\$&").replace(/_#-;,:/g,"\\d+")+"$")}function yp(e,o){return Ya.apply(null,arguments),e}function zp(e,o){var s=x.console;s&&s.warn&&(e=yc(e)+" is deprecated and will be removed soon. ",o&&(e+=o),s.warn(e))}var Ap=globalThis;tc("monospace serif");function Bp(){}Bp.prototype.pop=function(e){return this[e]||(this[e]=[]),this[e].pop()||document.createElement("canvas")},Bp.prototype.push=function(e,o){this[o]||(this[o]=[]),this[o].push(e)};var Cp=new Bp;t("H.service.util.eval",function(a){return eval(a)});function W(e,o,s,h,d,g){if(e&&o)this.Bi(e),this.af(o),this.wd(s),this.xi(d),this.Lk(g),this.bf(h);else throw new D(W,B,'Parameters "scheme" and "host" must be specified')}t("H.service.Url",W);function Dp(e,o){var s=x.document,h,d="";if(s){if(d=s.createElement("a"),o){var g=(h=s.getElementsByTagName("base")[0])&&h.href,_=s.head,j=h||_.appendChild(s.createElement("base"));j.href=o}d.href=e,d=d.href,o&&(h?h.href=g:_.removeChild(j))}else/[\w]+:\/\//.test(e)&&(d=e);g=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(d),e=g[1],_=g[4],o=g[5],j=g[6],s=g[7],h=g[8],!g[2]&&_&&/@/.test(_)&&(_=_.split("@")[1]),g=W,j=j&&0<j.length?j.substr(1):"",d={};var $,_t;if(s)for($=/([?&]?([^=&+]+))(=([^&]+))?/g;_t=$.exec(s);)d[decodeURIComponent(_t[2])]=_t[4]?decodeURIComponent(_t[4]):void 0;return new g(e,_,j,d,isNaN(+o)?void 0:+o,h&&0<h.length?h.substr(1):"")}W.parse=Dp,W.prototype.clone=function(){var e={},o;for(o in this.a)e[o]=this.a[o];return new W(this.i,this.c,this.b,e,this.g,this.f)},W.prototype.clone=W.prototype.clone,W.prototype.Bi=function(e){if(!e||typeof e!="string")throw new D(this.Bi,0,'The "scheme" parameter must be a non-empty string.');return this.i=e,this},W.prototype.setScheme=W.prototype.Bi,W.prototype.Vm=function(){return this.i},W.prototype.getScheme=W.prototype.Vm,W.prototype.af=function(e){if(!e||typeof e!="string"||e.charAt(0)==="-"||e.charAt(0)==="."||e.charAt(e.length-1)===".")throw new D(this.af,0,'The "host" parameter is not a valid host name.');return this.c=e,this},W.prototype.setHost=W.prototype.af,W.prototype.om=function(){return this.c},W.prototype.getHost=W.prototype.om,W.prototype.wd=function(e){return this.b=e||void 0,this},W.prototype.setPath=W.prototype.wd,W.prototype.Hm=function(){return this.b},W.prototype.getPath=W.prototype.Hm,W.prototype.bf=function(e){if(e)if(typeof e=="object")this.a=e;else throw new D(this.bf,0,'Parameter "params" must be an object.');else this.a={};return this},W.prototype.setQuery=W.prototype.bf,W.prototype.Mj=function(){return!Ep(this)},W.prototype.hasQuery=W.prototype.Mj,W.prototype.getQuery=function(){return this.a},W.prototype.getQuery=W.prototype.getQuery,W.prototype.xi=function(e){if(e===void 0)this.g=e;else{var o=ae(+e<<0,0,65535);if(o!=e)throw new D(this.xi,0,'Parameter "port" must be an integer in range [0...65535]');this.g=o}return this},W.prototype.setPort=W.prototype.xi,W.prototype.Mm=function(){return this.g},W.prototype.getPort=W.prototype.Mm,W.prototype.Lk=function(e){return this.f=e||void 0,this},W.prototype.setAnchor=W.prototype.Lk,W.prototype.kd=function(){return this.f},W.prototype.getAnchor=W.prototype.kd,W.prototype.I=function(e){if(typeof e!="object")throw new D(this.I,0,'Parameter "other" must be an object.');var o=this.a,s;for(s in e)e.hasOwnProperty(s)&&typeof e[s]!="function"&&(o[s]=e[s]);return this},W.prototype.mergeQuery=W.prototype.I,W.prototype.Ba=function(e){if(!e||typeof e!="string")throw new D(this.Ba,0,'Parameter "subDomain" must be a non-empty string');return e.substr(e.length-1)==="."&&(e=e.substr(0,e.length-1)),this.af(e+"."+this.c)},W.prototype.addSubDomain=W.prototype.Ba,W.prototype.G=function(e){if(!e||typeof e!="string")throw new D(this.G,0,'Parameter "subPath" must be a non-empty string');return this.wd((this.b?this.b+"/":"")+e)},W.prototype.addSubPath=W.prototype.G,W.prototype.toString=function(){return[this.i+"://",this.c,this.g?":"+this.g:"",this.b||!Ep(this)||this.f?"/":"",this.b?encodeURI(this.b):"",Fp(this),this.f?"#"+encodeURIComponent(this.f):""].join("")},W.prototype.toString=W.prototype.toString;function Gp(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(o){return"%"+o.charCodeAt(0).toString(16)})}function Fp(e){var o=[],s=e.a,h={},d;for(d in s){if(s.hasOwnProperty(d)&&typeof s[d]!="function"){var g=e.a[d];h.yd=Gp(d),C(g,Hp)?g.a.forEach(function(_){return function(j){o.push(_.yd+"="+Gp(j))}}(h)):C(g,Ip)?o.push(h.yd+"="+g.b.map(function(_){return Gp(_)}).join(g.a)):o.push(g===void 0?h.yd:h.yd+"="+Gp(g))}h={yd:h.yd}}return 0<o.length?"?"+o.join("&"):""}function Jp(e){var o=Hf("H-service","1.49.1","74e5afb",{region:"row"});return e.a.xnlp="CL_JSMv3."+o.version,e}function Ep(e){var o,s=0;for(o in e.a)if(e.a.hasOwnProperty(o)&&typeof e.a[o]!="function"&&(s++,0<s))break;return!s}function Kp(e,o){if(Bc(e))for(var s=0;s<e.length;s++){var h=e[s];if(!Cc(h)&&!Fc(h)){var d="The Array does not contain only strings and numbers";break}}else d="Not an Array";if(d)throw new D(o,0,e);return e}function Hp(e){this.a=Kp(e,Hp)}W.MultiValueQueryParameter=Hp,Hp.prototype.fn=function(){return this.a},Hp.prototype.getValues=Hp.prototype.fn;function Ip(e,o){if(this.b=Kp(e,Ip),!/^[!\$\(\)\*\+,;]$/.test(o))throw new D(Ip,1,'Invalid delimiter "'+o+'"');this.a=o}W.DelimitedQuerySubValues=Ip;function Lp(e,o){C(e,Mp,Lp,0);var s={};Object.assign(s,o),s.min=s.min||0,s.max=s.max||20,s.tileSize=s.tileSize||512,s.getURL=function(h,d,g){return e.v().clone().G(e.b.og+"/"+(e.b.eg+"/")+(g+"/"+h+"/"+d+"/")+e.b.format).I(e.f).clone().I({size:s.tileSize})},Ek.call(this,s),this.i=e}u(Lp,Ek),t("H.service.rasterTile.Provider",Lp),Lp.prototype.ba=function(e,o){var s=this.i;return Np(s.ba(),s.b.og+"."+s.V(),o,e)},Lp.prototype.getCopyrights=Lp.prototype.ba,Lp.prototype.l=function(){return od()},Lp.prototype.c=function(){return od()?nd():Lp.j.c.call(this)};function X(e){e=yp({},this.b,e);var o=e.apikey||e.apiKey,s=e.baseUrl;if(s=o?s?0:"baseUrl":"apikey")throw new D(X,0,'"'+s+'" must be specified');this.Nk(e.baseUrl),this.a=o,this.Yb.I({apikey:o}),this.c=e.headers||{},this.f=Wa(e.servicesConfig||{})}t("H.service.Platform",X),X.prototype.b={apikey:null,baseUrl:new W("https","hereapi"+(Mn?".cn":".com"))},X.prototype.Nk=function(e){this.Yb=Jp(e.clone()),this.a=e=this.a,this.Yb.I({apikey:e})},X.prototype.setBaseUrl=X.prototype.Nk,X.prototype.Ib=function(){return this.Yb},X.prototype.getBaseUrl=X.prototype.Ib,X.prototype.Ma=function(e,o){try{return e.Qf=!0,new e(yp({platformBaseUrl:this.Ib(),headers:this.c},this.f[e.CONFIG_KEY]||{},o||{}))}finally{e.Qf=!1}},X.prototype.createService=X.prototype.Ma,X.prototype.xf=function(e,o,s){var h=this;if(!H.map.render.harp)throw Error("HARP engine module not found");if(!Ea(e)&&!Cc(e))throw new D(this.xf,0,"is invalid: must be either a configuration object or a URL");if(!Da(o))throw new D(this.xf,1,"is invalid: must be a Function");if(!Da(s))throw new D(this.xf,2,"is invalid: must be a Function");var d=new H.map.render.harp.Style(e);d.addEventListener("change",function(){var g=d.getState();if(g===-1)s(Error("H.service.platform#createHybridLayers method failed to load style configuration"));else if(g===2){g={dark:!0};var _=h.lh({resource:"background",queryParams:{style:"satellite.day"}}),j=d.qc(),$={styles:[{technique:"raster",attr:{gamma:1,brightness:1}}]};j.definitions&&(j.definitions["Satellite.Texture.Gamma"]!==void 0&&($.styles[0].attr.gamma=j.definitions["Satellite.Texture.Gamma"]),j.definitions["Satellite.Texture.Brightness"]!==void 0&&($.styles[0].attr.brightness=j.definitions["Satellite.Texture.Brightness"])),_=new Lp(_,{engineType:Qn,style:new H.map.render.harp.Style($)}),o({raster:new sl(_,g),vector:h.He().$b(d,{engineType:Qn},g),traffic:h.oh().$b(d,{engineType:Qn},g)})}}),d.load()},X.prototype.createHybridLayers=X.prototype.xf,X.prototype.wf=function(e,o,s,h,d,g){function _(ly,py,gy){py=ly.f(py),py=_o?new ti(py):new H.map.render.harp.Style(py);var by={engineType:_t};_r&&_r.politicalView&&(by.politicalView=_r.politicalView),s&&(by.lg=s),h&&(by.lg2=h),g&&(by.pois=g);var wy;return gy&&(wy={dark:gy}),ly.$b(py,by,wy)}function j(ly,py,gy,by,wy){return ly.nc(py,gy,ga,by,_l,1,wy,_e)}var $=this,_t=jk,_e={crossOrigin:"anonymous"};if(Ea(e)){var _r=e;"crossOrigin"in _r&&(_e.crossOrigin=_r.crossOrigin),e=_r.tileSize,o=_r.ppi,s=_r.lg,h=_r.lg2,d=_r.style,g=_r.pois,_r.engineType!==void 0&&(_t=_r.engineType,_e.engineType=_t)}var _n=_t===kk.HARP,_o=_t===kk.WEBGL,ga=e||512,_l={};if(0>[72,250,320,500].indexOf(+o)){if(o!==B)throw new D(this.wf,1,o)}else _l.ppi=+o;if(s&&(_l.lg=s),h&&(_l.lg2=h),d&&(_l.style=d),g&&(_l.pois=!!g),_n&&!H.map.render.harp)throw new D(this.wf,0,"HARP engine is not supported, module not found");if(e={},Mn)yp(e,{vector:{normal:{map:_(this.He(),"harp/oslo/normal.day.json")}}});else{d=this.ih();var _f=this.ih({type:"aerial"}),_c=this.nh(),_p=_c.ej(_l.lg?{lg:_l.lg,i18n:!0,engineType:_t}:{engineType:_t});if(yp(e,{raster:{normal:{xbase:j(d,"xbasetile","normal.day","png8",!1),xbasenight:j(d,"xbasetile","normal.night","png8",!0),base:j(d,"basetile","normal.day","png8",!1),basenight:j(d,"basetile","normal.night","png8",!0),map:j(d,"maptile","normal.day","png8",!1),mapnight:j(d,"maptile","normal.night","png8",!0),trafficincidents:_p,transit:j(d,"maptile","normal.day.transit","png8",!1),labels:j(d,"labeltile","normal.day","png",!1)},satellite:{xbase:j(_f,"xbasetile","hybrid.day","jpg",!0),base:j(_f,"basetile","hybrid.day","jpg",!0),map:j(_f,"maptile","hybrid.day","jpg",!0),labels:j(_f,"labeltile","hybrid.day","png",!0)},terrain:{xbase:j(_f,"xbasetile","terrain.day","jpg",!1),base:j(_f,"basetile","terrain.day","jpg",!1),map:j(_f,"maptile","terrain.day","jpg",!1),labels:j(_f,"labeltile","terrain.day","png",!1)}}}),_n||_o){if(yp(e,{vector:{normal:{traffic:_c.dj(void 0,_t),trafficincidents:_p}}}),d=this.He(),_o?(e.vector.normal.map=_(d,"omv/miami/normal.day.yaml"),e.vector.normal.truck=_(d,"omv/miami/truck.day.yaml")):_n&&(e.vector.normal.map=_(d,"harp/oslo/normal.day.json"),e.vector.normal.truck=_(d,"harp/oslo/normal.day.json")),d=this.oh(),_n){var _g={ppi:72<o?400:100,size:256<ga?512:256,features:"pois:"+(g===!0||Cc(g)&&/[^0]/.test(g)?"all":"disabled")};s&&(_g.lang=s),h&&(_g.lang2=h),_r&&_r.politicalView&&(_g.pview=_r.politicalView),o={dark:!0},_f=function(ly,py,gy,by,wy){var Cy=yp({},_g);return/^explore\./.test(gy)||delete Cy.features,ly=$.lh({format:py,resource:ly,queryParams:yp({style:gy},Cy)}),wy=new Lp(ly,{engineType:_t,style:wy}),new sl(wy,by)},yp(e.raster.normal,{base:_f("background","png8","explore.day"),basenight:_f("background","png8","explore.night",o),map:_f("base","png8","explore.day"),mapnight:_f("base","png8","explore.night",o),labels:_f("label","png","explore.day")}),yp(e.raster.satellite,{xbase:_f("background","jpeg","satellite.day",o),base:_f("background","jpeg","explore.satellite.day",o),map:_f("base","jpeg","explore.satellite.day",o),labels:_f("label","png","explore.satellite.day")}),_c=this.He(),yp(e.vector.normal,{mapnight:_(_c,"harp/oslo/normal.night.json",!0),lite:_(_c,"harp/oslo/lite.day.json"),litenight:_(_c,"harp/oslo/lite.night.json",!0),ism:_(_c,"harp/oslo/ism.day.json"),ismnight:_(_c,"harp/oslo/ism.night.json",!0)}),_p={styles:[{technique:"raster",attr:{gamma:["interpolate",["linear"],["zoom"],0,1,13,1.2,17,1.3],brightness:["interpolate",["linear"],["zoom"],0,.7,13,.9,17,1]}}]};for(var ty=[],oy=0;4>oy;oy++){var ry=new H.map.render.harp.Style(JSON.parse(JSON.stringify(_p)));ry=_f("background","jpeg","satellite.day",o,ry),ty.push(ry)}e.hybrid={day:{raster:ty[0],vector:_(_c,"harp/oslo/hybrid.day.json",!0),traffic:_(d,"harp/oslo/hybrid.day.json",!0)},night:{raster:ty[1],vector:_(_c,"harp/oslo/hybrid.night.json",!0),traffic:_(d,"harp/oslo/hybrid.night.json",!0)},liteday:{raster:ty[2],vector:_(_c,"harp/oslo/lite.hybrid.day.json",!0),traffic:_(d,"harp/oslo/lite.hybrid.day.json",!0)},litenight:{raster:ty[3],vector:_(_c,"harp/oslo/lite.hybrid.night.json",!0),traffic:_(d,"harp/oslo/lite.hybrid.night.json",!0)}}}o={traffic:{}},o.traffic.map=_(d,_o?"traffic/vector.tile.yaml":"harp/oslo/normal.day.json"),_n&&(o.traffic.mapnight=_(d,"harp/oslo/normal.night.json"),o.traffic.lite=_(d,"harp/oslo/lite.day.json"),o.traffic.litenight=_(d,"harp/oslo/lite.night.json")),yp(e.vector,o)}}return e},X.prototype.createDefaultLayers=X.prototype.wf;function Op(e,o){if(o=o===void 0?{}:o,!e.Qf)throw new $c(e);Op.j.constructor.call(this);var s=Pp(this,o);if(!s.baseUrl&&!s.platformBaseUrl)throw new D(e,0,'either "baseUrl" or "platformBaseUrl" must be specified');this.i=(s.baseUrl?s.baseUrl:s.platformBaseUrl).clone(),e=s.baseUrl?o:s,e.host&&this.i.af(e.host),e.subDomain&&this.i.Ba(e.subDomain),e.path&&this.i.wd(e.path),Jp(this.i),this.g=s.headers||{}}u(Op,F),t("H.service.Service",Op);function Pp(e,o){return e=e.Aa(),o?yp({},e,o):e}Op.prototype.Aa=function(){return{}},Op.prototype.v=function(){return this.i},Op.prototype.getUrl=Op.prototype.v,Op.prototype.B=function(e,o,s,h){return h=new tf(h===void 0?"application/json":h,e.toString(),je,{headers:this.g}),h.then(o,Qp(this,e,s)),h};function Qp(e,o,s){return function(h){return typeof h.json!="function"?Promise.reject(s(Rp(o,h))):h.json().then(function(d){return s(e.a(d))},function(){return s(Rp(o,h))})}}Op.prototype.a=function(e){return Error(e.message)};function Rp(e,o){return Error((o.statusText?"["+o.statusText+"] ":"")+e+" request failed")}function Sp(e){Sp.j.constructor.call(this,Sp,e)}u(Sp,Op),t("H.service.traffic.Service7",Sp),Sp.prototype.Aa=function(){return{subDomain:"data.traffic",path:"v7"}},Sp.CONFIG_KEY="traffic_v7",Sp.prototype.qo=function(e,o,s,h){return e=this.v().clone().G(["incidents",e].join("/")).I(o||{}),this.B(e,s,h)},Sp.prototype.requestIncidentById=Sp.prototype.qo,Sp.prototype.oo=function(e,o,s){return e=this.v().clone().G("flow").I(e||{}),this.B(e,o,s)},Sp.prototype.requestFlowByArea=Sp.prototype.oo,Sp.prototype.so=function(e,o,s){return e=this.v().clone().G("incidents").I(e||{}),this.B(e,o,s)},Sp.prototype.requestIncidentsByArea=Sp.prototype.so;function Tp(e){if(!e||!Da(e.requestData))throw new D(Tp,0,"options.requestData");Tp.j.constructor.call(this,e),this.L=e.requestData,this.D=!!e.providesDomMarkers}u(Tp,S),t("H.map.provider.MarkerTileProvider",Tp),Tp.prototype.B=function(e,o,s,h,d){var g=this;return this.L(e,o,s,function(_){for(var j=[],$,_t,_e=_.length;_e--;)_t=_[_e],_t.Ho=g.getTileKey(e,o,s),_t.ka(g),$=_t.xb(),(C(_t,bj)||$.getState()===1)&&j.push(_[_e]);h(j)},d)},Tp.prototype.requestInternal=Tp.prototype.B,Tp.prototype.Td=function(e,o){o===kh.VISUAL&&(e=this.nb().get(e.Ho))&&(e.valid=!1,this.Va(e))},Tp.prototype.invalidateObject=Tp.prototype.Td,Tp.prototype.Qb=function(){return this.D},Tp.prototype.providesDomMarkers=Tp.prototype.Qb,Tp.prototype.Rb=ff,Tp.prototype.providesMarkers=Tp.prototype.Rb;function Up(){this.a={}}Up.prototype.xb=function(e,o){var s=e+o,h;return(h=this.a[s])?h:(e=Vp.MARKER.replace("{{icon}}",Wp[e]||Wp.OTHER),e=e.replace("{{color}}",Xp[o]||Xp.BLOCKING),o={size:{w:26,h:33},anchor:{x:13,y:30},hitArea:new Xi(Yi.POLYGON,Yp.MARKER)},this.a[s]=h=new Wj(e,o))};var Vp={MARKER:'<svg width="26" height="33" enable-background="new 0 0 26 33" viewBox="0 0 26 33" xmlns="http://www.w3.org/2000/svg"><path d="m26 33h-26v-33h26z" fill="#8c8c8c" opacity="0"/><path d="m17 29.566c0 1.116-1.791 2.022-4 2.022s-4-.906-4-2.022c0-1.118 1.791-2.026 4-2.026s4 .908 4 2.026" fill="#878787" opacity=".6"/><path d="m1.795 17.971c-1.562-1.555-1.574-3.828-.028-5.655l8.343-10.021c.769-.895 1.795-1.384 2.894-1.384 1.117 0 2.197.521 2.889 1.394l8.338 10.014c1.588 1.854 1.578 4.022-.029 5.65l-11.202 11.202z" fill="{{color}}"/>{{icon}}</svg>'},Wp={CONGESTION:'<path style="fill:#FFFFFF;" d="M12.966,1.177c0.965,0,1.894,0.442,2.496,1.204l8.378,10.258c1.362,1.592,1.482,3.477,0,4.979L12.994,28.464L2.143,17.618c-1.381-1.375-1.38-3.348,0-4.979l8.314-10.258C11.174,1.547,12.085,1.177,12.966,1.177 M12.967,0.177L12.967,0.177c-1.247,0-2.408,0.551-3.269,1.552l-8.332,10.28c-1.711,2.022-1.688,4.567,0.07,6.317l10.85,10.845l0.707,0.707l0.707-0.707l10.847-10.846c1.784-1.807,1.803-4.292,0.053-6.337L16.237,1.748C15.462,0.769,14.236,0.177,12.967,0.177L12.967,0.177z M16.645,10.405l-2.025-2.22c-0.48-0.51-1.15-0.8-1.84-0.8H9.53c-0.69,0-1.36,0.29-1.84,0.8l-1.94,2.22c-0.39,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.44l0.255-0.539c0.204-0.431,0.456-0.837,0.753-1.21l0.962-1.211l0.83-0.9c0.32-0.35,0.72-0.63,1.15-0.82H8.23c-0.28,0-0.55-0.07-0.79-0.22l-0.28-0.17l1.27-1.45c0.28-0.31,0.68-0.48,1.1-0.48h3.25c0.42,0,0.82,0.17,1.1,0.48l1.354,1.54H16.645z M18.31,12.205c-0.35-0.37-0.81-0.63-1.3-0.74c-0.18-0.04-0.36-0.06-0.54-0.06h-3.24c-0.7,0-1.37,0.29-1.84,0.8l-1.13,1.22l-0.82,1c-0.38,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.75v-1h5.99v1h1.75c0.69,0,1.25-0.56,1.25-1.25v-1.64c0-0.74-0.2-1.46-0.59-2.09L18.31,12.205z M12.1,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C12.35,16.993,12.238,17.105,12.1,17.105z M18.59,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C18.84,16.993,18.728,17.105,18.59,17.105z M18.56,14.505c-0.24,0.15-0.51,0.22-0.79,0.22h-5.85c-0.28,0-0.55-0.07-0.78-0.22l-0.29-0.17l1.27-1.45c0.15-0.16,0.33-0.28,0.53-0.37c0.18-0.07,0.38-0.11,0.58-0.11h3.24c0.24,0,0.48,0.06,0.68,0.16c0.16,0.08,0.3,0.19,0.42,0.32l1.27,1.45L18.56,14.505z M8.42,13.03h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C8.67,12.918,8.559,13.03,8.42,13.03z"/>',ROADWORKS:'<path d="m13.004 1.411c.964 0 1.894.441 2.496 1.204l8.346 10.023c1.363 1.592 1.482 3.477 0 4.979l-10.846 10.847-10.852-10.846c-1.381-1.375-1.379-3.348 0-4.979l8.346-10.023c.717-.835 1.628-1.205 2.51-1.205m0-1c-1.248 0-2.408.551-3.268 1.552l-8.356 10.035c-1.718 2.033-1.695 4.578.064 6.328l10.85 10.845.706.707.707-.707 10.846-10.846c1.784-1.808 1.803-4.293.053-6.337l-8.337-10.012c-.769-.973-1.996-1.565-3.265-1.565zm-.575 15.264c.018-.332-.13-.651-.394-.851l-2.945-2.235-.21.36c-.22.39-.41.78-.58 1.19l-.677 2.129-1.364 3.051h1.314l2.109-4.672 1.317 1.212.138 3.46h1.092zm6.16-1.327c-.401-.54-1.209-.539-1.609.001l-1.17 1.58-2.29-1.74-.139-4.054c-.011-.276-.134-.535-.342-.716l-.7-.61c-.185-.161-.422-.25-.667-.25h-1.885c-.335 0-.648.168-.833.447l-1.144 1.723 7.58 5.76-1.86 2.51c-.098.132-.004.32.161.32h6.648l1.142-1.077zm-8.79-2.989-.876-.665.841-1.018.965.043zm1.63 1.24.969-1.781.118 2.61zm2.76-5.79c-.64 0-1.16.52-1.16 1.16 0 .65.52 1.17 1.16 1.17s1.16-.52 1.16-1.17c0-.64-.52-1.16-1.16-1.16z" fill="#fff"/>',ACCIDENT:'<path style="fill:#FFFFFF;" d="M12.998,1.091c0.964,0,1.894,0.442,2.496,1.204l8.346,10.344c1.363,1.592,1.482,3.477,0,4.979L12.994,28.465L2.143,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.344C11.205,1.462,12.115,1.091,12.998,1.091 M12.998,0.091L12.998,0.091c-1.248,0-2.408,0.551-3.269,1.552L1.364,12.011c-1.708,2.021-1.685,4.566,0.073,6.316l10.85,10.845l0.707,0.707l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337l-8.327-10.32C15.494,0.684,14.268,0.091,12.998,0.091L12.998,0.091z M7.83,18.982l-3.309-1.855l0.945,1.855H7.83z M16.111,19h3.942l1.596-2L16.111,19z M10.512,20.064l1.021-1.021l1.632,0.076c0.329,0.018,0.651-0.022,0.963-0.123c0.626-0.206,1.122-0.76,1.288-1.44l0.264-1.089l2.066-0.93c0.373-0.17,0.673-0.42,0.861-0.731c0.275-0.449,0.405-0.97,0.369-1.498L18.9,11.676l1.021-1.021l-0.724-0.724l-0.427,0.427l-0.121-0.364c-0.201-0.603-0.54-1.151-0.989-1.6l-1.159-1.159c-0.5-0.5-1.31-0.5-1.809,0l-1.267,1.267l0.724,0.724l-5.066,5.066l-0.724-0.724l-1.267,1.267c-0.5,0.5-0.5,1.31,0,1.809l1.159,1.159c0.449,0.449,0.997,0.788,1.6,0.989l0.364,0.121l-0.427,0.427L10.512,20.064z M14.901,10.349l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0l-0.732-0.732C14.803,10.604,14.803,10.446,14.901,10.349z M9.472,15.777l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0L9.472,16.13C9.375,16.033,9.375,15.874,9.472,15.777z M11.391,17.615c0.069-0.271,0.206-0.518,0.405-0.717l4.961-4.961c0.195-0.195,0.445-0.337,0.717-0.405l0.344-0.083l0.137,1.925c0.022,0.318-0.058,0.63-0.221,0.901c-0.101,0.166-0.279,0.271-0.409,0.329L14.8,15.74l-0.38,1.574c-0.083,0.344-0.318,0.615-0.612,0.713c-0.188,0.058-0.38,0.083-0.579,0.072l-1.925-0.138L11.391,17.615z"/>',OTHER:'<path style="fill:#FFFFFF;" d="M13.004,1.411c0.964,0,1.894,0.441,2.496,1.204l8.346,10.023c1.363,1.592,1.482,3.477,0,4.979L13,28.465L2.148,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.023C11.211,1.781,12.122,1.411,13.004,1.411 M13.004,0.411L13.004,0.411c-1.248,0-2.408,0.551-3.268,1.552L1.38,11.998c-1.718,2.033-1.694,4.579,0.064,6.328l10.85,10.845L13,29.878l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337L16.269,1.976C15.5,1.003,14.273,0.411,13.004,0.411L13.004,0.411z M14.716,20.139c0,0.947-0.758,1.724-1.724,1.724c-0.947,0-1.704-0.777-1.704-1.724c0-0.928,0.757-1.704,1.704-1.704C13.958,18.435,14.716,19.211,14.716,20.139z M14.204,16.33H11.78l-0.537-8.533h3.5L14.204,16.33z"/>'},Xp={BLOCKING:"#323232",VERYHIGH:"#d5232f",HIGH:"#ffa100"},Yp={MARKER:[24.1,17.8,14.2,28.42,16.8,29.4,12.8,31.4,8.79,29.4,11.23,28.42,1.7,17.8,1.7,12.1,10,1.9,12.9,.498,15.8,1.9,24.1,12.1,24.1,17.8]};function Zp(e,o,s){s=s||{},s.criticality||(s.criticality="major,critical"),C(e,$p,Zp,0),Tp.call(this,{max:20,min:8,requestData:A(this.T,this),engineType:s.engineType}),this.f=new Up,this.u=e,this.i=s,this.reload=A(this.reload,this),this.m=setInterval(this.reload,o||18e4)}u(Zp,Tp),t("H.service.traffic.incidents.Provider",Zp);var aq={minor:"HIGH","low impact":"HIGH",major:"VERYHIGH",critical:"BLOCKING"};Zp.prototype.T=function(e,o,s,h,d){var g=this,_=this.f;return this.u.requestIncidentsByTile(e,o,s,function(j){var $=[];j=j.TRAFFIC_ITEMS;var _t;if(j)for(j=j.TRAFFIC_ITEM,_t=j.length;_t--;){var _e=j[_t],_r=_e.TRAFFIC_ITEM_TYPE_DESC;switch(_r){case"ACCIDENT":case"CONGESTION":var _n=_r;break;case"CONSTRUCTION":_n="ROADWORKS";break;default:_n="OTHER"}_n=_.xb(_n,aq[_e.CRITICALITY.DESCRIPTION]),_r=_e.LOCATION.GEOLOC.ORIGIN,_r=new Rn({lat:_r.LATITUDE,lng:_r.LONGITUDE},{provider:g,icon:_n}),_r.setData(_e),$.push(_r)}h($)},d,this.i)},Zp.prototype.F=function(){Tp.prototype.F.call(this),clearInterval(this.m)},Zp.prototype.dispose=Zp.prototype.F;var bq="A21 A22 F01 F02 F08 F04 F05 F07 F03 F06 A2F F13 A25 A2C F12 D1B F1B A27 E12 A3A A24 A3D A3F F1F F25 F2C E32 A33 F29 D26 D36 F26 D0F F0F F2B E0C D3A A45 D23 D11 F2E F19 F14 F39 A4A A4B A5C D38 F2A F1A D0A F1C A48 D25 D1D F32 A46 A3E D24 E1C E32 A5F D2E D22 D0A".split(" ");function cq(e,o,s,h){cq.j.constructor.call(this,{min:10,max:21,engineType:h}),C(e,$p,cq,0),this.m=e,this.f=s||dq,this.f.responseattributes="sh,fc",this.i=setInterval(A(this.reload,this),o||18e4),this.b===kk.WEBGL?this.Qa(new ti(Ao()+"/traffic/flow.yaml"),!0):this.Qa(new H.map.render.harp.Style({styles:[{when:["==",["geometry-type"],"LineString"],technique:"solid-line",renderOrder:10002,attr:{color:["case",[">=",["get","JF"],10],"black",[">=",["get","JF"],8],"red",[">=",["get","JF"],4],"yellow","green"],lineWidth:3,metricUnit:"Pixel"}}]}))}u(cq,S),t("H.service.traffic.flow.Provider",cq),cq.prototype.ei=ff,cq.prototype.providesGeoJSON=cq.prototype.ei,cq.prototype.V=function(){return this.Ya()},cq.prototype.getStyle=cq.prototype.V,cq.prototype.gb=function(e){e.a&&e.a("GeoJSONTileSource"),this.Qa(e)},cq.prototype.setStyle=cq.prototype.gb;var dq={locationreferences:"tmc,shp"};cq.prototype.o=function(){cq.j.o.call(this),clearInterval(this.i)},cq.prototype.B=function(e,o,s,h,d){return this.m.requestFlowByTile(e,o,s,function(g){g.type&&g.type.indexOf("Error")!==-1?d(g.Details):h(g)},d,this.f)},cq.prototype.requestInternal=cq.prototype.B,cq.prototype.ac=function(e,o,s,h,d){var g,_,j,$,_t={type:"FeatureCollection",features:[]},_e,_r=h.RWS.length;for(g=0;g<_r;g++){var _n=h.RWS[g],_o=_n.RW,ga=_o.length,_l=bq.indexOf(_n.EXTENDED_COUNTRY_CODE+_n.EBU_COUNTRY_CODE)!==-1;for(_n=0;_n<ga;_n++){var _f=_o[_n].FIS,_c=_f.length;for(_f=0;_f<_c;_f++){var _p=_o[_n].FIS[_f].FI,_g=_p.length;for(_=0;_<_g;_++){var ty=_p[_],oy=[],ry=ty.CF[0],ly=!!ry.SSS,py={type:"Feature",properties:ry,geometry:{type:"MultiLineString",coordinates:oy}};for(py.properties.LHT=_l,ty.SHP.length&&(py.properties.FC=ty.SHP[0].FC),ly&&(_e=[]),ry=0;ry<ty.SHP.length;ry++){var gy=ty.SHP[ry].value,by=gy.length;for(j=0;j<by;j++){var wy=ly?_e:void 0,Cy=new qo(gy[j].trim()),Gy=[],Ly={};for(Cy.ge();($=Cy.Pb())!==-1;)$===eq?(Ly.lat=+String.fromCharCode.apply(cq,Cy.Gd()),Cy.next(),Cy.ge()):$===fq?(Ly.lng=+String.fromCharCode.apply(cq,Cy.Gd()),Gy.push([Ly.lng,Ly.lat]),wy&&wy.push(ng(Ly)),Ly=[],Cy.next(),Cy.ge()):Cy.next();Ly.lng=+String.fromCharCode.apply(cq,Cy.Gd()),Gy.push([Ly.lng,Ly.lat]),wy&&wy.push(ng(Ly)),$=Gy,oy.push($)}}_t.features.push(py)}}}}return cq.j.ac.call(this,e,o,s,_t,d)},cq.prototype.createTileInternal=cq.prototype.ac;var fq=32,eq=44;function gq(e){function o(_e){h.contains(d)&&h.removeChild(d),_t&&clearTimeout(_t),delete gq.a[g],_e&&e.pj&&e.pj.call($,_e)}if(!e.url||!e.Og)throw Error('Parameter "options" must specify at least a URL and a callback.');if(typeof e.Og!="function")throw Error("Parameters options.callback must be a function");var s=e.cp||document,h=s.getElementsByTagName("head")[0],d=s.createElement("script");s=e.url instanceof W?e.url:Dp(e.url,e.bp);var g=gq.b++,_=e.vl||"callback",j=e.Og,$={},_t=null;return $.id=g,$.cancel=function(){o("cancelled")},e.timeout!==0&&(_t=x.setTimeout(function(){o("timeout")},e.timeout||3e4)),gq.a[g]=function(_e){o(),j.call($,_e)},d.type="text/javascript",d.src=s.toString()+(s.Mj()?"&":"?")+_+"="+(e.ep?"H.service.jsonp.handleResponse("+g+")":encodeURI("H.service.jsonp.handleResponse("+g+")")),h.appendChild(d),$}t("H.service.jsonp",gq),gq.mn=function(e){return(e=gq.a[e])?e:function(){}},gq.handleResponse=gq.mn,gq.b=0,gq.a={};function $p(e){$p.j.constructor.call(this,$p,e),this.c=Pp(this,e).callbackKey,this.b=!1}u($p,Op),t("H.service.traffic.Service",$p),$p.prototype.Aa=function(){return{subDomain:"traffic.ls",path:"traffic/6.1",callbackKey:"jsoncallback"}},$p.CONFIG_KEY="traffic",$p.prototype.dj=function(e,o){return new sl(new cq(this,void 0,e,o),{max:22})},$p.prototype.createFlowLayer=$p.prototype.dj,$p.prototype.ej=function(e){return new Sn(new Zp(this,void 0,e))},$p.prototype.createIncidentsLayer=$p.prototype.ej;function hq(e,o,s,h){return e.b||(zp($p,"Use HERE Traffic API v7 instead."),e.b=!0),gq({url:o,Og:s,pj:function(d){h(Error("["+d+"] "+o+" request failed"))},vl:e.c})}$p.prototype.ro=function(e,o,s){return e=this.v().clone().G("incidents.json").I(e),hq(this,e,o,s)},$p.prototype.requestIncidents=$p.prototype.ro,$p.prototype.po=function(e,o,s,h,d,g){return e=this.v().clone().G(["flow/json",s,e,o].join("/")).I(g||{}),hq(this,e,h,d)},$p.prototype.requestFlowByTile=$p.prototype.po,$p.prototype.to=function(e,o,s,h,d,g){return e=this.v().clone().G(["incidents/json",s,e,o].join("/")).I(g||{}),hq(this,e,h,d)},$p.prototype.requestIncidentsByTile=$p.prototype.to,X.prototype.nh=function(e,o){if(o=o||6,o===6)o=$p;else if(o===7)o=Sp;else throw new D(this.nh,1,"allowed values are 6 and 7");return this.Ma(o,e)},X.prototype.getTrafficService=X.prototype.nh;function iq(e){iq.j.constructor.call(this,iq,e),this.b=Pp(this,e).reverseSubDomain,zp(iq,"Use HERE Geocoding and Search API v7 instead.")}u(iq,Op),t("H.service.GeocodingService",iq),iq.prototype.Aa=function(){return{subDomain:"geocoder.ls",reverseSubDomain:"reverse",path:"6.2"}},iq.CONFIG_KEY="geocoding",iq.prototype.a=function(e){return Error(e.Details||e.message||e.error)},iq.prototype.Zg=function(e,o,s){return e=this.v().clone().G("geocode.json").I(e),this.B(e,o,s)},iq.prototype.geocode=iq.prototype.Zg,iq.prototype.ii=function(e,o,s){return e=this.v().clone().G("reversegeocode.json").I(e),this.b&&e.Ba(this.b),this.B(e,o,s)},iq.prototype.reverseGeocode=iq.prototype.ii,iq.prototype.search=function(e,o,s){return e=this.v().clone().G("search.json").I(e),this.B(e,o,s)},iq.prototype.search=iq.prototype.search,X.prototype.km=function(e){return this.Ma(iq,e)},X.prototype.getGeocodingService=X.prototype.km;function jq(e){zp(jq,"Use HERE Geocoding and Search API v7 instead."),jq.j.constructor.call(this,jq,e)}u(jq,Op),t("H.service.PlacesService",jq),jq.prototype.Aa=function(){return{subDomain:"places.ls",path:"places/v1"}},jq.CONFIG_KEY="places",jq.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"},jq.prototype.request=function(e,o,s,h){return kq(this,e,o,s,h)},jq.prototype.request=jq.prototype.request;function kq(e,o,s,h,d){return o=e.v().clone().G(o).I(s||{}),e.B(o,h,d)}jq.prototype.search=function(e,o,s){return kq(this,"discover/search",e,o,s)},jq.prototype.search=jq.prototype.search,jq.prototype.Go=function(e,o,s){return kq(this,"suggest",e,o,s)},jq.prototype.suggest=jq.prototype.Go,jq.prototype.Fl=function(e,o,s){return kq(this,"discover/explore",e,o,s)},jq.prototype.explore=jq.prototype.Fl,jq.prototype.rl=function(e,o,s){return kq(this,"discover/around",e,o,s)},jq.prototype.around=jq.prototype.rl,jq.prototype.on=function(e,o,s){return kq(this,"discover/here",e,o,s)},jq.prototype.here=jq.prototype.on,jq.prototype.wl=function(e,o,s){return kq(this,"categories/places",e,o,s)},jq.prototype.categories=jq.prototype.wl,jq.prototype.Gl=function(e,o,s,h){return e=Dp(e).I(this.v().getQuery()).I(h||{}),this.B(e,o,s)},jq.prototype.follow=jq.prototype.Gl,X.prototype.Im=function(e){return this.Ma(jq,e)},X.prototype.getPlacesService=X.prototype.Im;function lq(){this.a={}}function mq(e,o){for(var s in o)if(o.hasOwnProperty(s)){var h,d=o[s],g=e.a[s]||(e.a[s]=[]),_=d.length;for(h=0;h<_;h++)g.push(new nq(d[h]))}}function Np(e,o,s,h){var d=(e=e.a[o])?e.length:0,g=[];for(o=0;o<d;o++)e[o].nd(s,h)&&g.push(e[o]);return g}function nq(e){var o,s=e.boxes;if(this.label=e.label,this.min=e.minLevel,this.max=e.maxLevel,this.b=[],s&&(o=s.length)){var h=s[0],d=new K(h[0],h[1],h[2],h[3]);for(this.b.push(d),this.a=new K(h[0],h[1],h[2],h[3]),e=1;e<o;e++)h=s[e],d=new K(h[0],h[1],h[2],h[3]),this.b.push(d),this.a.ec(d,!1,this.a)}}nq.prototype.nd=function(e,o){if(e>=this.min&&e<=this.max)if((e=this.b.length)&&this.a){if(this.a.nd(o)){for(;e--;)if(this.b[e].nd(o))return!0}}else return!0;return!1};function oq(e,o,s){var h=this,d=s||{},g=+d.min,_=+d.max;d.tileSize=d.tileSize||512,d.min=g?ae(g,1,17):1,d.min+=Pk(d.tileSize,1),d.max=_?ae(_,1,17):17,oq.j.constructor.call(this,d),C(e,pq,oq,0),C(o,Wh,oq,1),this.i=e,o.a&&o.a("OMV"),this.Qa(o,!0),this.m=!1,s&&(s.politicalView&&(this.u=s.politicalView),qq(this,s.lg,s.lg2),this.m=!!s.pois),this.aa=function(){h.T=xp(h),h.reload(!1)},e.addEventListener("versionupdate",this.aa),this.T=xp(this),oq.prototype.qa=function(){var j=/^v2\/vectortiles\/(.+)\/mc$/.exec(e.v().b);return j?j[1]:B+""}()}u(oq,S),t("H.service.omv.Provider",oq),oq.prototype.Sb=ff,oq.prototype.providesOMV=oq.prototype.Sb,oq.prototype.ub=function(e){return this.T.test(e)},oq.prototype.cacheFilter=oq.prototype.ub,oq.prototype.uc=function(e,o,s){return rq(this.i,e,o,s).toString()},oq.prototype.getTileKey=oq.prototype.uc,oq.prototype.nb=function(){return this.xa},oq.prototype.getCache=oq.prototype.nb,oq.prototype.Lm=function(){return this.u},oq.prototype.getPoliticalView=oq.prototype.Lm,oq.prototype.yo=function(e){var o=this.u;this.u=e,this.dispatchEvent(new cj("politicalviewchange",this.u,o))},oq.prototype.setPoliticalView=oq.prototype.yo,oq.prototype.MAX_STORE_TIME=2592e6,oq.prototype.l=function(){return od()},oq.prototype.c=function(){return od()?nd():oq.j.c.call(this)},oq.prototype.s=function(){return this.i},oq.prototype.B=function(e,o,s,h,d){return this.i.Ha(e,o,s,h,d)},oq.prototype.requestInternal=oq.prototype.B,oq.prototype.gb=function(e){e.a&&e.a("OMV"),this.Qa(e)},oq.prototype.setStyle=oq.prototype.gb,oq.prototype.V=function(){return oq.j.Ya.apply(this)},oq.prototype.getStyle=oq.prototype.V,oq.prototype.Ya=function(){var e=oq.j.Ya.apply(this),o=e.getState()===Xh.READY,s=e.qc();return o&&s&&s.global&&(this.D&&(this.R&&(s.global.ux_language=this.R),this.L&&(s.global.ux_language_fallback=this.L)),this.m&&s.global.poi&&s.global.poi.default&&(s.global.poi.default.visible=this.m),this.D||this.m)&&(e=new ti(s,e.Ib())),e},oq.prototype.getStyleInternal=oq.prototype.Ya;function qq(e,o,s){var h=Cc(o),d=Cc(s);h&&(e.R=o),d&&(e.L=s),(h||d)&&(e.f=[],h=/^([a-zA-Z]{2})(-|$)/,(d=h.exec(o))&&(d[1]==="zh"?e.f.push(o):e.f.push(d[1])),(d=h.exec(s))&&(d[1]==="zh"?e.f.push(s):e.f.push(d[1])),e.D=!0)}oq.prototype.D=!1;var sq=["en"];oq.prototype.hh=function(){return this.f||sq},oq.prototype.getLanguages=oq.prototype.hh,oq.prototype.o=function(){oq.j.o.call(this),this.i.removeEventListener("versionupdate",this.aa)},oq.prototype.xa=new Rk(256),oq.prototype.ba=function(e,o){return Np(this.i.ba(),this.qa,o,e)},oq.prototype.getCopyrights=oq.prototype.ba;function pq(e){pq.j.constructor.call(this,pq,e);var o=Pp(this,e).mapVersion;this.l=e.queryParams||{},this.b=vc(o)?o:tq[this.v().toString()],vc(this.b)||uq(this)}u(pq,Op),t("H.service.omv.Service",pq),pq.prototype.Aa=function(){return{subDomain:"vector",path:"v2/vectortiles/base/mc"}},pq.CONFIG_KEY="omv";var tq={};Ic(tq),pq.prototype.Am=function(){return this.b},pq.prototype.getMapVersion=pq.prototype.Am;function uq(e){e.B(e.v().clone().G("../../info"),function(o){o=o.mapVersion;var s=e.v().toString();e.b=o,o!==tq[s]&&(tq[s]=o,e.dispatchEvent("versionupdate"))},function(){})}pq.prototype.$b=function(e,o,s){o=o||{};var h={min:0,max:22};return Ea(s)&&yp(h,s),Mn&&(o.min=h.min=4),new sl(new oq(this,e,o),h)},pq.prototype.createLayer=pq.prototype.$b,pq.prototype.Ha=function(e,o,s,h,d){return this.B(rq(this,e,o,s),function(g){return g.arrayBuffer().then(h,d)},d,"arraybuffer")};function rq(e,o,s,h){return o=e.v().clone().G(h+"/"+o+"/"+s+"/omv"),vc(e.b)&&o.I({mv:e.b}).I(e.l),o}pq.prototype.f=function(e){return Ao()+"/"+e},pq.prototype.Je=function(e,o){if(!Da(e))throw new D(this.Je,0,'"onResult" must be a function');if(!Da(o))throw new D(this.Je,1,'"onError" must be a function');return this.B(this.v().clone().wd("v2/vectortiles/pviews"),e,o)},pq.prototype.getPoliticalViews=pq.prototype.Je,X.prototype.He=function(e){return this.Ma(pq,e)},X.prototype.getOMVService=X.prototype.He,pq.prototype.s=function(e){mq(this.c,e),this.dispatchEvent("copyrightupdate")},pq.prototype.ba=function(){return this.c||(this.c=new lq,this.B(this.v().clone().G("../../copyrights"),A(this.s,this),ld)),this.c},pq.prototype.getCopyrights=pq.prototype.ba;function vq(e){vq.j.constructor.call(this,vq,e),this.b=e.getToken}u(vq,Op),t("H.service.iml.Service",vq),vq.prototype.Aa=function(){return{host:"interactive.data.api.platform.here.com",path:"interactive/v1/catalogs"}},vq.prototype.a=function(e){function o(){for(var h=ea(s),d=h.next();!d.done;d=h.next()){d=d.value;var g=d.format;if(d.keys.every(function(_){return e[_]}))return g()}return JSON.stringify(e)}var s=[{keys:["code","title","cause","action"],format:function(){return e.code+": "+e.title+"; cause: "+e.cause+"; action: "+e.action}},{keys:["error","error_description"],format:function(){return e.error+": "+e.error_description}},{keys:["error","errorMessage"],format:function(){return e.error+": "+e.errorMessage}}];return Error(Ea(e)?o():e)},vq.prototype.Qd=function(e,o,s,h,d){var g=this.Qd;return wq(g,0,e,o),xq(g,2,s,h),e=this.v().clone().G(e+"/layers/"+o+"/statistics").I(d||{}),yq(this,e,"GET",s,h)},vq.prototype.getStatistics=vq.prototype.Qd,vq.prototype.Ff=function(e,o,s,h,d,g,_,j,$){var _t=$?"":".mvtf";return e=this.v().clone().G(h+"/layers/"+d+"/tile/web/"+s+"_"+e+"_"+o+_t).I(Object.assign({clip:!0},j)),yq(this,e,"GET",$?g:function(_e){return _e.arrayBuffer().then(g)},_,void 0,$?"application/json":"arraybuffer")},vq.prototype.getFeaturesByTile=vq.prototype.Ff,vq.prototype.wj=function(e,o,s,h,d,g){var _=this.wj;return zq(_,e),wq(_,1,o,s),xq(_,3,h,d),e=Aq(this,e,o,s,g),yq(this,e,"GET",h,d)},vq.prototype.getFeatureById=vq.prototype.wj,vq.prototype.Sc=function(e,o,s,h,d,g){var _=this.Sc;return Bq(_,e),wq(_,1,o,s),xq(_,3,h,d),e=Dq(this,e,o,s,g),yq(this,e,"GET",h,d)},vq.prototype.getFeaturesById=vq.prototype.Sc,vq.prototype.Jd=function(e,o,s,h,d){var g=this.Jd;if(!Ea(e)||!(e.bbox||e.north&&e.east&&e.south&&e.west))throw new D(g,0,'must be an object with either "bbox" or a full set of "north", "east", "south" and "west"');return wq(g,1,o,s),xq(g,3,h,d),e=this.v().clone().G(o+"/layers/"+s+"/bbox").I(e),yq(this,e,"GET",h,d)},vq.prototype.getFeaturesByBoundingBox=vq.prototype.Jd,vq.prototype.yj=function(e,o,s,h,d){var g=this.yj;if(!(Ea(e)&&e.radius&&(e.lat&&(e.lng||e.lon)||e.refCatalogHrn&&e.refLayerId&&e.refFeatureId)))throw new D(g,0,'must be an object with "radius" and a combination of either "lat"+"lng" or "refCatalogHrn"+"refLayerId"+"refFeatureId"');return wq(g,1,o,s),xq(g,3,h,d),e=this.v().clone().G(o+"/layers/"+s+"/spatial").I(e),yq(this,e,"GET",h,d)},vq.prototype.getFeaturesByPointAndRadius=vq.prototype.yj,vq.prototype.xj=function(e,o,s,h,d,g){var _=this.xj;if(!Ea(e)||!e.radius)throw new D(_,0,'must be an object with "radius"');return Eq(_,1,o),wq(_,2,s,h),xq(_,4,d,g),e=this.v().clone().G(s+"/layers/"+h+"/spatial").I(e),yq(this,e,"POST",d,g,o)},vq.prototype.getFeaturesByGeometryAndRadius=vq.prototype.xj,vq.prototype.Jk=function(e,o,s,h,d){var g=this.Jk;return wq(g,0,e,o),xq(g,2,s,h),e=this.v().clone().G(e+"/layers/"+o+"/search").I(d||{}),yq(this,e,"GET",s,h)},vq.prototype.searchFeatures=vq.prototype.Jk,vq.prototype.Wj=function(e,o,s,h,d){var g=this.Wj;return wq(g,0,e,o),xq(g,2,s,h),e=this.v().clone().G(e+"/layers/"+o+"/iterate").I(d||{}),yq(this,e,"GET",s,h)},vq.prototype.iterateFeatures=vq.prototype.Wj,vq.prototype.$c=function(e,o,s,h,d,g){var _=this.$c;return Eq(_,0,e),wq(_,1,o,s),xq(_,3,h,d),o=Fq(this,o,s,g),yq(this,o,"PUT",h,d,e)},vq.prototype.putFeatures=vq.prototype.$c,vq.prototype.Yc=function(e,o,s,h,d,g){var _=this.Yc;return Eq(_,0,e),wq(_,1,o,s),xq(_,3,h,d),o=Fq(this,o,s,g),yq(this,o,"POST",h,d,e)},vq.prototype.postFeatures=vq.prototype.Yc,vq.prototype.hd=function(e,o,s,h,d){var g=this.hd;return Bq(g,e),wq(g,1,o,s),xq(g,3,h,d),e=Dq(this,e,o,s),yq(this,e,"DELETE",h,d)},vq.prototype.deleteFeatures=vq.prototype.hd,vq.prototype.Ck=function(e,o,s,h,d,g,_){var j=this.Ck;return zq(j,e),Eq(j,1,o),wq(j,2,s,h),xq(j,4,d,g),e=Aq(this,e,s,h,_),yq(this,e,"PUT",d,g,o)},vq.prototype.putFeature=vq.prototype.Ck,vq.prototype.wk=function(e,o,s,h,d,g,_){var j=this.wk;return zq(j,e),Eq(j,1,o),wq(j,2,s,h),xq(j,4,d,g),e=Aq(this,e,s,h,_),yq(this,e,"PATCH",d,g,o)},vq.prototype.patchFeature=vq.prototype.wk,vq.prototype.ij=function(e,o,s,h,d){var g=this.ij;return zq(g,e),wq(g,1,o,s),xq(g,3,h,d),e=Aq(this,e,o,s),yq(this,e,"DELETE",h,d,void 0,"text/plain")},vq.prototype.deleteFeature=vq.prototype.ij;function Fq(e,o,s,h){return e.v().clone().G(o+"/layers/"+s+"/features").I(h||{})}function Dq(e,o,s,h,d){return o=Object.assign({},d,{id:new Hp(o)}),Fq(e,s,h,o)}function Aq(e,o,s,h,d){return e.v().clone().G(s+"/layers/"+h+"/features/"+o).I(d||{})}function yq(e,o,s,h,d,g,_){return _=_===void 0?"application/json":_,s={method:s,headers:Object.assign({},g?{"Content-Type":"application/geo+json"}:void 0,typeof e.b=="function"?{Authorization:"Bearer "+e.b()}:void 0,e.g)},g&&(s.data=JSON.stringify(g)),g=new tf(_,o.toString(),je,s),g.then(h,Qp(e,o,d)),g}vq.CONFIG_KEY="iml";function wq(e,o,s,h){zc(s,"String",e,o,"must be a string"),zc(h,"String",e,o+1,"must be a string")}function zq(e,o){zc(o,"String",e,0,"must be a string")}function Bq(e,o){if(!Array.isArray(o)||o.length===0||o.some(function(s){return typeof s!="string"}))throw new D(e,0,"must be a non-empty array of strings")}function Eq(e,o,s){if(!Ea(s))throw new D(e,o,"must be a GeoJSON object")}function xq(e,o,s,h){if(!Da(s))throw new D(e,o,"must be a function");if(!Da(h))throw new D(e,o+1,"must be a function")}X.prototype.pm=function(e){return this.Ma(vq,e)},X.prototype.getIMLService=X.prototype.pm;function Gq(e,o,s,h){if(Gq.j.constructor.call(this,h?{min:h.min,max:h.max,engineType:h.engineType}:void 0),C(e,vq,Gq,0),!Cc(o))throw new D(Gq,1,'"catalogHrn" must be a string');if(!Cc(s))throw new D(Gq,2,'"layerId" must be a string');this.u=e,this.f=o,this.i=s,this.m=Ea(h)&&Ea(h.parameters)?h.parameters:{},this.Qa(this.b===kk.WEBGL?new ti({sources:{iml:{type:"MVT"}},layers:{iml:{data:{source:"iml",layer:this.f+":"+this.i},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#0258AE",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.f+":"+this.i,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.f+":"+this.i,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.f+":"+this.i,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.f+":"+this.i,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#0258AE",lineWidth:"2px",renderOrder:203}]}))}u(Gq,S),t("H.service.iml.Provider",Gq),Gq.prototype.B=function(e,o,s,h,d){return this.u.Ff(e,o,s,this.f,this.i,h,d,this.m)},Gq.prototype.requestInternal=Gq.prototype.B,Gq.prototype.Sb=ff,Gq.prototype.providesOMV=Gq.prototype.Sb,Gq.prototype.V=function(){return this.Ya()},Gq.prototype.getStyle=Gq.prototype.V,Gq.prototype.gb=function(e){C(e,ti)&&e.a("MVT"),this.Qa(e)},Gq.prototype.setStyle=Gq.prototype.gb;function Mp(e){e=e===void 0?{}:e,Mp.j.constructor.call(this,Mp,e),this.b={og:e.resource||"base",eg:e.projection||"mc",format:e.format||"png8"},this.f=e.queryParams||{}}u(Mp,Op),t("H.service.rasterTile.Service",Mp),p=Mp.prototype,p.V=function(){return this.f.style||"explore.day"},p.Aa=function(){return{subDomain:"maps",path:"v3"}},p.ba=function(){return this.c||(this.c=new lq,this.B(this.v().clone().G("copyright"),A(this.Kn,this),ld)),this.c},p.Kn=function(e){var o=e.copyrights;e=e.resources;var s={},h=this.b.og+"."+this.V();s[h]=[],e[this.b.og].styles[this.V()].forEach(function(d){o[d].forEach(function(g){var _=[];g.boundingBoxes.forEach(function(j){_.push([j.north,j.west,j.south,j.east])}),s[h].push({boxes:_,label:g.label,alt:g.alt,minLevel:g.minLevel,maxLevel:g.maxLevel})})}),mq(this.c,s)},p.Fe=function(e,o){return this.B(this.v().clone().G("info"),e,o)},Mp.prototype.getInfo=Mp.prototype.Fe,Mp.prototype.Je=function(e,o){return this.B(this.v().clone().G("politicalViews"),e,o)},Mp.prototype.getPoliticalViews=Mp.prototype.Je,Mp.prototype.jm=function(e,o){return this.B(this.v().clone().G("features"),e,o)},Mp.prototype.getFeatures=Mp.prototype.jm,Mp.prototype.hh=function(e,o){return this.B(this.v().clone().G("languages"),e,o)},Mp.prototype.getLanguages=Mp.prototype.hh,Mp.CONFIG_KEY="rasterTile",X.prototype.lh=function(e){return this.Ma(Mp,e)},X.prototype.getRasterTileService=X.prototype.lh;function Hq(e,o,s,h,d,g,_){var j=this;_=_||{},g=g||{};var $=e.v().clone().G(o+"/"+e.vc()+"/"+s).I(g),_t=e.c;this.D=e,this.R=$,Ek.call(this,{tileSize:h,max:h===512?19:20,min:h===512?2:0,getURL:function(_e,_r,_n){var _o=j.R.clone();return _t&&_o.Ba(_t[(_n+_r+_e)%_t.length]),_o.G(_n+"/"+_e+"/"+_r+"/"+h+"/"+d),_o.toString()},crossOrigin:_.crossOrigin,headers:_.headers,uri:$.toString().replace(/_/g,"")+h,engineType:_.engineType}),this.me=o,this.ab=s,this.xa=g,this.qa=s.split(".")[0],this.i=A(this.i,this),this.getCopyrights=this.ba,this.L=!1,e.addEventListener("versionupdate",this.i)}u(Hq,Ek),Hq.prototype.MAX_STORE_TIME=2592e6,Hq.prototype.B=function(e,o,s,h,d,g){return this.L||(zp(Iq,"Use HERE Vector Tile API or Raster Tile API v3 instead."),this.L=!0),Hq.j.B.call(this,e,o,s,h,d,g)},Hq.prototype.requestInternal=Hq.prototype.B,Hq.prototype.o=function(){Ek.prototype.o.call(this),this.D.removeEventListener("versionupdate",this.i)},Hq.prototype.ba=function(e,o){return Np(this.D.ba(),this.qa,o,e)},Hq.prototype.getCopyrights=Hq.prototype.ba,Hq.prototype.i=function(){var e=this.D;this.R=e.v().clone().G(this.me+"/"+e.vc()+"/"+this.ab).I(this.xa),this.reload(!1)},Hq.prototype.l=function(){return od()},Hq.prototype.c=function(){return od()?nd():Hq.j.c.call(this)};function Iq(e){Iq.j.constructor.call(this,Iq,e),e=Pp(this,e),this.c=e.shards,(this.f=e.ignoreTypes?null:e.type)&&this.v().Ba(this.f),this.b=e.version,this.s=new lq,this.m={},this.l=0,this.b==="newest"&&Jq(this)}u(Iq,Op),t("H.service.MapTileService",Iq),Iq.prototype.Aa=function(){return{subDomain:"maps.ls",path:"maptile/2.1",type:"base",version:"newest",shards:["1","2","3","4"]}},Iq.CONFIG_KEY="maptile";function Kq(e,o){for(var s={},h=e[o+"s"][o],d=h.length;d--;)s[h[d].id]=h[d];e[o+"s"]=s}Iq.prototype.Hj=function(){return this.f},Iq.prototype.getType=Iq.prototype.Hj,Iq.prototype.vc=function(){return this.b},Iq.prototype.getVersion=Iq.prototype.vc,Iq.prototype.ba=function(){return this.l||(this.b&&this.b!=="newest"||this.f==="traffic")&&Lq(this),this.s},Iq.prototype.getCopyrights=Iq.prototype.ba;function Jq(e){var o=e.v().clone().G("info").I({output:"json"});e.c&&o.Ba(e.c[0]),e.B(o,function(s){s=s.response;var h;if(Kq(s,"map"),Kq(s,"scheme"),Kq(s,"tiletype"),Kq(s,"format"),Kq(s,"resolution"),Kq(s,"language"),e.b==="newest"&&e.f!=="traffic")for(h in s.maps)s.maps[h].hash&&s.maps[h].newest&&(e.b=s.maps[h].hash,e.dispatchEvent("versionupdate"));e.u=s,e.dispatchEvent("infoupdate")},function(s){throw s})}function Lq(e){var o=e.v().clone().G("copyright").G(e.vc()).I({output:"json"});e.c&&o.Ba(e.c[0]),e.l=1,e.B(o,function(s){e.l=2,mq(e.s,s),e.dispatchEvent("copyrightupdate")},function(s){throw e.l=-1,s})}Iq.prototype.Fe=function(){return this.u},Iq.prototype.getInfo=Iq.prototype.Fe,Iq.prototype.ue=function(e,o,s,h,d,g){var _=this.v().clone().G(e+"/"+this.vc()+"/"+o+"/"+s+"/"+h).I(d||{}).toString(),j=0,$,_t=_.length;if(_t!==0)for($=0;$<_t;$++){var _e=_.charCodeAt($);j=(j<<5)-j+_e,j|=0}return _=j,j=this.m[_],j||(j=new Hq(this,e,o,s,h,d,yp({headers:this.g},g||{})),this.m[_]=j),j},Iq.prototype.createTileProvider=Iq.prototype.ue,Iq.prototype.nc=function(e,o,s,h,d,g,_,j){return e=this.ue(e,o,s,h,d,j),new sl(e,{opacity:g,dark:!!_})},Iq.prototype.createTileLayer=Iq.prototype.nc,X.prototype.ih=function(e){return this.Ma(Iq,e)},X.prototype.getMapTileService=X.prototype.ih;function Mq(e){Mq.j.constructor.call(this,Mq,e)}u(Mq,Op),t("H.service.publicTransit.Service",Mq),Mq.prototype.Aa=function(){return{subDomain:"transit.router",path:"v8"}},Mq.CONFIG_KEY="publicTransit",Mq.prototype.Tm=function(e,o,s){return e=this.v().clone().G("routes").I(e),this.B(e,o,s)},Mq.prototype.getRoutes=Mq.prototype.Tm,Mq.prototype.$l=function(e,o,s){return e=this.v().clone().G("departures").I(e),this.B(e,o,s)},Mq.prototype.getDepartures=Mq.prototype.$l,Mq.prototype.Xm=function(e,o,s){return e=this.v().clone().G("stations").I(e),this.B(e,o,s)},Mq.prototype.getStations=Mq.prototype.Xm,Mq.prototype.a=function(e){return Error(JSON.stringify(e))},X.prototype.Pm=function(e){return this.Ma(Mq,e)},X.prototype.getPublicTransitService=X.prototype.Pm;function Nq(e){Nq.j.constructor.call(this,Nq,e),zp(Nq,"Use HERE Routing API v8 instead.")}u(Nq,Op),t("H.service.RoutingService",Nq),Nq.prototype.Aa=function(){return{subDomain:"route.ls",path:"routing/7.2"}},Nq.prototype.a=function(e){return Error(e.details)},Nq.CONFIG_KEY="routing",Nq.prototype.Cd=function(e,o,s){return e=this.v().clone().G("calculateroute.json").I(e),this.B(e,o,s)},Nq.prototype.calculateRoute=Nq.prototype.Cd,Nq.prototype.Ng=function(e,o,s){return e=this.v().clone().Ba("isoline").G("calculateisoline.json").I(e),this.B(e,o,s)},Nq.prototype.calculateIsoline=Nq.prototype.Ng;function Oq(e){Oq.j.constructor.call(this,Oq,e)}u(Oq,Op),t("H.service.RoutingService8",Oq),Oq.CONFIG_KEY="routing_v8",Oq.prototype.Aa=function(){return{subDomain:"router",path:"v8/routes"}},Oq.prototype.a=function(e){return Error(e.error)},Oq.prototype.Cd=function(e,o,s){return e=this.v().clone().I(e),this.B(e,o,s)},Oq.prototype.calculateRoute=Oq.prototype.Cd,Oq.prototype.Ng=function(e,o,s){return e=this.v().clone().Ba("isoline").wd("v8/isolines").I(e),this.B(e,o,s)},Oq.prototype.calculateIsoline=Oq.prototype.Ng,X.prototype.Fj=function(e,o){if(o=Mn?8:+o||7,o===7)o=Nq;else if(o===8)o=Oq;else throw new D(this.Fj,1,"allowed values are 7 and 8");return this.Ma(o,e)},X.prototype.getRoutingService=X.prototype.Fj;function Pq(){}t("H.service.extension.dataView.ITable",Pq),Pq.prototype.Md=function(){},Pq.prototype.getMeta=Pq.prototype.Md,Pq.prototype.Pd=function(){},Pq.prototype.getRowCount=Pq.prototype.Pd,Pq.prototype.tc=function(){},Pq.prototype.getRow=Pq.prototype.tc,Pq.prototype.Ta=function(){},Pq.prototype.getColumnNames=Pq.prototype.Ta,Pq.prototype.Be=function(){},Pq.prototype.getColumn=Pq.prototype.Be,Pq.prototype.ua=function(){},Pq.prototype.getCell=Pq.prototype.ua,Pq.prototype.concat=function(){},Pq.prototype.concat=Pq.prototype.concat;function Qq(){}t("H.service.extension.dataView.IRow",Qq),Qq.prototype.Ta=function(){},Qq.prototype.getColumnNames=Qq.prototype.Ta,Qq.prototype.ua=function(){},Qq.prototype.getCell=Qq.prototype.ua,Qq.prototype.md=function(){},Qq.prototype.getTable=Qq.prototype.md;function Rq(e,o){this.a=e,this.b=o}t("H.service.extension.dataView.ObjRow",Rq),Rq.prototype.Ta=function(){return this.a.Ta()},Rq.prototype.getColumnNames=Rq.prototype.Ta,Rq.prototype.ua=function(e){return this.a.ua(this.b,e)},Rq.prototype.getCell=Rq.prototype.ua,Rq.prototype.md=function(){return this.a},Rq.prototype.getTable=Rq.prototype.md;function Sq(){}t("H.service.extension.dataView.IColumn",Sq),Sq.prototype.ua=function(){},Sq.prototype.getCell=Sq.prototype.ua;function Tq(e,o){this.b=e,this.a=o}t("H.service.extension.dataView.ObjColumn",Tq),Tq.prototype.ua=function(e){return this.b.ua(e,this.a)},Tq.prototype.getCell=Tq.prototype.ua;function Uq(e,o,s){var h;if(o=o||(e&&e.length?Object.keys(e[0]):B),this.Cb=e,o)for(this.Dd=o,this.Pg=e=oc(),h=o.length;h--;)e[o[h]]=!0;s!==B&&(this.Sh=s)}t("H.service.extension.dataView.ObjTable",Uq),p=Uq.prototype,p.Sh=B,p.Cb=B,p.Dd=B,p.Pg=B,p.Md=function(){return this.Sh},Uq.prototype.getMeta=Uq.prototype.Md,Uq.prototype.Pd=function(){return this.Cb?this.Cb.length:0},Uq.prototype.getRowCount=Uq.prototype.Pd,Uq.prototype.tc=function(e){var o=this.Cb;return o&&o[e]?new Rq(this,e):B},Uq.prototype.getRow=Uq.prototype.tc,Uq.prototype.Ta=function(){return this.Dd||hf},Uq.prototype.getColumnNames=Uq.prototype.Ta,Uq.prototype.Be=function(e){return this.Pg[e]?new Tq(this,e):B},Uq.prototype.getColumn=Uq.prototype.Be,Uq.prototype.ua=function(e,o){var s=this.Cb;return(e=s&&this.Pg[o]&&s[e])&&e[o]},Uq.prototype.getCell=Uq.prototype.ua,Uq.prototype.concat=function(){var e=arguments.length,o,s=this.Dd,h=""+this.Dd,d=(this.Cb||[]).slice();for(o=0;o<e;o++){var g=arguments[o];if(!(g instanceof Uq))throw new D(this.concat,o);if(g.Cb){if(s&&""+g.Dd!==h)throw new D(this.concat,o,"Incompatible columns!");d=d.concat(g.Cb)}}return new Uq(d,this.Dd,this.Sh)},Uq.prototype.concat=Uq.prototype.concat;function Vq(e,o){return e.Cb?e.Cb.push(o):e.Cb=[o],e.Cb.length-1}function Wq(e){var o=Xq;if(!e||!Cc(af(e.layerId,e.layer))||!Fc(e.level)||vc(e.rowFilter)&&!Da(e.rowFilter)||vc(e.rowFilterContext)&&!Ea(e.rowFilterContext))throw new D(o,1,vc("invalid layer config")?"invalid layer config":e)}function Yq(e,o,s,h){h=h||Zq,this.a={},h.provider=e,this.invalidate=gf,Yq.j.constructor.call(this,o,h),delete this.invalidate,s&&(this.b=s),this.ra(kh.ADD)}u(Yq,Hh),t("H.service.remote.Spatial",Yq);var Zq={};Yq.prototype.cb=function(){return this.b||Hh.prototype.cb.call(this)},Yq.prototype.getId=Yq.prototype.cb,Yq.prototype.pg=ld,Yq.prototype.retain=Yq.prototype.pg,Yq.prototype.release=ff,Yq.prototype.release=Yq.prototype.release;function $q(e,o){this.a=e,o&&(this.b=o)}var ar=new $q(hf);Yq.prototype.Kd=function(e){return(this.a[e.key]||ar).a},Yq.prototype.getGeometriesForTile=Yq.prototype.Kd,Yq.prototype.gh=function(e){return(this.a[e.key]||ar).b},Yq.prototype.getLabels=Yq.prototype.gh;function br(e,o,s){e.a[o.key]=new $q(s,void 0)}function cr(e,o,s,h){if(!Da(s))throw new D(e,o,"has invalid type");if(!Da(h))throw new D(e,o+1,"has invalid type")}function dr(e,o,s){var h=e===8;this.b=o,this.c=s||ld,(this.a=e===4||h)?this.l=h:this.g=e===1,this.f=this.a?"$HProjGeometry":"geometry"}dr.prototype.parse=function(e,o,s){var h,d,g={},_=[],j,$,_t=0;for(j=s.length;_t<j;_t++){var _e=s[_t],_r=_e.Rows;if(_e=_r.length){var _n=Object.keys(_r[0]).filter(function(ga){return ga!=="geometry"&&ga!=="$HProjGeometry"});for(_n=new Uq(_r,_n),$=0;$<_e;$++){var _o=_r[$];if(d=_o[this.f]){if(delete _o[this.f],_o=_n.tc($))try{this.a?h=er(this,e,o,_o,d):h=fr(this,e,_o,d.path),h.ka(e),_.push(h)}catch(ga){this.c(ga.message)}}else this.c("Layer must contain geometries")}}}return g[this.a?"spatials":this.g?"markers":"domMarkers"]=_,g};function er(e,o,s,h,d){var g=[],_=d.paths,j=_.length,$=0,_t=e.b&&e.b(h);for(e=new Yq(o,e.l,B,{style:_t||e.i,data:h});$!==j;)g.push(gr(_[$++]));return br(e,s,[new Ph(g,d.interiorsIndex,d.outlinesIndex)]),e}function fr(e,o,s,h){h=new kg(h[0],h[1]);var d=e.b&&e.b(s);return e.g?(e={icon:d,data:s,provider:o},e=new Rn(h,e)):(e={icon:d,data:s,provider:o},e=new bj(h,e)),e}function gr(e){for(var o=0,s=e.length,h=[];o<s;)h.push(new J(e[o++],e[o++]));return h}function hr(e,o){var s={};this.c=e,Ya(s,o||s),ok.call(this,s),this.ig={},e=this.Kb(nh.SPATIAL),e.update(e.a+1,kh.ADD)}u(hr,ok),t("H.service.remote.ObjectProvider",hr),hr.prototype.F=function(){ok.prototype.F.call(this)},hr.prototype.dispose=hr.prototype.F,hr.prototype.Ec=function(){return hf},hr.prototype.requestMarkers=hr.prototype.Ec,hr.prototype.Dc=function(){return hf},hr.prototype.requestDomMarkers=hr.prototype.Dc,hr.prototype.sd=function(){return hf},hr.prototype.requestOverlays=hr.prototype.sd,hr.prototype.Rb=ff,hr.prototype.providesMarkers=hr.prototype.Rb,hr.prototype.Qb=ff,hr.prototype.providesDomMarkers=hr.prototype.Qb,hr.prototype.Cc=ff,hr.prototype.providesSpatials=hr.prototype.Cc,hr.prototype.kg=function(){return hf},hr.prototype.requestSpatials=hr.prototype.kg;function ir(e){return e.wc(!0)}hr.prototype.mg=function(e,o){return e=jr(this,e,kr),o&&(e=e.filter(ir)),e},hr.prototype.requestSpatialsByTile=hr.prototype.mg;function jr(e,o,s){var h=o.l&&o.l[s],d;return!h&&(d=o.s)&&(delete o.s,(o.l=e=e.c.parse(e,o,d))&&(h=e[s])),h||hf}hr.prototype.fa=function(e){var o=e.cb();if(this.ig[o])throw new $c(this.fa,"Remote object "+o+" already added");return this.ig[o]=e},hr.prototype.Ga=function(e){delete this.ig[e.cb()]};var kr="spatials";function lr(e){e=e||{};var o=e.tileCacheSize||1024,s=e.resultType,h=e.styleCallback;if(vc(e.min)||(e.min=12),lr.j.constructor.call(this,e),mr.indexOf(s)===-1)throw new D(lr,2,"invalid resultType");if(this.f=s,h&&!Da(h))throw new D(lr,2,"invalid style callback");this.aa=h,this.R=e.pixelRatio||Ue(),this.Gb=A(this.Gb,this),this.J(new Rk(o,A(this.ab,this))),this.createTileInternal=s===4||s===8?A(this.T,this):A(this.L,this)}u(lr,S),t("H.service.extension.TileProvider",lr),lr.prototype.i=!1,lr.prototype.getCapabilities=function(){return lr.j.getCapabilities.call(this)|Qj.CROP_LINES_BY_TILE|Qj.CROP_POLYGONS_BY_TILE},lr.prototype.Ha=function(e,o,s,h){return this.i?lr.j.Ha.call(this,e,o,s,h):B},lr.prototype.requestTile=lr.prototype.Ha,lr.prototype.Gb=function(e){this.dispatchEvent(new wd("error",Cc(e)?e:e+"",this))},lr.prototype.Rb=function(){return this.f===1},lr.prototype.providesMarkers=lr.prototype.Rb,lr.prototype.Qb=function(){return this.f===2},lr.prototype.providesDomMarkers=lr.prototype.Qb,lr.prototype.Cc=function(){return this.f===4||this.f===8},lr.prototype.providesSpatials=lr.prototype.Cc;function nr(e){var o=e.qa;return o||(e.u||(e.u=e.m(e.f,e.aa,e.Gb)),o=e.qa=new hr(e.u),o.ka(e),o.addEventListener(e.A.za,A(e.xa,e)),o.qa=!0),o}lr.prototype.L=function(e,o,s,h){var d=this.getTileKey(e,o,s);d=this.nb().get(d);var g=this.f==2,_=[],j=nr(this);for(d?d.valid=!0:(e=d=new Xk(e,o,s,z),delete e.l,e.s=h),h=g?jr(j,d,"domMarkers"):jr(j,d,"markers"),o=h.length;o--;)e=h[o],e.Ii=d,(g||e.xb().getState()===1)&&_.push(e);return d.data=_,d},lr.prototype.xa=function(e){(e=e.target.Ii)&&(e.valid=!1)},lr.prototype.Ao=function(e){this.D=!!e},lr.prototype.setTileCanvasRendering=lr.prototype.Ao,lr.prototype.D=!0,lr.prototype.T=function(e,o,s,h){var d=nr(this),g=this.getTileKey(e,o,s),_=this.tileSize,j=this.nb().get(g);return j||(e=j=new al(g,e,o,s,_,this.R,s,d),delete e.l,e.s=h),this.D?(h=Cp.pop(_),j.W(h)||Cp.push(h,_)):gl(j),j},lr.prototype.ab=function(e,o){var s;if(this.f===4||this.f===8){for(e=o.Ua(),s=e.length;s--;)delete e[s].a[o.key];(e=o.gg())&&(Cp.push(e,this.tileSize),o.hg())}else for(e=o.data,s=e.length;s--;)delete e[s].Ii},lr.prototype.o=function(){lr.j.o.call(this),nr(this).F()};var or={MARKER:1,DOM_MARKER:2,POLYLINE:4,POLYGON:8};lr.ResultType=or;var mr=[1,2,4,8];function Xq(e,o,s){var h=this,d=o&&o.rowFilter,g=s.resultType;Xq.j.constructor.call(this,s),C(e,pr,Xq,0),Wq(o),d?(s=Wa(o),s.rowFilter=d.toString()):s=Wa(o),delete s.layer,s.layerId=af(o.layerId,o.layer),new Pf().a("pde","H.service.extension.worker.processor"),e=e.v().clone().G(qr+"."+rr).I({meta:1}),new Sf("pde",{message:[this.uid,0,{tileSize:this.tileSize,projected:!0,onlyOutline:g===4,serverUrl:e.toString(),layerConfigs:[s],horizontalMargin:1}]}).then(function(){h.i=!0,h.Va()},this.Gb)}u(Xq,lr),t("H.service.extension.platformData.TileProvider",Xq),Xq.prototype.m=function(e,o,s){return e=new dr(e,o,s),e.i=sr,e};var sr=new wh({strokeColor:"transparent",fillColor:"transparent",lineWidth:0,lineJoin:"round",lineCap:"round"});Xq.prototype.B=function(e,o,s,h,d){var g=this,_=this.getTileKey(e,o,s),j;_=this.nb().get(_);var $={cancel:ld},_t=!0,_e=this.f;if(_&&(_e===4||_e===8?_.Ud()||(h(Cp.pop(this.tileSize),null),_t=!1):(h(z),_t=!1)),_t){var _r=Ap.setTimeout(function(){j=new Sf("pde",{message:[g.uid,1,[e,o,s]]}),j.then(h,d)},500);$.cancel=function(){j?j.cancel():Ap.clearTimeout(_r)}}return $},Xq.prototype.requestInternal=Xq.prototype.B,Xq.prototype.o=function(){Xq.j.o.call(this),new Sf("pde",{message:[this.uid,3]})},Xq.ResultType=or;function tr(e,o,s,h,d,g){cr(tr,1,o,s),cr(tr,2,h,d),(this.f=e.length)?(this.U=e,this.m=o,this.i=s,this.b=0,this.c=A(this.c,this),this.s=h,this.l=d,this.a=oc(),Ya(this.a,ur,g||{}),this.g={},x.setTimeout(this.c,0)):o(hf,!0)}var ur={duration:100,Kl:"geometry",Jl:"WKT",uo:"searchAttributes",hj:B};tr.prototype.c=function(){for(var e=[],o=!1,s=Lk(),h;this.b<this.f;){var d=this.U[this.b];if(o=d.attributes,h=d.layerId||this.a.hj,d.distance&&(o[this.a.uo]={nearest:new kg(d.nearestLat,d.nearestLon),distance:d.distance}),d=d[this.a.Kl]){try{var g=Wn(new qo(d))}catch(_){this.i(new x.Error(_.message)),o=!0;break}o[this.a.Jl]=g}if((d=this.g[h])||(d=this.g[h]=this.s({layerId:h,columnNames:Object.keys(o)})),o=this.l(d,o),e.push(o),this.b++,(o=this.b===this.f)||Lk()-s>=this.a.duration){this.m(e,o);break}}o?this.g={}:this.u=x.setTimeout(this.c,0)},tr.prototype.cancel=function(){x.clearTimeout(this.u),this.b<this.f&&this.i(new x.Error("parsing canceled"))},tr.prototype.cancel=tr.prototype.cancel;function vr(e){this.a=e}vr.prototype.cancel=function(){for(var e=this.a,o=e.length;o--;)e[o].cancel();e.length=0},vr.prototype.cancel=vr.prototype.cancel;function pr(e){pr.j.constructor.call(this,pr,e),zp(pr)}u(pr,Op),t("H.service.extension.platformData.Service",pr),pr.prototype.Aa=function(){return{subDomain:"s.fleet.ls",path:"1"}},pr.CONFIG_KEY="platformData",pr.prototype.request=function(e,o,s,h,d){var g="text/plain";if(!e)throw new D(this.request,0,e);if(!o)throw new D(this.request,1,o);if(!h)throw new D(this.request,3,h);if(!d)throw new D(this.request,4,d);return e=this.v().clone().G(e+"."+o).I(s),o===wr.JSON&&(g="application/json"),this.B(e,h,d,g)},pr.prototype.request=pr.prototype.request;var qr="tiles";pr.EntryPoint={DOC_ATTRIBUTES:"doc/attributes",DOC_LAYER:"doc/layer",DOC_LAYERS:"doc/layers",DOC_MAPS:"doc/maps",DOC_INDEXES:"doc/indexes",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SERVICE_CONFIGURATION:"serviceconfiguration",STATIC:"static",TILE:"tile",TILES:qr,FILE:"file",INDEX:"index"};var rr="json",wr={TXT:"txt",JSON:rr,HTML:"html",BIN:"bin"};pr.EntryPointType=wr,pr.prototype.nc=function(e,o){var s=o&&o.resultType;e=new Xq(this,e,o);var h;return s==1||s===2?h=new Sn(e):h=new sl(e),h},pr.prototype.createTileLayer=pr.prototype.nc;function xr(e,o,s,h,d){var g=[],_,j=s.layer_id||s.layer_ids;return e=e.request(o,rr,s,function($){_=new tr($.geometries,h,d,function(_t){return new Uq([],_t.columnNames,_t)},function(_t,_e){return _t.tc(Vq(_t,_e))},{hj:j}),g.push(_)},function($){d(new x.Error($))}),g.push(e),new vr(g)}function yr(e,o,s){if(!Bc(e))throw new D(s,0,"has invalid type");if(!Bc(o))throw new D(s,1,"has invalid type");if(e.length!==o.length||!e.length)throw new D(s,1,"specify one key attribute for each given layer id in the same order")}pr.prototype.Fc=function(e,o,s,h,d,g){function _(_t,_e){_e&&j--,h(_t,!j)}var j,$=[];for(yr(e,o,this.Fc),cr(this.Fc,3,h,d),C(s,K,this.Fc,2),s={bbox:s.c+","+s.a+";"+s.f+","+s.b},g&&Ya(s,g),e=s.layer_id?[s.layer_id]:e,g=0,j=e.length;g<j;g++)s.layer_id=e[g],s.key_attribute=o[g],$.push(xr(this,"search/bbox",s,_,d));return new vr($)},pr.prototype.searchByBoundingBox=pr.prototype.Fc,pr.prototype.Ub=function(e,o,s,h,d,g,_){if(yr(e,o,this.Ub),C(s,kg,this.Ub,2,"has invalid type"),!Fc(h))throw new D(this.Ub,3,"has invalid type");return cr(this.Ub,4,d,g),e={layer_ids:e.join(","),key_attributes:o.join(","),proximity:s.lat+","+s.lng+","+h},_&&Ya(e,_),xr(this,"search/proximity",e,d,g)},pr.prototype.searchByProximity=pr.prototype.Ub,pr.prototype.Tb=function(e,o,s,h,d,g,_){var j="";if(yr(e,o,this.Tb),!Cc(s)&&!C(s,L))throw new D(this.Tb,1,"has invalid type");if(!Fc(h))throw new D(this.Tb,2,"has invalid type");if(cr(this.Tb,4,d,g),e={layer_ids:e.join(","),key_attributes:o.join(","),radius:h},Cc(s))e.route_id=s;else{for(h=s.$,s=0,o=h.length;s<o;s+=3)j+=h[s]+","+h[s+1],s<o-3&&(j+=";");e.corridor=j}return _&&Ya(e,_),xr(this,"search/corridor",e,d,g)},pr.prototype.searchByCorridor=pr.prototype.Tb,X.prototype.Jm=function(e){return this.Ma(pr,e)},X.prototype.getPlatformDataService=X.prototype.Jm;function zr(e){zr.j.constructor.call(this,zr,e),zp(zr)}u(zr,Op),t("H.service.extension.geofencing.Service",zr),zr.prototype.Aa=function(){return{subDomain:"fleet.ls",path:"2"}},zr.CONFIG_KEY="geofencing",zr.prototype.request=function(e,o,s,h){if(!e)throw new D(this.request,0,e);if(!Da(s))throw new TypeError("onResult must be a function");if(!Da(h))throw new TypeError("onError must be a function");return e=this.v().clone().G(e+".json").I(o),this.B(e,s,h)},zr.prototype.request=zr.prototype.request,zr.prototype.a=function(e){return Error(e.issues&&e.issues.length?e.issues.map(function(o){return o.message}).join(". "):e.message||e.response_code)},zr.EntryPoint={SEARCH_PROXIMITY:"search/proximity"},X.prototype.lm=function(e){return this.Ma(zr,e)},X.prototype.getGeofencingService=X.prototype.lm,t("H.service.extension.customLocation.Permission",{READ:"read",WRITE:"write",EXPORT:"export"}),t("H.service.extension.customLocation.Storage",{READONLY:"readonly",UPDATABLE:"updatable"});function Ar(e){var o=Br;if(!e||!Cc(e.layerId)||vc(e.rowFilter)&&!Da(e.rowFilter)||vc(e.rowFilterContext)&&!Ea(e.rowFilterContext))throw new D(o,1,vc("invalid layer config")?"invalid layer config":e)}function Cr(e){return Cc(e)&&/^[A-Z][A-Z0-9_]*$/.test(e)}function Dr(e){for(var o=e&&e.length,s=2<=o&&e[--o]==="WKT"&&e[--o]==="GEOMETRY_ID";s&&o--;)s=Cr(e[o]);return s}function Er(e,o){var s="",h=[];if(o){var d=e.geometries;if(d&&d.length){var g=Object.keys(d[0].attributes);for(s=s+("Meta:	"+o+`
`)+g.join("	"),s+=`	WKT
`,e=0;e<d.length;e++){var _=d[e].attributes,j=d[e].geometry;for(o=0;o<g.length;o++)h.push(_[g[o]]);s+=h.join("	"),s+="	"+j+`
`,h=[]}}}else{if(j={},h=[],e.geometries)for(d=0;d<e.geometries.length;d++)o=e.geometries[d],j[o.layerId]||(j[o.layerId]=[]),j[o.layerId].push(o);for(g in j)h.push({layerId:g,geometries:j[g]});for(e=0;e<h.length;e++)s+=Er(h[e],h[e].layerId)}return s}function Br(e,o,s){var h=this,d=o&&o.rowFilter,g;Br.j.constructor.call(this,s),C(e,Fr,Br,0);var _=s.resultType;if(Ar(o),d){var j=Wa(o);j.rowFilter=d.toString()}else j=o;new Pf().a("cle","H.service.extension.worker.processor");var $=o.layerId;e.request(Gr,Hr,{detail_level:"all",layer_id:$},function(_t){_t=_t.layers;var _e;for(_e=0;_e<_t.length;_e++)if(_t[_e].layerId===$){j.level=_t[_e].level;break}g=e.v().clone().G(Ir+"."+Hr).I({meta:1}),new Sf("cle",{message:[h.uid,0,{tileSize:h.tileSize,projected:!0,onlyOutline:_===4,serverUrl:g.toString(),layerConfigs:[j],batchTiles:!1,horizontalMargin:1}]}).then(function(){h.i=!0,h.Va()},h.Gb)},function(_t){h.Gb(_t.message)})}u(Br,lr),t("H.service.extension.customLocation.TileProvider",Br),Br.prototype.m=function(e,o,s){return new dr(e,o,s)},Br.prototype.B=function(e,o,s,h,d){var g=this,_=this.getTileKey(e,o,s),j;_=this.nb().get(_);var $={cancel:ld},_t=!0,_e=this.f;if(_&&(_e===4||_e===8?_.Ud()||(h(Cp.pop(this.tileSize),null),_t=!1):(h(z),_t=!1)),_t){var _r=Ap.setTimeout(function(){j=new Sf("cle",{message:[g.uid,1,[e,o,s]]}),j.then(h,d)},500);$.cancel=function(){j?j.cancel():Ap.clearTimeout(_r)}}return $},Br.prototype.requestInternal=Br.prototype.B,Br.prototype.o=function(){Br.j.o.call(this),new Sf("cle",{message:[this.uid,3]})};function Jr(){if(Kr)throw new $c(Jr)}t("H.service.extension.customLocation.Table",Jr);var Kr=!0;function Lr(e,o){var s;Kr=!1;var h=new Jr;Kr=!0,h.c=rc(x.JSON.parse(x.JSON.stringify(e))),e=e.columnNames;var d=oc();for(s=e.length;s--;)d[e[s]]=s;if(h.f=d,h.b=e.length,o){if(o.length%e.length)throw new D(Lr,1,"Invalid number of cells")}else o=[];return h.a=o,h}Jr.prototype.Md=function(){return this.c},Jr.prototype.getMeta=Jr.prototype.Md,Jr.prototype.Pd=function(){return this.a.length/this.b},Jr.prototype.getRowCount=Jr.prototype.Pd,Jr.prototype.tc=function(e){return e<this.a.length/this.b?new Mr(this,e):B},Jr.prototype.getRow=Jr.prototype.tc,Jr.prototype.Um=function(){var e=this.a.length/this.b,o,s=new x.Array(e);for(o=0;o<e;o++)s[o]=new Mr(this,o);return s},Jr.prototype.getRows=Jr.prototype.Um,Jr.prototype.Hg=function(e){var o=this.b,s=this.a,h=s.length/this.b;if(!e||e.length%o)throw new D(this.Hg,0,"Invalid number of cells");return this.a=s.concat(e),h},Jr.prototype.addCells=Jr.prototype.Hg,Jr.prototype.ol=function(){for(var e=this.b,o=this.a,s=this.a.length/this.b;e--;)o.push(z);return this.tc(s)},Jr.prototype.addRow=Jr.prototype.ol,Jr.prototype.Ta=function(){return this.c.columnNames},Jr.prototype.getColumnNames=Jr.prototype.Ta,Jr.prototype.Be=function(e){return this.f[e]===B?B:new Nr(this,e)},Jr.prototype.getColumn=Jr.prototype.Be,Jr.prototype.ua=function(e,o){return this.a[e*this.b+this.f[o]]},Jr.prototype.getCell=Jr.prototype.ua,Jr.prototype.Gc=function(e,o,s){if(o=this.f[o],e>=this.a.length/this.b)throw new D(this.Gc,0,"Row index out of bounds");if(o===B)throw new D(this.Gc,0,"Column unknown");this.a[e*this.b+o]=s},Jr.prototype.setCell=Jr.prototype.Gc,Jr.prototype.concat=function(e){var o=arguments.length,s,h=""+this.Ta(),d=this.a?this.a.slice():[];for(s=0;s<o;s++){var g=arguments[s];if(!(g instanceof Jr))throw new D(this.concat,s);if(""+g.Ta()!==h)throw new D(this.concat,s,"Incompatible columns!");g.a&&(d=d.concat(g.a))}return Lr(this.c,d)},Jr.prototype.concat=Jr.prototype.concat;var Or=/(\n|\t|\r|")/;Jr.prototype.Gi=function(e,o){var s,h=this.b,d=this.Ta(),g=[],_=[],j=this.a,$=-1;for(s=0;s<h;s++)(!e||e.test(d[s]))&&(d[s]==="WKT"&&($=g.length),g.push(s));if(!(e=g.length))throw new D(this.Gi,1,"No columns filtered");if(Pr(this,_,d,0,h,g,e,$),o){var _t=o.length;for(s=0;s<_t;s++)_.push(`
`),d=o[s],Pr(this,_,j,d,h,g,e,$)}else for(_t=this.Pd(),d=0;d<_t;d++)_.push(`
`),Pr(this,_,j,d,h,g,e,$);return _.join("")};function Pr(e,o,s,h,d,g,_,j){var $;for($=0;$<_;$++){$&&o.push("	");var _t=s[h*d+g[$]];if($!==j){if(_t!==z){if(_t=String(_t),Or.test(_t))throw new D(e.Gi,0,'Invalid character (\\n, \\r, \\t, or ") in row '+h+" column "+e.c.columnNames[g[$]]);o.push(_t)}}else o.push(_t)}}function Nr(e,o){this.b=e,this.a=o}Jr.Column=Nr,Nr.prototype.ua=function(e){return this.b.ua(e,this.a)},Nr.prototype.getCell=Nr.prototype.ua,Nr.prototype.Gc=function(e,o){this.b.Gc(e,this.a,o)},Nr.prototype.setCell=Nr.prototype.Gc;function Mr(e,o){this.a=e,this.Nh=o}Jr.Row=Mr,Mr.prototype.Ta=function(){return this.a.Ta()},Mr.prototype.getColumnNames=Mr.prototype.Ta,Mr.prototype.ua=function(e){return this.a.ua(this.Nh,e)},Mr.prototype.getCell=Mr.prototype.ua,Mr.prototype.Gc=function(e,o){this.a.Gc(this.Nh,e,o)},Mr.prototype.setCell=Mr.prototype.Gc,Mr.prototype.md=function(){return this.a},Mr.prototype.getTable=Mr.prototype.md;function Qr(e){if(e===B)e="	";else if(!/^[^"\r\n]$/.test(e))throw new D(Qr,0);this.b=String(e).charCodeAt(0),this.Oh=A(this.Oh,this),this.C=Rr}var Rr=0;p=Qr.prototype,p.getState=function(){return this.C};function Sr(e,o,s){var h=e.C;if(h!==o)throw h===1&&(e.C=Rr),new $c(s,"Requires state: "+["READY","PARSE","PAUSE"][o]+" but found "+["READY","PARSE","PAUSE"][h])}p.abort=function(){Sr(this,2,Qr.prototype.abort),this.C=Rr},p.Oh=function(e){throw this.C=Rr,new D(Qr.prototype.parse,0,"Malformed DSV at row "+this.a.l+" column "+this.a.b+": "+e)};function Tr(e,o){var s=[];return e.parse(o,function(h,d,g){return 1>h&&(s[d]=g),0<h}),e.C=Rr,s}p.parse=function(e,o,s){Sr(this,Rr,Qr.prototype.parse),e=e.trim(),this.a=new Ur(e,this.b,this.Oh),this.c=o,this.kk=s||gf,this.C=2,this.Ph()},p.kk=gf,p.Ph=function(){var e=this.a,o=[];Sr(this,2,Qr.prototype.Ph),this.C=1;do{if(!e.g){this.C=Rr;break}if(d>e.b){if(s!==void 0&&s!==d){this.a.a("The number of columns must be the same for all rows");return}var s=d}var h=e.l,d=e.b,g=e.tf,_=this.kk(h,d,e);if(e.tf>g)for(;e.next()!==-1;);else{for(;(g=e.next())!==-1;)o.push(g);_=String.fromCharCode.apply(z,o),o.length=0}Vr(e),this.c(h,d,_)&&(this.C=e.g?2:Rr)}while(this.C===1);this.C!=2&&s!==void 0&&0<d&&s!==d&&this.a.a("The number of columns must be the same for all rows")};function Ur(e,o,s){this.c=new qo(e),this.s=o,this.g=!0,this.tf=this.l=this.b=0,Vr(this),this.a=s,this.f=[],this.i=!1}p=Ur.prototype,p.tf=0;function Vr(e){var o=e.c.Pb();e.m=!1,(e.U=o===34)&&e.c.next()}function Wr(e,o){var s=e.c;switch(e.m=!0,o){case e.s:e.b++;break;case 13:s.next(),s.Pb()!==10&&e.a("CR without LF");case 10:e.b=0,e.l++;break;case-1:e.g=!1;break;default:e.a("End of field expected")}return s.next(),-1}p.Pb=function(){if(this.m)var e=-1;else{var o=this.c;if(e=o.Pb(),this.U)switch(e){case 34:o.next(),e=o.Pb(),e!==34&&(e=Wr(this,e));break;case-1:this.a("Closing quotation mark expected")}else switch(e){case 34:this.a("Unexpected quotation mark");case this.s:case 13:case 10:case-1:e=Wr(this,e)}}return e},p.ge=function(){this.i=!0,this.f=[]},p.Gd=function(){var e=this.f.slice();return this.i=!1,this.f=[],e},p.next=function(){var e=this.Pb();return e!==-1&&this.c.next(),this.i&&this.f.push(e),this.tf++,e};function Xr(e,o,s,h){if(h=h||{},!o)throw new D(Xr,1,"has to be a function");if(!s)throw new D(Xr,2,"has to be a function");for(this.s=o,this.u=s,this.a=[],this.g={},this.f=[],this.b={},this.i={},this.l={},this.m={},this.U=h.duration||100,this.c=A(this.c,this),e=e.split("Meta:	").slice(1),o=0;o<e.length;o++){h=e[o].split(`
`),s=h[0].split("	")[0],h=h.slice(1).join(`
`),this.b[s]=new Qr,this.g[s]=Tr(this.b[s],h);var d={layerId:s,columnNames:this.g[s]};this.f.push(s),this.m[s]=Lr(d),this.i[s]=Lk(),Yr(this,h,s),this.c(s)}}function Yr(e,o,s){var h=[],d=e.g[s].length-1,g=e.m[s];try{e.b[s].parse(o,function(_,j,$){var _t=!1;return 0<_&&(h[j]=$,j===d&&(e.a.push(g.tc(g.Hg(h))),Lk()-e.i[s]>e.U&&(_t=!0))),_t},function(_,j,$){if(0<_&&j===d)return Wn($)})}catch(_){e.u(_)}}Xr.prototype.cancel=function(){for(var e in this.l)x.clearTimeout(this.l[e])},Xr.prototype.cancel=Xr.prototype.cancel,Xr.prototype.c=function(e){var o=this,s,h;this.l[e]=x.setTimeout(function(){if(o.b[e].getState()===2)o.i[e]=Lk(),o.s(o.a,!1),o.a=[],o.b[e].Ph(),o.c(e);else{for(s=!0,h=0;h<o.f.length;h++)if(o.b[o.f[h]].getState()!==Rr){s=!1;break}s&&(0<o.a.length&&o.s(o.a,!0),o.a=[])}},0)};function Fr(e){Fr.j.constructor.call(this,Fr,e),zp(Fr)}u(Fr,Op),t("H.service.extension.customLocation.Service",Fr),Fr.prototype.Aa=function(){return{subDomain:"fleet.ls",path:"2"}},Fr.CONFIG_KEY="customLocation",Fr.prototype.nc=function(e,o){var s=o&&o.resultType;e=new Br(this,e,o);var h;return s===1||s===2?h=new Sn(e):h=new sl(e),h},Fr.prototype.createTileLayer=Fr.prototype.nc;function Zr(e,o,s,h){var d;e=e===$r?"changes":"file";var g=o[e],_=Cc(g),j=!_&&C(g,Blob);if(!_&&!j)throw new D(h,0,"Invalid "+e+" parameter");if(as)j?d=g:d=pf(g,"text/plain"),h=new x.FormData,h.append(e,d,d.name||e+".wkt"),s.method="POST",s.data=h,delete o[e];else if(j)throw new D(h,0,"Sending Blob data is not supported by the browser")}var as=x.FormData&&!!x.FormData.prototype.append;Fr.prototype.request=function(e,o,s,h,d){return bs(this,e,o,s,h,d)},Fr.prototype.request=Fr.prototype.request;function bs(e,o,s,h,d,g){var _="text/plain",j=o===cs.LAYERS_UPLOAD||o===cs.LAYERS_MODIFY||o===cs.LAYERS_IMPORT,$=h,_t={data:B,method:"GET",headers:e.g};if(!o)throw new D(e.request,0,o);if(!s)throw new D(e.request,1,s);cr(e.request,3,d,g),j&&(C(h,Object,e.request,2,"Invalid request parameters"),$=Wa(h),Zr(o,$,_t,e.request));var _e=e.v().clone().G(o+"."+s).I($);return s===ds.JSON&&(_="application/json"),e=new tf(_,_e.toString(),je,_t),e.then(function(_r){var _n=_r.issues;_n&&_r.error_id&&_r.response_code?g(Error(_n[0].message)):d(_r)},function(_r){_r.type==="error"||_r.status===404?g(Error(_r.statusText||"Unable to load data")):_r.json().then(function(_n){g(Error("["+_n.issues[0].message+"] "+_e+" request failed"))},function(){g(Error("["+_r.statusText+"] "+_e+" request failed"))})}),e}var Gr="layers/list",$r="layers/modify",Ir="tiled/tile",cs={LAYERS_DELETE:"layers/delete",LAYERS_GRANT:"layers/access/grant",LAYERS_LIST:Gr,LAYERS_MODIFY:$r,LAYERS_UPLOAD:"layers/upload",LAYERS_IMPORT:"layers/import",SEARCH_ALL:"search/all",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SEARCH_TILE:Ir};Fr.EntryPoint=cs;var Hr="json",ds={TXT:"txt",JSON:Hr};Fr.EntryPointType=ds,Fr.prototype.ob=function(e,o,s){var h=this;return this.request("search/all","txt",{filter:'WKT==""',layer_id:e},function(d){var g=String(d).replace(/[\r\n]+$/g,"").split("	");h.request(Gr,Hr,{layer_id:e,detail_level:"all"},function(_){_=_.layers[0],_.columnNames=g,o(Lr(_))},s)},s)},Fr.prototype.getLayer=Fr.prototype.ob,Fr.prototype.Kj=function(e,o,s,h){function d(){return++_<g?j.request("layers/access/grant",Hr,{layer_id:e,granted_app_id:o[_].grantedAppId,permissions:o[_].permissions.join(",")},d,h):j.ob(e,s,h)}var g=o&&o.length,_=-1,j=this;return d()},Fr.prototype.grantAccess=Fr.prototype.Kj,Fr.prototype.jj=function(e,o,s){return this.request("layers/delete",Hr,{layer_ids:e},o,s)},Fr.prototype.deleteLayer=Fr.prototype.jj,Fr.prototype.$b=function(e,o,s){function h(){setTimeout(function(){$.ob(_,function(_n){setTimeout(d.bind(null,_n),_e)},function(){64e3>_t?(_t+=_e,h()):s(x.Error("Timeout"))})},_e),_e*=2}function d(_n){var _o=JSON.stringify(_n.Ta()),ga=e.grants;if(_o!==JSON.stringify(j)){var _l="Results into different column names on the backend: "+_o;setTimeout(function(){$.jj(_,function(){s(x.Error(_l))},function(_f){s(x.Error(_l+". "+_f.message))})},_e)}else ga&&ga.length?$.Kj(_,ga,o,s):o(_n)}var g,_,j,$=this,_t=0,_e=1e3,_r=!e||!Cr(_=e.layerId)&&(g="layerId")||!Dr(j=e.columnNames)&&(g="columnNames")?0:Da(o)?Da(s)?-1:2:1;if(0<=_r)throw new D($.$b,_r,g||arguments[_r]);return $.ob(_,function(){s(x.Error("Layer exists already"))},function(){var _n={layer_id:_,file:j.join("	")},_o=e.level,ga=e.storage;_o!==B&&(_n.level=_o),ga!==B&&(_n.storage=ga),$.request("layers/upload",Hr,_n,h,s)})},Fr.prototype.createLayer=Fr.prototype.$b;function es(e,o,s,h,d){var g=[],_;return e=e.request(o,Hr,s,function(j){j.geometries.length?(j=Er(j,s.layer_id),_=new Xr(j,h,d),g.push(_)):h(hf,!0)},d),g.push(e),new vr(g)}Fr.prototype.Ub=function(e,o,s,h,d,g){if(!Bc(e))throw new D(this.Ub,0,"has invalid type");if(C(o,kg,this.Ub,1,"has invalid type"),!Fc(s))throw new D(this.Ub,2,"has invalid type");return cr(this.Ub,3,h,d),e={layer_ids:e.join(","),proximity:o.lat+","+o.lng+","+s},g&&Ya(e,g),es(this,"search/proximity",e,h,d)},Fr.prototype.searchByProximity=Fr.prototype.Ub,Fr.prototype.Tb=function(e,o,s,h,d,g){var _="";if(!Bc(e))throw new D(this.Tb,0,"has invalid type");if(!Cc(o)&&!C(o,L))throw new D(this.Tb,1,"has invalid type");if(!Fc(s))throw new D(this.Tb,2,"has invalid type");if(cr(this.Tb,3,h,d),e={layer_ids:e.join(","),radius:s},Cc(o))e.route_id=o;else{var j=o.$;for(o=0,s=j.length;o<s;o+=3)_+=j[o]+","+j[o+1],o<s-3&&(_+=",");e.corridor=_}return g&&Ya(e,g),es(this,"search/corridor",e,h,d)},Fr.prototype.searchByCorridor=Fr.prototype.Tb,Fr.prototype.Fc=function(e,o,s,h,d){function g($,_t){_t&&j--,s($,!j)}var _=[],j;if(!Bc(e))throw new D(this.Fc,0,"has invalid type");for(C(o,K,this.Fc,1,"has invalid type"),cr(this.Fc,2,s,h),o={bbox:o.c+","+o.a+";"+o.f+","+o.b},d&&Ya(o,d),e=o.layer_id?[o.layer_id]:e,d=0,j=e.length;d<j;d++)o.layer_id=e[d],_.push(es(this,"search/bbox",o,g,h));return new vr(_)},Fr.prototype.searchByBoundingBox=Fr.prototype.Fc,Fr.prototype.li=function(e,o,s,h){var d,g=[];if(!Cc(e))throw new D(this.li,0,"has invalid type");cr(this.li,1,o,s);var _={layer_id:e};return h&&Ya(_,h),h=this.request("search/all",Hr,_,function(j){j.geometries.length?(j=Er(j,e),d=new Xr(j,o,s),g.push(d)):o(hf,!0)},s),g.push(h),new vr(g)},Fr.prototype.searchAll=Fr.prototype.li;var fs={delete:/^GEOMETRY_ID$/,append:/^(?!GEOMETRY_ID$)/};function gs(e,o,s,h,d,g){function _(){ga++,h(this,ga===_n)}function j(_g){ga++,d(_g,this,ga===_n)}var $=o!=="append",_t,_e={},_r=oc(),_n=0,_o=[],ga=0;if(!Bc(s))throw new D(g,0,s);for(cr(g,1,h,d),_t=s.length;_t--;){var _l=s[_t];if(C(_l,Mr)){var _f=_l.md().Md().layerId,_c=_l.ua("GEOMETRY_ID");if($){if(_c===z||String(_c)==="")var _p='GEOMETRY_ID must not be null or ""';_e[_c=_f+"_"+_c]&&(_p="same GEOMETRY_ID for multiple rows"),_e[_c]=_l}else _c!==z&&String(_c)!==""&&(_p='GEOMETRY_ID must be null or ""')}else _p="Invalid type";if(_p)throw new D(g,0,"- Invalid row at index "+_t+", "+_p);_c=_r[_f],_c||(_c=_r[_f]=[],_n++),_c.push(_l)}for(_f in _r){for(_c=_r[_f],s=[],_t=_c.length;_t--;)s.push(_c[_t].Nh);_o.push(e.request($r,Hr,{layer_id:_f,action:o,changes:_c[0].md().Gi(fs[o]||null,s)},A(_,_c),A(j,_c)))}return new vr(_o)}Fr.prototype.$i=function(e,o,s){return gs(this,"append",e,o,s,this.$i)},Fr.prototype.appendRows=Fr.prototype.$i,Fr.prototype.il=function(e,o,s){return gs(this,"update",e,o,s,this.il)},Fr.prototype.updateRows=Fr.prototype.il,Fr.prototype.kj=function(e,o,s){return gs(this,"delete",e,o,s,this.kj)},Fr.prototype.deleteRows=Fr.prototype.kj,X.prototype.Yl=function(e){return this.Ma(Fr,e)},X.prototype.getCustomLocationService=X.prototype.Yl;function hs(e){jq.j.constructor.call(this,hs,e),zp(hs)}u(hs,Op),t("H.service.extension.customRoute.Service",hs),hs.prototype.Aa=function(){return{subDomain:"s.fleet.ls",path:"2"}},hs.CONFIG_KEY="customRoute",hs.prototype.a=function(e){return Error(e.issues&&e.issues.length?e.issues.map(function(o){return o.message}).join(". "):e)},hs.prototype.Cd=function(e,o,s){return cr(this.Cd,1,o,s),e=this.v().clone().G("calculateroute.json").I(e),this.B(e,o,s)},hs.prototype.calculateRoute=hs.prototype.Cd,X.prototype.Zl=function(e){return this.Ma(hs,e)},X.prototype.getCustomRoutingService=X.prototype.Zl;function is(e,o,s){s=s||{};var h=+s.min,d=+s.max;s.min=h?ae(h,1,17):1,s.max=d?ae(d,1,17):17,is.j.constructor.call(this,s),C(e,js,is,0),C(o,Wh,is,1),this.f=e,o.a&&o.a("OMV"),this.Qa(o,!0),this.i=xp(this)}u(is,S),t("H.service.trafficVectorTile.Provider",is),is.prototype.Sb=ff,is.prototype.providesOMV=is.prototype.Sb,is.prototype.ub=function(e){return this.i.test(e)},is.prototype.cacheFilter=is.prototype.ub,is.prototype.uc=function(e,o,s){return ks(this.f,e,o,s).toString()},is.prototype.getTileKey=is.prototype.uc,is.prototype.nb=function(){return this.m},is.prototype.getCache=is.prototype.nb,is.prototype.MAX_STORE_TIME=2592e6,is.prototype.l=function(){return od()},is.prototype.c=function(){return od()?nd():is.j.c.call(this)},is.prototype.s=function(){return this.f},is.prototype.B=function(e,o,s,h,d){return this.f.Ha(e,o,s,h,d)},is.prototype.requestInternal=is.prototype.B,is.prototype.gb=function(e){e.a&&e.a("OMV"),this.Qa(e)},is.prototype.setStyle=is.prototype.gb,is.prototype.V=function(){return is.j.Ya.apply(this)},is.prototype.getStyle=is.prototype.V,is.prototype.m=new Rk(256),is.prototype.ba=function(){return null},is.prototype.getCopyrights=is.prototype.ba;function js(e){js.j.constructor.call(this,js,e),this.b=(e||jf).layer||"traffic"}u(js,Op),t("H.service.trafficVectorTile.Service",js),js.prototype.Aa=function(){return{subDomain:"traffic.vector",path:"v2"}},js.CONFIG_KEY="trafficVectorTile",js.prototype.$b=function(e,o,s){o=o||{};var h={min:0,max:22};return Ea(s)&&yp(h,s),new sl(new is(this,e,o),h)},js.prototype.createLayer=js.prototype.$b,js.prototype.Ha=function(e,o,s,h,d){return this.B(ks(this,e,o,s),function(g){return g.arrayBuffer().then(h,d)},d,"arraybuffer")};function ks(e,o,s,h){return e.v().clone().G("traffictiles/"+e.b+"/mc/"+h+"/"+o+"/"+s+"/omv")}js.prototype.f=function(e){return Ao()+"/"+e},js.prototype.vm=function(){return this.b},js.prototype.getLayerName=js.prototype.vm,X.prototype.oh=function(e){return this.Ma(js,e)},X.prototype.getTrafficVectorTileService=X.prototype.oh;function ls(e){ls.j.constructor.call(this,ls,e)}u(ls,Op),t("H.service.SearchService",ls),ls.CONFIG_KEY="search",ls.prototype.Aa=function(){return{subDomain:"search",path:"v1"}},ls.prototype.a=function(e){return e=[e.title,e.action,e.cause].filter(function(o){return o}),Error(e.join(". "))},ls.prototype.Zg=function(e,o,s){return e=this.v().clone().Ba("geocode").G("geocode").I(e),this.B(e,o,s)},ls.prototype.geocode=ls.prototype.Zg,ls.prototype.ii=function(e,o,s){return e=this.v().clone().Ba("revgeocode").G("revgeocode").I(e),this.B(e,o,s)},ls.prototype.reverseGeocode=ls.prototype.ii,ls.prototype.sl=function(e,o,s){return e=this.v().clone().Ba("autosuggest").G("autosuggest").I(e),this.B(e,o,s)},ls.prototype.autosuggest=ls.prototype.sl,ls.prototype.zl=function(e,o,s){return e=this.v().clone().Ba("discover").G("discover").I(e),this.B(e,o,s)},ls.prototype.discover=ls.prototype.zl,ls.prototype.Gn=function(e,o,s){return e=this.v().clone().Ba("lookup").G("lookup").I(e),this.B(e,o,s)},ls.prototype.lookup=ls.prototype.Gn,ls.prototype.ul=function(e,o,s){return e=this.v().clone().Ba("browse").G("browse").I(e),this.B(e,o,s)},ls.prototype.browse=ls.prototype.ul,X.prototype.Wm=function(e){return this.Ma(ls,e)},X.prototype.getSearchService=X.prototype.Wm;function ms(e){if(this.c=!!e.toBypassToken,!this.c&&!e.token)throw new D(ms,0,'"token" must be specified');zp(ms,"Use HERE IML service instead."),ms.j.constructor.call(this,ms,e),this.l=e.token,this.f={},this.b={}}u(ms,Op),t("H.service.xyz.Service",ms),ms.prototype.Aa=function(){return{host:"xyz.api.here.com",path:"hub/spaces"}},ms.prototype.a=function(e){return Error(e.errorMessage||e.message)},ms.prototype.jh=function(e,o,s){return zc(e,"String",this.jh,0,'"projectId" must be a string'),ns(this.jh,1,o,s),e=os(this.v().clone().wd("project-api/projects/"+e)),this.B(e,o,s)},ms.prototype.getProject=ms.prototype.jh,ms.prototype.Gj=function(e,o,s){return ns(this.Gj,0,e,o),s=ps(this,this.v().clone().I(s||{})),this.B(s,e,o)},ms.prototype.getSpaces=ms.prototype.Gj,ms.prototype.Kf=function(e,o,s){return zc(e,"String",this.Kf,0,'"spaceId" must be a string'),ns(this.Kf,1,o,s),e=ps(this,this.v().clone().G(e)),this.B(e,o,s)},ms.prototype.getSpace=ms.prototype.Kf,ms.prototype.Qd=function(e,o,s){return zc(e,"String",this.Qd,0,'"spaceId" must be a string'),ns(this.Qd,1,o,s),e=ps(this,this.v().clone().G(e+"/statistics")),this.B(e,o,s)},ms.prototype.getStatistics=ms.prototype.Qd,ms.prototype.Ff=function(e,o,s,h,d,g,_){return e=ps(this,this.v().clone().G(h+"/tile/web/"+s+"_"+e+"_"+o+".mvtf").I(Object.assign({clip:!0},_))),this.B(e,function(j){return j.arrayBuffer().then(d)},g,"arraybuffer")},ms.prototype.search=function(e,o,s,h){return zc(e,"String",this.search,0,'"spaceId" must be a string'),ns(this.search,1,o,s),e=ps(this,this.v().clone().G(e+"/search").I(h||{})),this.B(e,o,s)},ms.prototype.search=ms.prototype.search,ms.prototype.Sc=function(e,o,s,h){if(zc(e,"String",this.Sc,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.Sc,1,'"params" must be an object');return ns(this.Sc,2,s,h),e=ps(this,this.v().clone().G(e+"/features").I(o)),this.B(e,s,h)},ms.prototype.getFeaturesById=ms.prototype.Sc,ms.prototype.Jd=function(e,o,s,h){if(zc(e,"String",this.Jd,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.Sc,1,'"params" must be an object');return ns(this.Jd,2,s,h),e=ps(this,this.v().clone().G(e+"/bbox").I(o)),this.B(e,s,h)},ms.prototype.getFeaturesByBoundingBox=ms.prototype.Jd,ms.prototype.ba=function(e){var o=this.f[e];return o||(this.b[e]||qs(this,e),null)},ms.prototype.$c=function(e,o,s,h,d){if(zc(e,"String",this.$c,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.$c,1,'"geojsonObject" must be an object');if(ns(this.$c,2,s,h),d&&!Ea(d))throw new D(this.$c,4,'"opt_params" must be an object');return rs(this,e,s,h,"PUT",o,d)},ms.prototype.putFeatures=ms.prototype.$c,ms.prototype.Yc=function(e,o,s,h,d){if(zc(e,"String",this.Yc,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.Yc,1,'"featureCollection" must be an object');if(ns(this.Yc,2,s,h),d&&!Ea(d))throw new D(this.Yc,4,'"opt_params" must be an object');return rs(this,e,s,h,"POST",o,d)},ms.prototype.postFeatures=ms.prototype.Yc,ms.prototype.hd=function(e,o,s,h){if(zc(e,"String",this.hd,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.hd,1,'"params" must be an object');return ns(this.hd,2,s,h),rs(this,e,s,h,"DELETE",B,o)},ms.prototype.deleteFeatures=ms.prototype.hd;function rs(e,o,s,h,d,g,_){var j=Object.assign(e.c?{}:{authorization:"Bearer "+e.l},{"Content-Type":"application/geo+json"},e.g);return d={method:d,headers:j},g&&(d.data=JSON.stringify(g)),o=os(e.v().clone().G(o+"/features").I(_||{})),g=new tf("application/json",o.toString(),je,d),g.then(s,Qp(e,o,h)),g}function qs(e,o){e.b[o]=ss,e.Kf(o,function(s){e.b[o]=ts,e.f[o]=s.copyright,e.dispatchEvent("copyrightupdate")},function(s){throw e.b[o]=us,s})}function ps(e,o){return e.c?o:os(o).I({access_token:e.l})}function os(e){var o=Object.assign({},e.getQuery());return delete o.apikey,e.bf(o)}ms.CONFIG_KEY="xyz";var ss=1,ts=2,us=-1;function ns(e,o,s,h){if(!Da(s))throw new D(e,o,'"onResult" must be a function');if(!Da(h))throw new D(e,o+1,'"onError" must be a function')}X.prototype.jn=function(e){return this.Ma(ms,e)},X.prototype.getXYZService=X.prototype.jn;function vs(e,o,s){var h;if(vs.j.constructor.call(this,s?{min:s.min,max:s.max,engineType:s.engineType}:void 0),C(e,ms,vs,0),!Cc(o))throw new D(vs,1,'"spaceId" must be a string');if(this.m=e,this.f=o,this.i={},s&&(["limit","simplificationLevel","tags"].forEach(function(d){d in s&&(this.i[d]=s[d])},this),e=s.parameters))for(h in e)this.i[h]=e[h];this.Qa(this.b===kk.WEBGL?new ti({sources:{xyz:{type:"MVT"}},layers:{xyz:{data:{source:"xyz",layer:this.f},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#000000",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.f,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.f,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.f,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.f,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#000000",lineWidth:"2px",renderOrder:203}]}))}u(vs,S),t("H.service.xyz.Provider",vs),vs.prototype.B=function(e,o,s,h,d){return this.m.Ff(e,o,s,this.f,h,d,this.i)},vs.prototype.requestInternal=vs.prototype.B,vs.prototype.ba=function(){return this.m.ba(this.f)},vs.prototype.getCopyrights=vs.prototype.ba,vs.prototype.Sb=ff,vs.prototype.providesOMV=vs.prototype.Sb,vs.prototype.V=function(){return this.Ya()},vs.prototype.getStyle=vs.prototype.V,vs.prototype.gb=function(e){C(e,ti)&&e.a("MVT"),this.Qa(e)},vs.prototype.setStyle=vs.prototype.gb,t("H.service.buildInfo",function(){return Hf("H-service","1.49.1","74e5afb",{region:"row"})});function ws(e,o,s,h,d){d&1&&xs(e,e,o,s,h,0),d&2&&xs(e,e,o,s,h,1),d&4&&xs(e,e,o,s,h,2),d&8&&xs(e,e,o,s,h,3)}function xs(e,o,s,h,d,g){for(var _=(s+1)*(s+1),j,$=4*h,_t=s+1,_e,_r=[{r:0,Hl:0,tl:0,Fg:0,next:null}],_n=1,_o=["r","g","b","a"][g],ga=2*s+1,_l,_f;_n<ga;_n++)_r[_n]={r:0,Hl:0,tl:0,Fg:0,next:null},_r[_n-1].next=_r[_n];_r[2*s].next=_r[0];var _c=4*(h-1);for(j=0;j<d;j++){var _p=j*$,_g=e[_p+g],ty=_g*_t*(s+2)/2;for(ga=_g*_t,_n=0;_n<=s;_n++)_r[_n][_o]=_g;var oy=0;for(_n=1;_n<=s;_n++){var ry=_n<h?_p+4*_n:_p+_c;ry=e[ry+g],ty+=ry*(_t-_n),oy+=ry,_r[s+_n][_o]=ry}ry=_r[0],_l=_r[_t],_n=_p,_f=4*_t;var ly=_p+_c;for(_g=0;_g<h;_g++){o[_n+g]=ty/_,ty-=ga;var py=_g+_t<h?_n+_f:ly;if(py=e[py+g],oy+=py,ty+=oy,ga-=ry[_o],ga+=_l[_o],oy-=_l[_o],ry[_o]=py,ry=ry.next,_l=_l.next,_n+=4,!ty)for(;(_e=4*(_g+_t))<$&&e[_p+g+_e]===0;)_g++,_n+=4}}for(_p=(d-1)*$,_g=0;_g<h;_g++){for(e=4*_g,j=o[e+g],ty=j*_t*(s+2)/2,ga=j*_t,_n=0;_n<=s;_n++)_r[_n][_o]=j;for(oy=0,_n=1;_n<=s;_n++)ry=_n<d?e+_n*$:e+_p,ry=o[ry+g],ty+=ry*(s-_n+1),oy+=ry,_r[s+_n][_o]=ry;for(ry=_r[0],_l=_r[_t],_n=e,ly=_t*$,_c=e+_p,j=0;j<d;j++)if(o[_n+g]=ty/_,ty-=ga,py=j+_t<d?_n+ly:_c,py=o[py+g],oy+=py,ty+=oy,ga-=ry[_o],ga+=_l[_o],oy-=_l[_o],ry[_o]=py,ry=ry.next,_l=_l.next,_n+=$,!ty)for(;(_e=j+_t)<d&&o[_e*$+g+e]===0;)j++,_n+=$}}function ys(e,o,s){this.f=o=e>>o,this.l=Math.log(o)*Math.LOG2E,this.i=e=document.createElement("CANVAS"),this.a=e.getContext("2d"),this.b=e.width=e.height=3*o;var h=document.createElement("canvas");e=s.a;var d=s.b;o=[];var g;h.width=256,h.height=1,h=h.getContext("2d");for(_ in d)d.hasOwnProperty(_)&&o.push({stop:parseFloat(_),value:d[_]});d=o.length,o.sort(this.s),0<o[0].stop&&o.unshift({stop:0,value:o[0].value}),1>o[d-1].stop&&o.push({stop:1,value:o[d-1].value}),d=o.length;var _=h.createLinearGradient(0,0,256,0);for(g=0;g<d;g++){if(!e&&$){var j=$.stop+(o[g].stop-$.stop)/2;_.addColorStop(j,$.value),_.addColorStop(j,o[g].value)}_.addColorStop(o[g].stop,o[g].value);var $=o[g]}h.fillStyle=_,h.fillRect(0,0,256,1),this.c=h.getImageData(0,0,256,1).data,this.g=s.a}ys.prototype.s=function(e,o){return e.stop-o.stop};function zs(e,o){this.a=e,this.size=o}function As(e,o){var s,h=0;if(!Ea(e)||Va(e))throw new D(As,0,e);for(s in e){var d=+s;if(h++,!(Fc(d)&&0<=d&&1>=d&&Cc(e[s])))throw new D(As,0,e)}if(2>h)throw new D(As,0,"Specify at least 2 stops");this.b=e,this.a=!!o}t("H.data.heatmap.Colors",As);var Bs=new As({0:"#008","0.2":"#0b0","0.5":"#ff0","0.7":"#f00"},!0);As.DEFAULT=Bs;function Cs(e,o,s){this.a=e=ae(e,0,30),this.u=o,this.i=s,this.s=[],this.b=[];do this.b[e]=[],this.s[e]=new Ds;while(e--);o===Es?(this.m=Fs,this.l=Gs):(this.m=Hs,this.l=Is),this.c=1/0,this.f=-1/0}var Js=Math.log(.5);function Gs(e){return this.g?Math.round((e-this.c)/this.g*255):127}function Is(e){return this.U===void 0?127:Math.round(255*Math.pow(e,this.U))}Cs.prototype.Db=function(e){var o,s,h=e.value;h===void 0&&(h=1),h>this.f&&(this.f=h,this.g=this.f-this.c),h<this.c&&(this.c=h,this.g=this.f-this.c);var d=mj.Pc(e).scale(1073741823).floor();h=this.a;var g=d.x>>30-h;for(d=d.y>>30-h,s=this.m;-1<h;){this.b[h][d]||(this.b[h][d]=[]),(o=this.b[h][d][g])||(o=this.b[h][d][g]=new s(g,d,h)),o.Db(e,h);var _=this.s[h];_.f>o.b&&(_.f=o.b),_.a<o.b&&(_.a=o.b),_.c>o.a&&(_.c=o.a),_.b<o.a&&(_.b=o.a),h--,g>>=1,d>>=1}};function Ks(e,o,s,h,d){var g=1<<o,_,j;return h=$d(h,g),g=0<=s&&s<g&&(_=e.b[o])&&(j=_[s])&&(g=j[h])||null,!g&&d&&0<=o&&(g=Ks(e,o-1,s>>1,h>>1,d)),g}function Ls(e,o,s,h,d,g){for(var _,j=[];s<=h;s++)for(_=d;_<=g;_++)j.push(Ks(e,o,s,_,!1));return j}function Ms(e,o){var s=0,h=0,d=Ks(e,0,0,0,!1),g;return o.f||(o.z===e.a?o.c=o.a:(Ns(e,o,function(_){var j=Os(e,_),$=4-j.length;if(_.z!==e.a){for(g=0;g<j.length;g++)s+=j[g].a,h++;s+=$*d.a,h+=$}}),o.c=s/h),o.f=!0),o.c}function Ns(e,o,s){o=[o];for(var h,d;0<o.length;)d=o.shift(),h=Os(e,d),s(d),o.push.apply(o,h)}function Os(e,o){var s=[],h,d,g;for(d=0;1>=d;d++)for(g=0;1>=g;g++)(h=Ks(e,o.z+1,2*o.x+d,2*o.y+g,!1))&&s.push(h);return s}Cs.prototype.clear=function(){Cs.call(this,this.a,this.u,this.i)};function Hs(e,o,s){this.x=e,this.y=o,this.z=s,this.a=this.b=this.g=0,this.f=!1,this.c=0}Hs.prototype.Db=function(e,o){this.g++,this.b+=e.value||1,this.a=this.b/Math.pow(2,2*(30-o))};function Fs(e,o,s){this.x=e,this.y=o,this.z=s,this.a=this.b=this.g=0,this.f=!1,this.c=0}Fs.prototype.Db=function(e){e=e.value,this.b+=e!==void 0?e:1,this.a=this.b/++this.g,this.f=!1};function Ds(){this.f=this.c=1/0,this.a=this.b=-1/0}function Ps(e){var o=e||{},s=+o.sampleDepth,h=o.pointSize;e=+o.coarseness;var d=o.colors,g={min:o.min,max:o.max,engineType:o.engineType},_=o.tileSize,j=+o.dataMax;if(o.tileSize&&(g.tileSize=_),S.call(this,g),lk(this,o.opacity),this.i=o.type==="value"?Es:Qs,this.sampleDepth_=Fc(s)?ae(Math.round(s),1,8):4,this.L=this.i===Qs?Fc(h)?ae(Math.round(7-h),0,6):2:1,this.D=!!o.assumeValues,o=this.max,this.T=Fc(j)?ae(Math.round(j),this.min,o+this.sampleDepth_):o,e=Fc(e)?ae(Math.round(e),0,3):1,d&&!C(d,As))throw new D(Ps,0,"colors");this.f=new Cs(o+this.sampleDepth_+this.L,this.i,this.T),this.aa=new ys(this.tileSize,e,d||Bs),this.u=A(this.u,this),this.m=A(this.m,this),this.R=new Mk(20,this.u)}u(Ps,S),t("H.data.heatmap.Provider",Ps),Ps.prototype.ic=function(e){lk(this,e)},Ps.prototype.setOpacity=Ps.prototype.ic,Ps.prototype.Tc=function(){return this.g},Ps.prototype.getOpacity=Ps.prototype.Tc,Ps.prototype.Ve=ff,Ps.prototype.providesRasters=Ps.prototype.Ve,Ps.prototype.B=function(e,o,s,h,d){var g=this.D,_,j;if(Ks(this.f,0,0,0,!1)){if(!g){var $=Ls(this.f,s,o-1,o+1,e-1,e+1);for(_=$.length;_--&&!g;)if($[_]!==null){g=!0;break}}g&&(j=this.R.push([e,o,s,h,d],this.m))}return g||h(null),j||Hl},Ps.prototype.requestInternal=Ps.prototype.B;function Rs(e,o,s,h){var d=document.createElement("canvas"),g=e.tileSize,_=d.getContext("2d");d.width=d.height=g;var j=e.aa,$=e.f,_t=e.D,_e=e.i,_r=e.L,_n=j.f,_o=j.a,ga,_l,_f=_e===Qs?_r===void 0?2:_r:1;_r=_f,e=Math.min(e.sampleDepth_+_f,j.l),_f=j.b;var _c=$.a;if(_t&&_e===Es){for(_l=-1;1>=_l;_l++)for(_t=-1;1>=_t;_t++){var _p=(_p=Ks($,h,s+_l,o+_t,!0))?$.l(Ms($,_p)):128;_o.fillStyle="rgba("+_p+",128,0,1)",_o.fillRect((_t+1)*_n,(_l+1)*_n,_n,_n)}_t=_n-Math.floor(_n/10),_l=3,_p=_o.getImageData(0,0,_f,_f),ws(_p.data,_t,_f,_f,_l),_o.putImageData(_p,0,0)}else _o.fillStyle=_t?"#080":"#000",_o.fillRect(0,0,_f,_f);for(;_r<=e&&h+_r<=_c;_r++){_t=_n>>_r,_l=_n-_t;var _g=_e===Qs?127+Math.floor(128/(1<<e-_r)):255;_p=(1<<_r)+2;var ty=1<<_r,oy=o<<_r,ry=s<<_r;for(ty=Ls($,h+_r,ry-1,ry+ty,oy-1,oy+ty),oy=ty.length;oy--;){ry=oy%_p;var ly=oy/_p<<0;(ga=ty[oy])&&(ga=$.l(ga.a),_o.fillStyle="rgba("+ga+","+_g+",0,1)",_o.fillRect(ry*_t+_l,ly*_t+_l,_t,_t))}_p=_o,_g=_t,ty=_l,oy=_n+2*_t,_t=_n+2*_t,ry=ry=3,ly=_o.getImageData(ty,_l,oy,_t),ws(ly.data,_g,oy,_t,ry),_p.putImageData(ly,ty,_l)}for(o=_o.getImageData(0,0,_f,_f),s=j.c,h=j.g,$=o.data,e=0,_f=$.length;e<_f;e+=4)_e=$[e],_r=$[e+1],s.length===4&&(_e=0),$[e]=s[4*_e],$[e+1]=s[4*_e+1],$[e+2]=s[4*_e+2],$[e+3]=s[4*_e+3]*(h?_r/255:10>_r?0:1);return _o.putImageData(o,0,0),j=new zs(j.i,_n),_n=j.size,_.drawImage(j.a,_n,_n,_n,_n,0,0,g,g),d}Ps.prototype.u=function(e,o){e.done(Rs(this,o[0],o[1],o[2]))},Ps.prototype.m=function(e,o,s){var h=e.data;e=h[3],h=h[4],s?h():e(o)},Ps.prototype.Zi=function(e,o){var s;if(!Bc(e))throw new D(this.Zi,0,e);if(s=e.length){for(;s--;)this.f.Db(e[s]);e=this.f;var h;s=e.s;var d=e.a,g=0;if(e.u===Qs){var _=s[e.a].a;for(h=e.a;0<=h&&s[h].a===_;h--)g=h;for(_=s[0].a,h=0;h<=g&&_===s[h].a;h++)d=h;g>e.i&&(g=e.i),_=Math.round(d+(g-d)/2),e.U=Js/Math.log(s[_].b)}this.reload(!!o)}},Ps.prototype.addData=Ps.prototype.Zi,Ps.prototype.clear=function(){this.f.clear(),this.reload(!0)},Ps.prototype.clear=Ps.prototype.clear;var Qs=0,Es=1;function Ss(){}t("H.data.utils.Dom",Ss),Ss.prototype.Hd=function(e){return!!e&&/^\s*(1|true)\s*$/i.test(this.Na(e))},Ss.prototype.getBoolean=Ss.prototype.Hd,Ss.prototype.Na=function(e){var o;try{if(e.nodeType===Node.ATTRIBUTE_NODE)return e.value;var s="",h=0,d=e.childNodes;for(o=d.length;h<o;h++)d[h].nodeType!==Node.COMMENT_NODE&&(s+=d[h].nodeValue.replace(/^\s+|\s+$/g,""))}catch{}return s||""},Ss.prototype.getString=Ss.prototype.Na,Ss.prototype.Gf=function(e){return parseFloat(this.Na(e))||0},Ss.prototype.getFloat=Ss.prototype.Gf,Ss.prototype.vk=function(e){var o=e.split(/\s+/),s=o.length,h=!(o&&s==1),d=h?1:3,g=[],_;for(h||(o=e.split(","),s=o.length),_=0;_<s;_+=d)if(e=this.$h(h?o[_]:_+3>o.length?null:o.slice(_,_+3)))g.push(e);else return[];return g},Ss.prototype.parseCoords=Ss.prototype.vk,Ss.prototype.$h=function(e){if(!e)return null;var o=e instanceof Array&&0<e.length&&4>e.length?e:e.split(",");e=parseFloat(o[0]);var s=parseFloat(o[1]);return o=parseFloat(o[2]),isNaN(s)||isNaN(e)?null:new kg(s,e,isNaN(o)?void 0:o)},Ss.prototype.parseCoord=Ss.prototype.$h,Ss.prototype.Ef=function(e){return e=this.Na(e),/^[0-9a-fA-F]{8}$/.test(e)?"#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2):"#000000ff"},Ss.prototype.getColor=Ss.prototype.Ef;function Ts(e){e=e.attributes;for(var o,s=e.length;s--;)switch(o=e[s],o.name){case"x":this.x=parseFloat(o.value);break;case"y":this.y=parseFloat(o.value);break;case"xunits":this.Vc=Ss.prototype.Na(o)==="fraction";break;case"yunits":this.zc=Ss.prototype.Na(o)==="fraction"}}t("H.data.kml.HotSpot",Ts);function Us(e){var o=e.childNodes,s=new Ss;for(e=o.length;e--;){var h=o[e];switch(h.nodeName){case"href":this.href=s.Na(h)}}}t("H.data.kml.Icon",Us);function Vs(e){var o;if(e){e=e.childNodes;var s=e.length;for(o=new Ss;s--;){var h=e[s];switch(h.nodeName){case"scale":this.scale=o.Gf(h);break;case"Icon":this.icon=h=new Us(h);break;case"hotSpot":this.a=h=new Ts(h)}}}}t("H.data.kml.IconStyle",Vs);function Ws(){this.a={4:function(e){return["#",e.charAt(1),e.charAt(1),e.charAt(2),e.charAt(2),e.charAt(3),e.charAt(3),"ff"].join("")},5:function(e){return["#",e.charAt(1),e.charAt(1),e.charAt(2),e.charAt(2),e.charAt(3),e.charAt(3),e.charAt(4),e.charAt(4)].join("")},7:function(e){return e+"ff"},9:function(e){return e}},this.b={4:function(e){return[Xs(e.charAt(1)),Xs(e.charAt(2)),Xs(e.charAt(3)),255]},5:function(e){return[Xs(e.charAt(1)),Xs(e.charAt(2)),Xs(e.charAt(3)),Xs(e.charAt(4))]},7:function(e){return e=parseInt(e.substring(1),16),[e>>16&255,e>>8&255,e&255,255]},9:function(e){return e=parseInt(e.substring(1),16),[e>>24&255,e>>16&255,e>>8&255,e&255]}}}t("H.data.utils.ColorHelper",Ws);function Xs(e){return e=parseInt(e,16),(e<<4)+e}function Ys(e){return 16>e?"0"+Math.round(e).toString(16):Math.round(e).toString(16)}function Zs(e,o,s){return/^(#|rgb).*/.test(o)?(s||(s="",o.charAt(0)==="#"?s=e.a[o.length]?o:"":o.substr(0,3)==="rgb"&&(o=o.match(/\d+(\.\d+)?/g),s=o.length,s=2<s&&5>s?["#",Ys(+o[0]),Ys(+o[1]),Ys(+o[2]),3<s?Ys(255*+o[3]):"ff"].join(""):""),o=s),e=e.b[o.length](o),e[3]=Math.round(e[3]/255*100)/100,e):[0,0,0,255]}Ws.prototype.el=function(e,o){var s="";if(!/^(#|rgb).*/.test(e)){s="";var h;for(h=0;6>h;h++)s+="ABCDEF0123456789".charAt(Math.floor(16*Math.random()));return s+"ff"}for(e=Zs(this,e,o),o=0;4>o;o++)3>o?h=Math.floor(Math.random()*(e[o]+1)):h=255*e[o],s+=Ys(h);return s},Ws.prototype.toRandomRGBA=Ws.prototype.el;function $s(e){e=e.childNodes;for(var o,s=e.length,h=new Ss,d=new Ws;s--;)switch(o=e[s],o.nodeName){case"color":this.a=h.Ef(o);break;case"colorMode":this.b=h.Na(o)}this.b==="random"&&(this.a="#"+d.el(this.a,!1))}t("H.data.kml.ColorStyle",$s);function at(e){var o=e.childNodes,s=o.length,h=new Ss;for(this.a=this.fill=!0,this.b=new $s(e);s--;)switch(e=o[s],e.nodeName){case"fill":this.fill=h.Hd(e);break;case"outline":this.a=h.Hd(e)}}t("H.data.kml.PolyStyle",at);function bt(e){var o=e.childNodes,s=o.length,h=new Ss;for(this.a=new $s(e);s--;)e=o[s],e.nodeName==="width"&&(this.width=h.Gf(e))}t("H.data.kml.LineStyle",bt);function ct(e){e=e.childNodes;for(var o,s=e.length,h=new Ss;s--;)switch(o=e[s],o.nodeName){case"bgColor":this.bgColor=h.Ef(o);break;case"textColor":this.textColor=h.Ef(o);break;case"text":this.text=h.Na(o);break;case"displayMode":this.displayMode=h.Na(o)}}t("H.data.kml.BalloonStyle",ct);function dt(e){var o=e.childNodes,s=o.length;for(this.id=e.getAttribute("id");s--;)switch(e=o[s],e.nodeName){case"IconStyle":this.Oj=e=new Vs(e);break;case"LineStyle":this.Wd=e=new bt(e);break;case"PolyStyle":this.yk=e=new at(e);break;case"BalloonStyle":this.pf=e=new ct(e)}}t("H.data.kml.Style",dt);function et(e,o){e=e.childNodes;var s=e.length,h=new Ss;for(this.b=o;s--;)switch(o=e[s],o.nodeName){case"key":this.key=h.Na(o);break;case"styleUrl":this.a=h.Na(o)}}t("H.data.kml.Pair",et),et.prototype.V=function(){if(this.a){var e=this.key==="highlight";e=this.b.mh(this.a.substr(1),e)}return e},et.prototype.getStyle=et.prototype.V;function ft(e,o){var s=e.childNodes,h=s.length;for(this.b=o,this.id=e.getAttribute("id"),this.a=[];h--;)e=s[h],e.nodeName==="Pair"&&(e=new et(e,this.b),this.a.push(e))}t("H.data.kml.StyleMap",ft),ft.prototype.V=function(e){var o=null;e=e?"highlight":"normal";for(var s=this.a.length;s--;)this.a[s].key===e&&(o=this.a[s].V());return o},ft.prototype.getStyle=ft.prototype.V;function gt(){this.a={}}t("H.data.kml.StyleContainer",gt),gt.prototype.Ig=function(e){e&&e.id&&(this.a["style_"+e.id]=e)},gt.prototype.addStyle=gt.prototype.Ig,gt.prototype.mh=function(e,o){return e=this.a["style_"+e],e instanceof ft&&(e=e.V(o)),e},gt.prototype.getStyleById=gt.prototype.mh;function ht(e){e=e.childNodes;for(var o,s=e.length,h=null,d=new Ss;s--;)o=e[s],o.nodeName==="coordinates"&&(h=d.Na(o));this.a=null,h&&(this.a=d.$h(h)||null)}t("H.data.kml.Point",ht);function it(e,o){var s=e&&e.childNodes||[],h=new Ss;if(!e||!o)throw Error("Node or stylesContainer is not defined");for(this.visibility=!0,this.f=e,e=s.length;e--;){var d=s[e];switch(d.nodeName){case"name":this.name=h.Na(d);break;case"description":this.description=h.Na(d);break;case"visibility":this.visibility=h.Hd(d);break;case"open":this.open=h.Hd(d);break;case"styleUrl":(this.b=h.Na(d))&&(d=this.b.substr(1),this.c=o.mh(d,!1));break;case"Style":this.a=d=new dt(d)}}}t("H.data.kml.Feature",it);function jt(e){e=e.childNodes;for(var o,s=e.length,h=new Ss;s--;)if(o=e[s],o.nodeName==="coordinates"){var d=[],g=new Ss;try{d=g.vk(h.Na(o))}catch{d=[]}this.a=2>d.length?[]:d}}t("H.data.kml.Line",jt);function kt(e){for(var o=new L,s=e.a?e.a.length:0;s--;)o.qd(e.a[s]);return o}function lt(){}lt.prototype.f=0,lt.prototype.b=0;function mt(e){var o=e.childNodes,s=o.length;for(this.a=new L,this.c=[];s--;){var h=o[s],d=h.nodeName;if(d==="outerBoundaryIs"||d==="innerBoundaryIs"){var g=h.childNodes;for(h=g.length;h--;){var _=g[h];if(_.nodeName==="LinearRing"){var j=new jt(_);if(d==="outerBoundaryIs"){this.a=kt(j);var $=void 0,_t=e,_e=j.a;j=new Ss;var _r=_t.querySelector("altitudeMode");if(_r&&_r.parentNode===_t&&!/^\s*clampTo/.test(j.Na(_r))&&_e){_r=_e.length;for(var _n=0;_n<_r&&$!==0;_n++){var _o=_e[_n].alt;_o?$?_o!==$&&($=0):$=_o:$=0}(_e=_t.querySelector("*|altitudeOffset"))&&_e.parentNode===_&&_e.namespaceURI==="http://www.google.com/kml/ext/2.2"&&(_=j.Gf(_e))&&($+=_),$&&($=yd(2047,$),(_=_t.querySelector("extrude"))&&_.parentNode===_t&&j.Hd(_)?this.b=$:this.f=$)}}else this.c.push(kt(j))}}}}}u(mt,lt),t("H.data.kml.Polygon",mt);function nt(e,o){var s=document.createElement("CANVAS");s.width=1,s.height=1,this.g=e,this.b={},this.c={},this.f=new Wj(s),this.Yb=o||""}nt.prototype.create=function(e){return this.a=new it(e,this.g),ot(this,e)};function ot(e,o,s){o=o.childNodes;for(var h=o.length,d,g={},_;h--;){var j=o[h];switch(j.nodeName){case"Point":j=new ht(j),_=pt(e,"Marker"),(j=j.a)&&(d=new Rn(j,_),_.ai&&Fe(_.ai,"statechange",A(e.i,e,_.ai,d,_),!1));break;case"LineString":j=new jt(j),_=pt(e,"Polyline"),d=new th(kt(j),_);break;case"LinearRing":j=new jt(j),_=pt(e,"Polyline"),d=new th(kt(j),_);break;case"Polygon":j=new mt(j),_=pt(e,"Polygon"),_.elevation=j.f,_.extrusion=j.b,d=new uh(new O(j.a,j.c),_);break;case"MultiGeometry":d=ot(e,j,new R)}d&&(e.a.name&&(g.name=e.a.name),e.a.description&&(g.description=e.a.description),_&&_.pf&&(g.balloonStyle=_.pf),g.kmlNode=e.a.f,d.setData(g),s&&s.fa(d))}return s||d}nt.prototype.i=function(e,o,s){var h=s.anchor,d=s.scale;s=d+"_"+h.x+h.y+h.Vc+h.zc+"_"+s.href;var g={};if(e.getState()===1){var _=this.b[s];if(!_){var j=h.x,$=h.y;(_=e.yb())&&(_={w:_.w*d,h:_.h*d},g.size=_),j=h.Vc&&_?_.w*j:j*d,$=h.zc&&_?_.h*(1-$):!h.zc&&_?_.h-$*d:$*d,g.anchor={x:j,y:$},_=new Wj(e.Qc(),g),this.b[s]=_}o.Ic(_)}delete this.c[s]};function pt(e,o){var s=e.a,h={visibility:s.visibility},d=new Ws,g=1,_={x:0,y:0,Vc:!1,zc:!1},j=qt(e,s.c);switch(s.a&&(j=qt(e,s.a,j)),o){case"Marker":if(j&&j.Oj){if(d=j.Oj,d.scale&&(g=d.scale),d.a){var $=d.a;_={x:$.x,y:$.y,Vc:$.Vc,zc:$.zc}}d.icon&&d.icon.href?(o=d.icon.href,rt.test(o)||(o=e.Yb+o),d=g+"_"+_.x+_.y+_.Vc+_.zc+"_"+o,$=e.b[d]||e.c[d],$||($=new Wj(o),e.c[d]=$),$.getState()===0?(h.icon=e.f,h.ai=$,h.href=o,h.anchor=_,h.scale=g):$.getState()===1&&(h.icon=$)):g!==1&&($||(_={x:14,y:4,Vc:!1,zc:!1}),e={w:28*g,h:36*g},g={size:new Wi(e.w,e.h),anchor:new J(_.Vc?e.w*_.x:_.x*g,_.zc?e.h*(1-_.y):e.h-_.y*g),hitArea:new Xi(Yi.POLYGON,[0*g,16*g,0*g,7*g,8*g,0*g,18*g,0*g,26*g,7*g,26*g,16*g,18*g,34*g,8*g,34*g])},h.icon=new Wj('<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>',g))}break;case"Polyline":h.style={},j&&j.Wd&&(g=j.Wd,h.style.strokeColor="rgba("+Zs(d,g.a.a,!0)+")",0<=g.width&&(h.style.lineWidth=g.width));break;case"Polygon":h.style={},j&&(j.Wd&&(g=j.Wd,h.style.strokeColor="rgba("+Zs(d,g.a.a,!0)+")",0<=g.width&&(h.style.lineWidth=g.width)),j.yk&&(g=j.yk,h.style.fillColor=g.fill?"rgba("+Zs(d,g.b.a,!0)+")":"rgba(0,0,0,0)",g.a||(h.style.lineWidth=0)))}return h.pf=j.pf,h}function qt(e,o,s){s=s||{};for(var h in o)o.hasOwnProperty(h)&&(s[h]=typeof o[h]=="object"?qt(e,o[h],s[h]):o[h]);return s}var rt=/^[^:\/]+:/;function st(e){xc(this,st),this.url=e,this.b=[],this.a=z,this.c=A(this.c,this),F.call(this)}u(st,F),t("H.data.AbstractReader",st);var tt={ERROR:-1,LOADING:0,VISIT:1,READY:2};st.State=tt,st.prototype.f=tt.READY,st.prototype.A={ml:"statechange"},st.prototype.ob=function(){if(!this.a){this.a=new N;var e=this.a.bc();e.Xb(this.b)}return new tl(this.a)},st.prototype.getLayer=st.prototype.ob,st.prototype.Gm=function(){return this.b.concat([])},st.prototype.getParsedObjects=st.prototype.Gm,st.prototype.v=function(){return this.url},st.prototype.getUrl=st.prototype.v,st.prototype.Co=function(e){if(this.f===tt.LOADING||this.f===tt.VISIT)throw Error("InvalidState: state "+this.f);return this.b=[],this.a=z,this.url=e,this},st.prototype.setUrl=st.prototype.Co,st.prototype.getState=function(){return this.f},st.prototype.getState=st.prototype.getState,st.prototype.O=function(e,o,s){this.f=e,this.dispatchEvent(new ut(o||this,this.A.ml,e,s||""))},st.prototype.parse=function(){var e=this;vc(this.url)?(this.O(tt.LOADING),new tf("text/plain",this.url).then(function(o){try{e.c(o)}catch(s){e.O(tt.ERROR,z,s.message)}},function(){e.O(tt.ERROR,z,"Error loading file")})):e.O(tt.ERROR,z,"File url was not set")},st.prototype.parse=st.prototype.parse;function ut(e,o,s,h){ut.j.constructor.call(this,o,e),this.state=s,this.message=h}u(ut,ud),st.Event=ut;function vt(e){var o=e?e.lastIndexOf("/"):-1;this.g=[],st.call(this,e),0<=o&&(this.i=e.substr(0,o)+"/")}u(vt,st),t("H.data.kml.Reader",vt),vt.prototype.c=function(e){var o,s=null;if(Cc(e)&&e.trim()!=""){try{var h=new DOMParser().parseFromString(e,"text/xml")}catch{this.O(tt.ERROR,z,"Error parsing KML document");return}if(h.getElementsByTagName("parsererror").length)this.O(tt.ERROR,z,"Error parsing KML document");else if((e=h.childNodes&&h.childNodes[0].nodeName==="kml"?h.childNodes[0]:void 0)&&(o=wt(e.childNodes,"Document")[0]),o=o||e){h=new gt;for(var d=wt(o.childNodes,"Style"),g=wt(o.childNodes,"StyleMap"),_=d.length;_--;)e=new dt(d[_]),h.Ig(e);for(_=g.length;_--;)e=new ft(g[_],h),h.Ig(e);for(this.l=new nt(h,this.i),e=o.childNodes,o=e.length;o--;)d=e[o],h=s,d.nodeName==="Placemark"?(d=this.l.create(d))&&xt(this,d,h):d.nodeName==="Folder"&&(d={group:new R,node:d},xt(this,d.group,h),this.g.push(d)),!o&&(h=this.g.shift())&&(e=h.node.childNodes,s=h.group,o=e.length);this.O(tt.READY)}else this.O(tt.ERROR,z,"Invalid KML document")}else this.O(tt.ERROR,z,"Unable to create objects from the empty data")};function xt(e,o,s){s?s.fa(o):(e.a&&e.a.bc().fa(o),e.b.push(o),e.O(tt.VISIT,o))}function wt(e,o){for(var s=e.length,h,d=[];s--;)h=e[s],h.nodeName===o&&d.push(h);return d}function yt(e,o){this.b=e,this.a=o}yt.prototype.create=function(e,o){var s=e.coordinates;switch(e.type){case"Point":var h=new Rn(zt(s));break;case"LineString":h=new th(At(s));break;case"Polygon":h=new uh(Bt(s));break;case"MultiPoint":var d=0,g=s.length;if(h=[],this.a){for(;d<g;d++)h.push(zt(s[d]));s=new Rn(new Vi(h))}else{for(;d<g;d++)h.push(new Rn(zt(s[d])));s=new R,s.Xb(h)}h=s,g="multiPoint";break;case"MultiLineString":if(d=0,g=s.length,h=[],this.a){for(;d<g;d++)h.push(At(s[d]));s=new th(new ih(h))}else{for(;d<g;d++)h.push(new th(At(s[d])));s=new R,s.Xb(h)}h=s,g="multiLineString";break;case"MultiPolygon":if(h=[],d=0,g=s.length,this.a){for(;d<g;d++)h.push(Bt(s[d]));s=new uh(new Ji(h))}else{for(;d<g;d++)h.push(new uh(Bt(s[d])));s=new R,s.Xb(h)}h=s,g="multiPolygon";break;case"GeometryCollection":s=h=new R,d=e.geometries,g=0;for(var _=d.length;g<_;g++)this.create(d[g],s);g="geometryCollection"}return h&&(s=h,d=e.properties,e=e.id,_={},d&&(this.a?_=d:_.properties=d),g&&!this.a&&(_[g]=!0),e&&s.Ai(e),s.setData(_),this.b(h)),o&&h&&o.fa(h),h},yt.prototype.create=yt.prototype.create;function zt(e){return new kg(e[1],e[0])}function Bt(e){for(var o=At(e[0]),s=[],h,d=1,g=e.length;d<g;d++)h=At(e[d]),s.push(h);return new O(o,s)}function At(e){for(var o=0,s=e.length,h=new L;o<s;o++)h.qd(zt(e[o]));return h}function Ct(e,o){o=o||{},this.i=o.style||this.Fd,(this.g=!!o.disableLegacyMode)||window.console.warn("H.data.geojson.Reader: Legacy parser is enabled in GeoJSON Reader. Features like Multi-Geometries, Polygon interiors and GeoJSON feature properties might not work as expected. To maximise compatibility with the remote services it is recommended to set the `disableLegacyMode` flag to true."),st.call(this,e)}u(Ct,st),t("H.data.geojson.Reader",Ct),Ct.prototype.c=function(e){var o,s;try{var h=typeof e=="string"?JSON.parse(e):e;if(typeof h=="object"){var d=new yt(this.i,this.g);switch(h.type){case"FeatureCollection":if(o=h.features){var g=new R;for(Dt(this,g),s=0;s<o.length;s++){var _=Et(o[s]);(_=d.create(_))&&g.fa(_)}}break;case"Feature":_=Et(h),(_=d.create(_))&&Dt(this,_);break;default:(_=d.create(h))&&Dt(this,_)}this.O(tt.READY)}else this.O(tt.ERROR,z,"Invalid syntax")}catch(j){this.O(tt.ERROR,z,"Parse error. "+j.message)}},Ct.prototype.io=function(e){this.O(tt.LOADING),this.c(e)},Ct.prototype.parseData=Ct.prototype.io,Ct.prototype.Fd=function(){};function Et(e){var o={};if(e.geometry){var s=e.geometry;o.type=s.type,o.properties=e.properties,s.coordinates&&(o.coordinates=s.coordinates),s.geometries&&(o.geometries=s.geometries),e.id&&(o.id=e.id)}return o}function Dt(e,o){e.a&&e.a.bc().fa(o),e.b.push(o),e.O(tt.VISIT,o)}t("H.data.buildInfo",function(){return Hf("H-data","1.49.1","74e5afb",{region:"row"})}),wg.prototype.Lc=ca(1,function(e,o){this.a.Lc(e,Fc(o)?o:this.c)}),Ag.prototype.Lc=ca(0,function(e,o){var s=0,h;if(!e(this)&&o--)for(;3>=s;s++)(h=this[s])&&h.Lc(e,o)});function Ft(e,o){this.a=e,this.b=o}t("H.clustering.grid.NoisePoint",Ft),Ft.prototype.ya=function(){return ng(this.a)},Ft.prototype.getPosition=Ft.prototype.ya,Ft.prototype.xc=function(){return this.a.wt},Ft.prototype.getWeight=Ft.prototype.xc,Ft.prototype.od=gf,Ft.prototype.isCluster=Ft.prototype.od,Ft.prototype.sc=function(){return this.b},Ft.prototype.getMinZoom=Ft.prototype.sc,Ft.prototype.getData=function(){return this.a.data},Ft.prototype.getData=Ft.prototype.getData;function Gt(e,o,s){this.g=this.b=s,this.bi=[],this.a=0,this.f=sg(e,o,!0)}t("H.clustering.grid.Cluster",Gt),Gt.prototype.ne=function(e){this.c||(this.c=ng(e)),this.a+=e.wt||1,this.bi.push(e)},Gt.prototype.ya=function(){return this.c},Gt.prototype.getPosition=Gt.prototype.ya,Gt.prototype.xc=function(){return this.a},Gt.prototype.getWeight=Gt.prototype.xc,Gt.prototype.od=ff,Gt.prototype.isCluster=Gt.prototype.od,Gt.prototype.sc=function(){return this.b},Gt.prototype.getMinZoom=Gt.prototype.sc,Gt.prototype.If=function(){return this.g},Gt.prototype.getMaxZoom=Gt.prototype.If,Gt.prototype.K=function(){return this.f},Gt.prototype.getBoundingBox=Gt.prototype.K,Gt.prototype.Yg=function(e){this.ze(e)},Gt.prototype.forEachEntry=Gt.prototype.Yg,Gt.prototype.ze=function(e){var o=this;if(!Da(e))throw new D(this.ze,0,e);this.bi.forEach(function(s){e(new Ft(s,o.b+1))})},Gt.prototype.forEachDataPoint=Gt.prototype.ze;function Ht(e){qd.call(this),this.a=[];var o;e?Ya(o={},It,e):o=It,this.g=o,qd.call(this)}u(Ht,qd);var Jt={clusters:[],noisePoints:[]},It={projection:mj,min:0,max:22,eps:32,minWeight:2};p=Ht.prototype,p.Hc=function(e){this.a=e,this.b=!0},p.Db=function(e){this.a.push(e),this.b=!0},p.mf=function(e){this.a=this.a.concat(e),this.b=!0},p.We=function(e){this.a=this.a.filter(function(o){return o!==e}),this.b=!0},p.o=function(){Ht.j.o.call(this),delete this.a},Ht.prototype.disposeInternal=Ht.prototype.o,Ht.prototype.U=ld;function Kt(e){Ht.call(this,e)}u(Kt,Ht),Kt.prototype.Ei=function(e){var o=this.g,s=o.min,h=o.max,d=[],g=[],_;if(this.b){for(_=this.a;s<=h;s++){for(var j,$=void 0,_t,_e,_r,_n,_o,ga,_l,_f=s,_c=_,_p=d,_g=g,ty=o.eps,oy=o.projection,ry=o.minWeight,ly=_c.length,py=Math.pow(2,_f+8),gy=[];_l=_c[--ly];)if(!_l.Ki){for(_e=oy.Pc(_l).scale(py).floor(),ga=py,_o=_e.x,_n=_e.y,_t=gy.length;_t--;)j=gy[_t],_r=j.ya(),j.Ji||(j.Ji=oy.Pc(_r).scale(py).floor()),_r=j.Ji,_r=_r.Wa(_e),_r<ga&&(ga=_r,$=j);$&&$.K().gd(_l)||($=new Gt(oy.dg({x:(_o-ty)/py,y:(_n-ty)/py}),oy.dg({x:(_o+ty)/py,y:(_n+ty)/py}),_f),gy.push($)),$.ne(_l),$=null}for(ly=gy.length;ly--;)if(j=gy[ly],_t=j.xc(),_t<ry)for(j=j.bi,_t=j.length;_l=j[--_t];)_g.push(new Ft(_l,_f)),_l.Ki=!0;else _p.push(j)}for(s=0,h=_.length;s<h;s++)delete _[s].Ki;this.b=!1,e({clusters:d,noisePoints:g})}};function Lt(e){this.a=e,e=document.createElement("canvas");var o=e.getContext("2d"),s=this.a,h=14*s;e.width=h,e.height=h,o.scale(s,s),o.beginPath(),o.strokeStyle="#FFFFFF",o.fillStyle="#1080DD",o.arc(7,7,6,0,2*Math.PI,!1),o.fill(),o.lineWidth=1,o.stroke(),this.f=new Wj(e,{size:{w:14,h:14},anchor:{x:7,y:7}}),this.b={},this.c={}}t("H.clustering.theme.Circular",Lt);function Mt(e,o,s){var h,d=document.createElement("canvas"),g=d.getContext("2d"),_=e.a,j=o*_;return d.width=j,d.height=j,g.scale(_,_),_=o+":"+s,(h=e.b[_])?g.putImageData(h,0,0):(o/=2,g.beginPath(),g.strokeStyle="rgba("+s+",0.2)",g.fillStyle="rgba("+s+",1)",g.arc(o,o,o/5*3,0,2*Math.PI,!1),g.fill(),g.lineWidth=o/5*4,g.stroke(),e.b[_]=g.getImageData(0,0,j,j)),d}Lt.prototype.Sl=function(e){var o=e.xc(),s=this.c[o];if(!s){if(10>o){s=Mt(this,28,"118,209,0");var h={x:11,y:18}}else 25>o?(s=Mt(this,38,"255,105,0"),h={x:13,y:23}):50>o?(s=Mt(this,38,"240,60,0"),h={x:13,y:23}):100>o?(s=Mt(this,38,"181,0,21"),h={x:13,y:23}):1e3>o?(s=Mt(this,48,"181,0,21"),h={x:15,y:28}):(s=Mt(this,66,"181,0,21"),h={x:20,y:38});var d=s.getContext("2d");d.fillStyle="#FFFFFF",d.font="bold 11px Arial",d.fillText(String(o),h.x,h.y),h=s.width/this.a,s=new Wj(s,{size:{w:h,h},anchor:{x:h/2,y:h/2}}),this.c[o]=s}return o=new Rn(e.ya(),{icon:s,min:e.sc(),max:e.If()}),o.setData(e),o},Lt.prototype.getClusterPresentation=Lt.prototype.Sl,Lt.prototype.Dm=function(e){var o=new Rn(e.ya(),{icon:this.f,min:e.sc()});return o.setData(e),o},Lt.prototype.getNoisePresentation=Lt.prototype.Dm;function Nt(e){if(Ht.call(this,e),e=this.g,e.projection!==mj)throw new D(Nt,0,"Other projection than mercator not supported yet");this.s=e.projection,this.f=e.eps,this.D=e.minWeight,this.m=new nj(this.s),new Pf().a("cluster","H.clustering.dynamicgrid.worker"),this.i=A(this.i,this),this.l=A(this.l,this)}u(Nt,Ht),Nt.prototype.U=function(e,o){this.u=e,this.J=Bd(o)},Nt.prototype.Ei=function(e,o){var s=this.c,h=this.u,d=this.J||0,g=!s||!(s.zoom===d&&s.b.ia(h));if(h&&(this.b||g)){if(s&&3>s.Yd&&s.cancel(),this.b=!1,s=this.f,s>=128*Gd(2,d))var _=Ot;else{g=this.m,g.Oa(d);var j=g.ib(h.Nb());_=g.ib(h.Jb()),j.y-=s,_.y+=s,j=g.Re(j);var $=g.Re(_);_=new K(j.lat,j.lng,$.lat,$.lng),s=g.Ra(s,0).lng+180,_=_.Bc(j.lat,j.lng-s,$.lat,j.lng).Bc(j.lat,$.lng,$.lat,$.lng+s)}for(s=_,j=this.a,_=[],g=j.length;g--;)s.gd(j[g])&&_.push(j[g]);0<_.length?(this.c=new Pt(h,d,_,this.f,this.D,this.s!==mj,e,o),this.c.then(this.i,this.l)):e(Jt)}},Nt.prototype.i=function(e){Ca(e)||(e=new x.Uint32Array(e)),this.c.g(Qt(this,e))},Nt.prototype.l=function(e){Cc(e)&&this.c.f(e)};var Ot=new K(90,-180,-90,180);function Qt(e,o){for(var s=0,h=o[s++],d=Array(h),g=0,_=[],j=o.length,$=e.c.a,_t=e.c.zoom;h--;)d[g++]=new Ft($[o[s++]],_t);for(;s<j;){h=o[s++],g=$[o[s]];var _e=e.m,_r=e.f;_e.Oa(e.c.zoom);var _n=_e.ib(g);for(g=_e.Ra(_n.x-_r,_n.y-_r),_e=_e.Ra(_n.x+_r,_n.y+_r),g=new K(g.lat,g.lng,_e.lat,_e.lng),g=new Gt(g.Nb(),g.Jb(),_t);h--;)g.ne($[o[s++]]);_.push(g)}return{clusters:_,noisePoints:d}}Nt.prototype.o=function(){Nt.j.o.call(this)},Nt.prototype.disposeInternal=Nt.prototype.o;function Pt(e,o,s,h,d,g,_,j){this.b=e,this.zoom=o,this.a=s,this.g=_,this.f=j,e=s.length,_=3*e,j=new(x.Float64Array||Array)(_);for(var $;e--;)$=s[e],j[--_]=$.lat,j[--_]=$.lng,j[--_]=$.wt;ie.call(this,"cluster",{message:[j,h,d,o,g]},void 0)}u(Pt,Sf);function Rt(e,o,s){this.b=e,this.a=o,this.f=s}t("H.clustering.fastgrid.NoisePoint",Rt),Rt.prototype.ya=function(){return this.c||(this.c=this.b.Ra(this.a[1],this.a[0],1)),this.c},Rt.prototype.getPosition=Rt.prototype.ya,Rt.prototype.xc=function(){return this.a.a},Rt.prototype.getWeight=Rt.prototype.xc,Rt.prototype.od=gf,Rt.prototype.isCluster=Rt.prototype.od,Rt.prototype.sc=function(){return this.f-this.b.c},Rt.prototype.getMinZoom=Rt.prototype.sc,Rt.prototype.getData=function(){return this.a.data},Rt.prototype.getData=Rt.prototype.getData;function St(e,o,s,h){this.b=e,this.a=o,this.l=s,this.U=h,this.f=Ka(this.f,this),this.c=Ka(this.c,this)}t("H.clustering.fastgrid.Cluster",St),St.prototype.ya=function(){return this.s||(this.s=this.b.Ra(this.a.qe,this.a.re,this.a.Fb)),this.s},St.prototype.getPosition=St.prototype.ya,St.prototype.xc=function(){return this.a.Fb},St.prototype.getWeight=St.prototype.xc,St.prototype.od=ff,St.prototype.isCluster=St.prototype.od,St.prototype.sc=function(){return this.l?this.l-this.b.c:-1/0},St.prototype.getMinZoom=St.prototype.sc,St.prototype.If=function(){return this.U-this.b.c},St.prototype.getMaxZoom=St.prototype.If,St.prototype.K=function(){return this.i||(this.i=sg(this.b.Ra(this.a.a,this.a.f,1),this.b.Ra(this.a.b,this.a.c,1),!0)),this.i},St.prototype.getBoundingBox=St.prototype.K,St.prototype.Yg=function(e){this.g=e,this.a.Lc(this.f,Wd)},St.prototype.forEachEntry=St.prototype.Yg,St.prototype.f=function(e,o){var s=!1,h,d;if(e.Fb>=this.b.s&&e!==this.a&&e.Fb!==this.a.Fb&&(this.g(new St(this.b,e,0,o)),s=!0),!s&&(h=e.entries))for(e=h.length,d=0;d<e;d++)this.g(new Rt(this.b,h[d],o));return s},St.prototype.ze=function(e){this.m=e,this.a.Lc(this.c,Wd)},St.prototype.forEachDataPoint=St.prototype.ze,St.prototype.c=function(e,o){var s;if(e=e.entries){var h=e.length;for(s=0;s<h;s++)this.m(new Rt(this.b,e[s],o))}return!1};function Tt(e,o,s,h,d,g){this.g=o,e&&(this.parent=e,o&1?(s=e[8],d=e[5]):(s=e[7],d=e[8]),o&2?(h=e[9],g=e[6]):(h=e[4],g=e[9])),this[7]=s,this[5]=d,this[8]=(s+d)/2,this[4]=h,this[6]=g,this[9]=(h+g)/2}p=Tt.prototype,p.Xd=0;function Ut(e,o){return e[o]||(++e.Xd,e[o]=new Tt(e,o))}p.removeChild=function(e){var o=e.g;this[o]===e&&(delete this[o],delete e.parent,--this.Xd)},p.Lc=function(e,o){for(var s=0,h=this;h=h.parent;)++s;Vt(this,e,o,s)};function Vt(e,o,s,h){var d,g;if(!o(e,h)&&s--)for(++h,d=0;4>d;d++)(g=e[d])&&Vt(g,o,s,h)}p.qe=0,p.re=0,p.Fb=0;function Wt(e){this.b=e||10,Xt(this)}function Xt(e){e.head=e.a=new Tt(null,NaN,0,0,4294967296,4294967296)}function Yt(e,o){var s,h;for(s=0;4>s;s++)(h=o[s])&&(Yt(e,h),delete o[s]);delete o.parent,delete o.entries}function Zt(e,o){var s=e.head,h;if(o){var d=o;if(d!==s)for(s=d;d=d.parent;)(d.entries||1<d.Xd)&&(s=d)}else for(;!s.entries&&2>(h=s.Xd)&&h;)s=d;e.head=s}Wt.prototype.yc=function(e,o,s,h){var d=this.a;if(!(e>=d[7]&&o>=d[4]&&e<=d[5]&&o<=d[6]))throw Error("Coordinates out of bounds");return $t(this,this.a,e,o,s,this.b,h)};function $t(e,o,s,h,d,g,_){var j=o.entries;return g?o.Xd?j=$t(e,Ut(o,+(s>=o[8])|+(h>=o[9])<<1),s,h,d,g-1,_):j?(j=j[0],j=Ut(o,+(j[1]>=o[8])|+(j[0]>=o[9])<<1),j.entries=o.entries,j.qe=o.qe,j.re=o.re,j.Fb=o.Fb,j.a=o.a,j.f=o.f,j.b=o.b,j.c=o.c,delete o.entries,Zt(e,j),j=$t(e,Ut(o,+(s>=o[8])|+(h>=o[9])<<1),s,h,d,g-1,_)):(g=j=new au(s,h,d,_),(o.entries||(o.entries=[])).push(g),Zt(e,o)):(j||Zt(e,o),e=j=new au(s,h,d,_),(o.entries||(o.entries=[])).push(e)),o.qe+=s*d,o.re+=h*d,o.Fb+=d,o.a===B?(o.a=o.b=s,o.f=o.c=h):(s<o.a?o.a=s:s>o.b&&(o.b=s),h<o.f?o.f=h:h>o.c&&(o.c=h)),j}Wt.prototype.Lc=function(e,o){Vt(this.a,e,o===+o?o:this.b,0)};function au(e,o,s,h){this[0]=o,this[1]=e,this.a=s,this.data=h}function bu(e){Ht.call(this,e),e=this.g,this.l=e.projection,this.m=e.min,this.f=e.max,this.s=e.minWeight,this.c=7-Ad(Ed(zd(1,e.eps))/Od),this.i=new Wt(zd(this.m,this.f+this.c))}u(bu,Ht),p=bu.prototype,p.Hc=function(e){var o=0,s=e.length,h,d=new J(0,0),g=this.l,_=this.i;for(bu.j.Hc.call(this,e),Yt(_,_.a),Xt(_);o<s;o++)g.Pc(h=e[o],d).scale(4294967296).floor(),_.yc(d.x,d.y,h.wt,h.data);this.b=!0},p.Db=function(e){bu.j.Db.call(this,e),this.Hc(this.a)},p.mf=function(e){for(var o=e.length,s=bu.j.Db;o--;)s.call(this,e[o]);this.Hc(this.a)},p.We=function(e){bu.j.We.call(this,e),this.Hc(this.a)},p.Ra=function(e,o,s,h){return this.l.Ra(e/s/4294967296,o/s/4294967296,h)},p.Ei=function(e){if(this.b){var o={clusters:[],noisePoints:[]};cu(this,this.i.a,0,this.f+this.c,-1/0,o,null),this.b=!1,e(o)}};function cu(e,o,s,h,d,g,_){var j=o.Fb,$;if(_&&(_.node.Fb!==j?(g.clusters.push(new St(e,_.node,_.depth,s-1)),_=null):d++),_||(j>=e.s?(_={node:o,depth:s},d=s):du(e,o,d+1,g)),o.Xd&&h--)for(s++,j=0;4>j;j++)($=o[j])&&(cu(e,$,s,h,d,g,_),_=null);_&&g.clusters.push(new St(e,_.node,_.depth,e.f+e.c))}function du(e,o,s,h){o=o.entries;var d;if(o){var g=o.length;for(h=h.noisePoints,d=0;d<g;d++)h.push(new Rt(e,o[d],s))}else for(d=0;4>d;d++)(g=e[d])&&du(e,g,s,h)}p.o=function(){bu.j.o.call(this),this.i=null},bu.prototype.disposeInternal=bu.prototype.o,t("H.clustering.DataPoint",function(e,o,s,h){this.lat=e,this.lng=o,this.wt=s===+s?s:1,this.data=h});function eu(e,o){o=o||{};var s={},h=o.min||0,d=zd(h,o.max||22);switch(h={min:h,max:d},eu.j.constructor.call(this,h),this.xa=o.pixelRatio||Ue(),Ya(s,It,h,o.clusteringOptions||{}),s.minWeight=zd(It.minWeight,s.minWeight),s.strategy){case fu.DYNAMICGRID:if(s.projection!==mj)throw new D(eu,1,"Unsupported projection");this.c=new Nt(s);break;case fu.GRID:this.c=new Kt(s);break;default:this.c=new bu(s)}this.c.Hc(e),this.D=o.theme||new Lt(this.xa),this.R=A(this.R,this),this.aa=A(this.aa,this),gu(this)}u(eu,N),t("H.clustering.Provider",eu),eu.prototype.o=function(){eu.j.o.call(this),this.f.na(),this.c.F(),delete this.c,delete this.L,delete this.D,x.clearTimeout(this.ea)};var fu={FASTGRID:0,GRID:1,DYNAMICGRID:2};eu.Strategy=fu,eu.prototype.R=function(){this.dispatchEvent("start"),this.c.Ei(this.aa,ld)};function gu(e,o,s){e.ea&&x.clearTimeout(e.ea),o&&e.c.U(o,s),e.ea=x.setTimeout(e.R,150)}eu.prototype.aa=function(e){this.L=e,hu(this),this.dispatchEvent("end")},eu.prototype.Hc=function(e){this.c.Hc(e),gu(this)},eu.prototype.setDataPoints=eu.prototype.Hc,eu.prototype.Db=function(e){this.c.Db(e),gu(this)},eu.prototype.addDataPoint=eu.prototype.Db,eu.prototype.mf=function(e){this.c.mf(e),gu(this)},eu.prototype.addDataPoints=eu.prototype.mf,eu.prototype.We=function(e){this.c.We(e),gu(this)},eu.prototype.removeDataPoint=eu.prototype.We,eu.prototype.Zm=function(){return this.D},eu.prototype.getTheme=eu.prototype.Zm,eu.prototype.zo=function(e){this.D=e,this.L&&(this.f.na(),hu(this))},eu.prototype.setTheme=eu.prototype.zo;function hu(e){var o=e.L.clusters,s=e.L.noisePoints,h=o.length,d=s.length,g=0<h+d;for(e.f.na();d--;){var _=s[d];e.f.fa(e.D.getNoisePresentation(_))}for(;h--;)s=o[h],e.f.fa(e.D.getClusterPresentation(s));g&&e.Va()}eu.prototype.Qb=function(){return!0},eu.prototype.providesDomMarkers=eu.prototype.Qb,eu.prototype.Rb=function(){return!0},eu.prototype.providesMarkers=eu.prototype.Rb,eu.prototype.Cc=function(){return!0},eu.prototype.providesSpatials=eu.prototype.Cc,eu.prototype.Ue=function(e,o){gu(this,e,o)},eu.prototype.preprocessData=eu.prototype.Ue,t("H.clustering.buildInfo",function(){return Hf("H-clustering","1.49.1","74e5afb",{region:"row"})});function iu(e,o){t:{for(var s=e.length,h=typeof e=="string"?e.split(""):e,d=0;d<s;d++)if(d in h&&o.call(void 0,h[d],d,e)){o=d;break t}o=-1}return 0>o?null:typeof e=="string"?e.charAt(o):e[o]}var ju={};function ku(e){var o=e.ownerDocument,s=o.documentElement;o=o.defaultView;var h=e.getBoundingClientRect();return e=h.left,h=h.top,isNaN(o.pageXOffset)?(e+=s.scrollLeft,h+=s.scrollTop):(e+=o.pageXOffset,h+=o.pageYOffset),new J(e,h)}function lu(e,o,s){o=Fc(o)?o+"px":o,s=Fc(s)?s+"px":s,e.style[Af("transform")]="translate("+o+","+s+")"}var mu,nu=navigator.userAgent,ou=-1<nu.indexOf("Android")&&-1<nu.indexOf("Mozilla/5.0")&&-1<nu.indexOf("AppleWebKit"),pu=/AppleWebKit\/([\d.]+)/,qu=pu.exec(nu)===null?null:parseFloat(pu.exec(nu)[1]);mu=ou&&qu!==null&&537>qu;var ru=globalThis,su=document.createElement("T");function tu(){this.a=this.lj()}tu.prototype.lj=function(){var e=navigator,o=[];return e&&(e.msPointerEnabled?o.push(uu):e.pointerEnabled&&o.push(vu)),1>o.length&&("TouchEvent"in ru&&o.push(wu),o.push(xu)),o},tu.prototype.detectEventSets=tu.prototype.lj,tu.prototype.addEventListener=function(e,o,s,h){for(var d=this.a,g,_=d.length,j=!1;_--;)(g=d[_][o])&&(j=!0,e.addEventListener(g,s,h||!1));j||e.addEventListener(o,s,h||!1)},tu.prototype.removeEventListener=function(e,o,s,h){for(var d=this.a,g,_=d.length,j=!1;_--;)(g=d[_][o])&&(j=!0,e.removeEventListener(g,s,h||!1));j||e.removeEventListener(o,s,h||!1)};var vu={start:"pointerdown",end:"pointerup",move:"pointermove",cancel:"pointercancel",over:"pointerover",out:"pointerout",hover:"pointerhover"},uu={start:"MSPointerDown",end:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel",over:"MSPointerOver",out:"MSPointerOut",hover:"MSPointerHover"},wu={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},xu={start:"mousedown",end:"mouseup",move:"mousemove",over:"mouseover",out:"mouseout",hover:"mousehover"};function yu(e,o,s,h){return e=e.createElement(o),s&&(e.className=s),h&&(e.innerHTML=h),e}function zu(e,o){for(var s=1,h=arguments.length;s<h;s++)e.appendChild(arguments[s])}var Au=new tu;function Bu(e,o,s){Au.addEventListener(e,o,s,void 0)}function Cu(e,o,s){Au.removeEventListener(e,o,s,void 0)}function Y(e,o){F.call(this),this.ab=e||"div",this.f=o?o.split(" "):[],this.L=!1,this.f.push("H_el")}u(Y,F),t("H.ui.base.Element",Y),Y.prototype.W=function(e){if(!e)throw Error("Wrong document object");return this.S=yu(e,this.ab,this.f.join(" ")),this.renderInternal(this.S,e),this.va(this.dc(),!0),this.jc(this.aa),this.qb(this.R),this.S},Y.prototype.ta=function(){},Y.prototype.T=function(){},Y.prototype.X=function(){},Y.prototype.renderInternal=Y.prototype.X,Y.prototype.dc=function(){return this.L},Y.prototype.isDisabled=Y.prototype.dc,Y.prototype.va=function(e,o){return e=!!e,(e!==this.L||o)&&((this.L=e)?this.Ka("H_disabled"):this.kb("H_disabled")),this},Y.prototype.setDisabled=Y.prototype.va,Y.prototype.J=null,Y.prototype.getData=function(){return this.J},Y.prototype.getData=Y.prototype.getData,Y.prototype.setData=function(e){this.J=e},Y.prototype.setData=Y.prototype.setData,Y.prototype.jc=function(e){var o=this.N();this.aa=e,o&&(e?o.setAttribute("title",e):o.removeAttribute("title"))},Y.prototype.setTooltip=Y.prototype.jc,Y.prototype.S=null,Y.prototype.N=function(){return this.S},Y.prototype.getElement=Y.prototype.N,Y.prototype.R=!0,Y.prototype.qb=function(e){var o=this.N();this.R=e,o&&(o.style.display=e?"":"none")},Y.prototype.setVisibility=Y.prototype.qb,Y.prototype.wc=function(){return this.R},Y.prototype.getVisibility=Y.prototype.wc,Y.prototype.Ka=function(e){var o=this.N();return 0>this.f.indexOf(e)&&this.f.push(e),o&&(o.className=this.f.join(" ")),this},Y.prototype.addClass=Y.prototype.Ka,Y.prototype.kb=function(e){e=this.f.indexOf(e);var o=this.N();return-1<e&&this.f.splice(e,1),o&&(o.className=this.f.join(" ")),this},Y.prototype.removeClass=Y.prototype.kb;function Du(e){(e=e.N())&&e.parentNode&&e.parentNode.removeChild(e)}Y.prototype.o=function(){Y.j.o.call(this),Du(this),this.J=this.S=null,delete this.aa};function Eu(e){e=e||{},Y.call(this,"div","H_btn"),this.Jc(e.label||" "),this.jc(e.tooltip||""),this.setData(e.data),this.va(!!e.disabled),this.O(Fu.UP,!0),e.onStateChange&&this.addEventListener("statechange",e.onStateChange),this.b=A(this.b,this),this.a=A(this.a,this)}u(Eu,Y),t("H.ui.base.Button",Eu),Eu.prototype.va=function(e,o){return e&&this.kb("H_active"),Eu.j.va.call(this,e,o)},Eu.prototype.setDisabled=Eu.prototype.va,Eu.prototype.X=function(e){Bu(e,"start",this.b),Bu(e,"end",this.a),Bu(e,"out",this.a),this.Jc(this.Ge(),!0)},Eu.prototype.renderInternal=Eu.prototype.X,Eu.prototype.getState=function(){return this.C},Eu.prototype.getState=Eu.prototype.getState,Eu.prototype.O=function(e,o){return e!==this.C&&(this.C=e,e===Fu.DOWN?this.Ka("H_active"):this.kb("H_active"),o||this.dispatchEvent("statechange")),this},Eu.prototype.setState=Eu.prototype.O,Eu.prototype.Ge=function(){return this.c},Eu.prototype.getLabel=Eu.prototype.Ge,Eu.prototype.Jc=function(e,o){return(o||e!==this.c)&&(this.c=e,(o=this.N())&&(o.innerHTML=e)),this},Eu.prototype.setLabel=Eu.prototype.Jc,Eu.prototype.b=function(e){this.dc()||this.O(Fu.DOWN),e.preventDefault()},Eu.prototype.a=function(e){this.dc()||this.O(Fu.UP),e.preventDefault()},Eu.prototype.o=function(){var e=this.N();e&&(Cu(e,"start",this.b),Cu(e,"end",this.a),Cu(e,"out",this.a)),Y.prototype.o.call(this)};var Fu={UP:"up",DOWN:"down"};Eu.State=Fu;var Gu={in:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g><path d="m5 10.6h5.6v-5.6h2.8v5.6h5.6v2.8h-5.6v5.6h-2.8v-5.6h-5.6v-2.8z"></path></g></svg>',out:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="m5 10.6h14v2.8h-14z"/></svg>'};function Hu(e){e=e||{};var o;this.b=!!e.vertical,this.ea=e.length||"16em",this.a=Fc(o=e.min)?o:0,this.i=zd(this.a,Fc(o=e.max)?o:100),this.wa=E(o=e.step)?1:o,this.l=Iu(this,Fc(o=e.value)?o:(this.a+this.i)/2),this.ag=A(this.ag,this),this.Wf=A(this.Wf,this),this.cg=A(this.cg,this),this.bg=A(this.bg,this),this.s=e.pointerArea,Y.call(this,"div","H_slider"+(this.b?"":" H_l_horizontal"))}u(Hu,Y),t("H.ui.base.Slider",Hu),Hu.prototype.wg=function(e,o){var s=this.b,h=s?"top":"left";return(!this.c||o)&&(e=ae(e,this.a,this.i),this.g&&(o=100*(e-this.a)/(this.i-this.a),s=(s?-1:1)*o,this.g.style[h]=s+"%",this.qa.style[h]=100+s+"%"),this.l=Iu(this,e)),this.l},Hu.prototype.setValue=Hu.prototype.wg,Hu.prototype.en=function(){return this.l},Hu.prototype.getValue=Hu.prototype.en;function Ju(e){if(!e.m){Bu(e.N(),"start",e.ag);var o=e.s;Bu(o,"move",e.Wf),Bu(o,"end",e.cg),Bu(o,"out",e.bg),e.m=!0}}function Ku(e){if(e.m){Cu(e.N(),"start",e.ag);var o=e.s;Cu(o,"move",e.Wf),Cu(o,"end",e.cg),Cu(o,"out",e.bg),e.m=!1}}function Iu(e,o){var s=e.wa;return o=ae(o,e.a,e.i),s?e.a+Ad((o-e.a)/s)*s:o}function Lu(e,o){var s=e.D,h=e.b;e.u||(e.u=s["offset"+(h?"Height":"Width")]),o-=ku(s)[h?"y":"x"],0>o&&(o=0),o=(e.i-e.a)*o/e.u,o=Iu(e,h?e.i-o:e.a+o),e.l!==o&&(e.wg(o,!0),e.dispatchEvent(new cj(e.A.ed,o,e.l)))}function Mu(e,o){return(o.touches?o.targetTouches[0]:o)["page"+(e.b?"Y":"X")]}function Nu(e){var o=!1,s=e.type;return s.indexOf("pointer")!==-1||s.indexOf("touch")!==-1?o=!0:C(e,MouseEvent)&&(o=e.which===1||e.buttons===1),o}function Ou(e){var o=e.touches;return o&&o.length===1||C(e,MouseEvent)}p=Hu.prototype,p.ag=function(e){var o=this.b;if(Nu(e)&&Ou(e)){var s=Mu(this,e),h=e.target;h===this.g||h.parentElement===this.g?(this.P=s-ku(this.g)[o?"y":"x"]-this.g.offsetWidth/2,this.N().className="H_slider H_slider_active"+(this.b?"":" H_l_horizontal"),this.c=!0):Lu(this,s),e.preventDefault()}},p.cg=function(){this.c&&(this.N().className="H_slider "+(this.b?"":" H_l_horizontal"),this.c=!1)},p.bg=function(e){this.c&&e.target===this.s&&(this.c=!1)},p.Wf=function(e){this.c&&Ou(e)&&(Nu(e)?(Lu(this,Mu(this,e)-this.P),e.preventDefault()):this.c=!1)},p.A={ed:"change"},p.X=function(e,o){var s=yu(o,"div","H_slider_cont"),h=yu(o,"div","H_slider_knob_cont"),d=yu(o,"div","H_slider_knob"),g=yu(o,"div","H_slider_knob_halo"),_=yu(o,"div","H_slider_track");o=yu(o,"div","H_slider_track H_slider_track_active"),e.appendChild(s),s.appendChild(_),_.appendChild(o),s.appendChild(h),h.appendChild(d),h.appendChild(g),this.D=_,this.qa=o,this.g=h,this.s||(this.s=e.ownerDocument.body),s.style[this.b?"height":"width"]=this.ea,this.wg(this.l),Ju(this)},Hu.prototype.renderInternal=Hu.prototype.X,Hu.prototype.o=function(){Ku(this)},Hu.prototype.va=function(e,o){return e?Ku(this):this.D&&Ju(this),Y.prototype.va.call(this,e,o)},Hu.prototype.setDisabled=Hu.prototype.va;var Pu={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};t("H.ui.LayoutAlignment",Pu);function Qu(e,o,s){Y.call(this,e,o),this.a=s?s.concat():[]}u(Qu,Y),t("H.ui.base.Container",Qu),Qu.prototype.va=function(e,o){var s=this.a?this.a.length:0;for(Y.prototype.va.call(this,e,o);s--;)this.a[s].va(e,o);return this},Qu.prototype.setDisabled=Qu.prototype.va,Qu.prototype.Ja=function(e){var o=this.N();return this.a.push(e),o&&(e.W(o.ownerDocument),o.appendChild(e.N())),this},Qu.prototype.addChild=Qu.prototype.Ja,Qu.prototype.dh=function(){return this.a.concat()},Qu.prototype.getChildren=Qu.prototype.dh,Qu.prototype.removeChild=function(e){var o=this.a.indexOf(e),s=this.N();0<=o&&(this.a.splice(o,1),s&&s.removeChild(e.N()))},Qu.prototype.removeChild=Qu.prototype.removeChild,Qu.prototype.na=function(){var e=this.N();e&&this.a.forEach(function(o){e.removeChild(o.N())}),this.a=[]},Qu.prototype.X=function(e,o){for(var s=0,h=this.a.length;s<h;s++)e.appendChild(this.a[s].W(o))},Qu.prototype.renderInternal=Qu.prototype.X,Qu.prototype.o=function(){this.na(),this.a.forEach(this.qa,this),Y.prototype.o.call(this)},Qu.prototype.qa=function(e){e.F()};function Ru(){Qu.call(this,"div","H_ctl"),this.map=null,this.Mc="top-left"}u(Ru,Qu),t("H.ui.Control",Ru),Ru.prototype.Ia=function(e){this.map=e},Ru.prototype.W=function(e){return Qu.prototype.W.call(this,e)},Ru.prototype.X=function(e,o){Qu.prototype.renderInternal.call(this,e,o),this.Vb(this.Mc)},Ru.prototype.renderInternal=Ru.prototype.X,Ru.prototype.Qe=function(){},Ru.prototype.onUnitSystemChange=Ru.prototype.Qe,Ru.prototype.Lb=function(){return this.map},Ru.prototype.getMap=Ru.prototype.Lb,Ru.prototype.pa=function(){return this.xa},Ru.prototype.getLocalization=Ru.prototype.pa,Ru.prototype.Ll=function(){return this.Mc},Ru.prototype.getAlignment=Ru.prototype.Ll,Ru.prototype.Vb=function(e){return typeof e=="string"&&Pu[e.replace("-","_").toUpperCase()]===e&&(this.Mc=e,this.dispatchEvent("alignmentchange")),this},Ru.prototype.setAlignment=Ru.prototype.Vb;function Su(e){e=e||{};var o=e.slider;Ru.call(this),this.s=A(this.s,this),this.g=A(this.g,this),this.b=A(this.b,this),o&&(this.u=A(this.u,this),this.D=o,this.wa=e.sliderSnaps,this.Ka("H_zoom_slider")),this.i=new Eu({label:Gu.in,onStateChange:this.s}),this.m=new Eu({label:Gu.out,onStateChange:this.s}),this.Ka("H_zoom"),this.Ka("H_grp"),this.ea=e.fractionalZoom!==!1,this.setZoomSpeed(e.zoomSpeed||4),this.Vb(e.alignment||"right-middle")}u(Su,Ru),t("H.ui.ZoomControl",Su),Su.prototype.kn=function(){return this.P},Su.prototype.getZoomSpeed=Su.prototype.kn,Su.prototype.Do=function(e){this.P=e},Su.prototype.setZoomSpeed=Su.prototype.Do,Su.prototype.Ia=function(e){this.map!==e&&(this.map&&this.map.removeEventListener("mapviewchange",this.g),Tu(this)),Ru.prototype.Ia.apply(this,arguments),this.map&&(this.b(),e.addEventListener("mapviewchange",this.g),e.addEventListener("baselayerchange",this.b))},Su.prototype.setMap=Su.prototype.Ia,Su.prototype.o=function(){Ru.prototype.o.apply(this,arguments),this.map.removeEventListener("baselayerchange",this.b),Tu(this)},Su.prototype.X=function(e,o){Ru.prototype.renderInternal.call(this,e,o),this.i.jc(this.pa().translate("zoom.in")),this.m.jc(this.pa().translate("zoom.out"))},Su.prototype.renderInternal=Su.prototype.X,Su.prototype.Vb=function(e){var o=this.Mc;return Ru.prototype.Vb.call(this,e),o!==e&&this.b(),this},Su.prototype.setAlignment=Su.prototype.Vb,Su.prototype.g=function(){var e=this.map,o=e.pb(),s=e.Xa()-1;e=e.g||e.f.getCapabilities().lookAt.zoom,this.D&&this.c.wg(o),this.dc()||(this.i.va(o+s>=e.max),this.m.va(o<=e.min))},Su.prototype.va=function(e,o){return Su.j.va.call(this,e,o),this.g(),this},Su.prototype.setDisabled=Su.prototype.va;function Tu(e){e.removeChild(e.c),e.c=null,e.l&&(e.l.removeEventListener("minchange",e.b),e.l.removeEventListener("maxchange",e.b),e.l=null)}Su.prototype.s=function(e){e=e.target;var o=e===this.i?1:-1,s=0<o?Math.ceil:Math.floor,h=this.map,d,g=this;h&&(e.getState()==="down"?(h.c.startControl(),h.c.control(0,0,o*this.P,0,0,0)):h.c.endControl(!0,function(_){d=g.ea?_.zoom:s(_.zoom),_.zoom=d}))},Su.prototype.u=function(e){this.map&&this.map.df(e.newValue)},Su.prototype.b=function(){var e=this.Mc,o=this.Lb();if(/^top/g.test(e)||/^bottom/g.test(e)){var s=this.m;e=this.i;var h=!1}else s=this.i,e=this.m,h=!0;if(this.removeChild(s),this.removeChild(e),this.Ja(s),this.D&&o){Tu(this),o=h;var d=(h=(s=this.map)&&s.g)||s.f.getCapabilities().lookAt.zoom;(this.l=h)&&(h.addEventListener("minchange",this.b),h.addEventListener("maxchange",this.b)),this.c=new Hu({step:this.wa?1:0,vertical:o,min:d.min,max:d.max,value:s.pb(),pointerArea:s.N()}),this.c.addEventListener(this.c.A.ed,this.u),this.Ja(this.c)}this.Ja(e)};function Uu(e,o){var s={},h={};s["top-left"]=yu(o,"div",[Vu,Wu].join(" ")),s["top-center"]=yu(o,"div",[Vu,Xu,Yu,Wu].join(" ")),s["top-right"]=yu(o,"div",[Vu,Wu].join(" ")),s["left-top"]=yu(o,"div",[Vu,Zu].join(" ")),s["left-middle"]=yu(o,"div",[Vu,$u,av,Zu].join(" ")),s["left-bottom"]=yu(o,"div",[Vu,Zu].join(" ")),s["right-top"]=yu(o,"div",[Vu,Zu].join(" ")),s["right-middle"]=yu(o,"div",[Vu,bv,av,Zu].join(" ")),s["right-bottom"]=yu(o,"div",[Vu,Zu].join(" ")),s["bottom-left"]=yu(o,"div",[Vu,Wu].join(" ")),s["bottom-center"]=yu(o,"div",[Vu,cv,Yu,Wu].join(" ")),s["bottom-right"]=yu(o,"div",[Vu,Wu].join(" ")),h["top-left"]=yu(o,"div",[Xu,$u].join(" ")),h["top-right"]=yu(o,"div",[Xu,bv].join(" ")),h["bottom-left"]=yu(o,"div",[cv,$u].join(" ")),h["bottom-right"]=yu(o,"div",[cv,bv].join(" ")),zu(h["top-left"],s["top-left"],s["left-top"]),zu(h["top-right"],s["top-right"],s["right-top"]),zu(h["bottom-left"],s["left-bottom"],s["bottom-left"]),zu(h["bottom-right"],s["right-bottom"],s["bottom-right"]),zu(e,h["top-left"],h["top-right"],h["bottom-left"],h["bottom-right"],s["top-center"],s["left-middle"],s["right-middle"],s["bottom-center"]),this.a=s}var Xu="H_l_top",cv="H_l_bottom",$u="H_l_left",bv="H_l_right",Yu="H_l_center",av="H_l_middle",Wu="H_l_horizontal",Zu="H_l_vertical",Vu="H_l_anchor";Uu.prototype.update=function(){var e=this.a;dv(e["top-center"],!0),dv(e["bottom-center"],!0),dv(e["left-middle"],!1),dv(e["right-middle"],!1)};function dv(e,o){o?(o=e.offsetWidth,e.style.marginLeft=-Math.round(.5*o)+"px"):(o=e.offsetHeight,e.style.marginTop=-Math.round(.5*o)+"px")}Uu.prototype.put=function(e,o){e=e?e.N():null;var s=o?this.a[o]:null;e&&s&&(e.parentElement&&e.parentElement.removeChild(e),s.insertBefore(e,/(bottom|right)$/.test(o)||/(center|middle)/.test(o)&&s.childNodes.length%2?s.firstChild:null)),this.update()};var ev={IMPERIAL:"imperial",METRIC:"metric"};t("H.ui.UnitSystem",ev);var fv={btn:'<svg class="H_icon" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><g transform="translate(3 2)"><path d="m18 13v7h-18v-7h2v5h2v-2h2v2h2v-3h2v3h2v-2h2v2h2v-5z"></path><path d="m2.3.3c.7 0 1.3.1 1.8.4s.9.6 1.1 1 .4.9.4 1.4c0 .5-.1 1-.3 1.4s-.57 1-1 1.6-1.3 1.3-2.3 2.2h3.9l-.2 1.7h-6.16v-1.6c1.1-1.1 2-2 2.5-2.6s.9-1 1-1.4.3-.8.3-1.2c0-.4-.1-.7-.3-.9s-.5-.3-.9-.3c-.3 0-.6 0-.9.2s-.5.4-.8.7l-1.3-1c.4-.5.9-.9 1.4-1.2s1.2-.4 1.8-.4zm14.4 9.7h-2.3l-.2-3.8c 0-.9-.1-1.7-.1-2.4 0-.5 0-1 0-1.5l-1.5 6.7h-2.2l-1.6-6.7c.1.8.1 1.6.1 2.3 0 .5 0 1.1 0 1.7l-.2 3.8h-2.2l.7-9.7h2.9l1.5 6.6 1.4-6.6h2.9z"></path></g></g></svg>',point:'<svg height="22" viewBox="0 0 12 12" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m6 12c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6z" fill="#fff"></path><path d="m6 10c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z" fill="#2ed5c9" stroke="#272c36" stroke-width="2"></path></g></svg>'};function gv(e){Eu.call(this,e),this.i=function(o){o.preventDefault()},this.g=A(function(o){this.dc()||this.toggleState(),o.preventDefault()},this)}u(gv,Eu),t("H.ui.base.PushButton",gv),gv.prototype.X=function(e){Bu(e,"start",this.g),Bu(e,"end",this.i),this.Jc(this.Ge(),!0)},gv.prototype.renderInternal=gv.prototype.X,gv.prototype.Lo=function(){var e=Fu.DOWN;return this.O(this.getState()===e?Fu.UP:e),this},gv.prototype.toggleState=gv.prototype.Lo,gv.prototype.o=function(){var e=this.N();e&&Cu(e,"start",this.g),Eu.prototype.o.call(this)};function hv(e,o,s){bj.call(this,e,{icon:iv,visibility:s}),jv(this,o)}u(hv,bj);function jv(e,o){e.zn=o,e.S&&(e.S.textContent=o)}var iv=new Ti(yu(ru.document,"span","H_dm_label"),{onAttach:function(e,o,s){s.S=e,jv(s,s.zn)},onDetach:function(e,o,s){delete s.S}});function kv(e,o){F.call(this),this.b=e,this.f=new hv(this.Jo,""),o.push(this.f),this.a=new R({objects:o,data:this}),this.ug=this.ug.bind(this)}u(kv,F),p=kv.prototype,p.Wc=!1,p.Jo={lat:0,lng:0},p.Jc=function(e,o){jv(this.f,e),this.f.da(o)},p.Rh=0,p.ug=function(){this.f.qb(this.m)};function lv(e,o){o&&(e.nextSibling=o,o.previousSibling=e)}function mv(e,o,s,h){var d=new L,g=[];lv(e,this),lv(this,o),d.qd(e.ya()),d.qd(o.ya()),this.c=new th(d,{style:s.Wd}),this.i=new th(d,{style:{strokeColor:"transparent",lineWidth:Math.min(100,this.c.V().lineWidth+2*(h||5))}}),s.c&&(this.g=new th(d,{style:s.c}),g.push(this.g)),g.push(this.c,this.i),kv.call(this,s,g),this.s=this.l=-1,e=this.a,e.addEventListener("pointermove",this.J,!0,this),e.addEventListener("pointerleave",this.u,!0,this)}u(mv,kv),mv.prototype.Ee=function(){var e=this.c.ga();return e.ye(0).Wa(e.ye(1))};function nv(e,o,s){var h=e.c.ga();h.ff(3*+s,3,[o.lat,o.lng,0]),e.g&&e.g.da(h),e.i.da(h),e.c.da(h)}mv.prototype.J=function(e){var o=e.currentPointer;e=this.previousSibling.ya();var s=this.nextSibling.ya(),h=this.b.f,d=o.viewportX;o=o.viewportY,(this.l!==d||this.s!==o)&&(this.l=d,this.s=o,h.da(this.b.g(e,s,{x:d,y:o})),h.qb(!0))},mv.prototype.u=function(){this.b.f.qb()},mv.prototype.ni=function(){this.Jc(this.b.a(this.Ee()),this.c.K().bb())};function ov(e,o,s){s=o.b(s||0),this.c=new Rn(e,{icon:s,zIndex:0}),this.c.draggable=!0,kv.call(this,o,[this.c]),e=this.a,e.addEventListener("dragstart",this.Qn,!0,this),e.addEventListener("drag",this.Rn,!0,this),e.addEventListener("dragend",this.Pn,!0,this)}u(ov,kv),p=ov.prototype,p.hk=0,p.A={ed:"change"},p.Ee=function(){return this.hk},p.ya=function(){return this.c.ga()};function pv(e){var o=0;e.nextSibling&&e.previousSibling&&(e.nextSibling.Wc||e.previousSibling.Wc?e.nextSibling.Wc&&!e.previousSibling.Wc&&(o=2):o=1),o=e.b.b(o),e.c.Ic(o)}p.Rn=function(e){var o=e.currentPointer;e=o.viewportX,o=o.viewportY,(this.i!==e||this.l!==o)&&(this.i=e,this.l=o,this.c.da(this.b.map.Pa(e-this.g.x,o-this.g.y)),this.dispatchEvent(new ud(this.A.ed,this)))},p.Qn=function(e){var o=e.currentPointer,s=o.viewportX;o=o.viewportY;var h=this.b.map.Da(this.ya());this.c.fe(1),this.g={x:s-h.x,y:o-h.y},e.stopPropagation()},p.Pn=function(){this.c.fe(0)},p.ni=function(e){this.hk=e,this.Jc(this.b.a(e),this.ya())};function qv(e,o){this.Ca=o,this.b=e,this.a={Wc:!0},rv(this,this.a),this.$f=A(this.$f,this)}t("H.ui.distanceMeasurement.Model",qv),p=qv.prototype,p.Rf=function(){return this.a.nextSibling===this.a};function sv(e,o){e=e.a;for(var s=e.nextSibling;s!==e;){var h=s,d=s.previousSibling===e?!1:o;(h.m=d)?h.ug():(h.Rh&&x.clearTimeout(h.Rh),h.Rh=x.setTimeout(h.ug,100)),s=s.nextSibling}}function tv(e,o){var s=o||e.a.nextSibling,h=0,d=0;if(o&&!uv(e,o))throw new D(e.Xe,0,o);for(s instanceof ov?h=s.Ee():s instanceof mv&&(h=s.previousSibling.Ee()),o=s;o&&o!==e.a;o=o.nextSibling,d++)o.ni(h),d%2===1&&(h+=o.Ee())}p.ne=function(e){var o=this.a.previousSibling,s=this.Rf();return e=new ov(e,this.Ca,s?0:2),this.b.fa(e.a),lv(e,this.a),e.addEventListener(e.A.ed,this.$f),s?rv(this,e):(vv(this,o,e),pv(o),tv(this,o)),e},p.insertBefore=function(e,o){var s,h=1;if(o){if(!uv(this,o))throw new D(this.insertBefore,1,o);(s=o.previousSibling.Wc)&&(h=0),e=new ov(e,this.Ca,h),e.addEventListener(e.A.ed,this.$f),this.b.fa(e.a),s?(s=this.a.nextSibling,vv(this,e,s),rv(this,e),o=e,pv(s)):(s=o.previousSibling,o=s.previousSibling,h=s.nextSibling,this.b.Ga(s.a),vv(this,o,e),vv(this,e,h)),tv(this,o)}else e=this.ne(e);return e},p.na=function(){rv(this,this.a),this.b.na()},p.Xe=function(e){var o=this.a,s=e.previousSibling,h=e.nextSibling;if(!uv(this,e))throw new D(this.Xe,0,e);if(this.b.Ga(e.a),s===o){var d=h;d!==o?(e=d.nextSibling,rv(this,e),e.ni(0),pv(e),tv(this,e)):rv(this,this.a)}else h===o?(d=s,e=d.previousSibling,lv(e,o),pv(e)):s&&h&&(vv(this,s.previousSibling,h.nextSibling),this.b.rd([h.a,s.a]),tv(this,s.previousSibling));d&&d!==o&&this.b.Ga(d.a)};function uv(e,o){for(var s=e.a.nextSibling,h=!1;s!==e.a;){if(s===o){h=!0;break}s=s.nextSibling}return h}function vv(e,o,s){o=new mv(o,s,e.Ca),e.b.fa(o.a)}function rv(e,o){e.a.nextSibling=o,o.previousSibling=e.a}p.$f=function(e){e=e.target;var o=e.previousSibling,s=e.nextSibling,h=e.ya();if(!s.Wc){nv(s,h,!1);var d=e}o.Wc||(nv(o,h,!0),d=o.previousSibling),tv(this,d)};function wv(e){e=e||{};var o,s=e.lineStyle;Ru.call(this),this.s=new gv({label:fv.btn,onStateChange:A(this.Nn,this)}),this.Ja(this.s),(o=e.distanceFormatter)&&(this.oj=o),s&&(this.Xj=s,this.sk=B),this.Vb(e.alignment||"right-bottom"),this.g={},this.g[0]=e.startIcon,this.g[2]=e.endIcon,this.g[1]=e.stopoverIcon,this.g[3]=e.splitIcon}u(wv,Ru),t("H.ui.DistanceMeasurement",wv),p=wv.prototype,p.Qh=ev.METRIC,p.Xj={strokeColor:"rgb(39,44,54)",lineWidth:5},p.sk={strokeColor:"white",lineWidth:7};function xv(e){var o=e.map,s,h={};e.c||(e.l=new N,e.m=new tl(e.l,{pixelRatio:e.map.Xa()}),e.u=s=e.l.bc(),e.u.Vk(!0),s.addEventListener("dragstart",e.Ln,!0,e),s.addEventListener("dragend",e.ef,!0,e),s.addEventListener("pointerenter",e.ef,!0,e),s.addEventListener("pointerleave",e.Mn,!0,e),s.addEventListener("tap",e.co,!0,e),e.i=yv(e),h.a=A(e.oj,e),h.b=A(e.dk,e),h.g=A(e.Dj,e),h.map=e.map,h.f=e.i,h.Wd=e.Xj,h.c=e.sk,e.b=new qv(e.u,h),e.c=!0),e.i&&e.u.fa(e.i),o.addEventListener("tap",e.pk,!0,e),o.a.add(e.m)}function zv(e){var o=e.map;e.c&&(o.removeEventListener("tap",e.pk,!0,e),o.ae(e.m),e.b.na())}function yv(e){function o(){var j=s.yb();return j={anchor:s.kd().clone().scale(g).floor(),size:new Wi(Bd(j.w*g),Bd(j.h*g)),hitArea:h},new Wj(s.Qc(),j)}var s=e.dk(3),h=new Xi(Yi.NONE,[]),d,g=s===e.D?.5:1;if(s.getState()===1)var _=o();else _=new Wj("<svg/>",{hitArea:h}),s.addEventListener("statechange",function(){s.getState()===1&&d.Ic(o())});return d=new Rn(e.map.bb(),{visibility:!1,icon:_})}p.oj=function(e){var o="m",s=0;return this.Qh==="metric"?1e3<=e&&(e/=1e3,o="km",s=1):(e/=.3048,o="ft",5280<=e&&(e/=5280,o="mi",s=1)),e.toFixed(s)+" "+this.pa().translate("scale."+o)},p.Dj=function(e,o,s){var h=this.map.Da(e);return o=this.map.Da(o),s=new J(s.x,s.y).Cj(h,o),this.map.Pa(s.x,s.y)||ng(e)},p.X=function(e,o){var s=22*(this.map.f.type===kk.P2D?this.map.Xa():1),h=s/2;Ru.prototype.renderInternal.call(this,e,o),this.Qh=ev.METRIC,this.D=new Wj(fv.point,{anchor:{x:h,y:h},size:{w:s,h:s},hitArea:new Xi(Yi.CIRCLE,[h,h,h])}),this.s.jc(this.pa().translate("distance.measurement"))},wv.prototype.renderInternal=wv.prototype.X,p=wv.prototype,p.dk=function(e){return this.g[e]||this.D},p.ef=function(){sv(this.b,!0)},p.Ln=function(){sv(this.b)},p.Mn=function(e){e.currentPointer.type!=="touch"&&sv(this.b)},p.co=function(e){var o=e.currentPointer,s=e.target.Fa,h;s&&(s=s.getData())instanceof kv&&(h=s),s=h,e=e.originalEvent,e=e.metaKey||e.altKey,s&&(e&&s instanceof ov?this.b.Xe(s):s instanceof mv&&(e=s.previousSibling.ya(),h=s.nextSibling.ya(),o={x:o.viewportX,y:o.viewportY},this.b.insertBefore(this.Dj(e,h,o),s.nextSibling),this.i.qb()),this.ef())},p.pk=function(e){var o=e.currentPointer;e=e.target,e!==this.map&&e.getProvider&&e.getProvider()===this.l||(this.b.ne(this.map.Pa(o.viewportX,o.viewportY)),this.i.qb(),this.ef())},p.Nn=function(e){e.target.getState()==="down"?xv(this):zv(this)},p.Qe=function(e){this.Qh=e,this.c&&(tv(this.b),this.ef())},wv.prototype.onUnitSystemChange=wv.prototype.Qe,wv.prototype.o=function(){zv(this),this.c&&(this.l.F(),this.m.F()),wv.j.o.call(this)},wv.prototype.Ia=function(e){e?this.s.getState()===Fu.DOWN&&(this.map=e,xv(this)):(zv(this),this.c=!1),Ru.prototype.Ia.apply(this,arguments)},wv.prototype.setMap=wv.prototype.Ia;function Av(){this.C=Bv.CLOSED,Qu.call(this,"div","H_overlay")}u(Av,Qu),t("H.ui.base.OverlayPanel",Av),Av.prototype.O=function(e,o){return(e!==this.C||o)&&(this.C=e,e===Bv.OPEN?this.Ka("H_open"):this.kb("H_open")),this},Av.prototype.setState=Av.prototype.O,Av.prototype.getState=function(){return this.C},Av.prototype.getState=Av.prototype.getState,Av.prototype.xk=function(e){var o=e.Mc;e=e.N();var s=this.N(),h=s.style;if(this.kb("H_top"),this.kb("H_middle"),this.kb("H_bottom"),this.kb("H_left"),this.kb("H_center"),this.kb("H_right"),h.bottom=h.top=h.left=h.right=h.margin="",/top/g.test(o)){this.Ka("H_top"),h.top="0",h.margin="0 12px";var d=-1}else/bottom/g.test(o)?(this.Ka("H_bottom"),h.bottom="0",h.margin="0 12px",d=1):(this.Ka("H_middle"),h.top="50%",h.margin="0 12px",h.marginTop=-Math.round(.5*s.offsetHeight)+"px",d=0);/left/g.test(o)?(this.Ka("H_left"),h.left=e.offsetWidth+"px",h.marginLeft="12px"):/right/g.test(o)?(this.Ka("H_right"),h.right=e.offsetWidth+"px",h.marginRight="12px"):(this.Ka("H_center"),h.left="50%",0>d?(h.top=e.offsetHeight+"px",h.marginTop="12px"):0<d&&(h.bottom=e.offsetHeight+"px",h.marginBottom="12px"),h.marginLeft=-Math.round(.5*s.offsetWidth)+"px",e.appendChild(s))},Av.prototype.pointToControl=Av.prototype.xk;var Bv={OPEN:"open",CLOSED:"closed"};Av.State=Bv;function Cv(e){e=e||{},Qu.call(this,"div","H_rdo"),this.g=new Y("div","H_rdo_title"),this.b=new Qu("div","H_rdo_buttons"),this.Ja(this.g),this.Ja(this.b),this.i=A(function(o){o.target.getState()===Fu.DOWN?(this.Kk(o.target,!0),this.dispatchEvent(Dv)):o.target.O(Fu.DOWN,!0)},this),this.addEventListener("statechange",this.i),this.Ci(e.title||""),e.onActiveButtonChange&&this.addEventListener(Dv,e.onActiveButtonChange),e.buttonsOptions&&e.buttonsOptions.forEach(function(o){this.Gg(new gv(o))},this)}u(Cv,Qu),t("H.ui.base.RadioGroup",Cv);var Dv="activebuttonchange";Cv.prototype.X=function(e,o){Qu.prototype.renderInternal.call(this,e,o),this.Ci(this.c,!0)},Cv.prototype.renderInternal=Cv.prototype.X,Cv.prototype.na=function(){this.b.na()},Cv.prototype.Ci=function(e,o){return(e!==this.c||o)&&(this.c=e,this.g.N()&&(this.g.N().innerHTML=this.c)),this},Cv.prototype.setTitle=Cv.prototype.Ci,Cv.prototype.an=function(){return this.c},Cv.prototype.getTitle=Cv.prototype.an,Cv.prototype.Gg=function(e){if(!(e instanceof gv))throw Error("PushButton expected");return e.ka(this),this.b.Ja(e),this},Cv.prototype.addButton=Cv.prototype.Gg,Cv.prototype.ko=function(e){return this.b.removeChild(e),e.ka(null),this},Cv.prototype.removeButton=Cv.prototype.ko,Cv.prototype.Df=function(){return this.b.dh()},Cv.prototype.getButtons=Cv.prototype.Df,Cv.prototype.Kk=function(e,o){for(var s=this.Df(),h=s.length;h--;)s[h].O(s[h]===e?Fu.DOWN:Fu.UP,o)},Cv.prototype.setActiveButton=Cv.prototype.Kk,Cv.prototype.o=function(){this.removeEventListener("statechange",this.i),this.na(),Qu.prototype.o.call(this)};function Ev(e){e=e||{},Ru.call(this),this.i=new Av,this.b=this.b.bind(this),this.s=this.s.bind(this),this.m=this.m.bind(this),this.Vb(e.alignment||"bottom-right"),Fv(this,e.baseLayers,e.layers)}u(Ev,Ru),t("H.ui.MapSettingsControl",Ev);function Gv(e,o){var s=[];return e.concat(o).forEach(function(h){s=s.concat(h.layer)}),s}function Hv(e,o,s){var h=e.Lb();if(h){e=Gv(e.c,e.g);var d=Gv(o,s);e.forEach(function(g){d.includes(g)||h.ae(g)})}}function Fv(e,o,s){Hv(e,o,s),e.D=NaN,e.c=Bc(o)?o:[],e.g=Bc(s)?s:[],e.l&&(e.l.na(),e.u.na(),Iv(e))}Ev.prototype.ta=function(){var e=this.Lb();e&&(e.addEventListener("tap",this.s),e=e.a,e.addEventListener("add",this.b),e.addEventListener("remove",this.b),e.addEventListener("set",this.b))},Ev.prototype.T=function(){var e=this.Lb();e&&(e.removeEventListener("tap",this.s),e=e.a,e.removeEventListener("add",this.b),e.removeEventListener("remove",this.b),e.removeEventListener("set",this.b))},Ev.prototype.X=function(e,o){var s=this.pa().translate("layers.choose");Ru.prototype.renderInternal.call(this,e,o),this.ta(),this.P=new gv({tooltip:s,label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.7,14.6 L4.5,16 L12,20.6 L19.5,16 L17.3,14.6 L19.1,13.5 L23,16 L12,23 L1,16 L4.9,13.5 L6.7,14.6 Z M12,2 L23,9 L12,16 L1,9 L12,2 Z"></path></svg>',onStateChange:A(function(h){h.target.getState()===Fu.DOWN?(this.i.O(Bv.OPEN),this.i.xk(this)):this.i.O(Bv.CLOSED)},this)}),Ev.prototype.wa=function(h){if(this.map.f.type===Qn){var d=H.map.render.harp.Style;h=[].concat(h);for(var g=0;!j&&g<h.length;g++){var _=h[g].ca();if(_.Sb()&&_.V){_=_.V();var j=_.getConfig()||_.getUrl()}}if(j){var $=function(_t){_t=_t.ca(),_t.Sb()&&_t.V&&_t.V()instanceof d&&_t.gb(new d(j))};this.g.forEach(function(_t){_t=_t.layer,Bc(_t)?_t.forEach($):_t&&$(_t)})}}},this.l=new Cv({title:s,onActiveButtonChange:(function(){var h=this.D;t:{for(var d=this.l.Df(),g=d.length;g--;)if(d[g].getState()===Fu.DOWN){d=d[g];break t}d=null}if(d=d.getData(),d=this.c[d].layer,g=Bc(d),this.map.ud(g?d[0]:d),(h=this.c[h])&&(h=h.layer,Bc(h)))for(var _=h.length;1<_--;)this.map.ae(h[_]);if(g)for(h=d.length;1<h--;)this.map.nf(d[h],1);this.wa(d),this.m()}).bind(this)}),this.u=new Qu("div","H_grp"),this.ea=new Y("div","H_separator"),this.Ja(this.P),this.Ja(this.i),this.i.Ja(this.l),this.i.Ja(this.ea),this.i.Ja(this.u),Iv(this)},Ev.prototype.renderInternal=Ev.prototype.X;function Iv(e){var o=e.pa();e.c.forEach(function(s,h){var d=s.layer;this.l.Gg(new gv({label:Jv(o,s.label),data:h,disabled:!d||Bc(d)&&!d.length}))},e),e.g.forEach(function(s,h){var d=s.layer;this.u.Ja(new gv({label:Jv(o,s.label),onStateChange:this.sb.bind(this,s.layer),data:h,disabled:!d||Bc(d)&&!d.length}))},e),e.ea.qb(!(!e.g.length||!e.c.length)),x.setTimeout((function(){this.map&&(this.b(),this.P.va(!(this.c&&this.c.length||this.g&&this.g.length)))}).bind(e))}Ev.prototype.b=function(){var e=this.map.g,o=this.map.a;this.D=NaN,this.c.forEach(function(s,h){s=s.layer,s=e===(Bc(s)?s[0]:s),this.l.Df()[h].O(Fu[s?"DOWN":"UP"],!0),s&&(this.D=h)},this),this.g.forEach(function(s,h){s=s.layer;var d=Bc(s);h=this.u.dh()[h],!s||d&&!s.length?h.va(!0):h.O(Fu[o.indexOf(d?s[0]:s)!==-1?"DOWN":"UP"],!0)},this)},Ev.prototype.sb=function(e,o){e=Bc(e)?e:[e],o=o.target.getState()===Fu.DOWN;for(var s=0;s<e.length;s++)o?this.map.nf(e[s]):this.map.ae(e[s]);this.m()},Ev.prototype.m=function(){var e=Kv(this);e&&(e.Bg.ca().V().Oe(e.ca().V().qc()),this.map.ae(e),e.F(),delete e.Bg),Lv(this)&&Mv(this,this.map.g)};function Mv(e,o){var s=window.H.service&&window.H.service.omv.Provider,h=o.ca();if(s&&o.ca()instanceof s&&h.V().xe){var d=h.V(),g=(function(){var _=Nv.ground.filter(function(_t){return!!d.kh("layers."+_t)}),j=Nv.water.filter(function(_t){return!!d.kh("layers."+_t)});if(_.concat(j).length){var $={};$h($,d.xe(_)),$h($,d.xe(j,!1,!0)),delete $.global,_=new ti($,d.Ib()),_=h.s().$b(_),_.Bg=o,this.map.nf(_)}d.removeEventListener(Zh.CHANGE,g)}).bind(e);d.getState()!==Xh.READY?d.addEventListener(Zh.CHANGE,g):g()}}function Kv(e){return iu(e.map.a.La(),function(o){return!!o.Bg})}function Lv(e){e=e.map.a.La();var o=window.H.service&&window.H.service.traffic.flow.Provider;return!!o&&e.some(function(s){return s.ca()instanceof o})}var Nv={water:["water.water-labels"],ground:"road_labels continent_label island_label roads.shields roads.directions truck-restriction.signs places landuse.label".split(" ")};function Jv(e,o){return/^layers?/.test(o)&&e.Nf(o)?e.translate(o):o}Ev.prototype.s=function(){this.P.O(Fu.UP)},Ev.prototype.o=function(){Ev.j.o.call(this),this.T()};var Ov=[];t("H.ui.i18n.defaultLocales",Ov);var Pv={},Qv=[];function Rv(e,o){Pv[e]=o,Ov.indexOf(e)===-1&&Ov.push(e),Qv.length?Sv(e,o):Qv=Object.keys(o)}function Sv(e,o){for(var s=Qv,h=s.length,d;h--;)if(d=s[h],!o[d])throw Error("'"+d+"' key missing in translation map for "+e)}function Tv(e){e=e||{},Ru.call(this),this.c=new gv({label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><g transform="translate(1 3)"><path fill-rule="nonzero" d="M5,0 L5,2 L2,2 L2,16 L5,16 L5,18 L2,18 C0.9,18 0,17 0,15.75 L0,2.25 C0,1 0.9,0 2,0 L5,0 Z M17,0 L20,0 C21.1,0 22,1 22,2.25 L22,15.75 C22,17 21.1,18 20,18 L17,18 L17,16 L20,16 L20,2 L17,2 L17,0 Z"></path><rect width="10" height="2" x="6" y="8"></rect><rect width="2" height="10" x="10" y="4"></rect></g></svg>',onStateChange:A(this.On,this)}),this.Ja(this.c),this.Vb(e.alignment||"right-bottom")}u(Tv,Ru),t("H.ui.ZoomRectangle",Tv),p=Tv.prototype,p.On=function(e){var o=this.map,s=o.b.element;e.target.getState()===Fu.DOWN?(o.addEventListener("dragstart",this.fk,!0,this),o.addEventListener("drag",this.gk,!0,this),o.addEventListener("dragend",this.ek,!0,this),e=s.ownerDocument.createElement("div"),e.className="H_zoom_lasso",s.appendChild(e),this.b=e):(o.removeEventListener("dragstart",this.fk,!0,this),o.removeEventListener("drag",this.gk,!0,this),o.removeEventListener("dragend",this.ek,!0,this),s.removeChild(this.b))},p.fk=function(e){var o=this.b.style,s=e.currentPointer,h=s.viewportX;s=s.viewportY,e.target===this.map&&(e.stopPropagation(),o.width="0px",o.height="0px",o.top=s+"px",o.left=h+"px",o.display="block",this.i=s,this.g=h)},p.gk=function(e){var o=e.currentPointer,s=o.viewportX,h=o.viewportY;o=this.g;var d=this.i,g=this.b.style;e.target===this.map&&(e.stopPropagation(),e=s-o,s=h-d,g.left=o+(0>e?e:0)+"px",g.top=d+(0>s?s:0)+"px",g.width=Math.abs(e)+"px",g.height=Math.abs(s)+"px")},p.ek=function(e){var o=this.map,s=e.currentPointer;e.target===this.map&&(e.stopPropagation(),this.b.style.display="none",o.c.Wb({bounds:tg([o.Pa(this.g,this.i),o.Pa(s.viewportX,s.viewportY)])},!0))},p.X=function(e,o){Ru.prototype.renderInternal.call(this,e,o),this.c.jc(this.pa().translate("zoom.rectangle"))},Tv.prototype.renderInternal=Tv.prototype.X,Rv("nl-NL",{"layers.normal":"Kaartweergave","layers.satellite":"Satelliet","layers.terrain":"Terrein","layer.transit":"Openbaar vervoer","layer.traffic":"Verkeerssituatie","layer.incidents":"Toon verkeersincidenten","layers.choose":"Weergave kiezen",minimap:"Minimap","scale.switchToImperial":"Overgaan naar mijlen","scale.switchToMetric":"Wijzigen naar km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Uitzoomen","zoom.in":"Inzoomen","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Openbaar vervoer","traffic.MISCELLANEOUS":"Diversen","traffic.ACCIDENT":"Ongeval","traffic.OTHER_NEWS":"Meer informatie","traffic.OTHER":"Meer informatie","traffic.PLANNED_EVENT":"Geplande afzetting","traffic.ROAD_HAZARD":"Gevaar op de weg","traffic.ROAD_CLOSURE":"Rijbaan afgesloten","traffic.WEATHER":"Weer","traffic.CONGESTION":"Verkeersopstopping","traffic.CONSTRUCTION":"Wegwerkzaamheden","traffic.DISABLED_VEHICLE":"Voertuig met pech","traffic.LANE_RESTRICTION":"Rijstrookbeperking","traffic.from":"Begintijd:","traffic.until":"Geschatte eindtijd:","distance.measurement":"Measure distance"}),Rv("pt-PT",{"layers.normal":"Vista do mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transportes públicos","layer.traffic":"Condições de trânsito","layer.incidents":"Mostrar incidentes de trânsito","layers.choose":"Escolher vista",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Diminuir","zoom.in":"Aumentar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transportes públicos","traffic.MISCELLANEOUS":"Diversos","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notícias","traffic.OTHER":"Outras notícias","traffic.PLANNED_EVENT":"Evento planeado","traffic.ROAD_HAZARD":"Perigo na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Meteorologia","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construção","traffic.DISABLED_VEHICLE":"Veículo avariado","traffic.LANE_RESTRICTION":"Limitação da faixa de rodagem","traffic.from":"Hora de início:","traffic.until":"Hora de fim prevista:","distance.measurement":"Measure distance"}),Rv("ru-RU",{"layers.normal":"Режим карты","layers.satellite":"Спутниковая","layers.terrain":"Местность","layer.transit":"Общественный транспорт","layer.traffic":"Дорожные условия","layer.incidents":"Показать дорожные события","layers.choose":"Выберите вид",minimap:"Minimap","scale.switchToImperial":"Использовать мили","scale.switchToMetric":"Использовать километры","scale.km":"км","scale.m":"м","scale.mi":"миль","scale.ft":"фут","zoom.out":"Отдалить","zoom.in":"Приблизить","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Общественный транспорт","traffic.MISCELLANEOUS":"Прочее ДТП","traffic.ACCIDENT":"ДТП","traffic.OTHER_NEWS":"Другие новости","traffic.OTHER":"Другие новости","traffic.PLANNED_EVENT":"Плановое мероприятие","traffic.ROAD_HAZARD":"Дорожная опасность","traffic.ROAD_CLOSURE":"Дорога закрыта","traffic.WEATHER":"Погода","traffic.CONGESTION":"Пробка","traffic.CONSTRUCTION":"Ремонт","traffic.DISABLED_VEHICLE":"Неисправный автомобиль","traffic.LANE_RESTRICTION":"Ограничение полосы движения","traffic.from":"Время начала:","traffic.until":"Ожидаемое время окончания:","distance.measurement":"Измерить расстояние"}),Rv("fi-FI",{"layers.normal":"Karttanäkymä","layers.satellite":"Satelliitti","layers.terrain":"Maasto","layer.transit":"Julkinen liikenne","layer.traffic":"Liikenneolosuhteet","layer.incidents":"Näytä liikennetapahtumat","layers.choose":"Valitse näkymä",minimap:"Minimap","scale.switchToImperial":"Vaihda maileihin","scale.switchToMetric":"Vaihda kilometreihin","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Loitonna","zoom.in":"Lähennä","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Julkinen liikenne","traffic.MISCELLANEOUS":"Erittelemätön syy","traffic.ACCIDENT":"Onnettomuus","traffic.OTHER_NEWS":"Muu tapahtuma","traffic.OTHER":"Muu tapahtuma","traffic.PLANNED_EVENT":"Suunniteltu tapahtuma","traffic.ROAD_HAZARD":"Vaara tiellä","traffic.ROAD_CLOSURE":"Tie suljettu","traffic.WEATHER":"Sää","traffic.CONGESTION":"Ruuhka","traffic.CONSTRUCTION":"Rakennustyö","traffic.DISABLED_VEHICLE":"Pysähtynyt ajoneuvo","traffic.LANE_RESTRICTION":"Kaista rajoitus","traffic.from":"Alkamisaika:","traffic.until":"Arvioitu päättymisaika:","distance.measurement":"Measure distance"}),Rv("pt-BR",{"layers.normal":"Exibição do mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transporte público","layer.traffic":"Condições do trânsito","layer.incidents":"Mostrar incidentes no trânsito","layers.choose":"Escolher exibição",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"milhas","scale.ft":"pés","zoom.out":"Menos zoom","zoom.in":"Mais zoom","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte público","traffic.MISCELLANEOUS":"Miscelânea","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notícias","traffic.OTHER":"Outras notícias","traffic.PLANNED_EVENT":"Evento planejado","traffic.ROAD_HAZARD":"Risco na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Clima","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construção","traffic.DISABLED_VEHICLE":"Veículo incapacitado","traffic.LANE_RESTRICTION":"Restrição de pista","traffic.from":"Hora de início:","traffic.until":"Tempo final estimado:","distance.measurement":"Measure distance"}),Rv("zh-CN",{"layers.normal":"地图视图","layers.satellite":"卫星","layers.terrain":"地形","layer.transit":"公共交通","layer.traffic":"交通情况","layer.incidents":"显示交通事件","layers.choose":"选择视图",minimap:"Minimap","scale.switchToImperial":"切换为「英里」","scale.switchToMetric":"切换为「公里」","scale.km":"公里","scale.m":"米","scale.mi":"英里","scale.ft":"英尺","zoom.out":"缩小","zoom.in":"放大","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"公共交通","traffic.MISCELLANEOUS":"综合事件","traffic.ACCIDENT":"交通意外","traffic.OTHER_NEWS":"其他新闻","traffic.OTHER":"其他新闻","traffic.PLANNED_EVENT":"预定事件","traffic.ROAD_HAZARD":"道路危险","traffic.ROAD_CLOSURE":"道路已关闭","traffic.WEATHER":"天气","traffic.CONGESTION":"堵塞","traffic.CONSTRUCTION":"施工","traffic.DISABLED_VEHICLE":"车辆抛锚","traffic.LANE_RESTRICTION":"车道限制","traffic.from":"开始时间：","traffic.until":"预计结束时间：","distance.measurement":"Measure distance"}),Rv("es-ES",{"layers.normal":"Mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transporte público","layer.traffic":"Estado del tráfico","layer.incidents":"Mostrar incidentes de tráfico","layers.choose":"Elija una vista",minimap:"Minimap","scale.switchToImperial":"Cambiar a millas","scale.switchToMetric":"Cambiar a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Alejar","zoom.in":"Acercar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte público","traffic.MISCELLANEOUS":"Varios","traffic.ACCIDENT":"Accidente","traffic.OTHER_NEWS":"Más noticias","traffic.OTHER":"Más noticias","traffic.PLANNED_EVENT":"Acto programado","traffic.ROAD_HAZARD":"Riesgo en carretera","traffic.ROAD_CLOSURE":"Carretera cerrada","traffic.WEATHER":"Tiempo","traffic.CONGESTION":"Atasco","traffic.CONSTRUCTION":"Construcción","traffic.DISABLED_VEHICLE":"Vehículo averiado","traffic.LANE_RESTRICTION":"Restricción de carril","traffic.from":"Inicio:","traffic.until":"Finalización estimada:","distance.measurement":"Measure distance"}),Rv("fr-FR",{"layers.normal":"Carte","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Transports publics","layer.traffic":"Conditions de circulation","layer.incidents":"Afficher les incidents de circulation","layers.choose":"Choisir la vue",minimap:"Minimap","scale.switchToImperial":"Passer en miles","scale.switchToMetric":"Passer en km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom arrière","zoom.in":"Zoom avant","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transports publics","traffic.MISCELLANEOUS":"Divers","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Autre","traffic.OTHER":"Autre","traffic.PLANNED_EVENT":"Événement prévu","traffic.ROAD_HAZARD":"Danger routier","traffic.ROAD_CLOSURE":"Chaussée fermée","traffic.WEATHER":"Météo","traffic.CONGESTION":"Embouteillage","traffic.CONSTRUCTION":"Travaux","traffic.DISABLED_VEHICLE":"Véhicule en panne","traffic.LANE_RESTRICTION":"Restriction de voie","traffic.from":"Date ou heure de début:","traffic.until":"Date et heure de fin estimées:","distance.measurement":"Measure distance"}),Rv("pl-PL",{"layers.normal":"Widok mapy","layers.satellite":"Satelita","layers.terrain":"Teren","layer.transit":"Transport publiczny","layer.traffic":"Warunki drogowe","layer.incidents":"Pokaż zdarzenia drogowe","layers.choose":"Wybierz widok",minimap:"Minimap","scale.switchToImperial":"Zmień na mile","scale.switchToMetric":"Zmień na km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Oddal","zoom.in":"Przybliż","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transport publiczny","traffic.MISCELLANEOUS":"Inne zdarzenie","traffic.ACCIDENT":"Wypadek","traffic.OTHER_NEWS":"Inne wiadomości","traffic.OTHER":"Inne wiadomości","traffic.PLANNED_EVENT":"Zdarzenie planowane","traffic.ROAD_HAZARD":"Niebezpieczeństwo na drodze","traffic.ROAD_CLOSURE":"Jezdnia zamknięta","traffic.WEATHER":"Pogoda","traffic.CONGESTION":"Korek","traffic.CONSTRUCTION":"Budowa","traffic.DISABLED_VEHICLE":"Uszkodzony pojazd","traffic.LANE_RESTRICTION":"Ograniczenie pasa ruchu","traffic.from":"Data rozpoczęcia:","traffic.until":"Przybliżona data zakończenia:","distance.measurement":"Measure distance"}),Rv("de-DE",{"layers.normal":"Kartenansicht","layers.satellite":"Satellit","layers.terrain":"Gelände","layer.transit":"Öffentliche Verkehrsmittel","layer.traffic":"Verkehrslage","layer.incidents":"Verkehrsstörungen anzeigen","layers.choose":"Ansicht auswählen",minimap:"Minimap","scale.switchToImperial":"Umrechnung in Meilen","scale.switchToMetric":"Umrechnung in Kilometer","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Verkleinern","zoom.in":"Vergrößern","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Öffentliche Verkehrsmittel","traffic.MISCELLANEOUS":"Diverse","traffic.ACCIDENT":"Unfall","traffic.OTHER_NEWS":"Anderes Ereignis","traffic.OTHER":"Anderes Ereignis","traffic.PLANNED_EVENT":"Geplantes Ereignis","traffic.ROAD_HAZARD":"Verkehrshindernis","traffic.ROAD_CLOSURE":"Fahrbahn gesperrt","traffic.WEATHER":"Wetter","traffic.CONGESTION":"Verkehrsstau","traffic.CONSTRUCTION":"Baustelle","traffic.DISABLED_VEHICLE":"Liegengebliebenes Fahrzeug","traffic.LANE_RESTRICTION":"Fahrstreifensperrung","traffic.from":"Beginn:","traffic.until":"Voraussichtliches Ende:","distance.measurement":"Measure distance"}),Rv("tr-TR",{"layers.normal":"Harita görünümü","layers.satellite":"Uydu","layers.terrain":"Arazi","layer.transit":"Toplu ulaşım","layer.traffic":"Trafik durumları","layer.incidents":"Trafik olaylarını göster","layers.choose":"Görünüm seç",minimap:"Minimap","scale.switchToImperial":"Mile dönüştür","scale.switchToMetric":"Kilometreye dönüştür","scale.km":"km","scale.m":"m","scale.mi":"mil","scale.ft":"ft","zoom.out":"Uzaklaştır","zoom.in":"Yakınlaştır","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Toplu ulaşım","traffic.MISCELLANEOUS":"Çeşitli","traffic.ACCIDENT":"Kaza","traffic.OTHER_NEWS":"Diğer haberler","traffic.OTHER":"Diğer haberler","traffic.PLANNED_EVENT":"Planlı etkinlik","traffic.ROAD_HAZARD":"Yol tehlikesi","traffic.ROAD_CLOSURE":"Yol kapalı","traffic.WEATHER":"Hava durumu","traffic.CONGESTION":"Yoğunluk","traffic.CONSTRUCTION":"Yol çalışması","traffic.DISABLED_VEHICLE":"Araç arızası","traffic.LANE_RESTRICTION":"Şerit kısıtlaması","traffic.from":"Başlangıç zamanı:","traffic.until":"Tahmini bitiş zamanı:","distance.measurement":"Measure distance"}),Rv("it-IT",{"layers.normal":"Vista mappa","layers.satellite":"Satellite","layers.terrain":"Terreno","layer.transit":"Mezzi pubblici","layer.traffic":"Condizioni del traffico","layer.incidents":"Mostra incidenti stradali","layers.choose":"Scegli vista",minimap:"Minimap","scale.switchToImperial":"Passa a miglia","scale.switchToMetric":"Passa a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom indietro","zoom.in":"Zoom avanti","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Mezzi pubblici","traffic.MISCELLANEOUS":"Varie","traffic.ACCIDENT":"Incidente","traffic.OTHER_NEWS":"Altre notizie","traffic.OTHER":"Altre notizie","traffic.PLANNED_EVENT":"Evento pianificato","traffic.ROAD_HAZARD":"Strada dissestata","traffic.ROAD_CLOSURE":"Strada chiusa","traffic.WEATHER":"Maltempo","traffic.CONGESTION":"Ingorgo","traffic.CONSTRUCTION":"Lavori in corso","traffic.DISABLED_VEHICLE":"Veicolo in panne","traffic.LANE_RESTRICTION":"Restrizione di corsia","traffic.from":"Ora di inizio:","traffic.until":"Ora di fine stimata:","distance.measurement":"Measure distance"}),Rv("en-US",{"layers.normal":"Map view","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Public transport","layer.traffic":"Traffic conditions","layer.incidents":"Show traffic incidents","layers.choose":"Choose view",minimap:"Minimap","scale.switchToImperial":"Change to miles","scale.switchToMetric":"Change to km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom out","zoom.in":"Zoom in","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Public transport","traffic.MISCELLANEOUS":"Miscellaneous","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Other news","traffic.OTHER":"Other news","traffic.PLANNED_EVENT":"Planned event","traffic.ROAD_HAZARD":"Road hazard","traffic.ROAD_CLOSURE":"Roadway closed","traffic.WEATHER":"Weather","traffic.CONGESTION":"Congestion","traffic.CONSTRUCTION":"Construction","traffic.DISABLED_VEHICLE":"Disabled vehicle","traffic.LANE_RESTRICTION":"Lane restriction","traffic.from":"Start time:","traffic.until":"Estimated end time:","distance.measurement":"Measure distance"});function Uv(e,o){if(!Cc(e))throw new TypeError("string locale code required");if(Ea(o))Sv(e,o);else{if(Ov.indexOf(e)===-1)throw Error("Default locale '"+e+"' does nto exist.");o=Pv[e]}this.b=o||{},this.a=e}t("H.ui.i18n.Localization",Uv),Uv.prototype.zm=function(){return this.a},Uv.prototype.getLocale=Uv.prototype.zm,Uv.prototype.sm=function(){return Object.keys(this.b)},Uv.prototype.getKeys=Uv.prototype.sm,Uv.prototype.Nf=function(e){return!(!this.b||!this.b[e])},Uv.prototype.hasKey=Uv.prototype.Nf,Uv.prototype.translate=function(e){var o=this.b[e];if(!Cc(o))throw Error("Translation missing for key '"+e+"'.");return o},Uv.prototype.translate=Uv.prototype.translate;function Vv(e){e=e||{},Ru.call(this),this.Ka("H_scalebar"),this.Vb(e.alignment||"right-bottom"),this.m=150,this.update=A(this.update,this),this.i=this.g=this.b=this.c=null}u(Vv,Ru),t("H.ui.ScaleBar",Vv),Vv.prototype.X=function(e,o){Ru.prototype.renderInternal.call(this,e,o),e.innerHTML='<svg height="12" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline style="fill:none; stroke:white; stroke-width:4" points="2,2 2,10 98,10 98,2"/><polyline style="fill:none; stroke:black; stroke-width:2" points="2,2 2,10 98,10 98,2"/></svg><div style="padding: 0 0 0 10px"></div>',e.style.direction="ltr",this.c=e.firstChild,o=this.c.childNodes,this.b=o[0],this.g=o[1],this.i=e.lastChild,this.l=ev.METRIC,this.s=A(function(s){this.dc()||(this.dispatchEvent("toggleunitsystem"),s.preventDefault())},this),this.u=A(function(s){s.preventDefault()},this),Bu(e,"start",this.u),Bu(e,"end",this.s),this.jc(this.pa().translate("scale.switchToImperial")),this.update()},Vv.prototype.renderInternal=Vv.prototype.X,Vv.prototype.Ia=function(e){this.map&&this.map.removeEventListener("mapviewchange",this.update),e&&e.addEventListener("mapviewchange",this.update),Ru.prototype.Ia.apply(this,arguments)},Vv.prototype.setMap=Vv.prototype.Ia,Vv.prototype.capture=function(e,o,s){var h=this.N(),d=h.ownerDocument,g=d.createElement("canvas"),_=g.getContext("2d"),j=d.createElementNS("http://www.w3.org/2000/svg","svg"),$=d.createElementNS("http://www.w3.org/2000/svg","foreignObject"),_t=lf(h,d,!1);d=parseFloat(h.offsetWidth)+1;var _e=parseFloat(h.offsetHeight),_r=d*e;e*=_e,g.width=_r,g.height=e,j.setAttribute("xmlns","http://www.w3.org/2000/svg"),j.setAttribute("width",_r),j.setAttribute("height",e),j.setAttribute("viewBox","0 0 "+d+" "+_e),$.setAttribute("width","100%"),$.setAttribute("height","100%"),j.appendChild($),_t.setAttribute("width","100%"),_t.setAttribute("height","100%"),_t.setAttribute("xmlns","http://www.w3.org/1999/xhtml");var _n=window.getComputedStyle(h);"box-shadow display align-items font font-family font-size height text-shadow direction".split(" ").forEach(function(_o){_t.style.setProperty(_o,_n.getPropertyValue(_o))}),$.appendChild(_t),h=bf(j.outerHTML),new tf("image",h).then(function(_o){_.drawImage(_o,0,0),o(g)},s)},Vv.prototype.capture=Vv.prototype.capture,Vv.prototype.Qe=function(e){this.l=e,this.jc(e==="imperial"?this.pa().translate("scale.switchToMetric"):this.pa().translate("scale.switchToImperial")),this.update()},Vv.prototype.onUnitSystemChange=Vv.prototype.Qe,Vv.prototype.update=function(){var e;if(this.N()){this.c=this.c,this.b=this.b;var o=this.m,s=0,h=this.map;if(h){var d=Math.round(.5*h.b.width),g=Math.round(.5*h.b.height);(e=h.Pa(d,g))&&(h=h.Pa(d+1,g))&&(s=100*e.Wa(h))}s&&(this.l===ev.IMPERIAL?1609.344>s?(h=s/.3048006,e=this.pa().translate("scale.ft")):(h=s/1609.344,e=this.pa().translate("scale.mi")):1e3>s?(h=s,e=this.pa().translate("scale.m")):(h=s/1e3,e=this.pa().translate("scale.km")),s=Math.pow(10,Math.floor(Math.log(h)/Math.LN10)),h=s/h*100,h<o/5?(s*=5,h*=5):h<o/2?(s*=2,h*=2):h>o&&(s/=2,h/=2),h=Math.round(h),this.c.setAttribute("width",h),this.i.textContent=s+" "+e,this.b.points.getItem(2).x=this.g.points.getItem(2).x=this.b.points.getItem(3).x=this.g.points.getItem(3).x=h-2)}};function Wv(e){C(e,Re,Wv,1),Y.call(this,"div","H_context_menu_item"),this.b=e,this.c=A(this.c,this),this.a=A(this.a,this),this.b.addEventListener("update",this.a)}u(Wv,Y),t("H.ui.context.Item",Wv),Wv.prototype.c=function(e){var o=this.b,s=o.callback;s&&!o.isDisabled()&&(this.dispatchEvent("click"),s(e))},Wv.prototype.X=function(){var e=this,o=this.N();Ee(o,"click",this.c),o.addEventListener("keyup",function(s){s.keyCode==13&&e.c(s)}),this.a()},Wv.prototype.renderInternal=Wv.prototype.X,Wv.prototype.a=function(){var e=this.N(),o=this.b;o.callback?(this.Ka("clickable"),e.setAttribute("tabindex","0")):(this.kb("clickable"),e.removeAttribute("tabindex")),o.isDisabled()?this.Ka("disabled"):this.kb("disabled"),o=o.getLabel(),su.textContent=o,e.innerHTML=su.innerHTML.split(`
`).join("<br/>")},Wv.prototype.o=function(){Y.prototype.o.call(this),this.b.removeEventListener("update",this.a)};function Xv(e){C(e,Array,Xv,1),Qu.call(this,"div","H_context_menu"),this.c=e,this.b=null}u(Xv,Qu),t("H.ui.context.Menu",Xv),Xv.prototype.X=function(){Qu.prototype.X.apply(this,arguments),this.c.forEach(function(e){e===Se?e=new Y("div","H_context_menu_item_separator"):(e=new Wv(e),e.addEventListener("click",this.g.bind(this))),this.Ja(e)},this),Ee(this.N(),["mousedown","touchstart","pointerdown","wheel"],function(e){e.stopPropagation()})},Xv.prototype.renderInternal=Xv.prototype.X,Xv.prototype.setPosition=function(e,o){if(this.b){var s=this.N(),h=s.offsetWidth,d=s.offsetHeight,g=this.b,_=g.b.width;g=g.b.height,e+h>_&&e>_/2&&(e-=h),o+d>g&&o>g/2&&(o-=d),lu(s,e,o)}},Xv.prototype.setPosition=Xv.prototype.setPosition,Xv.prototype.g=function(){this.b&&this.b.dispatchEvent(new ud("contextmenuclose",this.b))},Xv.prototype.Ia=function(e){this.b=e},Xv.prototype.setMap=Xv.prototype.Ia;function Yv(e,o){o=o||{};var s=this;Y.call(this,"div","H_ib H_ib_top"),this.u=A(function(h){s.dc()||(s.close(),h.preventDefault())},this),this.update=A(this.update,this),this.i=A(this.i,this),this.setPosition(e),this.$e(o.content),o.onStateChange&&this.addEventListener("statechange",o.onStateChange),this.O(Zv.OPEN)}u(Yv,Y),t("H.ui.InfoBubble",Yv),Yv.prototype.a=null,Yv.prototype.ya=function(){return this.m},Yv.prototype.setPosition=function(e){this.m=ng(e),this.update()},Yv.prototype.setPosition=Yv.prototype.setPosition,Yv.prototype.Ia=function(e){this.a=e},Yv.prototype.X=function(e,o){this.l=yu(o,"div","H_ib_body"),this.tailEl_=yu(o,"div","H_ib_tail"),this.c=yu(o,"div","H_ib_close H_btn",'<svg version="1.1" class="H_icon" viewBox="0 0 12 12"><path d="m8.12 6 3.66-3.66c.29-.29.29-.76 0-1.05l-1.06-1.06c-.29-.29-.76-.29-1.05 0l-3.66 3.66-3.66-3.66c-.29-.29-.76-.29-1.05 0l-1.06 1.06c-.29.29-.3.76 0 1.05l3.66 3.66-3.66 3.66c-.29.29-.29.76 0 1.05l1.06 1.06c.29.29.76.29 1.05 0l3.66-3.66 3.66 3.66c.29.29.76.29 1.05 0l1.06-1.06c.29-.29.3-.76 0-1.05z"></path></svg>'),this.b=yu(o,"div","H_ib_content","&nbsp;"),this.l.appendChild(this.c),this.l.appendChild(this.b),Bu(this.c,"start",this.u),this.a.c.addEventListener("sync",this.update),this.a.b.addEventListener("sync",this.update),e.appendChild(this.l),e.appendChild(this.tailEl_),this.$e(this.g)},Yv.prototype.renderInternal=Yv.prototype.X,Yv.prototype.i=function(){this.s||(this.s=setTimeout(this.update,0))},Yv.prototype.update=function(){var e=this.N(),o=this.a,s,h="none";if(this.s=0,o&&e&&this.getState()===Zv.OPEN){if(s=o.Da(this.m)){var d=s.x;s=s.y,o=o.b.width,(d>=-o||d<=2*o||s>=-o||s<=2*o)&&(h="",mu?(e.style.left=d-o+"px",e.style.top=s+"px"):lu(e,d,s))}e.style.display=h,h===""&&(e.style.visibility="visible")}};var Zv={OPEN:"open",CLOSED:"closed"};Yv.State=Zv,Yv.prototype.C=Zv.OPEN,Yv.prototype.getState=function(){return this.C},Yv.prototype.getState=Yv.prototype.getState,Yv.prototype.O=function(e){e!==this.C&&(this.C=e,this.dispatchEvent("statechange")),(e=this.N())&&(this.C===Zv.OPEN?(e.style.display="block",e.style.visibility="hidden",this.i()):e.style.display="none")},Yv.prototype.setState=Yv.prototype.O,Yv.prototype.close=function(){this.O(Zv.CLOSED)},Yv.prototype.close=Yv.prototype.close,Yv.prototype.open=function(){this.O(Zv.OPEN)},Yv.prototype.open=Yv.prototype.open,Yv.prototype.Ul=function(){return this.b||null},Yv.prototype.getContentElement=Yv.prototype.Ul,Yv.prototype.$e=function(e){if(e)if(typeof e=="string"||typeof e.nodeType=="number"&&typeof e.nodeName=="string")this.g=e;else throw Error("InfoBubble content must be a string or HTML node.");else this.g="";this.N()&&(this.g?(this.b.innerHTML="",typeof this.g=="string"?this.b.innerHTML=e:typeof e.nodeType=="number"&&typeof e.nodeName=="string"&&this.b.appendChild(e)):this.b.innerHTML="&nbsp;",this.i())},Yv.prototype.setContent=Yv.prototype.$e,Yv.prototype.o=function(){this.close(),this.$e(""),this.c&&Cu(this.c,"end",this.u),this.a&&(this.a.c.removeEventListener("sync",this.update),this.a.b.removeEventListener("sync",this.update)),Y.prototype.o.call(this)};function $v(e,o){this.b=e,this.a=null,this.f=0,this.c=22,this.i=o,this.Xf=A(this.Xf,this),this.Sg=A(this.Sg,this),e=this.b.Lb(),e.addEventListener("mapviewchange",this.bo,!1,this),this.g=e.f.type,e=e.a,e.addEventListener("add",this.Sn,!1,this),e.addEventListener("remove",this.Tn,!1,this)}function aw(e,o,s){var h=o.ca();h&&(s!==void 0&&s)&&h.removeEventListener("tap",e.Xf),o?(h.addEventListener("tap",e.Xf),e.f=h.min,e.c=h.max):(e.f=0,e.c=22)}p=$v.prototype,p.bo=function(e){var o=e.newValue.zoom;this.a&&e.modifiers&e.ZOOM&&(o<this.f||o>this.c)&&this.a.close()},p.Sn=function(e){e=e.added,bw(e)&&aw(this,e)},p.Tn=function(e){e=e.removed,bw(e)&&(this.a&&this.a.close(),aw(this,e,!0))};function bw(e){return window.H.service&&(e.ca()instanceof window.H.service.traffic.incidents.Provider||e.ca()instanceof window.H.service.trafficVectorTile.Provider&&e.ca().s().b==="incident")}p.Xf=function(e){var o,s=this.g===kk.HARP;e.target&&(o=e.target.getData())&&e.currentPointer.button===0&&(s?(o=this.b.Lb().Pa(e.currentPointer.viewportX,e.currentPointer.viewportY),(s=e.target.getData()?e.target.getData().properties.id:null)&&this.i.requestIncidentById(s,{locationReferencing:"none",lang:this.b.pa().a},this.hl.bind(this,o),console.error)):(s=e.target.ga(),this.hl(s,o)),e.stopPropagation())},p.hl=function(e,o){if(this.g===kk.HARP){o=o.incidentDetails;var s=this.b.pa().a,h=o.type,d=h.split(/(?=[A-Z])/).join("_").toUpperCase();this.b.pa().Nf("traffic."+d)&&(h=this.b.pa().translate("traffic."+d)),e={position:e,title:h,description:o.description.value,startTime:new Date(o.startTime).toLocaleString(s).split(",").join(" "),endTime:new Date(o.endTime).toLocaleString(s).split(",").join(" ")}}else s=o.TRAFFIC_ITEM_TYPE_DESC.replace(" ","_"),this.b.pa().Nf("traffic."+s)?s=this.b.pa().translate("traffic."+s):s=o.TRAFFIC_ITEM_DESCRIPTION[o.TRAFFIC_ITEM_DESCRIPTION.length-1].value,e={position:e,title:s,description:o.TRAFFIC_ITEM_DESCRIPTION[0].value,startTime:o.START_TIME,endTime:o.END_TIME};this.Sg(e)},p.Sg=function(e){var o=e.position,s=e.title,h=e.description,d=e.startTime;e=e.endTime,this.a||(this.a=new Yv(o),this.a.Ka("H_tib"),this.b.Yi(this.a)),this.a.setPosition(o),this.a.$e('<div class="H_tib_content"><div class="H_rdo_title" dir="auto">{{title}}</div><div class="H_tib_desc" dir="auto"><span>{{desc}}</span><div class="H_tib_time"><span class="H_tib_left">{{traffic.from}}</span><span class="H_tib_right">{{from}}</span><br/><span class="H_tib_left">{{traffic.until}}</span><span class="H_tib_right">{{until}}</span></div></div>'.replace("{{title}}",s).replace("{{desc}}",h).replace("{{traffic.from}}",this.b.pa().translate("traffic.from")).replace("{{traffic.until}}",this.b.pa().translate("traffic.until")).replace("{{from}}",d).replace("{{until}}",e)),this.a.open()};function cw(e,o){try{return e.Qf=!0,new e(o)}finally{e.Qf=!1}}function dw(e,o){var s=e.N(),h=this;F.call(this),this.c=e,this.i=s.ownerDocument,this.f={},this.b=[],this.S=yu(this.i,"div","H_ui"),this.setDirection(),this.P=A(function(d){this.m.put(d.target,d.target.Mc)},this),this.addEventListener("alignmentchange",this.P),this.L=A(function(){this.fl()},this),this.addEventListener("toggleunitsystem",this.L),this.S.addEventListener("contextmenu",this.J,!1),this.S.addEventListener("MSHoldVisual",this.J,!1),this.c.addEventListener("contextmenu",this.D,!1,this),this.c.addEventListener("contextmenuclose",this.u,!1,this),this.c.tb(this.F.bind(this)),this.a=null,this.s=-1,this.m=new Uu(this.S,this.i),this.g=ev.METRIC,ew(this,"en-US"),o&&fw(this,o),s.appendChild(this.S),x.setTimeout(function(){h.m.update()},1)}u(dw,F),t("H.ui.UI",dw),dw.prototype.J=function(e){for(var o=e.target;o&&!/\bH_ib_content\b/.test(o.className);)o=o.parentNode;o||e.preventDefault()},dw.prototype.N=function(){return this.S},dw.prototype.getElement=dw.prototype.N,dw.prototype.Lb=function(){return this.c},dw.prototype.getMap=dw.prototype.Lb,dw.prototype.dn=function(){return this.g},dw.prototype.getUnitSystem=dw.prototype.dn,dw.prototype.vg=function(e){var o=this.f,s;if(e!==this.g)for(s in this.g=e,o)o[s]instanceof Ru&&o[s].onUnitSystemChange(this.g)},dw.prototype.setUnitSystem=dw.prototype.vg,dw.prototype.setDirection=function(e){this.S.setAttribute("dir",e||getComputedStyle(this.Lb().N()).direction)},dw.prototype.setDirection=dw.prototype.setDirection;function ew(e,o){if(Cc(o))var s=o;else if(o instanceof Uv){s=o.a;var h=o}else throw Error("The locale parameter must be a string or a H.ui.i18n.Localization object.");if(s)if(h)e.l=h;else if(0<=Ov.indexOf(s))e.l=new Uv(s);else throw Error("Locale ["+s+"] is not supported.");else throw Error("No locale was defined.")}dw.prototype.pa=function(){return this.l},dw.prototype.fl=function(){this.g===ev.METRIC?this.vg(ev.IMPERIAL):this.vg(ev.METRIC)},dw.prototype.toggleUnitSystem=dw.prototype.fl,dw.prototype.Yi=function(e){var o=this.b.length,s=this.S;if(0>this.b.indexOf(e)){e.ka(this),e.Ia(this.c);var h=e.W(this.i);o=0<o?this.b[o-1].N().nextSibling:this.S.firstChild,s.insertBefore(h,o),this.b.push(e)}},dw.prototype.addBubble=dw.prototype.Yi,dw.prototype.D=function(e){var o=e.items;this.a&&this.u(),clearTimeout(this.s),this.s=x.setTimeout((function(){o.length&&(this.a=new Xv(o),this.S.insertBefore(this.a.W(this.i),this.S.firstChild),this.a.ka(this),this.a.Ia(this.c),this.a.setPosition(e.viewportX,e.viewportY))}).bind(this),0)},dw.prototype.u=function(){this.a&&(this.a.F(),this.a=null)},dw.prototype.jo=function(e){var o=this.b.indexOf(e);-1<o&&(e.ka(null),e.Ia(null),this.b.splice(o,1),this.S.removeChild(e.N()))},dw.prototype.removeBubble=dw.prototype.jo,dw.prototype.Ql=function(){return this.b},dw.prototype.getBubbles=dw.prototype.Ql,dw.prototype.Bd=function(e,o){if(this.Ce(e))throw Error("A control with name ["+e+"] is already registered.");o.ka(this),o.Ia(this.c),o.xa=this.l,o.W(this.i),o.onUnitSystemChange(this.g),this.f[e]=o},dw.prototype.addControl=dw.prototype.Bd,dw.prototype.lo=function(e){var o=this.Ce(e);if(o)o.T(),o.ka(null),o.Ia(null),Du(o),delete this.f[e];else throw Error("Control ["+e+"] not found in this UI's controls.");return o},dw.prototype.removeControl=dw.prototype.lo,dw.prototype.Ce=function(e){return this.f[e]},dw.prototype.getControl=dw.prototype.Ce,dw.prototype.o=function(){for(var e in this.f)ju.hasOwnProperty.call(this.f,e)&&this.f[e].F();this.b.forEach(function(o){o.F()}),(e=this.S.parentNode)&&e.removeChild(this.S),F.prototype.o.call(this),delete this.S};function fw(e,o){var s,h;o.unitSystem&&e.vg(o.unitSystem),(h=o.locale)&&ew(e,h),(s=o.zoom)&&e.Bd("zoom",new Su(Ea(s)?s:null)),(s=o.zoomrectangle)&&e.Bd("zoomrectangle",new Tv(Ea(s)?s:null)),(s=o.mapsettings)&&e.Bd("mapsettings",new Ev(Ea(s)?s:null)),(s=o.scalebar)&&e.Bd("scalebar",new Vv(Ea(s)?s:null)),(s=o.distancemeasurement)&&e.Bd("distancemeasurement",new wv(Ea(s)?s:null))}dw.prototype.capture=function(e,o,s,h){var d=this.Ce("scalebar"),g=e.getContext("2d"),_=e.width,j=e.height,$=this.c.s,_t=5+($?$.N().childNodes[1].offsetHeight:0);d&&d.wc()?d.capture(o,function(_e){g.drawImage(_e,_-_e.width-5*o,j-_e.height-_t*o),s(e)},h):s(e)},dw.prototype.capture=dw.prototype.capture,dw.createDefault=function(e,o,s){var h=e.f.type;if(s=new dw(e,{unitSystem:ev.METRIC,zoom:{alignment:"right-bottom"},mapsettings:gw(h,o,e.g),scalebar:{alignment:"bottom-right"},locale:s||"en-US"}),h===kk.P2D){var d=s.Ce("mapsettings"),g=function(){if(d.Lb()){var _t=gw(h,o,e.g);Fv(d,_t.baseLayers,_t.layers)}};e.addEventListener(e.A.lf,g),s.tb(function(){e.removeEventListener(e.A.lf,g)}),d.tb(function(){e.removeEventListener(e.A.lf,g)})}if(h===kk.HARP){if(window.H.service){var _=o.vector.traffic.map.ca().s().v(),j=new window.H.service.Url(_.i,_.c.split(".").slice(-2).join("."));j=cw(window.H.service.traffic.Service7,{platformBaseUrl:j});var $=j.v().getQuery();$.apikey=_.getQuery().apikey,j.v().bf($),new $v(s,j)}}else new $v(s);return s},dw.prototype.Bo=function(){},dw.prototype.setTrafficIncidentsHandle=dw.prototype.Bo;function hw(e,o,s,h){for(var d=e,g=0;d&&g<o.length;g++)d=d[o[g]];if(d&&d!==e)return e={label:s,layer:d},h.push(e),e}function gw(e,o,s){var h=[],d=[],g=o.raster;if(e===kk.P2D&&g){if(hw(o,["raster","normal","map"],"layers.normal",h),hw(o,["raster","satellite","map"],"layers.satellite",h),hw(o,["raster","terrain","map"],"layers.terrain",h),s){for(var _ in g)if(g[_]&&g[_].map===s){var j=_;break}}hw(o,["raster","normal","trafficincidents"],"layer.incidents",d),hw(o,["raster",j,"transit"],"layer.transit",d)}else hw(o,["vector","normal","map"],"layers.normal",h),e===kk.WEBGL?(hw(o,["raster","satellite","map"],"layers.satellite",h),hw(o,["vector","normal","traffic"],"layer.traffic",d),hw(o,["vector","normal","trafficincidents"],"layer.incidents",d)):(s=hw(o,["hybrid","day","vector"],"",[]),g=hw(o,["hybrid","day","raster"],"layers.satellite",h),g.layer=[g.layer,s.layer],window.H.service&&(s=o.vector.traffic.map.ca().s().v(),o=cw(window.H.service.trafficVectorTile.Service,{baseUrl:s,layer:"flow"}),s=cw(window.H.service.trafficVectorTile.Service,{baseUrl:s,layer:"incident"}),j=Ao()+"/harp/oslo/normal.day.json",g=new H.map.render.harp.Style(j),j=new H.map.render.harp.Style(j),o=o.createLayer(g,{engineType:e}),e=s.createLayer(j,{engineType:e}),d.push({label:"layer.traffic",layer:o},{label:"layer.incidents",layer:e})));return{alignment:"bottom-right",baseLayers:h,layers:d}}function iw(e,o){if(o=o||{},!(e&&e instanceof sl))throw Error("Base layer is mandatory for overview UI element");Ru.call(this),this.c=new gv({label:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="H_icon"><g fill-rule="evenodd" transform="translate(2 2)"><rect width="9" height="9" x="10" y="10"/><rect class="H_icon_stroke" width="18" height="18" x="1" y="1" fill="none" stroke="#000" stroke-width="2" rx="2"/></g></svg>',onStateChange:A(this.g,this)}),this.Ja(this.c),this.b=new jw(e,o.zoomDelta,o.scaleX,o.scaleY),this.Vb(o.alignment||"right-bottom"),this.Ja(this.b)}u(iw,Ru),t("H.ui.Overview",iw),iw.prototype.ud=function(e){return this.b.ud(e),this},iw.prototype.setBaseLayer=iw.prototype.ud,iw.prototype.g=function(e){e.target.getState()===Fu.DOWN?(e=this.b,kw(e,!0),e.Fi(),e.Ka("H_overview_active"),e.b.addEventListener("mapviewchange",e.Fi,!1,e)):lw(this.b)},iw.prototype.X=function(e,o){Ru.prototype.renderInternal.call(this,e,o),this.c.N().style.float=this.Mc.match("right")?"right":"left",this.b.Ia(this.map),this.c.jc(this.pa().translate("minimap"))},iw.prototype.renderInternal=iw.prototype.X,iw.prototype.o=function(){this.b.F(),Y.prototype.o.call(this)};function jw(e,o,s,h){this.l=e,typeof o=="number"&&(this.jl=o),typeof s=="number"&&(this.tk=s),typeof h=="number"&&(this.uk=h),Qu.call(this,"div","H_overview")}u(jw,Ru),jw.prototype.ud=function(e){this.c.ud(e)},jw.prototype.X=function(e,o){o=yu(o,"div","H_overview_map"),zu(e,o),this.g=o},jw.prototype.renderInternal=jw.prototype.X,jw.prototype.renderInternal=jw.prototype.X,p=jw.prototype,p.jl=3,p.tk=5,p.uk=5,p.Ia=function(e){this.b=e,this.c=new U(this.g,this.l,{pixelRatio:this.b.Xa(),engineType:this.b.f.type}),this.c.s.N().style.display="none",this.s=this.c.c,this.i=this.b.c};function lw(e){!e.zd&&kw(e),e.kb("H_overview_active"),e.b.removeEventListener("mapviewchange",e.Fi,!1,e)}p.Fi=function(e){e&&e.modifiers&e.SIZE&&kw(this,!0),e=this.i.jb(),e.zoom-=this.jl,this.s.Wb(e)};function kw(e,o){var s=e.b.b.element,h=e.N().style,d=s.offsetWidth/e.tk/10;s=s.offsetHeight/e.uk/10;var g=e.g.style;o?(h.width=d+"em",h.height=s+"em",g.width=d+"em",g.height=s+"em"):h.width=h.height="0em",e.c.b.resize()}p.o=function(){jw.j.o.call(this),lw(this),this.c.F(),this.c=this.s=this.i=this.b=this.l=this.g=null},t("H.ui.buildInfo",function(){return Hf("H-ui","1.49.1","74e5afb",{region:"row"})});function mw(e,o){if(!e)throw new D(mw,0,e);mw.j.constructor.call(this,e),this.b={},this.c=!(!o||!o.oc),this.f=nw++}u(mw,Cm);var nw=0;mw.prototype.W=function(e,o,s,h,d,g){var _=Ad(h),j=this.eb,$=_+(s.exp-j.pixelProjection.exp),_t=j.min,_e=j.max;h=j.tileSize;var _r=j.ca().g,_n=this.lb,_o=_n.Tc(),ga=_n.yb().w,_l=s.w,_f=s.x,_c=s.y,_p={};if(_<_t||_>_e)return wk.DONE;for(d=j.requestTiles(e,$,d,g,this.f),e=d.total,d=d.tiles,g=d.length,this.g=s,this.l=o,this.a=$,_o!==_r&&_n.ic(_r),s=h=h*_l/(Gd(2,$)*h),this.c||(h%1&&(h=Bd(h),_l=s/h,_f/=_l,_c/=_l,_l=Gd(2,$)*h),_f=Bd(_f),_c=Bd(_c)),this.i=s,$=-h,_=ga+h,j=0;j<g;j++){if(ga=d[j],(_t=ga.data)&&_t.tagName){for(s=o.x-(_f-ga.x*h),_r=o.y-(_c-ga.y*h),_n.Oc(_t,s,_r,h,h),_o=s;(_o-=_l)>$;)_n.Oc(_t,_o,_r,h,h);for(_o=s;(_o+=_l)<_;)_n.Oc(_t,_o,_r,h,h)}_p[this.a+"_"+ga.x+"_"+ga.y]=ga}return this.b=_p,g===e?wk.DONE:wk.PENDING},mw.prototype.Ea=function(e,o,s){var h=this.i,d=h/this.eb.tileSize,g=this.g,_=this.l,j;if(vc(this.a)&&g){e=g.x+(e-_.x),o=g.y+(o-_.y);var $=Bd(g.w/h),_t=g=Bd(e/h);_=Bd(o/h),Dd(_t)>=$&&(_t%=$),0>_t&&(_t=$+_t),($=this.b[this.a+"_"+_t+"_"+_])&&$.Ea&&(j=$.Ea((e-h*g)/d,(o-h*_)/d,s))}return j||hf},mw.prototype.Rd=function(){return"2d"};function ow(e,o){o=o||{},C(e,tl,ow,0),ow.j.constructor.call(this,e),this.oc=!!o.oc,this.c=o.fb||0,this.a=[],this.b={}}u(ow,Cm),ow.prototype.W=function(e,o,s,h,d,g){var _,j=this.eb,$;h-=this.c,this.a.length=0;var _t=this.b;if(this.b=_={},h>=j.min&&h<=j.max){var _e=j.sd(e,h,d,g),_r=_e.overlays;if(e=_r.length)for(_r.sort(ph),h=this.lb,d=this.oc,g=0;g<e;g++){j=_r[g];var _n=j.K(),_o=s.ib(_n.Nb()),ga=s.ib(_n.Jb());_n=s.w,_o.x>=ga.x&&(_o.x-=_n),_n=-((_o.x+ga.x)/_n>>1)*_n,_o.x+=_n,_o.add(o),ga.x+=_n,ga.add(o),d||(_o.round(),ga.round()),(_n=_t[$=j.cb()])?delete _t[$]:_n={ho:j},_[$]=_n;var _l=_o.x;_o=_o.y;var _f=ga.x;ga=ga.y;var _c=_f-_l,_p=ga-_o;h.ic(j.Tc()),h.Oc(j.Qc(),_l,_o,_c,_p),_n.Vg?_n.Vg.set(_l,_o,_f,ga):_n.Vg=new yk(_l,_o,_f,ga),this.a.push(_n)}}return!_e||_e.requested&&_e.requested===_e.total||!_e.requested&&_r.length===_e.total?wk.DONE:wk.PENDING},ow.prototype.Ea=function(e,o,s){for(var h=this.a,d=h.length,g,_,j;d--;)if(g=h[d],_=g.Vg,_.vf(e,o)){if(g=g.ho,j)j.push(g);else if(j=[g],s)break}return j||hf},ow.prototype.Rd=function(){return"2d"},ow.prototype.o=function(){delete this.a,ow.j.o.call(this)},ow.prototype.disposeInternal=ow.prototype.o;var pw={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:0},incline:{min:0,max:0},heading:{min:180,max:180}},interaction:{ZOOM:Nl.ZOOM,COORD:Nl.COORD},capture:!0};t("H.map.render.p2d.capabilities",pw);function qw(e,o){this.a=[],qw.j.constructor.apply(this,arguments)}u(qw,Gm),p=qw.prototype,p.rj=function(){return this.eb.Ec.apply(this.eb,arguments)},p.W=function(e,o,s,h,d,g,_){return this.a=[],qw.j.W.apply(this,arguments)},p.$j=1,p.Ek=function(e,o,s,h,d,g){var _=this.$j=h.Xa();d*=_,g*=_;var j=s.yb();o=j.w*_,j=j.h*_;var $=s.kd();this.oc?(d-=$.x*_,g-=$.y*_):(d=Ad(d-$.x*_),g=Ad(g-$.y*_)),h.Oc(s.Qc(),d,g,o,j),e.detail?e.detail.set(d,g,d+o,g+j):e.detail=new yk(d,g,d+o,g+j),this.a.push(e)},p.Ea=function(e,o,s){for(var h=this.a,d=h.length,g,_,j,$=hf,_t=this.$j;d--&&(g=h[d],_=g.detail,!(_.vf(e,o)&&(g=g.ik,(!(j=g.xb().c)||j.Of((e-_.left)/_t,(o-_.top)/_t,0))&&0>$.indexOf(g)&&($===hf&&($=[]),$.push(g),s)))););return $},p.Rd=function(){return"2d"},p.o=function(){this.a=[],qw.j.o.call(this)},qw.prototype.disposeInternal=qw.prototype.o;function Z(e,o,s,h){Z.j.constructor.call(this,e,o,s,h),this.L=new J(0,0),(s=h.renderBaseBackground)&&(this.Xn=s.lower,this.Hn=s.higher),this.yn=!!h.enableSubpixelRendering,this.fd=rw,this.Af=0,this.Ed=this.ve=!1,this.g=new om,this.a=h=new wm,this.dd=A(this.dd,this),h.addEventListener(h.A.Cg,this.dd),this.Da=A(this.Da,this),h=e.element,this.aa=e=h.ownerDocument.createElement("div"),e.style.position="absolute",e.style.width=e.style.height="100%",e.style.zIndex=0,h.insertBefore(e,h.firstChild),this.sj=new Tm(this.aa,this.oa),this.m=[],sw(this),this.Jh=A(Z.prototype.Jh,this),this.C=tw,this.ng(),this.zoom=uw(this,this.J.pb()+this.fb),this.Eb(),vw(this,o.jb().position,this.zoom),this.$a(),this.T()}u(Z,Jl),t("H.map.render.p2d.RenderEngine",Z),Z.prototype.type=Tl.P2D;var tw=2;Z.prototype.getState=function(){return this.C},Z.prototype.getState=Z.prototype.getState;function ww(e,o,s){return o=s-o,Dd(o)<e.b.w/2?o:o-e.b.w*s/Dd(s)}Z.prototype.Kg=function(e){var o=this,s=e.b,h=e.newValue,d=e.modifiers;e=h.position;var g=h.bounds,_,j=this.zoom,$=this.s,_t=0;if(d&ej.POSITION&&(_=o.b.ib(e)),d&ej.BOUNDS)h=xw(this,g.K(),d&ej.ZOOM?h.zoom:B,d&ej.POSITION?e:B),this.J.Wb(h,s);else{d&ej.POSITION||(_=o.b.ib(h.position));var _e=_.x,_r=_.y;yw(this),this.L.set(0,0),h=zw(this,h);var _n=h.zoom,_o=h.position;if(s){var ga=_n-j,_l={x:$.x,y:$.y};s=this.b.Zd(_l).x;var _f=this.b.projection.Pc(e);(_f.x!==this.s.x||_f.y!==this.s.y||_n!==this.zoom)&&(_e=ww(this,s,_e),Aw(this,function(_c){var _p=_c-_t;if(_n!==j){_=o.b.Zd(_f);var _g=o.b.Zd(_l);_e=ww(o,_g.x,_.x),_r=_.y-_g.y}_t=_c,Bw(o,_e*_p,_r*_p),j+=ga*_p,Cw(o,j),o.$a(),o.ha()},this.qa,function(){vw(o,_o,_n),Cw(o,_n),o.$a(_o),o.ha()},this.xa))}else Dw(this),vw(this,_o,_n),Cw(this,_n),this.$a(_o);this.ha()}},Z.prototype.qa=300,Z.prototype.rg=function(e){var o=Fc(e);if(!o||o&&0>e)throw new D(this.rg,1,"positive number required");this.qa=e},Z.prototype.setAnimationDuration=Z.prototype.rg,Z.prototype.$g=function(){return this.qa},Z.prototype.getAnimationDuration=Z.prototype.$g,Z.prototype.xa=em,Z.prototype.sg=function(e){if(!Da(e))throw new D(this.sg,1,"function required");this.xa=e},Z.prototype.setAnimationEase=Z.prototype.sg,Z.prototype.ah=function(){return this.xa},Z.prototype.getAnimationEase=Z.prototype.ah,Z.prototype.ng=function(){this.xa=em,this.qa=300},Z.prototype.resetAnimationDefaults=Z.prototype.ng,Z.prototype.Xh=function(e,o,s){var h;this.Nj=Lk(),(h=this.R.ja.splice(e,1)[0])&&h.F&&h.F(),(h=this.u.ja.splice(e,1)[0])&&h.F&&h.F(),(h=this.ta.ja.splice(e,1)[0])&&h.F&&h.F(),(h=this.ea.ja.splice(e,1)[0])&&h.F&&h.F(),this.ab=this.c.La(),e===0&&(Ol(this,o,!1),this.Eb()),this.m=Um(this.sj,Ew(this),Fw(this)),this.ce(),s||this.ha()};function sw(e){var o=e.c.La(),s=0,h=o.length;for([e.R={},e.u={},e.ta={},e.ea={}].forEach(function(d){d.Nc=[],d.ja=[]}),e.ab=e.c.La();s<h;s++)e.Pe(s,o[s]);e.Eb()}Z.prototype.Yh=function(){this.Eb(),this.ha()},Z.prototype.th=function(e,o,s){var h,d,g,_;if(o){var j={oc:this.yn,fb:this.fb};o.W?C(o,Em)?d=new Dm(o):C(o,Qm)&&(_=new Dm(o)):(o.requestOverlays&&(h=new ow(o,j)),o.requestTiles&&(d=new mw(o,j)),o.requestMarkers&&(g=new qw(o,j)),o.requestDomMarkers&&(_=new Jm(o,j)))}s=s||0,this.R.ja.splice(e,s,h),this.u.ja.splice(e,s,d),this.ta.ja.splice(e,s,g),this.ea.ja.splice(e,s,_),this.ab=this.c.La(),this.m=Um(this.sj,Ew(this),Fw(this))};function Fw(e){var o=[];return o=o.concat(e.u.ja),o=o.concat(e.R.ja),o=o.concat(e.ta.ja),o=o.concat(e.ea.ja),o=o.filter(vc)}function zw(e,o){var s=Pl(e,Pl(e,o.zoom)+e.fb);return e=Ql(e,o),e.zoom=s,e}function vw(e,o,s){var h=e.b;h.Oa(s),e.s=h.projection.Pc(o),h.x=h.w*e.s.x,h.y=h.h*e.s.y}Z.prototype.Pa=function(e,o){var s=this.f.center,h=this.oa;return this.b.Ra((e-s.x)*h,(o-s.y)*h)},Z.prototype.screenToGeo=Z.prototype.Pa,Z.prototype.qg=function(e,o){return e=this.Pa(e,o),o=this.J.jb(),o.position=e,o},Z.prototype.Da=function(e){var o=this.oa,s=this.f.center,h=s.x*o;s=s.y*o,e=this.b.ib(e);var d=this.b.w;return new J(Ad((e.x-Ad(e.x/d)*d+h)/o),Ad((e.y+s)/o))},Z.prototype.geoToScreen=Z.prototype.Da,Z.prototype.K=function(e,o){var s=this.wa[e||4];e=this.b;var h=s.left-o,d=e.Ra(h,s.top-o),g=s.right+o;return o=e.Ra(g,s.bottom+o),g-h>=e.w&&(d.lng=-(o.lng=180)),sg(d,o)},Z.prototype.Ea=function(e,o,s,h){var d=[],g=this.oa,_;for(e*=g,o*=g,g=[this.R,this.u,this.ta,this.ea],_=g.length;_--&&(!s||!d.length);){for(var j=d,$=g[_].ja,_t=e,_e=o,_r=s,_n=$.length;_n--&&!((d=$[_n])&&d.Ea&&(j=j.concat(d.Ea(_t,_e,_r)),j.length&&_r)););d=j}h(d)},Z.prototype.getObjectsAt=Z.prototype.Ea,Z.prototype.sb=z;function Ew(e){return e=e.wa[2],{w:e.right-e.left,h:e.bottom-e.top}}Z.prototype.T=function(){var e=this.m.length,o;Z.j.T.call(this);var s=Ew(this);this.L.set(0,0);var h=s.w;for(o=s.h;e--;){s=this.m[e];var d=s.yb();d.w===h&&d.h===o||s.cf(h,o)}this.sb=new Wi(h,o),this.ha()},Z.prototype.getCapabilities=function(){return pw},Z.prototype.getCapabilities=Z.prototype.getCapabilities;function Gw(e){e.i&&e.i.sa()||Lk()-e.Nj<e.fd&&!e.Ad?e.Yn=Jk(e.Jh):(e.Ad&&(e.ce(),Hw(e)),e.C=tw)}p=Z.prototype,p.ce=function(){this.R.Nc.length=0,this.u.Nc.length=0,this.ta.Nc.length=0,this.ea.Nc.length=0},p.Jh=function(){var e;this.D&&this.D.before();var o=this.u.ja,s=this.f.center.clone().scale(this.oa).round(),h=this.K(1,0),d=this.K(1,Iw),g=this.zoom,_=g-this.fb,j=this.b,$=this.Xn,_t=this.Hn,_e=o[0];o=this.L;var _r=this.m.length,_n=this.ab;for(e=_n.length;_r--;){var _o=this.m[_r];C(_o,Bm)&&_o.clear()}if(_e){if($)for(;$;)_r=g-$,_e.W(h,s,j,_r,!0,o),--$;if(_t&&this.Ed)for(_o=1;_o<=_t&&(_r=g+_o,j.Oa(_r),$=this.K(2,0),j.Oa(g),!_e.W($,s,j,_r,!0,o));_o++);}for(this.fd=rw;e--;)j=_n[e],C(j,qj)&&j.ca()&&j.ca().Ue(d,_);h=this.Zj(h,s,g,!1,o,Jw,this.u,this.R),s=this.Zj(d,s,_,!1,o,Kw,this.ta,this.ea),this.Ad=h&&s,this.i&&this.i.sa()&&this.me(),this.P||(this.P=this.J.jb()),this.P.bounds=this.K(4,0),this.J.$a(this.P),this.P=null,this.sb&&(this.f.$a(this.sb),this.sb=z),g<this.Af?this.Ed=!0:this.ve&&(this.Ed=!1),this.Af=g,this.ve=h,this.D&&this.D.after(),Gw(this)},p.Zj=function(e,o,s,h,d,g,_){var j=Array.prototype.slice.call(arguments,6),$=j.length,_t=j[0].ja.length,_e=$*_t,_r=!!_e,_n;for(_n=0;_n<_e;_n++){if(g===Jw)var _o=_n%$,ga=Math.floor(_n/$);else _o=Math.floor(_n/_t),ga=_n%_t;var _l=j[_o].ja[ga];_o=j[_o].Nc,_l&&(_l=_l.W(e,o,this.b,s,h,d,this.Da),_l===wk.ACTIVE&&(this.fd=1/0),_l!==wk.DONE||_o[ga]||(Hw(this,this.ab[ga]),_o[ga]=!0),_o[ga]||(_r=!1))}return _r};function Hw(e,o){e.dispatchEvent({type:e.A.Vi,target:o||e})}p.o=function(){var e=this.c.La()[0],o=this.f;Kk(this.Yn),Dw(this,!0),e&&Ol(this,e,!1),Fw(this).forEach(function(s){s.F()}),o.element&&o.element.removeChild(this.aa),this.aa=null,this.C=3,Z.j.o.call(this)},p.ha=function(){this.Nj=Lk(),this.C===tw&&(this.Ad=!1,this.C=1,Gw(this))};function Lw(e,o,s){Bw(e,o*e.oa,s*e.oa),e.L.set(0,0),e.$a(),e.ha()}function Bw(e,o,s){var h=e.b;e=e.s,h.x=Zd(h.x+o,h.w),h.y=zd(0,yd(h.w,h.y+s)),e.x=h.x/h.w,e.y=h.y/h.h}p.xd=function(e,o,s){e=Pl(this,Pl(this,e)+this.fb),Cw(this,e,o,s)},Z.prototype.zoomAt=Z.prototype.xd;function Cw(e,o,s,h){var d=e.oa,g=e.f.center;s===+s&&h===+h?(s=(s-g.x)*d,h=(h-g.y)*d,e.L.set(s,h),Bw(e,s,h),e.b.Oa(o),Bw(e,-s,-h)):(e.L.set(0,0),e.b.Oa(o)),e.zoom=o,e.$a(),e.ha()}function xw(e,o,s,h){var d=e.getCapabilities().lookAt.zoom.max,g=o.bb(),_=h||g;if(o.Rf()||s&&h)s=s===B?d:s;else{var j=new nj(e.b.projection);j.Oa(d);var $=j.ib(o.Nb()).round(),_t=j.ib(o.Jb()).round();d=j.w,o.Bb()&&($.x-=d),h?(g=j.ib(_),o=2*zd(g.x-$.x,_t.x-g.x),$=2*zd(g.y-$.y,_t.y-g.y)):(o=_t.x-$.x,$=_t.y-$.y,_=g),s===B&&(g=e.wa[4],s=g.right-g.left,g=g.bottom-g.top,s=-8+yd(Ed(s/o*d)/Od,Ed(g/$*d)/Od)-e.fb,s=Pl(e,s))}return{zoom:Bd(s),position:_}}function yw(e){Dw(e,!0),e.a.sa()&&e.vb(!0),e.g.sa()&&e.wb(!0),Dw(e,!0)}Z.prototype.lc=function(e,o){yw(this),Mw(this,o),this.g.start(e,!!o)},Z.prototype.startInteraction=Z.prototype.lc;function Mw(e,o){if(o){var s={};s.Te=o.power,s.we=o.ease,s.duration=o.duration,e.l=s}}function uw(e,o){return Pl(e,Pl(e,o-e.fb)+e.fb)}Z.prototype.cc=function(e,o,s,h,d){var g=!1;this.g.sa()&&(o=this.g.store(e,o,s,h,d),this.g.Ac(Nl.COORD)&&(e=this.g.Nd(),0<nm(e)&&(Lw(this,-e.x,-e.y),g=!0)),o&&this.g.Ac(Nl.ZOOM)&&(e=this.g.Bf(),o=this.g.Cf(),o=Ed(Gd(2,this.zoom)*o)/Od,o!==this.zoom&&(o=uw(this,o),Cw(this,o,e.x,e.y),g=!0)),g&&this.ha())},Z.prototype.interaction=Z.prototype.cc,Z.prototype.wb=function(e){var o=this;if(this.g.sa()&&!e){if(this.l){e=this.g.zb();var s=this.g.rc(),h=this.l.duration,d=(this.l.Te||1)*e,g=new Rm(-d/(0<h?h:1),d);!E(s.x)&&!E(s.y)&&0<d&&o.g.Ac(Nl.COORD)&&Aw(this,function(_){d=g.De(_*h),E(d)||Lw(o,Ad(-s.x*d),Ad(-s.y*d))},h,void 0,this.l.we)}this.l=null,this.g.clear()}},Z.prototype.endInteraction=Z.prototype.wb,Z.prototype.kc=function(e,o,s){yw(this),this.a.start(o,s),Mw(this,e)},Z.prototype.startControl=Z.prototype.kc,Z.prototype.control=function(e,o,s){if(E(+s))throw new D(this.control,2,s);if(E(e))throw new D(this.control,0,e);if(E(o))throw new D(this.control,1,o);this.a.sa()&&this.a.set(e,o,s,0,0,0)},Z.prototype.control=Z.prototype.control,Z.prototype.vb=function(e,o){var s=this,h;if(this.a.sa()){Dw(this,!0);var d=Lk(),g=d-this.Lj;if(1<=g){var _=zm(this.a);Nw(this,_,g)}if(!this.l||e||o)typeof o=="function"&&(e=this.jb(),e.zoom=this.zoom-this.fb,o(e),e.zoom+=this.fb,Ow(this,e));else{o=this.a.zb();var j=this.a.rc(),$=this.l.duration,_t=(this.l.Te||1)*o,_e=new Rm(-_t/(0<$?$:1),_t);!E(j.a)&&!E(j.b)&&0<_t&&Aw(this,function(_r,_n,_o,ga){d&&(_o=ga-d,d=0),_t=_e.De(_r*$)*_o,E(_t)||((h=j.c*_t)&&Cw(s,uw(s,s.zoom+h),s.a.a,s.a.b),Lw(s,Ad(j.a*_t),Ad(j.b*_t)))},$,void 0,this.l.we)}this.a.reset()}},Z.prototype.endControl=Z.prototype.vb;function Ow(e,o){var s=e.s,h=e.b.projection.Pc(o.position),d=e.b.Zd(h),g=d.y;d=d.x;var _=o.zoom;s=e.b.Zd(s),o=s.y;var j=s.x;s=e.zoom;var $=e.a.zb(),_t=e.a.a,_e=e.a.b,_r=0;if(d=ww(e,j,d),d-=j,g-=o,s=_-s,o=Fd(d*d+g*g+s*s),$!==0&&o!==0){var _n=d/o,_o=g/o,ga=s/o,_l=$*$/(2*o);Aw(e,function(_f,_c){var _p;_f!==1?(_f=$*_c-_l*_c*_c/2,_c=_f-_r,(_p=ga*_c)&&(_p=uw(e,e.zoom+_p),Cw(e,uw(e,_p),_t,_e)),Lw(e,Ad(_n*_c),Ad(_o*_c)),_r=_f):(e.s=h,Cw(e,uw(e,_),_t,_e),e.$a(),e.ha())},2*o/$)}}Z.prototype.dd=function(e){var o=this,s=e.b;this.L.set(0,0),s.a||s.b||s.c?(this.Lj=Lk(),Aw(this,function(h,d,g,_){o.Lj=_,Nw(o,s,g)},Number.POSITIVE_INFINITY),this.ha()):Dw(this,!0)};function Nw(e,o,s){s=s||0,o.c&&Cw(e,uw(e,e.zoom+o.c*s),e.a.atX,e.a.atY),Lw(e,o.a*s,o.b*s)}function Aw(e,o,s,h,d){e.i&&e.i.sa()&&e.i.stop(!0),e.i=new Fm(e,o,s,h,d),e.i.start()}function Dw(e,o){e.i&&e.i.sa()&&e.i.stop(o)}Z.prototype.Wg=function(){},Z.prototype.enter=Z.prototype.Wg,Z.prototype.Xg=function(e){Ml(this.aa,e)},Z.prototype.exit=Z.prototype.Xg,Z.prototype.capture=function(e,o,s,h){var d=this.aa.ownerDocument.createElement("canvas"),g=d.getContext("2d"),_=this.oa;for(d.width=(s-e)*_,d.height=(h-o)*_,s=0;s<this.m.length;s++)h=this.m[s],C(h,Bm)&&g.drawImage(h.N(),-e*_,-o*_);return Zb(d)};var Kw=0,Jw=1,rw=1e3,Iw=256;function Pw(e){var o;if(e)for(Qw={},o=e.length;o--;)Qw[e[o]]=!0;this.Yk={}}var Rw,Qw={};Pw.prototype.parse=function(e,o,s){var h,d,g,_,j;Rw=!1;try{s=JSON.parse(s)}catch{Rw=!0}if(s&&(h=s.metadata)){var $={spatials:[]};for(d in h)if((s=!Qw[d]&&(g=Sw[d]))&&((_=h[d])||(Rw=!0,_=void 0),s=_),s)for(s=_.length;s--;){var _t;(_t=_[s])||(Rw=!0,_t=void 0),(j=_t)&&g(o,e,this,d,j,$)}}else Rw=!0;return Rw?void 0:$},Pw.prototype.parse=Pw.prototype.parse;var Sw={"street labels":function(e,o,s,h,d,g){var _;if((_=d.vertices)||(Rw=!0,_=void 0),_){var j,$=_.length,_t;if((_t=0<$)||(Rw=!0,_t=void 0),_t)for(j=Array($/2);$;){var _e=_[--$];_t=_[--$],j[$/2]=new J(_t,_e)}j=j?{a:[j]}:B,$=+d["font size"]/e.Xa(),_=s.Yk[$],_||(Tw.lineWidth=$,_=s.Yk[$]=s.Fd.vj(Tw)),Uw(e,o,j,!1,_,d,h,g)}delete d.vertices},"city center labels":function(e,o,s,h,d,g){Uw(e,o,Vw(d,new Ph([])),!0,s.Fd,d,h,g)},labels:function(e,o,s,h,d,g){var _;if((_=d["bounding boxes"])||(Rw=!0,_=void 0),_){for(var j=_.length,$=new Ph([]),_t;j--;){var _e;(_e=_[j])||(Rw=!0,_e=void 0),(_t=_e)&&Vw(_t,$)}Uw(e,o,$,!0,s.Fd,d,h,g)}delete d["bounding boxes"]},buildings:function(e,o,s,h,d,g){var _=d.id,j=o.ig[_],$,_t,_e,_r=[],_n=[];if(($=d)||(Rw=!0,$=void 0),$&&((_t=$.vertices)||(Rw=!0,_t=void 0),_t)){var _o;(_o=$.polygons)||(Rw=!0,_o=void 0),(_e=_o)&&_r.push.apply(_r,Ww(_t,_e)),($=$.outlines)||(Rw=!0,$=void 0),(_e=$)&&_n.push.apply(_n,Ww(_t,_e))}_e=_r.length,_r.push.apply(_r,_n),_n=new Ph(_r,Wd,_e),(_r=_r.length)||(Rw=!0,_r=void 0),_r&&(j?(br(j,e,[_n]),g.spatials.push(j)):(j=Uw(e,o,_n,!0,s.Fd,d,h,g,_),o.fa(j)))}};Sw["transit stops"]=Sw.POIs=Sw.labels;var Xw=["box 2","box 1","annotation box","icon box"];function Vw(e,o){for(var s=Xw.length,h,d;s--;)if(h=Xw[s],d=e[h]){var g=d[0],_=d[1],j=d[2];d=d[3],o.a.push([new J(g,_),new J(g+j,_),new J(g+j,_+d),new J(g,_+d)]),delete e[h]}return o}function Ww(e,o){var s=o.length,h,d,g;if(0<s){for(d=Array(s);s--;)if((h=o[s])||(Rw=!0,h=void 0),h){var _=h.length;if(0<_)for(d[s]=g=Array(_);_--;){var j=2*h[_];g[_]=new J(e[j],e[j+1])}}}return d||[]}var Yw={};function Uw(e,o,s,h,d,g,_,j,$){return Yw.style=d,h=new Yq(o,h,$,Yw),s&&br(h,e,[s]),Zw(g),g.category=_,h.setData(g),j.spatials.push(h),h.ka(o),h}Pw.prototype.Fd=new wh({strokeColor:"transparent",fillColor:"transparent",lineWidth:0});var Tw={};function Zw(e){var o,s=!1;switch(typeof e){case"object":if(e instanceof Array)for(o=e.length;o--;)Zw(e[o])?s=!0:delete e[o];else if(e)for(o in e)Zw(e[o])?s=!0:delete e[o];break;case"number":s=!0;break;default:s=!!e}return s}function $w(e,o,s){s=s||{},o=o||{};var h=s.tileType||"maptile",d=s.scheme||"normal.day";if(S.call(this,{min:0,max:20}),o.pois===!0&&(o.pois="!F"),this.L=o,!(e&&e instanceof ax))throw Error("InvalidArgument: service required");this.m=e,this.i=A(this.i,this),this.m.addEventListener("versionupdate",this.i),this.Yb=e.v().clone().G(h+"/"+e.vc()+"/"+d).I(bx).I(o),this.R=e.f||null,this.T=s.pixelRatio||s.pixelratio||Ue(),this.tileSize=s.tileSize||256,this.tileType=h,this.scheme=d,this.f=new hr(new Pw(s.categoryFilter)),this.f.ka(this),this.u=A(this.u,this),this.f.addEventListener("update",this.u),this.D=!1,S.call(this,{min:0,max:20}),this.J(new Rk(s.tileCacheSize||256,A(this.aa,this)))}u($w,S),t("H.service.metaInfo.TileProvider",$w),$w.prototype.aa=function(e,o){e=o.Ua();for(var s=e.length,h;s--;)h=e[s],delete h.a[o.key],h.release();o.data&&(Cp.push(o.gg(),this.tileSize),o.hg())},$w.prototype.u=function(){this.dispatchEvent("update")},$w.prototype.B=function(e,o,s,h,d){var g=this.Yb.clone(),_=this.R,j=this.tileSize,$=this.getTileKey(e,o,s);$=this.nb().get($);var _t;if($&&!$.Ud()){h(Cp.pop(this.tileSize),null);var _e={cancel:function(){}}}else{_&&g.Ba(_[(s+o+e)%_.length]),g.G(s+"/"+e+"/"+o+"/"+j+"/png8");var _r=Ap.setTimeout(function(){_t=new tf("text/plain",g.toString()),_t.then(function(_n){h(null,_n)},d)},500)}return this.D||(zp($w,"Use HERE Vector Tile API or Raster Tile API v3 instead."),this.D=!0),_e||{cancel:function(){_t?_t.cancel():Ap.clearTimeout(_r)}}},$w.prototype.requestInternal=$w.prototype.B,$w.prototype.ac=function(e,o,s,h,d){var g=this.f,_=h||Cp.pop(this.tileSize);if(h)e=this.nb().get(this.getTileKey(e,o,s)),e.W(h);else if(h=e=new al(this.uc(e,o,s),e,o,s,this.tileSize,this.T,s,g),delete h.l,h.s=d,e.W(_))for(d=e.Ua(),_=d.length;_--;)d[_].pg();else Cp.push(_,this.tileSize);return e},$w.prototype.createTileInternal=$w.prototype.ac,$w.prototype.F=function(){this.f.F(),this.m.removeEventListener("versionupdate",this.i),S.prototype.F.call(this)},$w.prototype.dispose=$w.prototype.F,$w.prototype.i=function(){var e=this.m;this.Yb=e.v().clone().G(this.tileType+"/"+e.vc()+"/"+this.scheme).I(bx).I(this.L),this.reload(!1)};var bx={metadata:"metaonly",mgen:"2"};function ax(e){ax.j.constructor.call(this,ax,e),e=Pp(this,e),this.f=e.shards,(this.b=e.ignoreTypes?null:e.type)&&this.v().Ba(this.b),this.c=e.version,this.l=new lq,this.c==="newest"&&cx(this)}u(ax,Op),t("H.service.metaInfo.Service",ax),ax.prototype.Aa=function(){return{type:"base",version:"newest",subDomain:"maps.ls",path:"maptile/2.1",shards:["1","2","3","4"]}},ax.CONFIG_KEY="metaInfo";function dx(e,o){for(var s={},h=e[o+"s"][o],d=h.length;d--;)s[h[d].id]=h[d];e[o+"s"]=s}ax.prototype.Hj=function(){return this.b},ax.prototype.vc=function(){return this.c},ax.prototype.getVersion=ax.prototype.vc,ax.prototype.ba=function(){return this.l},ax.prototype.getCopyrights=ax.prototype.ba;function cx(e){var o=e.v().clone().G("info").I({output:"json"});e.f&&o.Ba(e.f[0]),e.B(o,function(s){s=s.response;var h;if(dx(s,"map"),dx(s,"scheme"),dx(s,"tiletype"),dx(s,"format"),dx(s,"resolution"),dx(s,"language"),e.c==="newest"&&e.b!=="traffic")for(h in s.maps)s.maps[h].hash&&s.maps[h].newest&&(e.c=s.maps[h].hash,e.dispatchEvent("versionupdate"));e.s=s,e.dispatchEvent("infoupdate")},function(s){throw s})}ax.prototype.Fe=function(){return this.s},ax.prototype.getInfo=ax.prototype.Fe,ax.prototype.ue=function(e,o,s,h,d,g){return new $w(this,h,{tileSize:e,pixelRatio:o,categoryFilter:s,tileType:d,scheme:g})},ax.prototype.createTileProvider=ax.prototype.ue,ax.prototype.nc=function(e,o,s,h,d,g){return new sl(this.ue(e,o,s,h,d,g))},ax.prototype.createTileLayer=ax.prototype.nc,X.prototype.Aj=function(e){return this.Ma(ax,e)},X.prototype.getMetaInfoService=X.prototype.Aj,function(){var e=X.prototype.createDefaultLayers;X.prototype.createDefaultLayers=function(o,s,h,d,g,_){var j=e.call(this,o,s,h,d,g,_),$={},_t=this.Aj();typeof o=="object"&&(_=o,o=_.tileSize,s=_.ppi,h=_.lg,d=_.lg2,g=_.style,_=_.pois),o=o||256;var _e=s===320?2:1;if(0>[72,250,320,500].indexOf(+s)){if(s!==B)throw new D(this.wf,1,s)}else $.ppi=+s;return h&&($.lg=h),d&&($.lg2=d),g&&($.style=g),_&&($.pois=_),j.raster.normal.metaInfo=_t.nc(o,_e,["buildings"],$),j}}(),H.__bootstrap__=`var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(a,b){if(b){var c=ba;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}var ea;
if("function"==typeof Object.setPrototypeOf)ea=Object.setPrototypeOf;else{var fa;a:{var ha={lb:!0},ja={};try{ja.__proto__=ha;fa=ja.lb;break a}catch(a){}fa=!1}ea=fa?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ka=ea;ca("Object.setPrototypeOf",function(a){return a||ka});var p=this||self;
function la(a,b,c){a=a.split(".");c=c||p;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function ma(){}
function na(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function r(a){return"function"==na(a)}function oa(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var pa="closure_uid_"+(1E9*Math.random()>>>0),ra=0;function sa(a,b,c){return a.call.apply(a.bind,arguments)}
function ta(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function ua(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ua=sa:ua=ta;return ua.apply(null,arguments)}
function va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function t(a,b){la(a,b,void 0)}function wa(a,b){function c(){}c.prototype=b.prototype;a.U=b.prototype;a.prototype=new c;a.prototype.constructor=a};function v(){}t("H.util.ICache",v);v.prototype.add=function(){};v.prototype.add=v.prototype.add;v.prototype.get=function(){};v.prototype.get=v.prototype.get;v.prototype.sa=function(){};v.prototype.drop=v.prototype.sa;v.prototype.forEach=function(){};v.prototype.forEach=v.prototype.forEach;v.prototype.S=function(){};v.prototype.removeAll=v.prototype.S;v.prototype.aa=function(){};v.prototype.registerOnDrop=v.prototype.aa;v.prototype.qa=function(){};v.prototype.deRegisterOnDrop=v.prototype.qa;function xa(){var a=ya,b;for(b in a)return!1;return!0}function za(a){var b={},c;for(c in a)b[c]=a[c];return b}var Aa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ba(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Aa.length;f++)c=Aa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Ca=this;function Da(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Da);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}wa(Da,Error);Da.prototype.name="CustomError";var Ea=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var Fa=ua,Ga=String,Ha=Ca.Object.freeze||function(a){return a},x=[].pop(),Ia=/x/.exec("");function Ja(a){return Ga(a).split(","!==x?",":" ")}var Ma="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Na(a,b,c,d){if(!(b=a instanceof b)&&c)throw new y(c,d,void 0!==x?void 0:a);return b}function Oa(a,b,c,d){var e;if(!(e="Array"===Pa(a))&&b)throw new y(b,c,d!==x?d:a);return e}
t("H.lang.isArray",function(a,b,c,d){return Oa(a,b,c,d)});function Qa(a){return"string"===typeof a}t("H.lang.isString",Qa);var Ra=isNaN;function Sa(a){return a===+a}t("H.lang.isNumber",Sa);t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(a){return"number"===typeof a&&0===a%1});function Pa(a){var b=Object[Ma[0]][Ma[6]].call(a).match(/^\\[object (\\w+)\\]$/);return b?b[1]:typeof a}var Ta=[];0>Ta.indexOf(Ta)&&Ta.push(Ta);
function Ua(a,b,c,d){var e="",f=2>arguments.length,g;f&&(b={H:Ca.H},c="",d=Ta.slice());Va(b,!0,function(h,k){try{if(g=h[k],k=Wa(h,g),!(oa(g)&&g.window===g&&g.self===g||oa(g)&&0<g.nodeType&&r(g.cloneNode))&&oa(g)){if(g===a)return e=c+"."+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=Ua(a,g,c+"."+k,d)))return!0}}catch(m){}});f&&(e=e?e.substr(1).replace("."+Ma[0]+".","#"):"~"+(r(a)?Xa(a)+"()":Pa(a)));return e}
function Wa(a,b){var c=[];Va(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(Ya)[0]}function Ya(a,b){return b.length-a.length}var Za=Object[Ma[0]][Ma[2]];function Va(a,b,c){var d;if(a){for(e in a)if((!b||Za.call(a,e))&&c(a,e,!0))return;for(d=Ma.length;d--;){var e=Ma[d];if((!b||Za.call(a,e))&&c(a,e,!1))break}}}function Xa(a){return(a=/^\\s*function ([^\\( ]+)/.exec(a))?a[1]:"anonymous"}function $a(a,b,c){c[b]="#"+b};function A(a,b,c){this.g=[];b&&this.aa(b);if(c&&!r(c))throw new y(A,2,c);this.b=0;this.filter=c;this.a={};this.f=this.c=null;this.Ha(a)}t("H.util.Cache",A);A.prototype.add=function(a,b,c){var d,e;c=+c;if(!Sa(c)||0>c)throw new y(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.a[a])?(d.data!==b&&ab(this,d),this.b+=c-d.size,d.size=c,d.data=b,eb(this,d)):this.a[a]=fb(this,{id:a,data:b,size:c,m:null,C:null},this.c),gb(this);return e};A.prototype.add=A.prototype.add;
A.prototype.aa=function(a){if(!r(a))throw new y(this.aa,0,a);this.g.push(a)};A.prototype.registerOnDrop=A.prototype.aa;A.prototype.qa=function(a){this.g=this.g.filter(function(b){return b!==a})};A.prototype.deRegisterOnDrop=A.prototype.qa;A.prototype.get=function(a,b){return(a=b?this.a[a]:eb(this,this.a[a]))&&a.data};A.prototype.get=A.prototype.get;A.prototype.sa=function(a){var b;(b=this.a[a])&&hb(this,b,!0)};A.prototype.drop=A.prototype.sa;
A.prototype.forEach=function(a,b,c){var d;for(d in this.a){var e=this.a[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};A.prototype.forEach=A.prototype.forEach;A.prototype.S=function(a){var b;for(b in this.a){var c=this.a[b];(a?a(b,c.data,c.size):1)&&hb(this,this.a[b],!0)}};A.prototype.removeAll=A.prototype.S;A.prototype.Ha=function(a){if(!(0<+a))throw new y(A.prototype.Ha,0,a);this.i=+a;gb(this);return this};A.prototype.setMaxSize=A.prototype.Ha;A.prototype.Bb=function(){return this.i};
A.prototype.getMaxSize=A.prototype.Bb;A.prototype.xb=function(){return this.b};A.prototype.getCurrentSize=A.prototype.xb;function eb(a,b){b&&(a.c=fb(a,b,a.c));return b}function gb(a){for(;a.b>a.i&&a.f;)hb(a,a.f,!0)}function fb(a,b,c){if(c!==b){(b.m||b.C)&&hb(a,b,!1);if(b.m=c)b.C=c.C,c.C=b;b.C||(a.c=b);b.m||(a.f=b);a.b+=b.size}return b}function hb(a,b,c){var d=b.C,e=b.m;if(d||e||b==a.c&&b==a.f)d?d.m=e:a.c=e,e?e.C=d:a.f=d,a.b-=b.size,c&&(delete a.a[b.id],ab(a,b));b.m=b.C=null}
function ab(a,b){for(var c=a.g.length;c--;)a.g[c].call(a,b.id,b.data,b.size)};function B(){}t("H.service.extension.dataView.ITable",B);B.prototype.xa=function(){};B.prototype.getMeta=B.prototype.xa;B.prototype.ya=function(){};B.prototype.getRowCount=B.prototype.ya;B.prototype.ga=function(){};B.prototype.getRow=B.prototype.ga;B.prototype.A=function(){};B.prototype.getColumnNames=B.prototype.A;B.prototype.wa=function(){};B.prototype.getColumn=B.prototype.wa;B.prototype.l=function(){};B.prototype.getCell=B.prototype.l;B.prototype.concat=function(){};B.prototype.concat=B.prototype.concat;function ib(){}t("H.service.extension.dataView.IRow",ib);ib.prototype.A=function(){};ib.prototype.getColumnNames=ib.prototype.A;ib.prototype.l=function(){};ib.prototype.getCell=ib.prototype.l;ib.prototype.za=function(){};ib.prototype.getTable=ib.prototype.za;function jb(a,b){this.a=a;this.b=b}t("H.service.extension.dataView.ObjRow",jb);jb.prototype.A=function(){return this.a.A()};jb.prototype.getColumnNames=jb.prototype.A;jb.prototype.l=function(a){return this.a.l(this.b,a)};jb.prototype.getCell=jb.prototype.l;jb.prototype.za=function(){return this.a};jb.prototype.getTable=jb.prototype.za;function kb(){}t("H.service.extension.dataView.IColumn",kb);kb.prototype.l=function(){};kb.prototype.getCell=kb.prototype.l;function lb(a,b){this.b=a;this.a=b}t("H.service.extension.dataView.ObjColumn",lb);lb.prototype.l=function(a){return this.b.l(a,this.a)};lb.prototype.getCell=lb.prototype.l;function y(a,b,c){var d=arguments.length;b=b!==x?+b:b;if(b!==x){var e=(e=/^.*?\\(([^\\)]+)/.exec((""+a).replace(/(\\/\\*([\\s\\S]*?)\\*\\/)|(\\/\\/(.*)$)/gm,"")))?Ja(e[1].replace(/\\s+/g,"")):[];e.forEach($a);e=e[b]||"#"+b}var f=a?Ua(a):"";d=2<d?Ga(c):"";if(e||d)f+=" (Argument "+(e||"")+(d?" "+d:"")+")";d=Error(f);Object.setPrototypeOf(d,y.prototype);return d}wa(y,Error);t("H.lang.InvalidArgumentError",y);y.prototype.name="InvalidArgumentError";function C(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):x);this.D=a;if(b)for(this.M=b,this.pa=a=Object.create(Ia,void 0),d=b.length;d--;)a[b[d]]=!0;c!==x&&(this.Ca=c)}t("H.service.extension.dataView.ObjTable",C);l=C.prototype;l.Ca=x;l.D=x;l.M=x;l.pa=x;l.xa=function(){return this.Ca};C.prototype.getMeta=C.prototype.xa;C.prototype.ya=function(){return this.D?this.D.length:0};C.prototype.getRowCount=C.prototype.ya;C.prototype.ga=function(a){var b=this.D;return b&&b[a]?new jb(this,a):x};
C.prototype.getRow=C.prototype.ga;C.prototype.A=function(){return this.M||mb};C.prototype.getColumnNames=C.prototype.A;C.prototype.wa=function(a){return this.pa[a]?new lb(this,a):x};C.prototype.getColumn=C.prototype.wa;C.prototype.l=function(a,b){var c=this.D;return(a=c&&this.pa[b]&&c[a])&&a[b]};C.prototype.getCell=C.prototype.l;
C.prototype.concat=function(){var a=arguments.length,b,c=this.M,d=""+this.M,e=(this.D||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof C))throw new y(this.concat,b);if(f.D){if(c&&""+f.M!==d)throw new y(this.concat,b,"Incompatible columns!");e=e.concat(f.D)}}return new C(e,this.M,this.Ca)};C.prototype.concat=C.prototype.concat;var D=Math,nb=D.min,ob=D.max,pb=D.round,qb=D.floor,rb=D.ceil,sb=D.abs,tb=D.log,ub=D.sqrt,vb=D.pow,wb=D.exp,xb=D.sin,yb=D.asin,zb=D.cos,Ab=D.tan,Bb=D.atan,Cb=D.atan2,Db=D.LN2,E=D.PI,Eb=E/2,Fb=E/4,Gb=2*E,Hb=3*E,Ib=E/180,Kb=180/E,Lb=1/0;vb(-2,53);function Mb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}t("H.math.normalize",function(a,b,c){b-=c=c||0;a-=c;return a-qb(a/b)*b+c});function Nb(a,b,c){return a>c?c:a<b?b:a}t("H.math.clamp",Nb);function Ob(a,b,c){return b<c?a>=b&&a<=c:a>=c&&a<=b}
function Pb(a,b,c,d,e,f){return ub(vb((a-e)*(d-f)-(b-f)*(c-e),2)/(vb(c-e,2)+vb(d-f,2)))}var Qb={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",Qb);
function Rb(a,b,c){for(var d=c.length,e=d,f,g,h,k,m=c[0],n=0,q=0,u=0;1!=n&&1<e;){g=c[--e];f=c[--e];k=c[e?e-1:(d+(e-1))%d];h=c[e?e-2:(d+(e-2))%d];if(f>=a&&f<=a&&g>=b&&g<=b||h>=a&&h<=a&&k>=b&&k<=b)n=1;else if(!n&&f===a)h===a&&(g<b&&k>b||g>b&&k<b)||(m<=a&&h>a||m>=a&&h<a)&&(g>=b?++q:++u),n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0;else if(!n&&Ob(a,f,h)){if(f<a&&h>a||f>a&&h<a)m=g+(a-f)/(h-f)*(k-g),q+=m>b,u+=m<b;n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0}m=f}!n&&0!==u&&0!==q%2&&(n=3);return n}
function Sb(a,b){return Rb(a.x,a.y,b)!==Qb.NONE}t("H.math.isPointInsidePolygon",Sb);function Tb(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&a[0].x!==x;b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}t("H.math.flatten",Tb);function F(a,b){this.x=+a;this.y=+b}t("H.math.Point",F);F.prototype.set=F;F.prototype.set=F.prototype.set;F.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new F(this.x,this.y);return a};F.prototype.clone=F.prototype.clone;F.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};F.prototype.add=F.prototype.add;F.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};F.prototype.sub=F.prototype.sub;F.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};
F.prototype.scale=F.prototype.scale;F.prototype.round=function(){this.x=pb(this.x);this.y=pb(this.y);return this};F.prototype.round=F.prototype.round;F.prototype.floor=function(){this.x=qb(this.x);this.y=qb(this.y);return this};F.prototype.floor=F.prototype.floor;F.prototype.ceil=function(){this.x=rb(this.x);this.y=rb(this.y);return this};F.prototype.ceil=F.prototype.ceil;F.prototype.F=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};F.prototype.equals=F.prototype.F;
F.prototype.Cb=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=a;if(c||d){var f=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d);0>=f?e=a:1<=f?e=b:e=new F(a.x+f*c,a.y+f*d)}return e};F.prototype.getNearest=F.prototype.Cb;F.prototype.ra=function(a){return ub(vb(this.x-a.x,2)+vb(this.y-a.y,2))};F.prototype.distance=F.prototype.ra;F.fromIPoint=function(a){if(!a)throw Error("invalid argument");return a instanceof F?a:new F(a.x,a.y)};function Ub(a,b,c,d,e,f){var g,h,k=a.length,m,n;if(k)for(g=[];k--;){var q=a[k];var u=q.length;var I=0;for(m=1;m<u;m++)if(n=Vb(q[m-1],q[m],c,b,d,e)){var L=n[0];var w=n[1];I&&I.F(L)?h.push(w):g.push(h=n);I=w;f&&(m=u,k=0)}}else g=a;return g}t("H.math.clipping.clipStrips",Ub);
function Vb(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var m=a;g=h;a=b;h=k;b=m;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var n=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);n&&(a=-a,b=-b);return k?[new F(h,-b),new F(g,-a)]:[new F(g,-a),new F(h,-b)]}
function Wb(a,b,c){a=Xb(a,!0);b=Xb(b,!1);var d,e;var f={};var g=d=1;switch(~~(c||0)){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.W=new Yb(b.x,b.y,null,Zb(b));a.W=new Yb(a.x,a.y,null,Zb(a));for(g=b;g.next;g=g.next)if(!g.u)for(d=a;d.next;d=d.next)if(!d.u){var k=$b(g.next);var m=$b(d.next);if(e=ac(g,k,d,m,f)){e=f.mb;var n=f.nb;var q=f.ec;var u=f.fc;e=new Yb(q,u,null,null,null,null,!0,0,0,e);bc(e,g,k);k=new Yb(q,u,null,null,null,null,!0,0,0,n);bc(k,d,m);e.Da=k;k.Da=e}}f=
Sb(b,cc(a));c&&(f=!f);for(g=b;g;g=g.next)g.u&&(g.Aa=f,f=!f);f=Sb(a,cc(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.u&&(d.Aa=f,f=!f);dc(b);for(dc(a);(a=ec(b))!=b;){for(c=null;!a.na;a=a.Da){for(f=a.Aa;;){c=new Yb(a.x,a.y,c);c.artificial=a.u||a.Wa;a.na=1;a=f?a.next:a.o;if(!a)break;if(a.u){a.na=1;break}}if(!a)break}c.Za=I||null;var I=c}return I}}t("H.math.clipping.clipPolygon",Wb);
function Yb(a,b,c,d,e,f,g,h,k,m){this.x=a;this.y=b;this.next=c||null;this.o=d||null;this.Za=e||null;this.Da=f||null;this.u=!!g;this.Aa=!!h;this.na=k||0;this.alpha=m||0;d&&(d.next=this);c&&(c.o=this);this.Wa=!1;this.W=null}function $b(a){for(;a&&a.u;)a=a.next;return a}function Zb(a){if(a)for(;a.next;)a=a.next;return a}function ec(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.u||b.u&&b.na))}return b}function dc(a){var b=Zb(a);b.o.next=a;a.o=b.o}
function ac(a,b,c,d,e){var f,g=b.x-a.x,h=b.y-a.y;var k=d.x-c.x;var m=d.y-c.y;var n=g*m-h*k;if(!n)return 0;k=((c.x-a.x)*m-(c.y-a.y)*k)/n;n=(h*(c.x-a.x)-g*(c.y-a.y))/n;if(0>k||1<k||0>n||1<n)return 0;0===k?f=a:1===k?f=b:0===n?f=c:1===n&&(f=d);if(f)return f.x+=2.480549651603763E-5,f.y+=7.321997314118067E-5,f.W&&(f.W.x=f.x,f.W.y=f.y),ac(a,b,c,d,e);e.ec=a.x+k*g;e.fc=a.y+k*h;e.mb=k;e.nb=n;return 1}function cc(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}
function bc(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.o=b.o;a.next.o=a;a.o.next=a}function Xb(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=new Yb(a[e].x,a[e].y,d);c.Wa=b;if(c.next=d)d.o=c;d=c}return d};function fc(a,b){var c=[];a&&c.push(Ua(a));1<arguments.length&&c.push(""+b);c=Error(c.join(" "));Object.setPrototypeOf(c,fc.prototype);return c}wa(fc,Error);t("H.lang.IllegalOperationError",fc);fc.prototype.name="IllegalOperationError";function gc(){this.constructor=this.constructor;if(!Qa("STATIC_DB"))throw new y(this.constructor,0);this.i=hc();if(!this.i)throw new fc(this.constructor,"This browser does not support IndexedDB");this.a=[];this.c=[];this.g=Fa(this.g,this)}var ic,jc;gc.prototype.get=function(a,b,c){var d;if(!Qa(a)&&!Sa(a))throw new y(this.get,0);if(!r(b))throw new y(this.get,1);kc(this,function(e){d=e.get(a);lc(d,b,c)},c);return{cancel:function(){d&&(d.onsuccess=mc)}}};
gc.prototype.g=function(){var a=this.b.result;a.objectStoreNames.contains("data")||a.createObjectStore("data")};
function nc(a,b,c){if(a.b)a.a?(a.a.push(b),c&&a.c.push(c)):a.f?c&&c(a.f):b(a.b.result);else{a.b=a.i.open("H_STATIC_DB",1);a.b.onupgradeneeded=a.g;var d=a.b.onerror=function(){clearTimeout(a.j);a.f=this.error;a.c.forEach(function(e){e(a.f)});delete a.a;delete a.c};a.j=setTimeout(function(){d.call({error:Error("DbOpenTimeoutError")})},500);a.b.onsuccess=function(){clearTimeout(a.j);a.a?(a.a.forEach(function(e){e(this.result)},this),delete a.a,delete a.c):(delete a.b,delete a.f,a.a=[],a.c=[])};
a.a.push(b);c&&a.c.push(c)}}function kc(a,b,c){nc(a,function(d){d=d.transaction(["data"],"readwrite");b(d.objectStore("data"))},c)}function lc(a,b,c){b&&(a.onsuccess=function(){b(this.result)});c&&(a.onerror=function(){c(this.error)})}t("H.util.IndexedDBStorage.getInstance",function(){ic||(ic=new gc);return ic});function hc(){return Ca.indexedDB||Ca.webkitIndexedDB||Ca.mozIndexedDB||Ca.msIndexedDB}
t("H.util.IndexedDBStorage.isSupported",function(){var a="";if(jc===x)if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)jc=!1;else{try{var b=hc();a="H_TEST_DB";var c=b&&b.open(a,1)}catch(d){}jc=!!c&&null===c.onupgradeneeded;c&&b.deleteDatabase&&b.deleteDatabase(a)}return jc});function J(){0!=oc&&(pc[this[pa]||(this[pa]=++ra)]=this);this.c=this.c;this.a=this.a}var oc=0,pc={};J.prototype.c=!1;J.prototype.s=function(){if(!this.c&&(this.c=!0,this.v(),0!=oc)){var a=this[pa]||(this[pa]=++ra);if(0!=oc&&this.a&&0<this.a.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pc[a]}};
J.prototype.L=function(a,b){this.c?void 0!==b?a.call(b):a():(this.a||(this.a=[]),this.a.push(void 0!==b?ua(a,b):a))};J.prototype.v=function(){if(this.a)for(;this.a.length;)this.a.shift()()};function K(a,b){this.type=a;this.currentTarget=this.target=b;this.a=!1;this.ab=!0}K.prototype.stopPropagation=function(){this.a=!0};K.prototype.c=function(){this.ab=!1};t("H.util.Event",K);K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.CAPTURING_PHASE=1;K.prototype.CAPTURING_PHASE=K.prototype.CAPTURING_PHASE;K.prototype.AT_TARGET=2;K.prototype.AT_TARGET=K.prototype.AT_TARGET;K.prototype.BUBBLING_PHASE=3;K.prototype.BUBBLING_PHASE=K.prototype.BUBBLING_PHASE;K.prototype.eventPhase=0;K.prototype.eventPhase=K.prototype.eventPhase;function qc(a,b,c){qc.U.constructor.call(this,a,c);this.data=b}wa(qc,K);t("H.util.DataEvent",qc);function rc(a,b,c){rc.U.constructor.call(this,a,c);this.message=b}wa(rc,K);t("H.util.ErrorEvent",rc);function sc(){}t("H.util.ICancelable",sc);sc.prototype.cancel=function(){};sc.prototype.cancel=sc.prototype.cancel;function tc(a,b){this.c=a;this.f=b;this.b=0;this.a=null}tc.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};function uc(a,b){a.f(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};function vc(){this.b=this.a=null}var xc=new tc(function(){return new wc},function(a){a.reset()});vc.prototype.add=function(a,b){var c=xc.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};function yc(){var a=zc,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function wc(){this.next=this.b=this.a=null}wc.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};wc.prototype.reset=function(){this.next=this.b=this.a=null};var Ac=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function Bc(a,b){return a<b?-1:a>b?1:0};var Cc;a:{var Dc=p.navigator;if(Dc){var Ec=Dc.userAgent;if(Ec){Cc=Ec;break a}}Cc=""}function M(a){return-1!=Cc.indexOf(a)};function Hc(a,b){this.b=a===Ic&&b||"";this.a=Jc}var Jc={},Ic={},Kc=new Hc(Ic,"");function Lc(a,b){this.b=a===Mc&&b||"";this.a=Nc}var Nc={},Mc={};function Oc(){this.a="";this.b=Pc}function Qc(){var a=Rc;if(a instanceof Oc&&a.constructor===Oc&&a.b===Pc)return a.a;na(a);return"type_error:SafeHtml"}var Pc={};function Sc(a){var b=new Oc;b.a=a;return b}Sc("<!DOCTYPE html>");var Rc=Sc("");Sc("<br>");function Tc(a){var b=new Lc(Mc,Kc instanceof Hc&&Kc.constructor===Hc&&Kc.a===Jc?Kc.b:"type_error:Const");b instanceof Lc&&b.constructor===Lc&&b.a===Nc?b=b.b:(na(b),b="type_error:TrustedResourceUrl");a.src=b.toString()};function Uc(a){Uc[" "](a);return a}Uc[" "]=ma;var Vc=M("Opera"),Wc=M("Trident")||M("MSIE"),Xc=M("Edge"),Yc=M("Gecko")&&!(-1!=Cc.toLowerCase().indexOf("webkit")&&!M("Edge"))&&!(M("Trident")||M("MSIE"))&&!M("Edge"),Zc=-1!=Cc.toLowerCase().indexOf("webkit")&&!M("Edge");function $c(){var a=p.document;return a?a.documentMode:void 0}var ad;
a:{var bd="",cd=function(){var a=Cc;if(Yc)return/rv:([^\\);]+)(\\)|;)/.exec(a);if(Xc)return/Edge\\/([\\d\\.]+)/.exec(a);if(Wc)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(Zc)return/WebKit\\/(\\S+)/.exec(a);if(Vc)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();cd&&(bd=cd?cd[1]:"");if(Wc){var dd=$c();if(null!=dd&&dd>parseFloat(bd)){ad=String(dd);break a}}ad=bd}var ed={},fd;fd=p.document&&Wc?$c():void 0;function gd(a){var b=document;a=String(a);"application/xhtml+xml"===b.contentType&&(a=a.toLowerCase());return b.createElement(a)};function hd(a){p.setTimeout(function(){throw a;},0)}var id;
function jd(){var a=p.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!M("Presto")&&(a=function(){var e=gd("IFRAME");e.style.display="none";Tc(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(Qc());e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=ua(function(k){if(("*"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},
this);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!M("Trident")&&!M("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Pa;c.Pa=null;e()}};return function(e){d.next={Pa:e};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in gd("SCRIPT")?function(e){var f=gd("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;
f.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){p.setTimeout(e,0)}};function kd(a,b){ld||md();nd||(ld(),nd=!0);zc.add(a,b)}var ld;function md(){if(p.Promise&&p.Promise.resolve){var a=p.Promise.resolve(void 0);ld=function(){a.then(od)}}else ld=function(){var b=od;!r(p.setImmediate)||p.Window&&p.Window.prototype&&!M("Edge")&&p.Window.prototype.setImmediate==p.setImmediate?(id||(id=jd()),id(b)):p.setImmediate(b)}}var nd=!1,zc=new vc;function od(){for(var a;a=yc();){try{a.a.call(a.b)}catch(b){hd(b)}uc(xc,a)}nd=!1};function pd(a){this.a=qd;this.j=void 0;this.f=this.b=this.c=null;this.g=this.i=!1;if(a!=ma)try{var b=this;a.call(void 0,function(c){rd(b,sd,c)},function(c){rd(b,td,c)})}catch(c){rd(this,td,c)}}var qd=0,sd=2,td=3;function ud(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}ud.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var vd=new tc(function(){return new ud},function(a){a.reset()});function wd(a,b,c){var d=vd.get();d.f=a;d.b=b;d.c=c;return d}
function xd(a,b,c){yd(a,b,c,null)||kd(va(b,a))}function zd(a){return new pd(function(b,c){var d=a.length,e=[];if(d)for(var f=function(m,n){d--;e[m]=n;0==d&&b(e)},g=function(m){c(m)},h=0,k;h<a.length;h++)k=a[h],xd(k,va(f,h),g);else b(e)})}function Ad(){var a,b,c=new pd(function(d,e){a=d;b=e});return new Bd(c,a,b)}pd.prototype.then=function(a,b,c){return Cd(this,r(a)?a:null,r(b)?b:null,c)};pd.prototype.$goog_Thenable=!0;
pd.prototype.cancel=function(a){if(this.a==qd){var b=new Dd(a);kd(function(){Ed(this,b)},this)}};function Ed(a,b){if(a.a==qd)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==qd&&1==d?Ed(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Fd(c),Gd(c,e,td,b)))}a.c=null}else rd(a,td,b)}function Hd(a,b){a.b||a.a!=sd&&a.a!=td||Id(a);a.f?a.f.next=b:a.b=b;a.f=b}
function Cd(a,b,c,d){var e=wd(null,null,null);e.a=new pd(function(f,g){e.f=b?function(h){try{var k=b.call(d,h);f(k)}catch(m){g(m)}}:f;e.b=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof Dd?g(h):f(k)}catch(m){g(m)}}:g});e.a.c=a;Hd(a,e);return e.a}pd.prototype.Ea=function(a){this.a=qd;rd(this,sd,a)};pd.prototype.Ga=function(a){this.a=qd;rd(this,td,a)};
function rd(a,b,c){a.a==qd&&(a===c&&(b=td,c=new TypeError("Promise cannot resolve to itself")),a.a=1,yd(c,a.Ea,a.Ga,a)||(a.j=c,a.a=b,a.c=null,Id(a),b!=td||c instanceof Dd||Jd(a,c)))}function yd(a,b,c,d){if(a instanceof pd)return Hd(a,wd(b||ma,c||null,d)),!0;if(a)try{var e=!!a.$goog_Thenable}catch(g){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(oa(a))try{var f=a.then;if(r(f))return Kd(a,f,b,c,d),!0}catch(g){return c.call(d,g),!0}return!1}
function Kd(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function Id(a){a.i||(a.i=!0,kd(a.P,a))}function Fd(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}pd.prototype.P=function(){for(var a;a=Fd(this);)Gd(this,a,this.a,this.j);this.i=!1};
function Gd(a,b,c,d){if(c==td&&b.b&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Ld(b,c,d);else try{b.g?b.f.call(b.c):Ld(b,c,d)}catch(e){Md.call(null,e)}uc(vd,b)}function Ld(a,b,c){b==sd?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function Jd(a,b){a.g=!0;kd(function(){a.g&&Md.call(null,b)})}var Md=hd;function Dd(a){Da.call(this,a)}wa(Dd,Da);Dd.prototype.name="cancel";function Bd(a,b,c){this.a=a;this.b=b;this.reject=c};function Nd(a,b,c){this.type=a;this.data=b;this.a=Ad();this.Xa=Fa(this.Xa,this);this.reject=Fa(this.reject,this);this.priority=Od;c!==x&&(this.priority=c);this.b().add(this)}var Od=1,Pd={hc:0,ic:Od,gc:2};l=Nd.prototype;l.then=function(a,b,c){return this.a.a.then(a,b,c)};l.Xa=function(a){this.Z=3;this.a.b(a)};l.reject=function(a){this.Z=5;this.a.reject(a)};l.Z=0;
l.cancel=function(){if(3>this.Z){this.c();var a=this.b(),b=this.priority,c=a.a[b].indexOf(this);-1<c?a.a[b].splice(c,1):this.Ma&&a.ca.qb(this.Ma);this.Z=4}};Nd.prototype.cancel=Nd.prototype.cancel;function Qd(a){var b;this.a={};for(b in Pd)this.a[Pd[b]]=[];this.ca=a;this.ca.addEventListener("allocatable",Fa(this.b,this))}t("H.util.JobManager",Qd);var Rd=Object.keys(Pd).map(function(a){return Pd[a]}).sort().reverse();Qd.prototype.add=function(a){Na(a,Nd,this.add,0);this.a[a.priority].push(a);this.b()};Qd.prototype.contains=function(a){return-1<this.a[a.priority].indexOf(a)};
Qd.prototype.b=function(){Rd.forEach(function(a){this.a[a]=this.a[a].filter(function(b){var c;if((c=this.ca.jc(b))!==Ia){var d=Fa(this.ca.qb,this.ca,c,b);b.Ma=c;b.then(d,d);b.Z=b.kc(c)?1:5}else return!0},this)},this)};function Sd(a,b,c){var d=[],e=arguments.length;a&&d.push(Ua(a));1<e&&(e=2<e&&Oa(c,void 0,void 0,void 0)?" out of ["+c[0]+"..."+c[1]+"]":"",d.push("("+b+e+")"));d=Error(d.join(" "));Object.setPrototypeOf(d,Sd.prototype);return d}wa(Sd,Error);t("H.lang.OutOfRangeError",Sd);Sd.prototype.name="OutOfRangeError";var Td="closure_listenable_"+(1E6*Math.random()|0),Ud=0;function Vd(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.ha=e;this.key=++Ud;this.T=this.da=!1}function Wd(a){a.T=!0;a.listener=null;a.proxy=null;a.src=null;a.ha=null};function Xd(a){this.src=a;this.a={};this.b=0}Xd.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=Yd(a,b,d,e);-1<g?(b=a[g],c||(b.da=!1)):(b=new Vd(b,this.src,f,!!d,e),b.da=c,a.push(b));return b};function Zd(a,b){var c=b.type;if(c in a.a){var d=a.a[c],e=Ea(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(Wd(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}
Xd.prototype.S=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,Wd(d[e]);delete this.a[c];this.b--}return b};function Yd(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.T&&f.listener==b&&f.capture==!!c&&f.ha==d)return e}return-1};var $d;($d=!Wc)||($d=9<=Number(fd));var ae=$d,be;
if(be=Wc){var ce;if(Object.prototype.hasOwnProperty.call(ed,"9"))ce=ed["9"];else{for(var de=0,ee=Ac(String(ad)).split("."),fe=Ac("9").split("."),ge=Math.max(ee.length,fe.length),he=0;0==de&&he<ge;he++){var ie=ee[he]||"",je=fe[he]||"";do{var ke=/(\\d*)(\\D*)(.*)/.exec(ie)||["","","",""],le=/(\\d*)(\\D*)(.*)/.exec(je)||["","","",""];if(0==ke[0].length&&0==le[0].length)break;de=Bc(0==ke[1].length?0:parseInt(ke[1],10),0==le[1].length?0:parseInt(le[1],10))||Bc(0==ke[2].length,0==le[2].length)||Bc(ke[2],le[2]);
ie=ke[3];je=le[3]}while(0==de)}ce=ed["9"]=0<=de}be=!ce}var me=be,ne=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{p.addEventListener("test",ma,b),p.removeEventListener("test",ma,b)}catch(c){}return a}();function oe(a,b){K.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(Yc){a:{try{Uc(b.nodeName);var e=!0;break a}catch(f){}e=
!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=
a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:pe[a.pointerType]||"";this.b=a;a.defaultPrevented&&this.c()}}wa(oe,K);var pe={2:"touch",3:"pen",4:"mouse"};oe.prototype.stopPropagation=function(){oe.U.stopPropagation.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};
oe.prototype.c=function(){oe.U.c.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,me)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var qe="closure_lm_"+(1E6*Math.random()|0),re={},se=0;function te(a,b,c,d,e){if(d&&d.once)ue(a,b,c,d,e);else if("array"==na(b))for(var f=0;f<b.length;f++)te(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!1,oa(d)?!!d.capture:!!d,e):we(a,b,c,!1,d,e)}
function we(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=oa(e)?!!e.capture:!!e,h=xe(a);h||(a[qe]=h=new Xd(a));c=h.add(b,c,d,g,f);if(!c.proxy){d=ye();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ne||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ze(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");se++}}
function ye(){var a=Ae,b=ae?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function ue(a,b,c,d,e){if("array"==na(b))for(var f=0;f<b.length;f++)ue(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!0,oa(d)?!!d.capture:!!d,e):we(a,b,c,!0,d,e)}
function Be(a,b,c,d,e){if("array"==na(b))for(var f=0;f<b.length;f++)Be(a,b[f],c,d,e);else(d=oa(d)?!!d.capture:!!d,c=ve(c),a&&a[Td])?(a=a.b,b=String(b).toString(),b in a.a&&(f=a.a[b],c=Yd(f,c,d,e),-1<c&&(Wd(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=xe(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yd(b,c,d,e)),(c=-1<a?b[a]:null)&&Ce(c))}
function Ce(a){if("number"!==typeof a&&a&&!a.T){var b=a.src;if(b&&b[Td])Zd(b.b,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ze(c),d):b.addListener&&b.removeListener&&b.removeListener(d);se--;(c=xe(b))?(Zd(c,a),0==c.b&&(c.src=null,b[qe]=null)):Wd(a)}}}function ze(a){return a in re?re[a]:re[a]="on"+a}
function De(a,b,c,d){var e=!0;if(a=xe(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.T&&(f=Ee(f,d),e=e&&!1!==f)}return e}function Ee(a,b){var c=a.listener,d=a.ha||a.src;a.da&&Ce(a);return c.call(d,b)}
function Ae(a,b){if(a.T)return!0;if(!ae){if(!b)a:{b=["window","event"];for(var c=p,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new oe(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.a&&0<=e;e--){b.currentTarget=d[e];var f=De(d[e],a,!0,b);c=c&&f}for(e=0;!b.a&&e<d.length;e++)b.currentTarget=
d[e],f=De(d[e],a,!1,b),c=c&&f}return c}return Ee(a,new oe(b,this))}function xe(a){a=a[qe];return a instanceof Xd?a:null}var Fe="__closure_events_fn_"+(1E9*Math.random()>>>0);function ve(a){if(r(a))return a;a[Fe]||(a[Fe]=function(b){return a.handleEvent(b)});return a[Fe]};function N(){J.call(this);this.b=new Xd(this);this.j=this;this.i=null}wa(N,J);N.prototype[Td]=!0;l=N.prototype;l.B=function(){return this.i};l.la=function(a){this.i=a};l.addEventListener=function(a,b,c,d){te(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Be(this,a,b,c,d)};
l.dispatchEvent=function(a){var b,c=this.B();if(c)for(b=[];c;c=c.B())b.push(c);c=this.j;var d=a.type||a;if("string"===typeof a)a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);Ba(a,e)}e=!0;if(b)for(var f=b.length-1;!a.a&&0<=f;f--){var g=a.currentTarget=b[f];e=g.N(d,!0,a)&&e}a.a||(g=a.currentTarget=c,e=g.N(d,!0,a)&&e,a.a||(e=g.N(d,!1,a)&&e));if(b)for(f=0;!a.a&&f<b.length;f++)g=a.currentTarget=b[f],e=g.N(d,!1,a)&&e;return e};
l.v=function(){N.U.v.call(this);this.b&&this.b.S(void 0);this.i=null};l.N=function(a,b,c){a=this.b.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.T&&f.capture==b){var g=f.listener,h=f.ha||f.src;f.da&&Zd(this.b,f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.ab};t("H.util.EventTarget",N);N.prototype.la=N.prototype.la;N.prototype.setParentEventTarget=N.prototype.la;N.prototype.B=N.prototype.B;N.prototype.getParentEventTarget=N.prototype.B;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.dispatchEvent=N.prototype.dispatchEvent;
N.prototype.dispatchEvent=N.prototype.dispatchEvent;N.prototype.s=N.prototype.s;N.prototype.dispose=N.prototype.s;N.prototype.L=N.prototype.L;N.prototype.addOnDisposeCallback=N.prototype.L;N.prototype.P=N.prototype.N;
N.prototype.N=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?"AT_TARGET":b?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=c.type)&&"pointerleave"!==e)c.eventPhase=g,f=N.prototype.P.apply(this,arguments),d&&this.B&&null===this.B()&&delete c.eventPhase;return f};N.prototype.Yb=function(a){for(var b,c=this;c&&(b=c.B())&&b!==a;)c=b;b||c.la(a)};N.prototype.setRootParentEventTarget=N.prototype.Yb;function Q(a){a=a||{};var b=a.callback;this.g=a.label;r(b)&&(this.callback=b);this.f=!!a.disabled;Q.U.constructor.call(this)}wa(Q,N);t("H.util.ContextItem",Q);Q.prototype.zb=function(){return this.g};Q.prototype.getLabel=Q.prototype.zb;Q.prototype.Xb=function(a){this.g!==a&&(this.g=a,this.dispatchEvent("update"));return this};Q.prototype.setLabel=Q.prototype.Xb;Q.prototype.Ob=function(){return this.f};Q.prototype.isDisabled=Q.prototype.Ob;
Q.prototype.Wb=function(a){a!==this.f&&(this.f=a,this.dispatchEvent("update"));return this};Q.prototype.setDisabled=Q.prototype.Wb;var Ge=new Q;Q.SEPARATOR=Ge;function Ie(a){if(Ca.document){var b=document.createElement("canvas");b.width=b.height=1;b.getContext("2d",{lc:a})}}t("H.util.getPixelRatio",function(){return window.devicePixelRatio||1});Object.create(Ia,void 0);t("H.util.eval",function(a){return eval(a)});t("H.util.provide",function(a){var b=p.$jscomp;if(b&&("function"!=typeof b.wb?0:b.wb()))throw Error("goog.provide cannot be used within a module.");la(a,void 0)});function Je(){this.m=0}
Je.prototype.next=function(a){if(9007199254740992===this.m)throw new Sd(a,this.m,[0,9007199254740991]);return this.m++};var Ke=new Je;Fa(Ke.next,Ke);function mc(){}var mb=Ha([]);Ha({});Ie(!0);Ie(!1);function Le(a,b,c){var d=Nb(+a,-90,90);if(b&&Ra(d))throw new y(b,c,a);return d}function Me(a,b,c){var d=+a;if(-180>d||180<d)d=Mb(d+180,360)-180;if(b&&Ra(d))throw new y(b,c,a);return d}function Ne(a,b,c){var d;if(a!==x&&Ra(d=+a)&&b)throw new y(b,c,a);return d}t("H.geo.isDBC",function(a,b){return 0>a!==0>b&&180<sb(b-a)});function R(){var a=R;if(!0===(Na(this,a)&&this.constructor===a))throw new TypeError("Illegal constructor "+Ua(a));}t("H.geo.AbstractGeometry",R);R.prototype.getBoundingBox=R.prototype.X;R.prototype.equals=R.prototype.F;R.prototype.oa="";R.prototype.va="";R.prototype.toString=function(){return this.eb([this.oa.toUpperCase()," "]).join("")};R.prototype.toString=R.prototype.toString;R.prototype.$b=function(){return{type:this.va,coordinates:this.cb()}};R.prototype.toGeoJSON=R.prototype.$b;
R.prototype.ta=function(){return{type:this.oa,coordinates:this.ua(),boundingBox:this.X().ta()}};R.prototype.forWorkerMessage=R.prototype.ta;function S(a,b,c){this.lat=Le(a,S,0);this.lng=Me(b,S,1);c!==x&&(this.alt=Ne(c,S,2))}wa(S,R);t("H.geo.Point",S);S.prototype.F=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};S.prototype.equals=S.prototype.F;S.prototype.ra=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Ib;var c=a.lat*Ib;a=1.274200158E7*yb(nb(1,ub(vb(xb((b-c)/2),2)+zb(b)*zb(c)*vb(xb((this.lng*Ib-a.lng*Ib)/2),2))))}return a};
S.prototype.distance=S.prototype.ra;
S.prototype.dc=function(a,b,c){var d;if(c){if(d=b/6371000.79){b=a*Ib;a=Ib*this.lat;var e=xb(a);c=xb(d);var f=zb(d);d=Ib*this.lng;var g=zb(a);a=yb(g*zb(b)*c+e*f);b=Cb(xb(b)*g*c,f-e*xb(a));b=(d+b+E)%(2*E)-E;b*=Kb;e=new S(a*Kb,(b+540)%360-180)}return e||this}a=(a%360+360)%360;if(0===(a+90)%180)return a=this.lng+b/(6371000.79*Gb*zb(this.lat*Ib))*(270===a?-360:360),new S(this.lat,(a+540)%360-180);if(b/=6371000.79)a*=Ib,e=this.lat*Ib,c=this.lng*Ib,d=e+b*zb(a),f=d-e,g=tb(Ab(d/2+Fb)/Ab(e/2+Fb)),g=Ra(f/g)?
zb(e):f/g,a=b*xb(a)/g,sb(d)>Eb&&(d=0<d?E-d:-(E+d)),d=new S(d*Kb,((c+a+Hb+(sb(e+f)>Eb?E:0))%Gb-E)*Kb);return d||this};S.prototype.walk=S.prototype.dc;S.prototype.X=function(){return new V(this.lat,this.lng,this.lat,this.lng)};S.prototype.getBoundingBox=S.prototype.X;function Oe(a,b,c){var d=oa(a)&&!(Ra(a.lat=Le(a.lat))||Ra(a.lng=Me(a.lng))||a.alt!==x&&Ra(a.alt=Ne(a.alt)));if(!d&&b)throw new y(b,c,a);return d}S.validate=Oe;function Pe(a){if(!a)throw new y(Pe,0,a);return new S(a.lat,a.lng,a.alt)}
S.fromIPoint=Pe;l=S.prototype;l.oa="Point";l.eb=function(a){a.push("(",this.lng," ",this.lat,")");return a};l.va="Point";l.cb=function(){return[this.lng,this.lat,this.alt||0]};l.ua=function(){return[this.lat,this.lng,this.alt||0]};function Qe(){}function Re(a){return nb(1,ob(0,.5-tb(Ab(Fb+Eb*a/180))/E/2))}Qe.prototype.ia=function(a,b,c){c?(c.x=b/360+.5,c.y=Re(a)):c=new F(b/360+.5,Re(a));return c};Qe.prototype.latLngToPoint=Qe.prototype.ia;Qe.prototype.tb=function(a,b){return this.ia(a.lat,a.lng,b)};Qe.prototype.geoToPoint=Qe.prototype.tb;function Se(a){return 0>=a?90:1<=a?-90:Kb*(2*Bb(wb(E*(1-2*a)))-Eb)}Qe.prototype.V=function(a,b,c){c?(c.lat=Se(b),c.lng=360*(1===a?1:Mb(a,1))-180):c=new S(Se(b),360*(1===a?1:Mb(a,1))-180);return c};
Qe.prototype.xyToGeo=Qe.prototype.V;Qe.prototype.Tb=function(a,b){return this.V(a.x,a.y,b)};Qe.prototype.pointToGeo=Qe.prototype.Tb;var Te=new Qe;t("H.geo.mercator",Te);t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0);t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function W(a,b){this.projection=a||Te;this.b=0;this.a=this.exp=tb(b||256)/Db;Ue(this);this.y=this.x=0}t("H.geo.PixelProjection",W);var Ve=sb(24)+sb(-8);W.prototype.Vb=Te;W.prototype.projection=W.prototype.Vb;W.prototype.x=0;W.prototype.x=W.prototype.x;W.prototype.y=0;W.prototype.y=W.prototype.y;W.prototype.cc=vb(2,Ve);W.prototype.w=W.prototype.cc;W.prototype.Jb=vb(2,Ve);W.prototype.h=W.prototype.Jb;
W.prototype.ba=function(a){if(Ra(a))throw new y(this.ba,0,a);var b=this.x/this.w;var c=this.y/this.h;this.b=a;this.a=this.exp+a;Ue(this);this.x=b*this.w;this.y=c*this.h};W.prototype.rescale=W.prototype.ba;function Ue(a){a.a>Ve&&(a.a=Ve);a.w=vb(2,a.a);a.h=vb(2,a.a)}W.prototype.Ta=function(){return this.b||0};W.prototype.getZoomScale=W.prototype.Ta;W.prototype.sb=function(a,b){a=this.projection.ia(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};W.prototype.geoToPixel=W.prototype.sb;
W.prototype.Fa=function(a,b){return this.projection.V((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};W.prototype.pixelToGeo=W.prototype.Fa;W.prototype.V=function(a,b,c){return this.projection.V((a+this.x)/this.w,(b+this.y)/this.h,c)};W.prototype.xyToGeo=W.prototype.V;W.prototype.Ba=function(a,b,c){a=this.projection.ia(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};W.prototype.latLngToPixel=W.prototype.Ba;W.prototype.Ub=function(a){return new F(a.x*this.w-this.x,a.y*this.h-this.y)};
W.prototype.pointToPixel=W.prototype.Ub;t("H.util.Disposable",J);J.prototype.L=J.prototype.L;J.prototype.addOnDisposeCallback=J.prototype.L;t("H.util.dispose",function(a){a&&"function"==typeof a.s&&a.s()});J.prototype.s=J.prototype.s;J.prototype.dispose=J.prototype.s;J.prototype.v=J.prototype.v;J.prototype.disposeInternal=J.prototype.v;function We(a,b,c,d){if(!a||!b||!c)throw new y(We,x,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c;d&&Ba(this,d)}t("H.util.BuildInfo",We);We.prototype.toString=function(){var a,b=[];for(a in this)Qa(this[a])&&b.push(this[a]);return b.join(";")};var Xe={};function Ye(a,b,c,d){if(!a)throw new y(Ye,1,"Must specify a name parameter");return Xe[a]||(Xe[a]=new We(a,b,c,d))}We.get=Ye;function Y(a,b,c,d,e,f){if(a&&b)this.Ka(a),this.ka(b),this.Ia(c),this.Ja(e),this.bb(f),this.ma(d);else throw new y(Y,x,'Parameters "scheme" and "host" must be specified');}t("H.service.Url",Y);
function Ze(a,b){var c=Ca.document,d;var e="";if(c){e=c.createElement("a");if(b){var f=(d=c.getElementsByTagName("base")[0])&&d.href;var g=c.head;var h=d||g.appendChild(c.createElement("base"));h.href=b}e.href=a;e=e.href;b&&(d?d.href=f:g.removeChild(h))}else/[\\w]+:\\/\\//.test(a)&&(e=a);f=/(?:(\\w+):\\/\\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\\/[^?#]*)?(\\?[^#]+)?(#.*)?/.exec(e);a=f[1];g=f[4];b=f[5];h=f[6];c=f[7];d=f[8];!f[2]&&g&&/@/.test(g)&&(g=g.split("@")[1]);f=Y;h=h&&0<h.length?h.substr(1):
"";e={};var k,m;if(c)for(k=/([?&]?([^=&+]+))(=([^&]+))?/g;m=k.exec(c);)e[decodeURIComponent(m[2])]=m[4]?decodeURIComponent(m[4]):void 0;return new f(a,g,h,e,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):"")}Y.parse=Ze;Y.prototype.clone=function(){var a={},b;for(b in this.a)a[b]=this.a[b];return new Y(this.i,this.g,this.b,a,this.f,this.c)};Y.prototype.clone=Y.prototype.clone;
Y.prototype.Ka=function(a){if(!a||"string"!==typeof a)throw new y(this.Ka,0,'The "scheme" parameter must be a non-empty string.');this.i=a;return this};Y.prototype.setScheme=Y.prototype.Ka;Y.prototype.Gb=function(){return this.i};Y.prototype.getScheme=Y.prototype.Gb;Y.prototype.ka=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw new y(this.ka,0,'The "host" parameter is not a valid host name.');this.g=a;return this};
Y.prototype.setHost=Y.prototype.ka;Y.prototype.yb=function(){return this.g};Y.prototype.getHost=Y.prototype.yb;Y.prototype.Ia=function(a){this.b=a||void 0;return this};Y.prototype.setPath=Y.prototype.Ia;Y.prototype.Db=function(){return this.b};Y.prototype.getPath=Y.prototype.Db;Y.prototype.ma=function(a){if(a)if("object"==typeof a)this.a=a;else throw new y(this.ma,0,'Parameter "params" must be an object.');else this.a={};return this};Y.prototype.setQuery=Y.prototype.ma;Y.prototype.Kb=function(){return!$e(this)};
Y.prototype.hasQuery=Y.prototype.Kb;Y.prototype.getQuery=function(){return this.a};Y.prototype.getQuery=Y.prototype.getQuery;Y.prototype.Ja=function(a){if(void 0===a)this.f=a;else{var b=Nb(+a<<0,0,65535);if(b!=a)throw new y(this.Ja,0,'Parameter "port" must be an integer in range [0...65535]');this.f=b}return this};Y.prototype.setPort=Y.prototype.Ja;Y.prototype.Eb=function(){return this.f};Y.prototype.getPort=Y.prototype.Eb;Y.prototype.bb=function(a){this.c=a||void 0;return this};
Y.prototype.setAnchor=Y.prototype.bb;Y.prototype.ub=function(){return this.c};Y.prototype.getAnchor=Y.prototype.ub;Y.prototype.R=function(a){if("object"!==typeof a)throw new y(this.R,0,'Parameter "other" must be an object.');var b=this.a,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};Y.prototype.mergeQuery=Y.prototype.R;
Y.prototype.Na=function(a){if(!a||"string"!==typeof a)throw new y(this.Na,0,'Parameter "subDomain" must be a non-empty string');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.ka(a+"."+this.g)};Y.prototype.addSubDomain=Y.prototype.Na;Y.prototype.Oa=function(a){if(!a||"string"!==typeof a)throw new y(this.Oa,0,'Parameter "subPath" must be a non-empty string');return this.Ia((this.b?this.b+"/":"")+a)};Y.prototype.addSubPath=Y.prototype.Oa;
Y.prototype.toString=function(){return[this.i+"://",this.g,this.f?":"+this.f:"",this.b||!$e(this)||this.c?"/":"",this.b?encodeURI(this.b):"",af(this),this.c?"#"+encodeURIComponent(this.c):""].join("")};Y.prototype.toString=Y.prototype.toString;function bf(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(b){return"%"+b.charCodeAt(0).toString(16)})}
function af(a){var b=[],c=a.a,d={},e;for(e in c){if(c.hasOwnProperty(e)&&"function"!==typeof c[e]){var f=a.a[e];d.K=bf(e);Na(f,cf)?f.a.forEach(function(g){return function(h){b.push(g.K+"="+bf(h))}}(d)):Na(f,df)?b.push(d.K+"="+f.b.map(function(g){return bf(g)}).join(f.a)):b.push(void 0===f?d.K:d.K+"="+bf(f))}d={K:d.K}}return 0<b.length?"?"+b.join("&"):""}function $e(a){var b,c=0;for(b in a.a)if(a.a.hasOwnProperty(b)&&"function"!==typeof a.a[b]&&(c++,0<c))break;return!c}
function ef(a,b){if(Oa(a,void 0,void 0,void 0))for(var c=0;c<a.length;c++){var d=a[c];if(!Qa(d)&&!Sa(d)){var e="The Array does not contain only strings and numbers";break}}else e="Not an Array";if(e)throw new y(b,0,a);return a}function cf(a){this.a=ef(a,cf)}Y.MultiValueQueryParameter=cf;cf.prototype.Ib=function(){return this.a};cf.prototype.getValues=cf.prototype.Ib;function df(a,b){this.b=ef(a,df);if(!/^[!\\$\\(\\)\\*\\+,;]$/.test(b))throw new y(df,1,'Invalid delimiter "'+b+'"');this.a=b}
Y.DelimitedQuerySubValues=df;var ff={};function gf(a){try{importScripts.apply(self,arguments)}catch(b){this.postError("invalid_script")}}function hf(a){delete ff[a];this.postMessage(a)}function jf(a,b,c){if(r(b))var d=b;else try{d=self.eval("("+b+")"),r(d)||(d=null)}catch(e){}d?(ff[a]=d,c||this.postMessage(a)):this.postError("invalid_processor")}function kf(a){this.b=a&&a[0];this.a=a&&a[1];this.c=a&&a[2]||[]}kf.prototype.postError=function(a){this.postMessage(a,x,0)};
kf.prototype.postMessage=function(a,b,c){self.postMessage({processor:this.b,taskId:this.a,type:c===x?1:c,data:a},b||x)};function lf(a,b,c){if(!Qa(a))throw new y(lf,0,"InvalidArgument");if(!r(b))throw new y(lf,1,"InvalidArgument");var d=mf++;nf[d]={mimeType:c||of,ob:b};(new kf(["3",d,[]])).postMessage(a,[],2)}var nf={},mf=0;
function pf(a,b){var c=a;if(nf[this.a]){var d=nf[this.a];var e=d.ob;delete nf[this.a];if(b)e(null,b);else{if(d.mimeType===qf){a=new Uint8Array(a);b=a.byteLength;d="";c=0;for(var f,g,h,k;c<b;)f=a[c++],192>f||(g=a[c++],224>f?f=(f&31)<<6|g&63:(h=a[c++],240>f?f=(f&15)<<12|(g&63)<<6|h&63:(k=a[c++],f=(f&7)<<18|(g&63)<<12|(h&63)<<6|k&63))),65536>f?d+=String.fromCharCode(f):(f-=65536,d+=String.fromCharCode((f>>10)+55296,(f&1023)+56320));c=d}e(c)}}}var of=0,qf=1;function V(a,b,c,d){rf(this,Le(a,V,0),Me(b,V,1),Le(c,V,2),Me(d,V,3))}wa(V,R);t("H.geo.Rect",V);V.prototype.oa="Polygon";V.prototype.eb=function(a){var b=this.f,c=this.a,d=this.c,e=this.b;a.push("(","(",c," ",b,",",e," ",b,",",e," ",d,",",c," ",d,",",c," ",b,")",")");return a};V.prototype.F=function(a){var b=this===a;!b&&Na(a,V)&&(b=this.f===a.f&&this.a===a.a&&this.c===a.c&&this.b===a.b);return b};V.prototype.equals=V.prototype.F;
V.prototype.clone=function(){return new V(this.f,this.a,this.c,this.b)};V.prototype.clone=V.prototype.clone;function rf(a,b,c,d,e){a.a=c;a.b=e;b<d&&(c=b,b=d,d=c);a.f=b;a.c=d;a.j=a.g=a.i=null;return a}V.prototype.Sa=function(){this.j||(this.j=new S(this.f,this.a));return this.j};V.prototype.getTopLeft=V.prototype.Sa;V.prototype.Ra=function(){this.g||(this.g=new S(this.c,this.b));return this.g};V.prototype.getBottomRight=V.prototype.Ra;V.prototype.Hb=function(){return this.f};V.prototype.getTop=V.prototype.Hb;
V.prototype.vb=function(){return this.c};V.prototype.getBottom=V.prototype.vb;V.prototype.Ab=function(){return this.a};V.prototype.getLeft=V.prototype.Ab;V.prototype.Fb=function(){return this.b};V.prototype.getRight=V.prototype.Fb;V.prototype.G=function(){this.i||(this.i=new S(this.c+(this.f-this.c)/2,sf(this.a,this.I())));return this.i};V.prototype.getCenter=V.prototype.G;V.prototype.I=function(){return tf(this.a,this.b)};V.prototype.getWidth=V.prototype.I;
V.prototype.O=function(){return this.f-this.c};V.prototype.getHeight=V.prototype.O;V.prototype.Nb=function(){return this.a>this.b};V.prototype.isCDB=V.prototype.Nb;V.prototype.Pb=function(){return!this.I()&&!this.O()};V.prototype.isEmpty=V.prototype.Pb;V.prototype.X=function(){return new V(this.f,this.a,this.c,this.b)};V.prototype.getBoundingBox=V.prototype.X;
V.prototype.ea=function(a,b,c){var d=this.G();c||(a=Le(a,this.ea,0),b=Me(b,this.ea,1));b=this.J(a,b,c);a=b.G();return a.lat===d.lat&&a.lng===d.lng&&this.O()===b.O()&&this.I()===b.I()};V.prototype.containsLatLng=V.prototype.ea;V.prototype.fa=function(a,b){b||Oe(a,this.fa,0);return this.ea(a.lat,a.lng,b)};V.prototype.containsPoint=V.prototype.fa;
V.prototype.Qa=function(a,b){var c=this.G();if(!b&&!Na(a,V))throw new y(this.Qa,0,a);b=this.ja(a,b);a=b.G();return a.lat===c.lat&&a.lng===c.lng&&this.O()===b.O()&&this.I()===b.I()};V.prototype.containsRect=V.prototype.Qa;V.prototype.J=function(a,b,c,d){if(!c){if(Ra(a=Le(a)))throw new y(this.J,0,a);if(Ra(b=Me(b)))throw new y(this.J,1,b);}return uf(this.f,this.a,this.c,this.b,a,b,a,b,d)};V.prototype.mergeLatLng=V.prototype.J;
V.prototype.Ya=function(a,b,c){b||Oe(a,this.Ya,0);return this.J(a.lat,a.lng,b,c)};V.prototype.mergePoint=V.prototype.Ya;V.prototype.ja=function(a,b,c){if(!b&&!Na(a,V))throw new y(this.ja,0,a);return uf(this.f,this.a,this.c,this.b,a.f,a.a,a.c,a.b,c)};V.prototype.mergeRect=V.prototype.ja;V.prototype.$=function(a,b,c,d,e,f){e||(a=Le(a,this.$,0),b=Me(b,this.$,1),c=Le(c,this.$,2),d=Me(d,this.$,3));return uf(this.f,this.a,this.c,this.b,a,b,c,d,f)};V.prototype.mergeTopLeftBottomRight=V.prototype.$;
V.prototype.Va=function(a,b){var c=this.a<=this.b,d=a.a<=a.b,e=this.a<a.b,f=a.a<this.b;if(!b&&!Na(a,V))throw new y(this.Va,0,a);return this.c<=a.f&&a.c<=this.f&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};V.prototype.intersects=V.prototype.Va;function tf(a,b){a=b-a;return a+(0>a?360:0)}function sf(a,b){a+=b/2;return a-(180<a?360:0)}
function uf(a,b,c,d,e,f,g,h,k){c=nb(c,g);a=ob(a,e);e=tf(b,d);var m=sf(b,e);g=tf(f,h);var n=sf(f,g)-m;n+=0>n-1E-6?360:0;if(180>n-1E-6){m=b;var q=h}else n=360-n,m=f,q=d;n=n+e/2+g/2;360<=n+5E-7?(m=-180,q=180):n-5E-7<e?(m=b,q=d):n-5E-7<g&&(m=f,q=h);return k?rf(k,a,m,c,q):new V(a,m,c,q)}V.merge=uf;function vf(a,b,c){c||(Oe(a,vf,0),Oe(b,vf,1));return new V(a.lat,a.lng,b.lat,b.lng)}V.fromPoints=vf;
function wf(a,b){var c=1,d=a.length,e=null;var f=na(a);if("array"!=f&&("object"!=f||"number"!=typeof a.length))throw new y(wf,0,a);if(0<d)for(f=a[0],e=vf(f,f,b);c<d;c++)f=a[c],e.J(f.lat,f.lng,b,e);return e}V.coverPoints=wf;function xf(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new y(xf,0,a);if(0<d)for(e=new V(a[0],a[1],a[0],a[1]);c<d;c+=3)e.J(a[c],a[c+1],b,e);return e}V.coverLatLngAlts=xf;
function yf(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new y(yf,0,a);if(0<d)for(e=new V(a[0].f,a[0].a,a[0].c,a[0].b);c<d;c++)e.ja(a[c],b,e);return e}V.coverRects=yf;
V.prototype.$a=function(a,b){var c=this.a,d=this.f,e=this.b,f=this.c,g=this.G().lng;Oe(a,this.$a,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?rf(b,d,a,f,e):new V(d,a,f,e)};V.prototype.resizeToCenter=V.prototype.$a;V.prototype.va="Polygon";
V.prototype.cb=function(){return[[this.a,this.f,0],[this.b,this.f,0],[this.b,this.c,0],[this.a,this.c,0],[this.a,this.f,0]]};V.prototype.ta=function(){return this.ua()};V.prototype.ua=function(){return[this.f,this.a,this.c,this.b]};function zf(a,b,c,d){this.key="";this.x=a;this.y=b;this.b=c;this.Y=d;this.a=Ad()}zf.prototype.then=function(a,b,c){return this.a.a.then(a,b,c)};zf.prototype.reject=function(a){this.a.reject(a)};zf.prototype.cancel=function(){this.a.a.cancel()};zf.prototype.cancel=zf.prototype.cancel;function Af(a,b,c,d){var e=!!c,f,g=0,h=0,k=0,m=0,n=0,q,u=-1;var I=Ca.Float32Array;var L,w=[];if(b){b=Ja(b);a=Ja(a);e&&(f=Ja(c));c=b.length;d=d?1E-7:1E-5;for(L=new I(3*c);g<c;){I=b[g];var G=+I;var X=+a[g];e&&(q=+f[g]);Bf.test(I)?0<=u&&(0<g-u&&w.push(u,g+1),u=-1):0>u&&(u=g);g++;m=L[h++]=m+X*d;k=L[h++]=k+G*d;e&&(n=L[h]=n+q);h++}0<=u&&1<c-u&&w.push(u,c)}else L=new I(0);return{path:L,outlineIndices:w}}var Bf=/^-?0\\d/;
function Cf(a,b){for(var c=0,d=a.length/3,e=new Ca.Array(d),f=0;c<d;)e[c++]=b.Ba(a[f],a[++f]),f+=2;return e};function Df(a,b){b=180/(1<<b);var c=a.lat+90;a=(a.lng+180)%360;var d=0;180==c&&d--;d+=Math.floor(c/b);return[d,Math.floor(a/b)]}var Ef=1/Math.pow(10,10);function Ff(a,b){var c=[],d=a.Sa();a=a.Ra();var e;180==a.lng&&(a.lng-=Ef);d=Df(d,b);a=Df(a,b);for(e=d[0];e>=a[0];e--)for(b=d[1];b<=a[1];b++)c.push(e,b);return c};function Gf(a,b){var c=a.tileSize||256;this.b={};this.j=Ze(a.serverUrl);this.g=b;this.fb=a.layerConfigs||[];this.i=a.projected;this.P=c;this.Ea=!1!==a.batchTiles;this.bc=a.horizontalMargin||0;this.gb=a.onlyOutline;this.ib=new W(x,c);this.f=new W(x,c);this.f.ba(22-Math.log(c)/Math.LN2+8)}wa(Gf,J);
Gf.prototype.kb=function(a,b,c){var d=this.P,e=this.bc,f={x:a*d-e,y:b*d};d={x:(a+1)*d-1+e,y:(b+1)*d-1};e=this.ib;e.ba(c);f=e.Fa(f);d=e.Fa(d);return Hf(this,new V(f.lat,f.lng,d.lat,d.lng),this.fb,{x:a,y:b,z:c})};Gf.prototype.jb=function(a,b,c,d,e){return Hf(this,new V(a,b,c,d),e)};
function Hf(a,b,c,d){var e=If(c),f=e.length,g={},h,k=a.b,m=[],n=[];for(c=0;c<f;c++){var q=e[c];var u=q.layerId;var I=q.level;g[u]=q.columns;q=Ff(b,I);var L=q.length-1;for(h=0;h<L;h+=2){var w=[u,q[h+1],q[h],I].join("_");var G=k[w]||a.g.get(w);G||(G=new zf(q[h+1],q[h],I,u),G.key=w,k[w]=G,n.push(G));m.push(G)}}n.length&&(a.Ea?Jf(a,n):Kf(a,n));return zd(m.map(function(X){return X.then(Fa(this.Ga,this,X.Y,Lf(e))).then(Fa(this.hb,this,X,d||Mf)).then(Fa(this.ac,this,g[X.Y]))},a))}var Mf={x:0,y:0,z:0};
Gf.prototype.Ga=function(a,b,c){var d=c.Rows,e=d.length,f,g;if(e&&(f=b[a])){b=new C(c.Rows);var h=[];for(g=0;g<e;g++){var k=d[g];f(b.ga(g),a)&&h.push(k)}a={Rows:h};if(c=c.Meta)a.Meta=c}else a=c;return a};function Kf(a,b){function c(k,m,n){n?(delete a.b[k.key],k.reject(n)):Nf(a,k,m)}var d,e=b.length,f=a.j;for(d=0;d<e;d++){var g=b[d];var h=f.clone().R({tilex:g.x}).R({tiley:g.y}).R({level:g.b}).R({layer:g.Y});new lf(h.toString(),Fa(c,null,g),qf)}}
function Jf(a,b){var c=b.length,d;for(d=0;d<c;d+=15){var e=b.slice(d,d+15);Of(a,e)}}function Of(a,b){var c=a.j.clone(),d=[],e=[],f=[],g=c.getQuery();b.length&&(b.forEach(function(h){d.push(h.x,h.y);e.push(h.b);f.push(h.Y)}),g.tilexy=d.join(","),g.layers=f.join(","),g.levels=e.join(","),c.ma(g),new lf(c.toString(),function(h,k){k?b.forEach(function(m){delete a.b[m.key];m.reject("error")}):Nf(a,b,h)},qf))}
function Nf(a,b,c){var d=b.length,e;if(Oa(b,void 0,void 0,void 0)){var f=c.indexOf("[")+1;for(e=0;e<d;e++){var g=c.indexOf("]},{",f+3)+2;g<f&&(g=c.lastIndexOf("]}"));var h=c.substr(f,g-f);f=g+1;Pf(a,b[e],h)}}else Pf(a,b,c)}function Pf(a,b,c){try{var d=c.length;var e=b.key;delete a.b[e];a.g.add(e,b,2*d);var f=JSON.parse(c);b.a.b(f)}catch(g){b.reject(g.message)}}
function Lf(a){var b={},c,d=a.length;for(c=0;c<d;c++){var e=a[c];if(e.rowFilter){var f=e.layerId;f=f!==x?f:e.layer;b[f]=Fa(e.rowFilter,e.rowFilterContext)}}return b}function Qf(a,b,c,d,e){return e?[new F(a,b),new F(c,b),new F(c,d),new F(a,d),new F(a,b)]:[a,b,c,b,c,d,a,d]}
Gf.prototype.hb=function(a,b,c){var d=this.f.Ta()-b.z,e=this.P<<d,f=50<<d,g=b.x*e;b=b.y*e;var h=g+e;e=b+e;var k=g-f,m=b-f,n=h+f;f=e+f;var q,u,I=c.Rows,L=I.length,w,G=/^ADAS/.test(a.Y),X=this.f,qa=this.gb,O,bb=[],Ka=[],La=[],cb=[];for(a=0;a<L;a++){var z=w=I[a];var T=(O=G)?"HPY":"LAT";var U=O?"HPX":"LON";var da=O?"HPZ":"ZLEVEL";if(z[T]){var P=Af(z[T],z[U],z[da],O);z.geometry=P;delete z[T];delete z[U];delete z[da];if(z.INNER_LAT)for(T=z.INNER_LAT.split(";"),P=z.INNER_LON.split(";"),delete z.INNER_LAT,
delete z.INNER_LON,z.interiors=da=[],U=T.length,z=0;z<U;z++)da.push(Af(T[z],P[z],"",O))}if(this.i){U=w;z=X;P=U.$$projected$$;T=0;if(!P){var Z=U.geometry;O=Cf(Z.path,z);w=[O];U.$$projected$$=P={Sb:w};U=(da=U.interiors)?da.length:0;w.length+=U;T|=+Rf(w,O,Z.outlineIndices);if(U)for(P.Lb=1,q=0;q<U;q++)Z=da[q],O=Cf(Z.path,z),w[1+q]=O,T|=+Rf(w,O,Z.outlineIndices);T&&(P.Qb=1+U)}z=P;O=z.Sb;w=z.Lb;var Fc=z.Qb;P=[];T=U=Lb;var db=da=x;z=O[0];if(1===z.length){var Gc=Gc||(Gc=Qf(g,b,h,e,!1));w=z[0];Rb(w.x,w.y,
Gc)&&P.push(Sf(z,g,b,d))}else{var He=O.length;for(Z=qa?Fc:0;Z<He&&(qa||!Z||P.length);Z++)if(z=O[Z],Z>=Fc){Z===Fc&&(T=P.length);var ia=Ub([z],k,m,n,f,!1);Tf(ia,g,b,d,P)}else{var Jb=Jb||(Jb=Qf(k,m,n,f,!0));if(Z>=w)if(Z===w&&(U=P.length),db)for(q=db.length;q--;){if(ia=Uf(db[q],z),u=ia.length){for(da=da||[];u--;)da.push(q);Tf(ia,g,b,d,P)}}else ia=Uf(Jb,z),Tf(ia,g,b,d,P);else if(ia=Uf(Jb,z),Tf(ia,g,b,d,P),1<ia.length&&w<He)for(db=[],q=ia.length;q--;)db[q]=ia[q]}}P.length&&(bb[a]=P,Ka[a]=U,La[a]=da,cb[a]=
T)}}return{Zb:c,pb:bb,Mb:Ka,rb:La,Rb:cb}};function Rf(a,b,c){for(var d=c.length,e=0,f,g,h=b.length;e<d;)f=c[e++],g=c[e++],a.push(g-f===h?b:b.slice(f,g));return 0<c.length}function Uf(a,b){var c,d=[];if(c=Wb(a,b)){do{a=[];b=c;do a.push(b);while(b=b.next);d.push(a)}while(c=c.Za)}else Sb(b[0],Tb(a))?d.push(b):Sb(a[0],Tb(b))&&d.push(a);return d}function Tf(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++)e.push(Sf(a[f],b,c,d))}
function Sf(a,b,c,d){var e,f=a.length,g=new Int32Array(2*f),h=0;for(e=0;e<f;e++){var k=a[e];g[h++]=k.x-b>>d;g[h++]=k.y-c>>d}return g}
Gf.prototype.ac=function(a,b){var c=b.Zb,d=b.pb,e=b.Mb,f=b.Rb;b=b.rb;for(var g=[],h,k={Rows:g},m,n=a?a.length:0,q=0,u,I=c.Rows,L=I.length,w;q<L;q+=1)if(d[q]||!this.i){h={};u=I[q];if(n)for(m=0;m<n;m++)u.hasOwnProperty(a[m])&&(h[a[m]]=u[a[m]]);else for(w in u)"$$projected$$"!==w&&(h[w]=u[w]);u.geometry&&(h.geometry=u.geometry);m=void 0;var G,X=h,qa=d[q],O=e[q],bb=b[q],Ka=f[q],La=g;if(qa){var cb=qa.length;if(bb)for(G=O;G--;){if(G){var z={};for(m in X)z[m]=X[m]}else z=X;u=[qa[G]];var T=nb(cb,Ka)-O;for(h=
0;h<T;h++)bb[h]===G&&u.push(qa[O+h]);T=u.length;if(!G)for(h=Ka;h<cb;h++)u.push(qa[h]);z.$HProjGeometry={paths:u,interiorsIndex:1,outlinesIndex:T};La.push(z)}else X.$HProjGeometry={paths:qa,interiorsIndex:O,outlinesIndex:Ka},La.push(X)}else La.push(X)}c.Meta&&(k.Meta=c.Meta);return k};Gf.prototype.v=function(){var a,b=this.b;for(a in b)b.hasOwnProperty(a)&&(b[a].reject("disposed"),delete b[a])};Gf.prototype.disposeInternal=Gf.prototype.v;
function If(a){for(var b=[],c,d=a.length,e=0;e<d;e++){c=za(a[e]);if(c.rowFilter&&(c.rowFilter=eval("("+c.rowFilter+")"),!r(c.rowFilter)))throw Error("Invalid row filter for layer "+c.layerId);b.push(c)}return b};t("H.service.extension.worker.processor",function(a,b,c){function d(h){e.postMessage(h)}var e=this,f=ya[a];var g=function(h){e.postError(h.toString())};if(0===b)f||(ya[a]=new Gf(c,Vf)),this.postMessage(void 0);else if(f)switch(b){case 1:try{f.kb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 2:try{f.jb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 3:f.s();delete ya[a];xa()&&Vf.S();break;default:e.postError("Unsupported command")}});
var Vf=new A(26214400),ya=Object.create(Ia,void 0);function Wf(a,b,c){var d=a[b];a=a[b+1];this.Ua=[];this.La=0;this.b=b;this.a=[a-c,d-c,a+c,d+c]}Wf.prototype.fa=function(a,b){var c=a[b];a=a[b+1];b=this.a;return b[1]<=c&&c<=b[3]&&b[0]<=a&&a<=b[2]};Wf.prototype.G=function(){return this.b};var Xf=new F(0,0);function Yf(a,b,c,d,e){d[e]=b;d[e+1]=a}var Zf=new W;function $f(a,b,c,d,e){Zf.Ba(a,b,Xf);d[e]=Xf.x;d[e+1]=Xf.y}
t("H.clustering.dynamicgrid.worker",function(a,b,c,d,e){var f=e?Yf:$f,g=0;e=!!self.ArrayBuffer;var h=a.byteLength?new Float64Array(a):a,k=h.length/3;a=[];var m=[],n=[],q=e?new Float64Array(2*k):[];k=0;var u=0;for(Zf.ba(d);g<h.length;){var I=h[g++];var L=h[g++];var w=h[g++];f(w,L,d,q,u);for(w=a.length;w--;)if(L=a[w],L.fa(q,u)){var G=L;break}G||(G=new Wf(q,u,b),a.push(G));w=u/2;G.La+=I||1;G.Ua.push(w);G=null;u+=2}for(w=a.length;w--;)L=a[w],b=L.La>=c,f=L.Ua,d=f.length,b?(m.push(d),m=m.concat(f)):
(k+=d,n=n.concat(f));c=[k].concat(n,m);c=e?(new Uint32Array(c)).buffer:c;this.postMessage(c,[c])});self.addEventListener("message",function(a){a=new kf(a.data);var b=ff[a.b];if(b)try{b.apply(a,a.c)}catch(c){a.postError(c.message)}else a.postError("processor_not_found")});(function(){var a=new kf;var b=function(c,d){jf.apply(a,[c,d,!0])};b("0",gf);b("1",jf);b("2",hf);b("3",pf)})();
`,function(){var f=function(){var target=(typeof self>"u"||!(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope))&&(typeof module<"u"&&module.exports||typeof window<"u"),__worker_src__,__worker_src_map__,__worker_src_origin__;target&&(__worker_src__=f.toString(),__worker_src_map__="",__worker_src_origin__=typeof document<"u"&&document.currentScript instanceof HTMLScriptElement?document.currentScript.src:""),function(){var toString={}.toString,classofRaw=function(e){return toString.call(e).slice(8,-1)},commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function createCommonjsModule(e,o){return e(o={exports:{}},o.exports),o.exports}var O="object",check=function(e){return e&&e.Math==Math&&e},global_1=check(typeof globalThis==O&&globalThis)||check(typeof window==O&&window)||check(typeof self==O&&self)||check(typeof commonjsGlobal==O&&commonjsGlobal)||Function("return this")(),fails=function(e){try{return!!e()}catch{return!0}},descriptors=!fails(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),isObject=function(e){return typeof e=="object"?e!==null:typeof e=="function"},document$1=global_1.document,exist=isObject(document$1)&&isObject(document$1.createElement),documentCreateElement=function(e){return exist?document$1.createElement(e):{}},ie8DomDefine=!descriptors&&!fails(function(){return Object.defineProperty(documentCreateElement("div"),"a",{get:function(){return 7}}).a!=7}),anObject=function(e){if(!isObject(e))throw TypeError(String(e)+" is not an object");return e},toPrimitive=function(e,o){if(!isObject(e))return e;var s,h;if(o&&typeof(s=e.toString)=="function"&&!isObject(h=s.call(e))||typeof(s=e.valueOf)=="function"&&!isObject(h=s.call(e))||!o&&typeof(s=e.toString)=="function"&&!isObject(h=s.call(e)))return h;throw TypeError("Can't convert object to primitive value")},nativeDefineProperty=Object.defineProperty,f=descriptors?nativeDefineProperty:function(e,o,s){if(anObject(e),o=toPrimitive(o,!0),anObject(s),ie8DomDefine)try{return nativeDefineProperty(e,o,s)}catch{}if("get"in s||"set"in s)throw TypeError("Accessors not supported");return"value"in s&&(e[o]=s.value),e},objectDefineProperty={f},createPropertyDescriptor=function(e,o){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:o}},hide=descriptors?function(e,o,s){return objectDefineProperty.f(e,o,createPropertyDescriptor(1,s))}:function(e,o,s){return e[o]=s,e},setGlobal=function(e,o){try{hide(global_1,e,o)}catch{global_1[e]=o}return o},isPure=!1,shared=createCommonjsModule(function(e){var o="__core-js_shared__",s=global_1[o]||setGlobal(o,{});(e.exports=function(h,d){return s[h]||(s[h]=d!==void 0?d:{})})("versions",[]).push({version:"3.1.0",mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),id=0,postfix=Math.random(),uid=function(e){return"Symbol(".concat(e===void 0?"":e,")_",(++id+postfix).toString(36))},nativeSymbol=!fails(function(){return!String(Symbol())}),store=shared("wks"),Symbol$1=global_1.Symbol,wellKnownSymbol=function(e){return store[e]||(store[e]=nativeSymbol&&Symbol$1[e]||(nativeSymbol?Symbol$1:uid)("Symbol."+e))},TO_STRING_TAG=wellKnownSymbol("toStringTag"),CORRECT_ARGUMENTS=classofRaw(function(){return arguments}())=="Arguments",tryGet=function(e,o){try{return e[o]}catch{}},classof=function(e){var o,s,h;return e===void 0?"Undefined":e===null?"Null":typeof(s=tryGet(o=Object(e),TO_STRING_TAG))=="string"?s:CORRECT_ARGUMENTS?classofRaw(o):(h=classofRaw(o))=="Object"&&typeof o.callee=="function"?"Arguments":h},TO_STRING_TAG$1=wellKnownSymbol("toStringTag"),test={};test[TO_STRING_TAG$1]="z";var objectToString=String(test)!=="[object z]"?function(){return"[object "+classof(this)+"]"}:test.toString,hasOwnProperty={}.hasOwnProperty,has=function(e,o){return hasOwnProperty.call(e,o)},functionToString=shared("native-function-to-string",Function.toString),WeakMap=global_1.WeakMap,nativeWeakMap=typeof WeakMap=="function"&&/native code/.test(functionToString.call(WeakMap)),shared$1=shared("keys"),sharedKey=function(e){return shared$1[e]||(shared$1[e]=uid(e))},hiddenKeys={},WeakMap$1=global_1.WeakMap,set,get,has$1,enforce=function(e){return has$1(e)?get(e):set(e,{})},getterFor=function(e){return function(o){var s;if(!isObject(o)||(s=get(o)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return s}},store$1,wmget,wmhas,wmset,set,get,has$1,STATE;has$1=nativeWeakMap?(store$1=new WeakMap$1,wmget=store$1.get,wmhas=store$1.has,wmset=store$1.set,set=function(e,o){return wmset.call(store$1,e,o),o},get=function(e){return wmget.call(store$1,e)||{}},function(e){return wmhas.call(store$1,e)}):(STATE=sharedKey("state"),hiddenKeys[STATE]=!0,set=function(e,o){return hide(e,STATE,o),o},get=function(e){return has(e,STATE)?e[STATE]:{}},function(e){return has(e,STATE)});var internalState={set,get,has:has$1,enforce,getterFor},redefine=createCommonjsModule(function(e){var o=internalState.get,s=internalState.enforce,h=String(functionToString).split("toString");shared("inspectSource",function(d){return functionToString.call(d)}),(e.exports=function(d,g,_,j){var $=!!j&&!!j.unsafe,_t=!!j&&!!j.enumerable,_e=!!j&&!!j.noTargetGet;typeof _=="function"&&(typeof g!="string"||has(_,"name")||hide(_,"name",g),s(_).source=h.join(typeof g=="string"?g:"")),d!==global_1?($?!_e&&d[g]&&(_t=!0):delete d[g],_t?d[g]=_:hide(d,g,_)):_t?d[g]=_:setGlobal(g,_)})(Function.prototype,"toString",function(){return typeof this=="function"&&o(this).source||functionToString.call(this)})}),ObjectPrototype=Object.prototype;objectToString!==ObjectPrototype.toString&&redefine(ObjectPrototype,"toString",objectToString,{unsafe:!0});var ceil=Math.ceil,floor=Math.floor,toInteger=function(e){return isNaN(e=+e)?0:(0<e?floor:ceil)(e)},requireObjectCoercible=function(e){if(e==null)throw TypeError("Can't call method on "+e);return e},stringAt=function(e,o,s){var h,d,g=String(requireObjectCoercible(e)),_=toInteger(o),j=g.length;return _<0||j<=_?s?"":void 0:(h=g.charCodeAt(_))<55296||56319<h||_+1===j||(d=g.charCodeAt(_+1))<56320||57343<d?s?g.charAt(_):h:s?g.slice(_,_+2):d-56320+(h-55296<<10)+65536},nativePropertyIsEnumerable={}.propertyIsEnumerable,nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,NASHORN_BUG=nativeGetOwnPropertyDescriptor&&!nativePropertyIsEnumerable.call({1:2},1),f$1=NASHORN_BUG?function(e){var o=nativeGetOwnPropertyDescriptor(this,e);return!!o&&o.enumerable}:nativePropertyIsEnumerable,objectPropertyIsEnumerable={f:f$1},split="".split,indexedObject=fails(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return classofRaw(e)=="String"?split.call(e,""):Object(e)}:Object,toIndexedObject=function(e){return indexedObject(requireObjectCoercible(e))},nativeGetOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,f$2=descriptors?nativeGetOwnPropertyDescriptor$1:function(e,o){if(e=toIndexedObject(e),o=toPrimitive(o,!0),ie8DomDefine)try{return nativeGetOwnPropertyDescriptor$1(e,o)}catch{}if(has(e,o))return createPropertyDescriptor(!objectPropertyIsEnumerable.f.call(e,o),e[o])},objectGetOwnPropertyDescriptor={f:f$2},min=Math.min,toLength=function(e){return 0<e?min(toInteger(e),9007199254740991):0},max=Math.max,min$1=Math.min,toAbsoluteIndex=function(e,o){var s=toInteger(e);return s<0?max(s+o,0):min$1(s,o)},arrayIncludes=function(e){return function(o,s,h){var d,g=toIndexedObject(o),_=toLength(g.length),j=toAbsoluteIndex(h,_);if(e&&s!=s){for(;j<_;)if((d=g[j++])!=d)return!0}else for(;j<_;j++)if((e||j in g)&&g[j]===s)return e||j||0;return!e&&-1}},arrayIndexOf=arrayIncludes(!1),objectKeysInternal=function(e,o){var s,h=toIndexedObject(e),d=0,g=[];for(s in h)!has(hiddenKeys,s)&&has(h,s)&&g.push(s);for(;o.length>d;)has(h,s=o[d++])&&(~arrayIndexOf(g,s)||g.push(s));return g},enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],hiddenKeys$1=enumBugKeys.concat("length","prototype"),f$3=Object.getOwnPropertyNames||function(e){return objectKeysInternal(e,hiddenKeys$1)},objectGetOwnPropertyNames={f:f$3},f$4=Object.getOwnPropertySymbols,objectGetOwnPropertySymbols={f:f$4},Reflect$1=global_1.Reflect,ownKeys=Reflect$1&&Reflect$1.ownKeys||function(e){var o=objectGetOwnPropertyNames.f(anObject(e)),s=objectGetOwnPropertySymbols.f;return s?o.concat(s(e)):o},copyConstructorProperties=function(e,o){for(var s=ownKeys(o),h=objectDefineProperty.f,d=objectGetOwnPropertyDescriptor.f,g=0;g<s.length;g++){var _=s[g];has(e,_)||h(e,_,d(o,_))}},replacement=/#|\.prototype\./,isForced=function(e,o){var s=data[normalize(e)];return s==POLYFILL||s!=NATIVE&&(typeof o=="function"?fails(o):!!o)},normalize=isForced.normalize=function(e){return String(e).replace(replacement,".").toLowerCase()},data=isForced.data={},NATIVE=isForced.NATIVE="N",POLYFILL=isForced.POLYFILL="P",isForced_1=isForced,getOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,_export=function(e,o){var s,h,d,g,_=e.target,j=e.global,$=e.stat,_t=j?global_1:$?global_1[_]||setGlobal(_,{}):(global_1[_]||{}).prototype;if(_t)for(s in o){if(d=o[s],h=e.noTargetGet?(g=getOwnPropertyDescriptor(_t,s))&&g.value:_t[s],!isForced_1(j?s:_+($?".":"#")+s,e.forced)&&h!==void 0){if(typeof d==typeof h)continue;copyConstructorProperties(d,h)}(e.sham||h&&h.sham)&&hide(d,"sham",!0),redefine(_t,s,d,e)}},toObject=function(e){return Object(requireObjectCoercible(e))},correctPrototypeGetter=!fails(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),IE_PROTO=sharedKey("IE_PROTO"),ObjectPrototype$1=Object.prototype,objectGetPrototypeOf=correctPrototypeGetter?Object.getPrototypeOf:function(e){return e=toObject(e),has(e,IE_PROTO)?e[IE_PROTO]:typeof e.constructor=="function"&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ObjectPrototype$1:null},ITERATOR=wellKnownSymbol("iterator"),BUGGY_SAFARI_ITERATORS=!1,returnThis=function(){return this},IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=objectGetPrototypeOf(objectGetPrototypeOf(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS=!0),IteratorPrototype==null&&(IteratorPrototype={}),has(IteratorPrototype,ITERATOR)||hide(IteratorPrototype,ITERATOR,returnThis);var iteratorsCore={IteratorPrototype,BUGGY_SAFARI_ITERATORS},objectKeys=Object.keys||function(e){return objectKeysInternal(e,enumBugKeys)},objectDefineProperties=descriptors?Object.defineProperties:function(e,o){anObject(e);for(var s,h=objectKeys(o),d=h.length,g=0;g<d;)objectDefineProperty.f(e,s=h[g++],o[s]);return e},document$2=global_1.document,html=document$2&&document$2.documentElement,IE_PROTO$1=sharedKey("IE_PROTO"),PROTOTYPE="prototype",Empty=function(){},createDict=function(){var e,o=documentCreateElement("iframe"),s=enumBugKeys.length,h="script";for(o.style.display="none",html.appendChild(o),o.src="javascript:",(e=o.contentWindow.document).open(),e.write("<script>document.F=Object</"+h+">"),e.close(),createDict=e.F;s--;)delete createDict[PROTOTYPE][enumBugKeys[s]];return createDict()},objectCreate=Object.create||function(e,o){var s;return e!==null?(Empty[PROTOTYPE]=anObject(e),s=new Empty,Empty[PROTOTYPE]=null,s[IE_PROTO$1]=e):s=createDict(),o===void 0?s:objectDefineProperties(s,o)};hiddenKeys[IE_PROTO$1]=!0;var defineProperty=objectDefineProperty.f,TO_STRING_TAG$2=wellKnownSymbol("toStringTag"),setToStringTag=function(e,o,s){e&&!has(e=s?e:e.prototype,TO_STRING_TAG$2)&&defineProperty(e,TO_STRING_TAG$2,{configurable:!0,value:o})},iterators={},IteratorPrototype$1=iteratorsCore.IteratorPrototype,returnThis$1=function(){return this},createIteratorConstructor=function(e,o,s){var h=o+" Iterator";return e.prototype=objectCreate(IteratorPrototype$1,{next:createPropertyDescriptor(1,s)}),setToStringTag(e,h,!1),iterators[h]=returnThis$1,e},validateSetPrototypeOfArguments=function(e,o){if(anObject(e),!isObject(o)&&o!==null)throw TypeError("Can't set "+String(o)+" as a prototype")},objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var e,o=!1,s={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(s,[]),o=s instanceof Array}catch{}return function(h,d){return validateSetPrototypeOfArguments(h,d),o?e.call(h,d):h.__proto__=d,h}}():void 0),ITERATOR$1=wellKnownSymbol("iterator"),IteratorPrototype$2=iteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS$1=iteratorsCore.BUGGY_SAFARI_ITERATORS,KEYS="keys",VALUES="values",ENTRIES="entries",returnThis$2=function(){return this},defineIterator=function(e,o,s,h,d,g,_){createIteratorConstructor(s,o,h);function j(_c){if(_c===d&&_l)return _l;if(!BUGGY_SAFARI_ITERATORS$1&&_c in _o)return _o[_c];switch(_c){case KEYS:case VALUES:case ENTRIES:return function(){return new s(this,_c)}}return function(){return new s(this)}}var $,_t,_e,_r=o+" Iterator",_n=!1,_o=e.prototype,ga=_o[ITERATOR$1]||_o["@@iterator"]||d&&_o[d],_l=!BUGGY_SAFARI_ITERATORS$1&&ga||j(d),_f=o=="Array"&&_o.entries||ga;if(_f&&($=objectGetPrototypeOf(_f.call(new e)),IteratorPrototype$2!==Object.prototype&&$.next&&(objectGetPrototypeOf($)!==IteratorPrototype$2&&(objectSetPrototypeOf?objectSetPrototypeOf($,IteratorPrototype$2):typeof $[ITERATOR$1]!="function"&&hide($,ITERATOR$1,returnThis$2)),setToStringTag($,_r,!0))),d==VALUES&&ga&&ga.name!==VALUES&&(_n=!0,_l=function(){return ga.call(this)}),_o[ITERATOR$1]!==_l&&hide(_o,ITERATOR$1,_l),iterators[o]=_l,d)if(_t={values:j(VALUES),keys:g?_l:j(KEYS),entries:j(ENTRIES)},_)for(_e in _t)!BUGGY_SAFARI_ITERATORS$1&&!_n&&_e in _o||redefine(_o,_e,_t[_e]);else _export({target:o,proto:!0,forced:BUGGY_SAFARI_ITERATORS$1||_n},_t);return _t},STRING_ITERATOR="String Iterator",setInternalState=internalState.set,getInternalState=internalState.getterFor(STRING_ITERATOR);defineIterator(String,"String",function(e){setInternalState(this,{type:STRING_ITERATOR,string:String(e),index:0})},function(){var e,o=getInternalState(this),s=o.string,h=o.index;return h>=s.length?{value:void 0,done:!0}:(e=stringAt(s,h,!0),o.index+=e.length,{value:e,done:!1})});var domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},UNSCOPABLES=wellKnownSymbol("unscopables"),ArrayPrototype=Array.prototype;ArrayPrototype[UNSCOPABLES]==null&&hide(ArrayPrototype,UNSCOPABLES,objectCreate(null));var addToUnscopables=function(e){ArrayPrototype[UNSCOPABLES][e]=!0},ARRAY_ITERATOR="Array Iterator",setInternalState$1=internalState.set,getInternalState$1=internalState.getterFor(ARRAY_ITERATOR),es_array_iterator=defineIterator(Array,"Array",function(e,o){setInternalState$1(this,{type:ARRAY_ITERATOR,target:toIndexedObject(e),index:0,kind:o})},function(){var e=getInternalState$1(this),o=e.target,s=e.kind,h=e.index++;return!o||h>=o.length?{value:e.target=void 0,done:!0}:s=="keys"?{value:h,done:!1}:s=="values"?{value:o[h],done:!1}:{value:[h,o[h]],done:!1}},"values");iterators.Arguments=iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries");var ITERATOR$2=wellKnownSymbol("iterator"),TO_STRING_TAG$3=wellKnownSymbol("toStringTag"),ArrayValues=es_array_iterator.values;for(var COLLECTION_NAME in domIterables){var Collection=global_1[COLLECTION_NAME],CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype){if(CollectionPrototype[ITERATOR$2]!==ArrayValues)try{hide(CollectionPrototype,ITERATOR$2,ArrayValues)}catch{CollectionPrototype[ITERATOR$2]=ArrayValues}if(CollectionPrototype[TO_STRING_TAG$3]||hide(CollectionPrototype,TO_STRING_TAG$3,COLLECTION_NAME),domIterables[COLLECTION_NAME]){for(var METHOD_NAME in es_array_iterator)if(CollectionPrototype[METHOD_NAME]!==es_array_iterator[METHOD_NAME])try{hide(CollectionPrototype,METHOD_NAME,es_array_iterator[METHOD_NAME])}catch{CollectionPrototype[METHOD_NAME]=es_array_iterator[METHOD_NAME]}}}}var aFunction=function(e){if(typeof e!="function")throw TypeError(String(e)+" is not a function");return e},anInstance=function(e,o,s){if(!(e instanceof o))throw TypeError("Incorrect "+(s?s+" ":"")+"invocation");return e},ITERATOR$3=wellKnownSymbol("iterator"),ArrayPrototype$1=Array.prototype,isArrayIteratorMethod=function(e){return e!==void 0&&(iterators.Array===e||ArrayPrototype$1[ITERATOR$3]===e)},bindContext=function(e,o,s){if(aFunction(e),o===void 0)return e;switch(s){case 0:return function(){return e.call(o)};case 1:return function(h){return e.call(o,h)};case 2:return function(h,d){return e.call(o,h,d)};case 3:return function(h,d,g){return e.call(o,h,d,g)}}return function(){return e.apply(o,arguments)}},ITERATOR$4=wellKnownSymbol("iterator"),getIteratorMethod=function(e){if(e!=null)return e[ITERATOR$4]||e["@@iterator"]||iterators[classof(e)]},callWithSafeIterationClosing=function(e,o,s,h){try{return h?o(anObject(s)[0],s[1]):o(s)}catch(g){var d=e.return;throw d!==void 0&&anObject(d.call(e)),g}},iterate=createCommonjsModule(function(e){var o={};(e.exports=function(s,h,d,g,_){var j,$,_t,_e,_r,_n=bindContext(h,d,g?2:1);if(_)j=s;else{if(typeof($=getIteratorMethod(s))!="function")throw TypeError("Target is not iterable");if(isArrayIteratorMethod($)){for(_t=0,_e=toLength(s.length);_t<_e;_t++)if((g?_n(anObject(_r=s[_t])[0],_r[1]):_n(s[_t]))===o)return o;return}j=$.call(s)}for(;!(_r=j.next()).done;)if(callWithSafeIterationClosing(j,_n,_r.value,g)===o)return o}).BREAK=o}),ITERATOR$5=wellKnownSymbol("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR$5]=function(){return this}}catch(e){}var checkCorrectnessOfIteration=function(e,o){if(!o&&!SAFE_CLOSING)return!1;var s=!1;try{var h={};h[ITERATOR$5]=function(){return{next:function(){return{done:s=!0}}}},e(h)}catch{}return s},SPECIES=wellKnownSymbol("species"),speciesConstructor=function(e,o){var s,h=anObject(e).constructor;return h===void 0||(s=anObject(h)[SPECIES])==null?o:aFunction(s)},location=global_1.location,set$1=global_1.setImmediate,clear=global_1.clearImmediate,process=global_1.process,MessageChannel=global_1.MessageChannel,Dispatch=global_1.Dispatch,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",defer,channel,port,run=function(e){var o;queue.hasOwnProperty(e)&&(o=queue[e],delete queue[e],o())},runner=function(e){return function(){run(e)}},listener=function(e){run(e.data)},post=function(e){global_1.postMessage(e+"",location.protocol+"//"+location.host)};set$1&&clear||(set$1=function(e){for(var o=[],s=1;s<arguments.length;)o.push(arguments[s++]);return queue[++counter]=function(){(typeof e=="function"?e:Function(e)).apply(void 0,o)},defer(counter),counter},clear=function(e){delete queue[e]},classofRaw(process)=="process"?defer=function(e){process.nextTick(runner(e))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(runner(e))}:MessageChannel?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=bindContext(port.postMessage,port,1)):!global_1.addEventListener||typeof postMessage!="function"||global_1.importScripts||fails(post)?defer=ONREADYSTATECHANGE in documentCreateElement("script")?function(e){html.appendChild(documentCreateElement("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run(e)}}:function(e){setTimeout(runner(e),0)}:(defer=post,global_1.addEventListener("message",listener,!1)));var task={set:set$1,clear},navigator$1=global_1.navigator,userAgent=navigator$1&&navigator$1.userAgent||"",getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,macrotask=task.set,MutationObserver=global_1.MutationObserver||global_1.WebKitMutationObserver,process$1=global_1.process,Promise$1=global_1.Promise,IS_NODE=classofRaw(process$1)=="process",queueMicrotaskDescriptor=getOwnPropertyDescriptor$1(global_1,"queueMicrotask"),queueMicrotask=queueMicrotaskDescriptor&&queueMicrotaskDescriptor.value,flush,head,last,notify,toggle,node,promise;queueMicrotask||(flush=function(){var e,o;for(IS_NODE&&(e=process$1.domain)&&e.exit();head;){o=head.fn,head=head.next;try{o()}catch(s){throw head?notify():last=void 0,s}}last=void 0,e&&e.enter()},notify=IS_NODE?function(){process$1.nextTick(flush)}:MutationObserver&&!/(iphone|ipod|ipad).*applewebkit/i.test(userAgent)?(toggle=!0,node=document.createTextNode(""),new MutationObserver(flush).observe(node,{characterData:!0}),function(){node.data=toggle=!toggle}):Promise$1&&Promise$1.resolve?(promise=Promise$1.resolve(void 0),function(){promise.then(flush)}):function(){macrotask.call(global_1,flush)});var microtask=queueMicrotask||function(e){var o={fn:e,next:void 0};last&&(last.next=o),head||(head=o,notify()),last=o},PromiseCapability=function(e){var o,s;this.promise=new e(function(h,d){if(o!==void 0||s!==void 0)throw TypeError("Bad Promise constructor");o=h,s=d}),this.resolve=aFunction(o),this.reject=aFunction(s)},f$5=function(e){return new PromiseCapability(e)},newPromiseCapability={f:f$5},promiseResolve=function(e,o){if(anObject(e),isObject(o)&&o.constructor===e)return o;var s=newPromiseCapability.f(e);return(0,s.resolve)(o),s.promise},hostReportErrors=function(e,o){var s=global_1.console;s&&s.error&&(arguments.length===1?s.error(e):s.error(e,o))},perform=function(e){try{return{error:!1,value:e()}}catch(o){return{error:!0,value:o}}},redefineAll=function(e,o,s){for(var h in o)redefine(e,h,o[h],s);return e},path=global_1,aFunction$1=function(e){return typeof e=="function"?e:void 0},getBuiltIn=function(e,o){return arguments.length<2?aFunction$1(path[e])||aFunction$1(global_1[e]):path[e]&&path[e][o]||global_1[e]&&global_1[e][o]},SPECIES$1=wellKnownSymbol("species"),setSpecies=function(e){var o=getBuiltIn(e),s=objectDefineProperty.f;descriptors&&o&&!o[SPECIES$1]&&s(o,SPECIES$1,{configurable:!0,get:function(){return this}})},PROMISE="Promise",task$1=task.set,SPECIES$2=wellKnownSymbol("species"),getInternalState$2=internalState.get,setInternalState$2=internalState.set,getInternalPromiseState=internalState.getterFor(PROMISE),PromiseConstructor=global_1[PROMISE],TypeError$1=global_1.TypeError,document$3=global_1.document,process$2=global_1.process,$fetch=global_1.fetch,versions=process$2&&process$2.versions,v8=versions&&versions.v8||"",newPromiseCapability$1=newPromiseCapability.f,newGenericPromiseCapability=newPromiseCapability$1,IS_NODE$1=classofRaw(process$2)=="process",DISPATCH_EVENT=!!(document$3&&document$3.createEvent&&global_1.dispatchEvent),UNHANDLED_REJECTION="unhandledrejection",REJECTION_HANDLED="rejectionhandled",PENDING=0,FULFILLED=1,REJECTED=2,HANDLED=1,UNHANDLED=2,Internal,OwnPromiseCapability,PromiseWrapper,FORCED=isForced_1(PROMISE,function(){function e(){}var o=PromiseConstructor.resolve(1),s=(o.constructor={})[SPECIES$2]=function(h){h(e,e)};return!((IS_NODE$1||typeof PromiseRejectionEvent=="function")&&!isPure&&o.then(e)instanceof s&&v8.indexOf("6.6")!==0&&userAgent.indexOf("Chrome/66")===-1)}),INCORRECT_ITERATION=FORCED||!checkCorrectnessOfIteration(function(e){PromiseConstructor.all(e).catch(function(){})}),isThenable=function(e){var o;return!(!isObject(e)||typeof(o=e.then)!="function")&&o},notify$1=function(e,o,s){var h;o.notified||(o.notified=!0,h=o.reactions,microtask(function(){for(var d=o.value,g=o.state==FULFILLED,_=0;h.length>_;)(function(j){var $,_t,_e,_r=g?j.ok:j.fail,_n=j.resolve,_o=j.reject,ga=j.domain;try{_r?(g||(o.rejection===UNHANDLED&&onHandleUnhandled(e,o),o.rejection=HANDLED),_r===!0?$=d:(ga&&ga.enter(),$=_r(d),ga&&(ga.exit(),_e=!0)),$===j.promise?_o(TypeError$1("Promise-chain cycle")):(_t=isThenable($))?_t.call($,_n,_o):_n($)):_o(d)}catch(_l){ga&&!_e&&ga.exit(),_o(_l)}})(h[_++]);o.reactions=[],o.notified=!1,s&&!o.rejection&&onUnhandled(e,o)}))},dispatchEvent=function(e,o,s){var h,d;DISPATCH_EVENT?((h=document$3.createEvent("Event")).promise=o,h.reason=s,h.initEvent(e,!1,!0),global_1.dispatchEvent(h)):h={promise:o,reason:s},(d=global_1["on"+e])?d(h):e===UNHANDLED_REJECTION&&hostReportErrors("Unhandled promise rejection",s)},onUnhandled=function(e,o){task$1.call(global_1,function(){var s,h=o.value;if(isUnhandled(o)&&(s=perform(function(){IS_NODE$1?process$2.emit("unhandledRejection",h,e):dispatchEvent(UNHANDLED_REJECTION,e,h)}),o.rejection=IS_NODE$1||isUnhandled(o)?UNHANDLED:HANDLED,s.error))throw s.value})},isUnhandled=function(e){return e.rejection!==HANDLED&&!e.parent},onHandleUnhandled=function(e,o){task$1.call(global_1,function(){IS_NODE$1?process$2.emit("rejectionHandled",e):dispatchEvent(REJECTION_HANDLED,e,o.value)})},bind=function(e,o,s,h){return function(d){e(o,s,d,h)}},internalReject=function(e,o,s,h){o.done||(o.done=!0,h&&(o=h),o.value=s,o.state=REJECTED,notify$1(e,o,!0))},internalResolve=function(e,o,s,h){if(!o.done){o.done=!0,h&&(o=h);try{if(e===s)throw TypeError$1("Promise can't be resolved itself");var d=isThenable(s);d?microtask(function(){var g={done:!1};try{d.call(s,bind(internalResolve,e,g,o),bind(internalReject,e,g,o))}catch(_){internalReject(e,g,_,o)}}):(o.value=s,o.state=FULFILLED,notify$1(e,o,!1))}catch(g){internalReject(e,{done:!1},g,o)}}};FORCED&&(PromiseConstructor=function(e){anInstance(this,PromiseConstructor,PROMISE),aFunction(e),Internal.call(this);var o=getInternalState$2(this);try{e(bind(internalResolve,this,o),bind(internalReject,this,o))}catch(s){internalReject(this,o,s)}},Internal=function(){setInternalState$2(this,{type:PROMISE,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:PENDING,value:void 0})},Internal.prototype=redefineAll(PromiseConstructor.prototype,{then:function(e,o){var s=getInternalPromiseState(this),h=newPromiseCapability$1(speciesConstructor(this,PromiseConstructor));return h.ok=typeof e!="function"||e,h.fail=typeof o=="function"&&o,h.domain=IS_NODE$1?process$2.domain:void 0,s.parent=!0,s.reactions.push(h),s.state!=PENDING&&notify$1(this,s,!1),h.promise},catch:function(e){return this.then(void 0,e)}}),OwnPromiseCapability=function(){var e=new Internal,o=getInternalState$2(e);this.promise=e,this.resolve=bind(internalResolve,e,o),this.reject=bind(internalReject,e,o)},newPromiseCapability.f=newPromiseCapability$1=function(e){return e===PromiseConstructor||e===PromiseWrapper?new OwnPromiseCapability(e):newGenericPromiseCapability(e)},typeof $fetch=="function"&&_export({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return promiseResolve(PromiseConstructor,$fetch.apply(global_1,arguments))}})),_export({global:!0,wrap:!0,forced:FORCED},{Promise:PromiseConstructor}),setToStringTag(PromiseConstructor,PROMISE,!1),setSpecies(PROMISE),PromiseWrapper=path[PROMISE],_export({target:PROMISE,stat:!0,forced:FORCED},{reject:function(e){var o=newPromiseCapability$1(this);return o.reject.call(void 0,e),o.promise}}),_export({target:PROMISE,stat:!0,forced:FORCED},{resolve:function(e){return promiseResolve(this,e)}}),_export({target:PROMISE,stat:!0,forced:INCORRECT_ITERATION},{all:function(e){var o=this,s=newPromiseCapability$1(o),h=s.resolve,d=s.reject,g=perform(function(){var _=aFunction(o.resolve),j=[],$=0,_t=1;iterate(e,function(_e){var _r=$++,_n=!1;j.push(void 0),_t++,_.call(o,_e).then(function(_o){_n||(_n=!0,j[_r]=_o,--_t||h(j))},d)}),--_t||h(j)});return g.error&&d(g.value),s.promise},race:function(e){var o=this,s=newPromiseCapability$1(o),h=s.reject,d=perform(function(){var g=aFunction(o.resolve);iterate(e,function(_){g.call(o,_).then(s.resolve,h)})});return d.error&&h(d.value),s.promise}}),_export({target:"Promise",proto:!0,real:!0},{finally:function(e){var o=speciesConstructor(this,getBuiltIn("Promise")),s=typeof e=="function";return this.then(s?function(h){return promiseResolve(o,e()).then(function(){return h})}:e,s?function(h){return promiseResolve(o,e()).then(function(){throw h})}:e)}}),path.Promise;var perf,start;function _typeof(e){return(_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(e)}function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,o){for(var s=0;s<o.length;s++){var h=o[s];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(e,h.key,h)}}function _createClass(e,o,s){return o&&_defineProperties(e.prototype,o),s&&_defineProperties(e,s),e}function _defineProperty(e,o,s){return o in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s,e}function _inherits(e,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),o&&_setPrototypeOf(e,o)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(e)}function _setPrototypeOf(e,o){return(_setPrototypeOf=Object.setPrototypeOf||function(s,h){return s.__proto__=h,s})(e,o)}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function _construct(e,o,s){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(h,d,g){var _=[null];_.push.apply(_,d);var j=new(Function.bind.apply(h,_));return g&&_setPrototypeOf(j,g.prototype),j}).apply(null,arguments)}function _isNativeFunction(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function _wrapNativeSuper(e){var o=typeof Map=="function"?new Map:void 0;return(_wrapNativeSuper=function(s){if(s===null||!_isNativeFunction(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(o!==void 0){if(o.has(s))return o.get(s);o.set(s,h)}function h(){return _construct(s,arguments,_getPrototypeOf(this).constructor)}return h.prototype=Object.create(s.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(h,s)})(e)}function _assertThisInitialized(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,o){return!o||typeof o!="object"&&typeof o!="function"?_assertThisInitialized(e):o}function _createSuper(e){var o=_isNativeReflectConstruct();return function(){var s,h=_getPrototypeOf(e);return _possibleConstructorReturn(this,o?(s=_getPrototypeOf(this).constructor,Reflect.construct(h,arguments,s)):h.apply(this,arguments))}}function _superPropBase(e,o){for(;!Object.prototype.hasOwnProperty.call(e,o)&&(e=_getPrototypeOf(e))!==null;);return e}function _get(e,o,s){return(_get=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(h,d,g){var _=_superPropBase(h,d);if(_){var j=Object.getOwnPropertyDescriptor(_,d);return j.get?j.get.call(g):j.value}})(e,o,s||e)}function _slicedToArray(e,o){return _arrayWithHoles(e)||_iterableToArrayLimit(e,o)||_unsupportedIterableToArray(e,o)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function _iterableToArrayLimit(e,o){if(typeof Symbol<"u"&&Symbol.iterator in Object(e)){var s=[],h=!0,d=!1,g=void 0;try{for(var _,j=e[Symbol.iterator]();!(h=(_=j.next()).done)&&(s.push(_.value),!o||s.length!==o);h=!0);}catch($){d=!0,g=$}finally{try{h||j.return==null||j.return()}finally{if(d)throw g}}return s}}function _unsupportedIterableToArray(e,o){if(e){if(typeof e=="string")return _arrayLikeToArray(e,o);var s=Object.prototype.toString.call(e).slice(8,-1);return s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set"?Array.from(e):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_arrayLikeToArray(e,o):void 0}}function _arrayLikeToArray(e,o){(o==null||o>e.length)&&(o=e.length);for(var s=0,h=new Array(o);s<o;s++)h[s]=e[s];return h}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _createForOfIteratorHelper(e,o){var s;if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(s=_unsupportedIterableToArray(e))||o&&e&&typeof e.length=="number"){s&&(e=s);var h=0,d=function(){};return{s:d,n:function(){return h>=e.length?{done:!0}:{done:!1,value:e[h++]}},e:function($){throw $},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g,_=!0,j=!1;return{s:function(){s=e[Symbol.iterator]()},n:function(){var $=s.next();return _=$.done,$},e:function($){j=!0,g=$},f:function(){try{_||s.return==null||s.return()}finally{if(j)throw g}}}}typeof Object.assign!="function"&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),s=1;s<arguments.length;s++){var h=arguments[s];if(h!=null)for(var d in h)h.hasOwnProperty(d)&&(o[d]=h[d])}return o}),typeof Object.values!="function"&&(Object.values=function(e){return Object.keys(e).map(function(o){return e[o]})}),Math.hypot=Math.hypot||function(){for(var e=0,o=arguments.length,s=0;s<o;s++){if(arguments[s]===1/0||arguments[s]===-1/0)return 1/0;e+=arguments[s]*arguments[s]}return Math.sqrt(e)},Math.log2=Math.log2||function(e){return Math.log(e)*Math.LOG2E},typeof window<"u"?(!("performance"in window)&&(window.performance={}),perf=window.performance):typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&(!("performance"in self)&&(self.performance={}),perf=self.performance),perf&&typeof perf.now!="function"&&(start=+new Date,perf.now=function(){return new Date-start});var global$1=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},ns={},MathUtils;(function(){var e,o,s=typeof Object.defineProperties=="function"?Object.defineProperty:function(_h,iy,cy){_h!=Array.prototype&&_h!=Object.prototype&&(_h[iy]=cy.value)},h=(typeof window>"u"||window!==this)&&global$1!==void 0&&global$1!=null?global$1:this;if(typeof Object.setPrototypeOf=="function")e=Object.setPrototypeOf;else{t:{var d={};try{d.__proto__={ea:!0},o=d.ea;break t}catch{}o=!1}e=o?function(_h,iy){if(_h.__proto__=iy,_h.__proto__!==iy)throw new TypeError(_h+" is not extensible");return _h}:null}var g=e;(function(_h,iy){if(iy){var cy=h;_h=_h.split(".");for(var hy=0;hy<_h.length-1;hy++){var fy=_h[hy];fy in cy||(cy[fy]={}),cy=cy[fy]}(iy=iy(hy=cy[_h=_h[_h.length-1]]))!=hy&&iy!=null&&s(cy,_h,{configurable:!0,writable:!0,value:iy})}})("Object.setPrototypeOf",function(_h){return _h||g});var _=this||self;function j(_h){var iy=_typeof(_h);if(iy=="object"){if(!_h)return"null";if(_h instanceof Array)return"array";if(_h instanceof Object)return iy;var cy=Object.prototype.toString.call(_h);if(cy=="[object Window]")return"object";if(cy=="[object Array]"||typeof _h.length=="number"&&_h.splice!==void 0&&_h.propertyIsEnumerable!==void 0&&!_h.propertyIsEnumerable("splice"))return"array";if(cy=="[object Function]"||_h.call!==void 0&&_h.propertyIsEnumerable!==void 0&&!_h.propertyIsEnumerable("call"))return"function"}else if(iy=="function"&&_h.call===void 0)return"object";return iy}function $(_h){return j(_h)=="function"}function _t(_h){var iy=_typeof(_h);return iy=="object"&&_h!=null||iy=="function"}function _e(_h,iy){_h=_h.split(".");var cy,hy=_;for((_h[0]in hy)||hy.execScript===void 0||hy.execScript("var "+_h[0]);_h.length&&(cy=_h.shift());)_h.length||iy===void 0?hy=hy[cy]&&hy[cy]!==Object.prototype[cy]?hy[cy]:hy[cy]={}:hy[cy]=iy}function _r(_h,iy){function cy(){}cy.prototype=iy.prototype,_h.ua=iy.prototype,_h.prototype=new cy,_h.prototype.constructor=_h}var _n=Math,_o=_n.min,ga=_n.max,_l=_n.round,_f=_n.floor,_c=_n.ceil,_p=_n.abs,_g=_n.log,ty=_n.sqrt,oy=_n.pow,ry=_n.sin,ly=_n.asin,py=_n.cos,gy=_n.tan,by=_n.atan2,wy=_n.PI,Cy=wy/2,Gy=wy/4,Ly=2*wy,d0=3*wy,s0=wy/180,t0=180/wy;function Ay(_h,iy,cy){return cy<_h?cy:_h<iy?iy:_h}function Ny(_h,iy,cy){return iy<cy?iy<=_h&&_h<=cy:cy<=_h&&_h<=iy}function Hy(_h,iy,cy,hy,fy,vy){return ty(oy((_h-fy)*(hy-vy)-(iy-vy)*(cy-fy),2)/(oy(cy-fy,2)+oy(hy-vy,2)))}_e("H.math.normalize",function(_h,iy,cy){return iy-=cy=cy||0,(_h-=cy)-_f(_h/iy)*iy+cy}),_e("H.math.clamp",Ay);var n0={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function v0(_h,iy){var cy=_h.x;_h=_h.y;for(var hy,fy,vy,Py,Ey=iy.length,My=Ey,By=iy[0],$y=0,Zy=0,y0=0;$y!=1&&1<My;)fy=iy[--My],hy=iy[--My],Py=iy[My?My-1:(Ey+(My-1))%Ey],vy=iy[My?My-2:(Ey+(My-2))%Ey],cy<=hy&&hy<=cy&&_h<=fy&&fy<=_h||cy<=vy&&vy<=cy&&_h<=Py&&Py<=_h?$y=1:$y||hy!==cy?!$y&&Ny(cy,hy,vy)&&((hy<cy&&cy<vy||cy<hy&&vy<cy)&&(Zy+=_h<(By=fy+(cy-hy)/(vy-hy)*(Py-fy)),y0+=By<_h),$y=Ny(_h,fy,Py)&&Hy(cy,_h,hy,fy,vy,Py)<=0?2:0):(vy===cy&&(fy<_h&&_h<Py||_h<fy&&Py<_h)||(By<=cy&&cy<vy||cy<=By&&vy<cy)&&(_h<=fy?++Zy:++y0),$y=Ny(_h,fy,Py)&&Hy(cy,_h,hy,fy,vy,Py)<=0?2:0),By=hy;return $y||y0===0||Zy%2==0||($y=3),$y!==n0.NONE}function f0(_h,iy){this.x=+_h,this.y=+iy}function A0(_h,iy,cy,hy,fy,vy,Py,Ey,My,By){return _h={x:_h,y:iy,next:cy||null,s:hy||null,ta:fy||null,X:vy||null,o:!!Py,T:Ey||0,O:My||0,alpha:By||0},hy&&(_h.s.next=_h),cy&&(_h.next.s=_h),_h}function q0(_h){for(;_h&&_h.o;)_h=_h.next;return _h}function D0(_h){if(_h)for(;_h.next;)_h=_h.next;return _h}function K0(_h){var iy=D0(_h);(iy.s.next=_h).s=iy.s}function a1(_h){for(var iy=[];_h;)iy.push(_h.x,_h.y),_h=_h.next;return iy}function J0(_h,iy,cy){for(iy=iy.next;iy!==cy&&iy.alpha<=_h.alpha;)iy=iy.next;_h.next=iy,_h.s=iy.s,(_h.next.s=_h).s.next=_h}function C0(_h,iy){for(var cy,hy=null,fy=0,vy=_h.length;fy<vy;fy++)(cy=A0(_h[fy].x,_h[fy].y,hy)).qa=iy,(cy.next=hy)&&(hy.s=cy),hy=cy;return hy}function H0(_h,iy,cy,hy){return(_h-=cy)*_h+(iy-=hy)*iy}_e("H.math.CoverType",n0),_e("H.math.isPointInsidePolygon",v0),_e("H.math.flatten",function(_h){for(var iy=_h.length,cy=new Float64Array(2*iy),hy=iy&&_h[0].x!==n1;iy--;){var fy=_h[iy],vy=iy<<1;cy[vy]=hy?fy.x:fy[0],cy[1+vy]=hy?fy.y:fy[1]}return cy}),_e("H.math.Point",f0),(f0.prototype.set=f0).prototype.clone=function(_h){return _h?(_h.x=this.x,_h.y=this.y):_h=new f0(this.x,this.y),_h},f0.prototype.add=function(_h){return this.x+=_h.x,this.y+=_h.y,this},f0.prototype.sub=function(_h){return this.x-=_h.x,this.y-=_h.y,this},f0.prototype.scale=function(_h,iy){return this.x*=_h,this.y*=iy===void 0?_h:iy,this},f0.prototype.round=function(){return this.x=_l(this.x),this.y=_l(this.y),this},f0.prototype.floor=function(){return this.x=_f(this.x),this.y=_f(this.y),this},f0.prototype.ceil=function(){return this.x=_c(this.x),this.y=_c(this.y),this},f0.prototype.equals=f0.prototype.w=function(_h){return!(!_h||this.x!==_h.x||this.y!==_h.y)},f0.prototype.getNearest=f0.prototype.la=function(_h,iy){var cy,hy=iy.x-_h.x,fy=iy.y-_h.y,vy=_h;return(hy||fy)&&(vy=(cy=((this.x-_h.x)*hy+(this.y-_h.y)*fy)/(hy*hy+fy*fy))<=0?_h:1<=cy?iy:new f0(_h.x+cy*hy,_h.y+cy*fy)),vy},f0.prototype.distance=f0.prototype.R=function(_h){return ty(oy(this.x-_h.x,2)+oy(this.y-_h.y,2))},f0.fromIPoint=function(_h){if(!_h)throw Error("invalid argument");return _h instanceof f0?_h:new f0(_h.x,_h.y)},_e("H.math.clipping.clipStrips",function(_h,iy,cy,hy,fy,vy){var Py,Ey,My,By=_h.length;if(By)for(Py=[];By--;)for(var $y,Zy,y0=_h[By],S0=y0.length,V0=0,i0=1;i0<S0;i0++)(My=function(a0,r0,m0,R0,z0,L0){var I0=a0.x;a0=-a0.y;var w0=r0.x;if(r0=-r0.y,m0=-m0,L0=-L0,w0<I0){if(z0<w0||I0<R0)return;var g1=I0,Z0=a0;I0=w0,a0=r0,w0=g1,r0=Z0,g1=1}else if(z0<I0||w0<R0)return;if(r0<a0){if(m0<r0||a0<L0)return;var m1=1;a0=-a0,r0=-r0,Z0=L0,L0=-m0,m0=-Z0}else if(m0<a0||r0<L0)return;if(I0<R0){if((a0+=(R0-I0)*(r0-a0)/(w0-I0))>m0)return;I0=R0}if(a0<L0){if((I0+=(L0-a0)*(w0-I0)/(r0-a0))>z0)return;a0=L0}return z0<w0&&(r0=a0+(z0-I0)*(r0-a0)/(w0-I0),w0=z0),m0<r0&&(w0=I0+(m0-a0)*(w0-I0)/(r0-a0),r0=m0),m1&&(a0=-a0,r0=-r0),g1?[new f0(w0,-r0),new f0(I0,-a0)]:[new f0(I0,-a0),new f0(w0,-r0)]}(y0[i0-1],y0[i0],cy,iy,hy,fy))&&($y=My[0],Zy=My[1],V0&&V0.w($y)?Ey.push(Zy):Py.push(Ey=My),V0=Zy,vy&&(i0=S0,By=0));else Py=_h;return Py}),_e("H.math.clipping.clipPolygon",function(_h,iy,cy){var hy;_h=C0(_h,!0),iy=C0(iy,!1);var fy={},vy=hy=1;switch(~~(cy||0)){case 1:vy=hy=0;break;case 2:hy=0,vy=1;break;case 3:hy=1,vy=0}cy=hy;var Py,Ey,My,By,$y,Zy,y0=vy;if(iy&&_h){for(iy.M=A0(iy.x,iy.y,null,D0(iy)),_h.M=A0(_h.x,_h.y,null,D0(_h)),vy=iy;vy.next;vy=vy.next)if(!vy.o)for(hy=_h;hy.next;hy=hy.next)hy.o||(Zy=function V0(i0,a0,r0,m0,R0){var z0,L0=a0.x-i0.x,I0=a0.y-i0.y,w0=m0.x-r0.x,g1=m0.y-r0.y,Z0=L0*g1-I0*w0;return!Z0||(w0=((r0.x-i0.x)*g1-(r0.y-i0.y)*w0)/Z0,Z0=(I0*(r0.x-i0.x)-L0*(r0.y-i0.y))/Z0,w0<0||1<w0||Z0<0||1<Z0)?0:(w0===0?z0=i0:w0===1?z0=a0:Z0===0?z0=r0:Z0===1&&(z0=m0),z0?(z0.x+=2480549651603763e-20,z0.y+=7321997314118067e-20,z0.M&&(z0.M.x=z0.x,z0.M.y=z0.y),V0(i0,a0,r0,m0,R0)):(R0.xa=i0.x+w0*L0,R0.ya=i0.y+w0*I0,R0.fa=w0,R0.ga=Z0,1))}(vy,Py=q0(vy.next),hy,Ey=q0(hy.next),fy))&&(Zy=fy.fa,My=fy.ga,J0(Zy=A0(By=fy.xa,$y=fy.ya,null,null,null,null,!0,0,0,Zy),vy,Py),J0(Py=A0(By,$y,null,null,null,null,!0,0,0,My),hy,Ey),(Zy.X=Py).X=Zy);for(fy=v0(iy,a1(_h)),cy&&(fy=!fy),vy=iy;vy;vy=vy.next)vy.o&&(fy=!(vy.T=fy));for(fy=v0(_h,a1(iy)),y0&&(fy=!fy),hy=_h;hy.next;hy=hy.next)hy.o&&(fy=!(hy.T=fy));for(K0(iy),K0(_h);(_h=function(V0){var i0=V0;if(i0)for(;(i0=i0.next)!=V0&&(!i0.o||i0.o&&i0.O););return i0}(iy))!=iy;){for(cy=null;!_h.O;_h=_h.X){for(fy=_h.T;(cy=A0(_h.x,_h.y,cy)).artificial=_h.o||_h.qa,_h.O=1,_h=fy?_h.next:_h.s;)if(_h.o){_h.O=1;break}if(!_h)break}cy.ta=S0;var S0=cy}return S0}}),_e("H.math.simplifyDP",function(_h,iy,cy){return function hy(fy,vy,Py,Ey,My){var By=0,$y=Ey,Zy=fy[Ey].x,y0=fy[Ey].y,S0=fy[My].x,V0=fy[My].y,i0=Ey+1,a0=H0(Zy,y0,S0,V0);if(a0)for(;i0<My;){var r0=fy[i0++],m0=r0.x;r0=r0.y;var R0=((m0-Zy)*(S0-Zy)+(r0-y0)*(V0-y0))/a0;m0=R0<0?H0(m0,r0,Zy,y0):1<R0?H0(m0,r0,S0,V0):H0(m0,r0,Zy+R0*(S0-Zy),y0+R0*(V0-y0)),By<m0&&(By=m0,$y=i0-1)}else for(;i0<My;)r0=fy[i0++],m0=r0.x,r0=r0.y,m0=H0(m0,r0,Zy,y0),By<m0&&(By=m0,$y=i0-1);return Ey=vy<=By||0<Py&&$y-Ey?(--Py,1<$y-Ey?(Ey=hy(fy,vy,Py,Ey,$y),Ey.splice(Ey.length-1,1)):Ey=[fy[Ey]],1<My-$y?Ey.concat(hy(fy,vy,Py,$y,My)):Ey.concat(fy.slice($y,My+1))):[fy[Ey],fy[My]],Ey}(_h,iy*iy,cy||0,0,_h.length-1)});var u1=this,t1=String,n1=[].pop(),h1=/x/.exec(""),s1="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W0(_h,iy){if(_h instanceof iy&&_h.constructor===iy)throw new TypeError("Illegal constructor "+l1(iy))}_e("H.lang.isArray",function(_h,iy,cy,hy){var fy;if(!(fy=k1(_h)==="Array")&&iy)throw new B0(iy,cy,hy!==n1?hy:_h);return fy}),_e("H.lang.isString",function(_h){return typeof _h=="string"});var i1=isNaN;function w1(_h){return _h===+_h}function k1(_h){var iy=Object[s1[0]][s1[6]].call(_h).match(/^\[object (\w+)\]$/);return iy?iy[1]:_typeof(_h)}_e("H.lang.isNumber",w1),_e("H.lang.isInteger",Number.isInteger?Number.isInteger:function(_h){return typeof _h=="number"&&_h%1==0});var X0=[];function l1(_h,iy,cy,hy){var fy,vy,Py="",Ey=arguments.length<2;return Ey&&(iy={H:u1.H},cy="",hy=X0.slice()),E1(iy,!0,function(My,By){try{if(fy=My[By],$y=fy,E1(My,!(Zy=[]),function(y0,S0){y0[S0]===$y&&Zy.push(S0)}),By=Zy.sort(P1)[0],!(_t(fy)&&fy.window===fy&&fy.self===fy||_t(fy)&&0<fy.nodeType&&$(fy.cloneNode))&&_t(fy)){if(fy===_h)return Py=cy+"."+By,1;if(hy.indexOf(fy)<0&&(hy.push(fy),Py=l1(_h,fy,cy+"."+By,hy)))return 1}}catch{}var $y,Zy}),Ey&&(Py=Py?Py.substr(1).replace("."+s1[0]+".","#"):"~"+($(_h)?((vy=/^\s*function ([^\( ]+)/.exec(vy=_h))?vy[1]:"anonymous")+"()":k1(_h))),Py}function P1(_h,iy){return iy.length-_h.length}X0.indexOf(X0)<0&&X0.push(X0);var T0=Object[s1[0]][s1[2]];function E1(_h,iy,cy){var hy;if(_h){for(fy in _h)if((!iy||T0.call(_h,fy))&&cy(_h,fy,!0))return;for(hy=s1.length;hy--;){var fy=s1[hy];if((!iy||T0.call(_h,fy))&&cy(_h,fy,!1))break}}}function M1(_h,iy,cy){cy[iy]="#"+iy}function B0(_h,iy,cy){var hy,fy,vy=arguments.length;return(iy=iy!==n1?+iy:iy)!==n1&&((fy=hy=(fy=/^.*?\(([^\)]+)/.exec((""+_h).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?t1(fy[1].replace(/\s+/g,"")).split(n1!==","?",":" "):[]).forEach(M1),fy=fy[iy]||"#"+iy),hy=_h?l1(_h):"",vy=2<vy?t1(cy):"",(fy||vy)&&(hy+=" (Argument "+(fy||"")+(vy?" "+vy:"")+")"),vy=Error(hy),Object.setPrototypeOf(vy,B0.prototype),vy}function p1(_h,iy,cy){var hy=Ay(+_h,-90,90);if(iy&&i1(hy))throw new B0(iy,cy,_h);return hy}function e1(_h,iy,cy){var hy,fy=+_h;if((fy<-180||180<fy)&&(fy=((hy=(fy+180)%360)<0?360+hy:hy)-180),iy&&i1(fy))throw new B0(iy,cy,_h);return fy}function C1(_h,iy,cy){var hy;if(_h!==n1&&i1(hy=+_h)&&iy)throw new B0(iy,cy,_h);return hy}function Q0(){W0(this,Q0)}function O0(_h,iy,cy){this.lat=p1(_h,O0,0),this.lng=e1(iy,O0,1),cy!==n1&&(this.alt=C1(cy,O0,2))}function y1(_h,iy,cy){var hy=_t(_h)&&!(i1(_h.lat=p1(_h.lat))||i1(_h.lng=e1(_h.lng))||_h.alt!==n1&&i1(_h.alt=C1(_h.alt)));if(!hy&&iy)throw new B0(iy,cy,_h);return hy}function qy(_h,iy,cy,hy){T1(this,p1(_h,qy,0),e1(iy,qy,1),p1(cy,qy,2),e1(hy,qy,3))}function T1(_h,iy,cy,hy,fy){return _h.f=cy,_h.g=fy,iy<hy&&(cy=iy,iy=hy,hy=cy),_h.i=iy,_h.h=hy,_h.m=_h.b=_h.c=null,_h}function c1(_h,iy){return(_h=iy-_h)+(_h<0?360:0)}function v1(_h,iy){return(_h+=iy/2)-(180<_h?360:0)}function L1(_h,iy,cy,hy,fy,vy,Py,Ey,My){cy=_o(cy,Py),_h=ga(_h,fy);var By=v1(iy,fy=c1(iy,hy)),$y=v1(vy,Py=c1(vy,Ey))-By,Zy=($y+=$y-1e-6<0?360:0)-1e-6<180?(By=iy,Ey):($y=360-$y,By=vy,hy);return 360<=($y=$y+fy/2+Py/2)+5e-7?(By=-180,Zy=180):$y-5e-7<fy?(By=iy,Zy=hy):$y-5e-7<Py&&(By=vy,Zy=Ey),My?T1(My,_h,By,cy,Zy):new qy(_h,By,cy,Zy)}function S1(_h,iy,cy){return cy||(y1(_h,S1,0),y1(iy,S1,1)),new qy(_h.lat,_h.lng,iy.lat,iy.lng)}function A1(_h,iy,cy,hy,fy,vy){W0(this,A1),this.sa=_h||10,this.c=this.b=null,this.j=hy||0,this.l=fy||0,this.m=iy||1,this.u=cy||1,this.I=!!vy,this.flush()}function O1(_h,iy,cy){var hy,fy;if(_h.I&&(hy=_h.c))for(fy=3;0<=fy;fy--){var vy=iy[fy];if(fy%3?vy>=hy[fy]:vy<=hy[fy]){if(!cy){_h.c=null;break}hy[fy]=vy}}}function I1(_h,iy){var cy,hy=_h.a;if(iy){var fy=iy;if(fy!==hy)for(hy=fy;fy=fy.c;)(fy.entries||1<fy.a)&&(hy=fy)}else for(;!hy.entries&&(cy=hy.a)<2&&cy;)hy=fy;_h.a=hy}_r(B0,Error),_e("H.lang.InvalidArgumentError",B0),B0.prototype.name="InvalidArgumentError",_e("H.geo.isDBC",function(_h,iy){return(_h<0^iy<0)!=0&&180<_p(iy-_h)}),_e("H.geo.AbstractGeometry",Q0),Q0.prototype.getBoundingBox=Q0.prototype.D,Q0.prototype.equals=Q0.prototype.w,Q0.prototype.a="",Q0.prototype.l="",Q0.prototype.toString=function(){return this.I([this.a.toUpperCase()," "]).join("")},Q0.prototype.toGeoJSON=Q0.prototype.va=function(){return{type:this.l,coordinates:this.u()}},Q0.prototype.forWorkerMessage=Q0.prototype.U=function(){return{type:this.a,coordinates:this.j(),boundingBox:this.D().U()}},_r(O0,Q0),_e("H.geo.Point",O0),O0.prototype.equals=O0.prototype.w=function(_h){return this===_h||!!_h&&this.lat===_h.lat&&this.lng===_h.lng&&(this.alt||0)===(_h.alt||0)},O0.prototype.distance=O0.prototype.R=function(_h){var iy,cy;return _h=this===_h||this.lat===_h.lat&&this.lng===_h.lng?0:(iy=this.lat*s0,cy=_h.lat*s0,1274200158e-2*ly(_o(1,ty(oy(ry((iy-cy)/2),2)+py(iy)*py(cy)*oy(ry((this.lng*s0-_h.lng*s0)/2),2)))))},O0.prototype.walk=O0.prototype.wa=function(_h,iy,cy){var hy,fy,vy,Py,Ey,My,By;return cy?((iy/=637100079e-2)&&(_h*=s0,Ey=s0*this.lat,hy=ry(Ey),fy=ry(iy),vy=py(iy),Py=s0*this.lng,My=py(Ey),Ey=ly(My*py(_h)*fy+hy*vy),My=(_h=(Py+(_h=by(ry(_h)*My*fy,vy-hy*ry(Ey)))+wy)%(2*wy)-wy)*t0),iy?new O0(Ey*t0,(My+540)%360-180):this):((_h=(_h%360+360)%360)+90)%180==0?(Ey=this.lng+iy/(637100079e-2*Ly*py(this.lat*s0))*(_h===270?-360:360),new O0(this.lat,(Ey+540)%360-180)):((iy/=637100079e-2)&&(_h*=s0,Py=this.lat*s0,hy=this.lng*s0,vy=(fy=Py+iy*py(_h))-Py,Ey=_g(gy(fy/2+Gy)/gy(Py/2+Gy)),Ey=i1(vy/Ey)?py(Py):vy/Ey,By=iy*ry(_h)/Ey,_p(fy)>Cy&&(fy=0<fy?wy-fy:-(wy+fy))),iy?new O0(fy*t0,((hy+By+d0+(_p(Py+vy)>Cy?wy:0))%Ly-wy)*t0):this)},O0.prototype.getBoundingBox=O0.prototype.D=function(){return new qy(this.lat,this.lng,this.lat,this.lng)},O0.validate=y1,O0.fromIPoint=function _h(iy){if(!iy)throw new B0(_h,0,iy);return new O0(iy.lat,iy.lng,iy.alt)},O0.prototype.a="Point",O0.prototype.I=function(_h){return _h.push("(",this.lng," ",this.lat,")"),_h},O0.prototype.l="Point",O0.prototype.u=function(){return[this.lng,this.lat,this.alt||0]},O0.prototype.j=function(){return[this.lat,this.lng,this.alt||0]},_r(qy,Q0),_e("H.geo.Rect",qy),qy.prototype.a="Polygon",qy.prototype.I=function(_h){var iy=this.i,cy=this.f,hy=this.h,fy=this.g;return _h.push("(","(",cy," ",iy,",",fy," ",iy,",",fy," ",hy,",",cy," ",hy,",",cy," ",iy,")",")"),_h},qy.prototype.equals=qy.prototype.w=function(_h){return this===_h||!!_h&&this.i===_h.i&&this.f===_h.f&&this.h===_h.h&&this.g===_h.g},qy.prototype.clone=function(){return new qy(this.i,this.f,this.h,this.g)},qy.prototype.getTopLeft=qy.prototype.W=function(){return this.m||(this.m=new O0(this.i,this.f)),this.m},qy.prototype.getBottomRight=qy.prototype.V=function(){return this.b||(this.b=new O0(this.h,this.g)),this.b},qy.prototype.getTop=qy.prototype.na=function(){return this.i},qy.prototype.getBottom=qy.prototype.ha=function(){return this.h},qy.prototype.getLeft=qy.prototype.ja=function(){return this.f},qy.prototype.getRight=qy.prototype.ma=function(){return this.g},qy.prototype.getCenter=qy.prototype.F=function(){return this.c||(this.c=new O0(this.h+(this.i-this.h)/2,v1(this.f,this.A()))),this.c},qy.prototype.getWidth=qy.prototype.A=function(){return c1(this.f,this.g)},qy.prototype.getHeight=qy.prototype.G=function(){return this.i-this.h},qy.prototype.isCDB=qy.prototype.N=function(){return this.f>this.g},qy.prototype.isEmpty=qy.prototype.ra=function(){return!this.A()&&!this.G()},qy.prototype.getBoundingBox=qy.prototype.D=function(){return new qy(this.i,this.f,this.h,this.g)},qy.prototype.containsLatLng=qy.prototype.L=function(_h,iy,cy){var hy=this.F();return cy||(_h=p1(_h,this.L,0),iy=e1(iy,this.L,1)),(_h=(iy=this.B(_h,iy,cy)).F()).lat===hy.lat&&_h.lng===hy.lng&&this.G()===iy.G()&&this.A()===iy.A()},qy.prototype.containsPoint=qy.prototype.$=function(_h,iy){return iy||y1(_h,this.$,0),this.L(_h.lat,_h.lng,iy)},qy.prototype.containsRect=qy.prototype.aa=function(_h,iy){var cy=this.F();if(!(iy||_h instanceof qy))throw new B0(this.aa,0,_h);return(_h=(iy=this.J(_h,iy)).F()).lat===cy.lat&&_h.lng===cy.lng&&this.G()===iy.G()&&this.A()===iy.A()},qy.prototype.mergeLatLng=qy.prototype.B=function(_h,iy,cy,hy){if(!cy){if(i1(_h=p1(_h)))throw new B0(this.B,0,_h);if(i1(iy=e1(iy)))throw new B0(this.B,1,iy)}return L1(this.i,this.f,this.h,this.g,_h,iy,_h,iy,hy)},qy.prototype.mergePoint=qy.prototype.ca=function(_h,iy,cy){return iy||y1(_h,this.ca,0),this.B(_h.lat,_h.lng,iy,cy)},qy.prototype.mergeRect=qy.prototype.J=function(_h,iy,cy){if(!(iy||_h instanceof qy))throw new B0(this.J,0,_h);return L1(this.i,this.f,this.h,this.g,_h.i,_h.f,_h.h,_h.g,cy)},qy.prototype.mergeTopLeftBottomRight=qy.prototype.C=function(_h,iy,cy,hy,fy,vy){return fy||(_h=p1(_h,this.C,0),iy=e1(iy,this.C,1),cy=p1(cy,this.C,2),hy=e1(hy,this.C,3)),L1(this.i,this.f,this.h,this.g,_h,iy,cy,hy,vy)},qy.prototype.intersects=qy.prototype.ba=function(_h,iy){var cy=this.f<=this.g,hy=_h.f<=_h.g,fy=this.f<_h.g,vy=_h.f<this.g;if(!(iy||_h instanceof qy))throw new B0(this.ba,0,_h);return this.h<=_h.i&&_h.h<=this.i&&(!cy&&(!hy||fy||vy)||!hy&&(fy||vy)||fy&&vy)},qy.merge=L1,qy.fromPoints=S1,qy.coverPoints=function _h(iy,cy){var hy=1,fy=iy.length,vy=null,Py=j(iy);if(Py!="array"&&(Py!="object"||typeof iy.length!="number"))throw new B0(_h,0,iy);if(0<fy)for(vy=S1(Py=iy[0],Py,cy);hy<fy;hy++)Py=iy[hy],vy.B(Py.lat,Py.lng,cy,vy);return vy},qy.coverLatLngAlts=function _h(iy,cy){var hy,fy=3,vy=iy.length;if(!(cy||iy&&iy.length!=null))throw new B0(_h,0,iy);if(0<vy)for(hy=new qy(iy[0],iy[1],iy[0],iy[1]);fy<vy;fy+=3)hy.B(iy[fy],iy[fy+1],cy,hy);return hy},qy.coverRects=function _h(iy,cy){var hy,fy=1,vy=iy.length;if(cy&&(!iy||iy.length==null))throw new B0(_h,0,iy);if(0<vy)for(hy=new qy(iy[0].i,iy[0].f,iy[0].h,iy[0].g);fy<vy;fy++)hy.J(iy[fy],cy,hy);return hy},qy.prototype.resizeToCenter=qy.prototype.da=function(_h,iy){var cy=this.f,hy=this.i,fy=this.g,vy=this.h,Py=this.F().lng;y1(_h,this.da,0);var Ey=_h.lat-vy-(hy-vy)/2,My=_h.lng-Py;return _h=(_h=cy+((My=180<My||My<-180?-(Py+_h.lng):My)<0?2*My:0))<-180?360+_h:_h,fy=180<(fy+=0<My?2*My:0)?fy-360:fy,90<=(hy=0<Ey?hy+2*Ey:hy)&&(hy=90),(vy=Ey<0?vy+2*Ey:vy)<=-90&&(vy=-90),iy?T1(iy,hy,_h,vy,fy):new qy(hy,_h,vy,fy)},qy.prototype.l="Polygon",qy.prototype.u=function(){return[[this.f,this.i,0],[this.g,this.i,0],[this.g,this.h,0],[this.f,this.h,0],[this.f,this.i,0]]},qy.prototype.U=function(){return this.j()},qy.prototype.j=function(){return[this.i,this.f,this.h,this.g]},A1.prototype.remove=function(_h){var iy,cy,hy,fy,vy,Py,Ey=!1;if(_h&&(iy=_h.a)&&iy.b===this&&(cy=iy.entries)&&0<=(hy=cy.indexOf(_h))){for(cy.splice(hy,1),cy=this.a;iy;)(fy=iy.entries)&&fy.length||(fy&&delete iy.entries,iy.a||!(vy=iy.c))?iy=h1:((hy=vy)[Py=(Ey=iy).j]===Ey&&(delete hy[Py],delete Ey.c,--hy.a),cy===iy&&(cy=vy),iy=vy);this.a!==cy&&(this.a=cy,I1(this)),O1(this,_h,!1),Ey=!0}return Ey},A1.prototype.flush=function(){var _h=new xy(null,NaN,this.j-this.m,this.l-this.u,this.j+this.m,this.l+this.u);(_h.b=this).a=this.b=_h,this.c=null},A1.prototype.o=function(_h,iy,cy,hy,fy,vy){var Py=[],Ey=this.a,My=this.b;return _h<=Ey[5]&&iy<=Ey[6]&&(fy?cy>=Ey[7]:cy>Ey[7])&&(vy?hy>=Ey[4]:hy>Ey[4])&&function By($y,Zy,y0,S0,V0,i0,a0,r0,m0){var R0,z0=Zy.entries,L0=Zy[7],I0=Zy[4],w0=Zy[5],g1=Zy[6],Z0=Zy[8],m1=Zy[9];if(z0){var _1=z0.length;if(I0<V0||L0<S0||a0<g1||i0<w0)for(;_1--;){L0=z0[_1],I0=L0[3],w0=L0[0],g1=L0[1];var V1=L0[2];V0<=V1&&S0<=g1&&(w0<a0||r0&&w0==a0)&&(I0<i0||m0&&I0==i0)&&y0.push(L0)}else for(;_1--;)y0.push(z0[_1])}(Z0<i0||m0&&i0==Z0)&&(V0<m1&&(R0=Zy[1])&&By($y,R0,y0,S0,V0,i0,a0,r0,m0),(m1<a0||r0&&a0==m1)&&(R0=Zy[3])&&By($y,R0,y0,S0,V0,i0,a0,r0,m0)),S0<Z0&&(V0<m1&&(R0=Zy[0])&&By($y,R0,y0,S0,V0,i0,a0,r0,m0),(m1<a0||r0&&a0==m1)&&(R0=Zy[2])&&By($y,R0,y0,S0,V0,i0,a0,r0,m0))}(this,Ey,Py,_h,iy,cy,hy,vy||hy>=My[6],fy||cy>=My[5]),Py};var yy=0;function xy(_h,iy,cy,hy,fy,vy){this.j=iy,_h&&(this.c=_h,this.b=_h.b,fy=1&iy?(cy=_h[8],_h[5]):(cy=_h[7],_h[8]),vy=2&iy?(hy=_h[9],_h[6]):(hy=_h[4],_h[9])),this[7]=cy,this[5]=fy,this[8]=(cy+fy)/2,this[4]=hy,this[6]=vy,this[9]=(hy+vy)/2}function Ty(_h,iy,cy,hy,fy,vy){Ty.ua.constructor.apply(this,arguments)}function Wy(_h,iy,cy,hy,fy,vy,Py){var Ey,My,By=iy[8],$y=iy[9];return Py&&(fy<By||(Ey=By<=cy))&&(vy<$y||(My=$y<=hy))?cy=(By=Wy)(_h,iy=iy[Ey|=My<<1]||(++iy.a,iy[Ey]=new xy(iy,Ey)),cy,hy,fy,vy,Py-1):(hy=cy=new _v(cy,hy,fy,vy),(iy.entries||(iy.entries=[])).push(hy),hy.a=iy,O1(_h,cy,!0),I1(_h,iy)),cy}function _v(_h,iy,cy,hy){this.id=yy++,this[0]=iy,this[1]=cy,this[2]=hy,this[3]=_h}function p0(_h){this.l=new Ty(+_h||10,180,90,0,0,!0),this.j=[],this.m=!1,this.a=this.b=this.c=null}function c0(_h,iy,cy,hy,fy,vy){if(vy)vy=new _v(fy,-iy,cy+360,-hy),_h.j.push(vy),_h.m=!0,_h.a&&_h.a.C(iy,cy,hy,fy,!0,_h.a);else{var Py=-iy,Ey=-hy,My=(vy=_h.l).b,By=My[5],$y=My[6];if(!(My[7]<=cy&&My[4]<=Py&&(fy<By||By===fy&&By===My.b.b[5])&&(Ey<$y||$y===Ey&&$y===My.b.b[6])))throw Error("Coordinates out of bounds");vy=Wy(vy,vy.b,cy,Py,fy,Ey,vy.sa),_h.b&&_h.b.C(iy,cy,hy,fy,!0,_h.b)}return _h.c=null,vy}function o0(_h,iy,cy,hy,fy,vy,Py){var Ey=(_h=_h.j).length,My=[];if(Ey)for(var By=cy+360,$y=fy+360;Ey--;){var Zy=_h[Ey];(_m(Zy,iy,cy,hy,fy,vy,Py)||_m(Zy,iy,By,hy,$y,vy,Py))&&My.push(Zy)}return My}function _m(_h,iy,cy,hy,fy,vy,Py){var Ey=_h[3],My=_h[0],By=_h[1];return _h=_h[2],(vy?My<=hy:My<hy)&&(Py?Ey<=fy:Ey<fy)&&iy<=_h&&cy<=By}function g0(_h,iy){var cy,hy;if(cy=iy.length){for(var fy=_h.length,vy={};fy--;)vy[_h[fy].id]=1;for(;cy--;)(hy=iy[cy]).id in vy||_h.push(hy)}}function k0(){}function Qy(_h,iy,cy){if(this.l=[],iy&&this.K(iy),cy&&!$(cy))throw new B0(Qy,2,cy);this.b=0,this.m=cy,this.a={},this.j=this.c=null,this.Z(_h)}function P0(_h,iy){return iy&&(_h.c=r1(_h,iy,_h.c)),iy}function $0(_h){for(;_h.b>_h.u&&_h.j;)F0(_h,_h.j,!0)}function r1(_h,iy,cy){return cy!==iy&&((iy.H||iy.v)&&F0(_h,iy,!1),(iy.H=cy)&&(iy.v=cy.v,cy.v=iy),iy.v||(_h.c=iy),iy.H||(_h.j=iy),_h.b+=iy.size),iy}function F0(_h,iy,cy){var hy=iy.v,fy=iy.H;(hy||fy||iy==_h.c&&iy==_h.j)&&(hy?hy.H=fy:_h.c=fy,fy?fy.v=hy:_h.j=hy,_h.b-=iy.size,cy&&(delete _h.a[iy.id],d1(_h,iy))),iy.H=iy.v=null}function d1(_h,iy){for(var cy=_h.l.length;cy--;)_h.l[cy].call(_h,iy.id,iy.data,iy.size)}xy.prototype.a=0,_r(Ty,A1),_e("H.geo.QuadTree",p0),p0.prototype.N=function(){return this.m},p0.prototype.D=function(){var _h;if(!this.c){var iy,cy,hy=[];if((Py=!this.b)&&(Ey=(vy=this.l).c,vy.I&&!Ey&&((Py=vy.a).entries||Py[0]||Py[1]||Py[2]||Py[3])&&(Ey=function By($y,Zy){for(var y0,S0,V0=0,i0=3;0<=i0;i0--){for(var a0=i0+4,r0=0<i0%3,m0=[],R0=Zy[i0],z0=$y[i0],L0=z0.length;L0--;){var I0=z0[L0];if(y0=I0.entries)for(S0=y0.length;S0--;){var w0=y0[S0][i0];(r0?R0<w0:w0<R0)&&(R0=w0)}for(S0=4;S0--;)(y0=I0[S0])&&(r0?y0[a0]>R0:y0[a0]<R0)&&m0.push(y0)}V0+=m0.length,Zy[i0]=R0,$y[i0]=m0}return V0&&(Zy=By($y,Zy)),Zy}([Ey=[Py],Ey,Ey,Ey],[Py[6],Py[7],Py[4],Py[5]]),vy.c=Ey),Py=vy=Ey),Py&&(this.b=new qy(-vy[0],vy[3],-vy[2],vy[1])),(_h=this.b)&&hy.push(_h),!this.a&&(cy=(iy=this.j).length)){for(Py=360,Ey=-(vy=90),My=0;cy--;)var fy=iy[cy],vy=_o(vy,fy[0]),Py=_o(Py,fy[3]),Ey=ga(Ey,fy[2]),My=ga(My,fy[1]);this.a=new qy(-vy,Py,-Ey,My-360)}(_h=this.a)&&hy.push(_h),(_h=hy[0])&&(hy[1]&&(_h=_h.J(hy[1],!0)),this.c=_h)}return this.c},p0.prototype.insertBoundingBox=p0.prototype.oa=function(_h){var iy=_h.W(),cy=_h.V();return(_h=_h.N())?c0(this,iy.lat,cy.lng,cy.lat,iy.lng,_h):c0(this,iy.lat,iy.lng,cy.lat,cy.lng,_h)},p0.prototype.remove=function(_h){var iy,cy;return _h.a?(cy=this.l.remove(_h),this.b=null):(cy=0<=(_h=(iy=this.j).indexOf(_h)))&&(iy.splice(_h,1),this.m=0<iy.length,this.a=null),cy&&(this.c=null),cy},p0.prototype.intersectBoundingBox=p0.prototype.pa=function(_h,iy,cy){var hy=this.l,vy=_h.W(),Ey=_h.V(),fy=-vy.lat,vy=vy.lng,Py=-Ey.lat,Ey=Ey.lng;return!iy&&fy==Py||!cy&&vy===Ey?_h=[]:_h.N()?(g0(_h=hy.o(-180,fy,Ey,Py,cy,iy),hy.o(vy,fy,180,Py,!1,iy)),g0(_h,o0(this,fy,Ey,Py,vy+360,iy,cy))):g0(_h=hy.o(vy,fy,Ey,Py,cy,iy),o0(this,fy,vy,Py,Ey,iy,cy)),_h},_e("H.util.ICache",k0),k0.prototype.add=function(){},k0.prototype.get=function(){},k0.prototype.drop=k0.prototype.S=function(){},k0.prototype.forEach=function(){},k0.prototype.removeAll=k0.prototype.Y=function(){},k0.prototype.registerOnDrop=k0.prototype.K=function(){},k0.prototype.deRegisterOnDrop=k0.prototype.P=function(){},_e("H.util.Cache",Qy),Qy.prototype.add=function(_h,iy,cy){var hy,fy;if(!w1(cy=+cy)||cy<0)throw new B0(this.add,2,cy);return _h=String(_h),(fy=!this.m||this.m(_h,iy,cy))&&((hy=this.a[_h])?(hy.data!==iy&&d1(this,hy),this.b+=cy-hy.size,hy.size=cy,hy.data=iy,P0(this,hy)):this.a[_h]=r1(this,{id:_h,data:iy,size:cy,H:null,v:null},this.c),$0(this)),fy},Qy.prototype.registerOnDrop=Qy.prototype.K=function(_h){if(!$(_h))throw new B0(this.K,0,_h);this.l.push(_h)},Qy.prototype.deRegisterOnDrop=Qy.prototype.P=function(_h){this.l=this.l.filter(function(iy){return iy!==_h})},Qy.prototype.get=function(_h,iy){return(_h=iy?this.a[_h]:P0(this,this.a[_h]))&&_h.data},Qy.prototype.drop=Qy.prototype.S=function(_h){var iy;(iy=this.a[_h])&&F0(this,iy,!0)},Qy.prototype.forEach=function(_h,iy,cy){var hy;for(hy in this.a){var fy=this.a[hy];cy&&!cy(hy,fy.data,fy.size)||_h.call(iy,hy,fy.data,fy.size)}},Qy.prototype.removeAll=Qy.prototype.Y=function(_h){var iy;for(iy in this.a){var cy=this.a[iy];_h&&!_h(iy,cy.data,cy.size)||F0(this,this.a[iy],!0)}},Qy.prototype.setMaxSize=Qy.prototype.Z=function(_h){if(!(0<+_h))throw new B0(Qy.prototype.Z,0,_h);return this.u=+_h,$0(this),this},Qy.prototype.getMaxSize=Qy.prototype.ka=function(){return this.u},Qy.prototype.getCurrentSize=Qy.prototype.ia=function(){return this.b}}).call(ns);var MathUtils$1=MathUtils={},Geo;function _xyToArr(e){return[e.x,e.y]}function _arrToXy(e){return _construct(ns.H.math.Point,_toConsumableArray(e))}MathUtils.clipPolygon=function(e,o){var s,h,d=[],g=ns.H.math.clipping.clipPolygon(e.map(_arrToXy),o.map(_arrToXy));if(g)do{for(s=[],h=g;s.push(_xyToArr(h)),h=h.next;);d.push(s)}while(g=g.nextPoly);else MathUtils.isPointInsidePolygon(o[0],e)?d.push(o):MathUtils.isPointInsidePolygon(e[0],o)&&d.push(e);return d},MathUtils.isPointInsidePolygon=function(e,o){return ns.H.math.isPointInsidePolygon({x:e[0],y:e[1]},ns.H.math.flatten(o))},MathUtils.clamp=function(e,o,s){return(e-=0)>s?s:e<o?o:e},MathUtils.splitLegs=function(e,o){var s=[];e.push(e[0]);for(var h=0;h<e.length-1;h++){var d,g=e[h],_=e[h+1];s.push(g),Math.abs(_[0]-g[0])>=o&&(d=[(g[0]+_[0])/2,(g[1]+_[1])/2],s.push(d))}return s.length!==e.length-1?MathUtils.splitLegs(s,o):s},MathUtils.getBBox=function(e){var o=1/0,s=1/0,h=-1/0,d=-1/0;return e.forEach(function(g){g[0]<o&&(o=g[0]),g[1]<s&&(s=g[1]),g[0]>h&&(h=g[0]),g[1]>d&&(d=g[1])}),[o,s,h,d]},MathUtils.getBBoxCenter=function(e){var o=_slicedToArray(e,4),s=o[0],h=o[1];return[s+(o[2]-s)/2,h+(o[3]-h)/2]},MathUtils.getLineLength=function(e,o,s,h){return Math.sqrt(Math.pow(e-s,2)+Math.pow(o-h,2))},MathUtils.modulo=function(e,o){var s;return(s=e%o)<0==o<0?s:s+o};var Geo$1=Geo={};Geo.default_source_max_zoom=18,Geo.default_view_max_zoom=20,Geo.tile_size=256,Geo.half_circumference_meters=20037508342789244e-9,Geo.circumference_meters=2*Geo.half_circumference_meters,Geo.min_zoom_meters_per_pixel=Geo.circumference_meters/Geo.tile_size;var meters_per_pixel=[];Geo.metersPerPixel=function(e){return meters_per_pixel[e]=meters_per_pixel[e]||Geo.min_zoom_meters_per_pixel/Math.pow(2,e),meters_per_pixel[e]};var meters_per_tile=[];Geo.metersPerTile=function(e){return meters_per_tile[e]=meters_per_tile[e]||Geo.circumference_meters/Math.pow(2,e),meters_per_tile[e]},Geo.tile_scale=4096,Geo.units_per_pixel=Geo.tile_scale/Geo.tile_size,Geo.height_scale=16;var units_per_meter=[];Geo.unitsPerMeter=function(e){return units_per_meter[e]=units_per_meter[e]||Geo.tile_scale/(Geo.tile_size*Geo.metersPerPixel(e)),units_per_meter[e]},Geo.metersForTile=function(e){return{x:e.x*Geo.circumference_meters/Math.pow(2,e.z)-Geo.half_circumference_meters,y:-(e.y*Geo.circumference_meters/Math.pow(2,e.z)-Geo.half_circumference_meters)}},Geo.tileForMeters=function(e,o){var s=_slicedToArray(e,2),h=s[0],d=s[1];return{x:Math.floor((h+Geo.half_circumference_meters)/(Geo.circumference_meters/Math.pow(2,o))),y:Math.floor((-d+Geo.half_circumference_meters)/(Geo.circumference_meters/Math.pow(2,o))),z:o}},Geo.metersToExactTileCoords=function(e,o){var s=_slicedToArray(e,2),h=s[0],d=s[1];return{x:Math.pow(2,o-1)*(1+h/Geo.half_circumference_meters),y:Math.pow(2,o-1)*(1-d/Geo.half_circumference_meters),z:o}},Geo.wrapTile=function(e){var o=e.x,s=e.y,h=e.z,d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{x:!0,y:!1},g=(1<<h)-1;return d.x&&(o&=g),d.y&&(s&=g),{x:o,y:s,z:h}},Geo.wrapMeters=function(e){var o=e.x,s=e.y;return{x:MathUtils$1.modulo(o+Geo.half_circumference_meters,Geo.circumference_meters)-Geo.half_circumference_meters,y:s}},Geo.metersToLatLng=function(e){var o=_slicedToArray(e,2),s=o[0],h=o[1];return s/=Geo.half_circumference_meters,h/=Geo.half_circumference_meters,h=(2*Math.atan(Math.exp(h*Math.PI))-Math.PI/2)/Math.PI,[s*=180,h*=180]},Geo.latLngToMeters=function(e){var o=_slicedToArray(e,2),s=o[0],h=o[1],h=Math.log(Math.tan(h*Math.PI/360+Math.PI/4))/Math.PI;return h*=Geo.half_circumference_meters,h=Math.min(Math.max(h,-Geo.half_circumference_meters),Geo.half_circumference_meters),[s*=Geo.half_circumference_meters/180,h]},Geo.tileSpaceToMeters=function(e,o,s){var h=_slicedToArray(e,2),d=h[0],g=h[1],_=Geo.unitsPerMeter(o);return[d/_+s.x,g/_+s.y]},Geo.tileSpaceToLatlng=function(e,o,s){var h=Geo.unitsPerMeter(o);return Geo.transformGeometry(e,function(d){d[0]=d[0]/h+s.x,d[1]=d[1]/h+s.y;var g=_slicedToArray(Geo.metersToLatLng(d),2),_=g[0],j=g[1];d[0]=_,d[1]=j}),e},Geo.copyGeometry=function(e){if(e!=null){var o={type:e.type};return e.type==="Point"?o.coordinates=[e.coordinates[0],e.coordinates[1]]:e.type==="LineString"||e.type==="MultiPoint"?o.coordinates=e.coordinates.map(function(s){return[s[0],s[1]]}):e.type==="Polygon"||e.type==="MultiLineString"?o.coordinates=e.coordinates.map(function(s){return s.map(function(h){return[h[0],h[1]]})}):e.type==="MultiPolygon"&&(o.coordinates=e.coordinates.map(function(s){return s.map(function(h){return h.map(function(d){return[d[0],d[1]]})})})),o}},Geo.transformGeometry=function(e,o){e!=null&&(e.type==="Point"?o(e.coordinates):e.type==="LineString"||e.type==="MultiPoint"?e.coordinates.forEach(o):e.type==="Polygon"||e.type==="MultiLineString"?e.coordinates.forEach(function(s){return s.forEach(o)}):e.type==="MultiPolygon"&&e.coordinates.forEach(function(s){s.forEach(function(h){return h.forEach(o)})}))},Geo.boxIntersect=function(e,o){return!(o.sw.x>e.ne.x||o.ne.x<e.sw.x||o.sw.y>e.ne.y||o.ne.y<e.sw.y)},Geo.findBoundingBox=function(e){for(var o=1/0,s=-1/0,h=1/0,d=-1/0,g=e[0].length,_=0;_<g;_++){var j=e[0][_];j[0]<o&&(o=j[0]),j[1]<h&&(h=j[1]),j[0]>s&&(s=j[0]),j[1]>d&&(d=j[1])}return[o,h,s,d]},Geo.geometryType=function(e){return e==="Polygon"||e==="MultiPolygon"?"polygon":e==="LineString"||e==="MultiLineString"?"line":e==="Point"||e==="MultiPoint"?"point":void 0},Geo.centroid=function(e){var o=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];if(e&&e.length!==0){var s,h=0,d=0,g=0,_=e[0],j=_.length;o&&(s=_[0],_=_.map(function(ga){return[ga[0]-s[0],ga[1]-s[1]]}));for(var $=0,_t=j-1;$<j;_t=$,$++){var _e=_[$],_r=_[_t],_n=_e[1]*_r[0]-_r[1]*_e[0];h+=(_e[0]+_r[0])*_n,d+=(_e[1]+_r[1])*_n,g+=3*_n}var _o=[h/g,d/g];return o&&(_o[0]+=s[0],_o[1]+=s[1]),_o}},Geo.multiCentroid=function(e){for(var o=e.length,s=[0,0],h=0;h<e.length;h++){var d=Geo.centroid(e[h]);s[0]+=d[0],s[1]+=d[1]}return s[0]/=o,s[1]/=o,s},Geo.signedPolygonRingAreaSum=function(e){for(var o=0,s=e.length,h=0;h<s-1;h++){var d=e[h],g=e[h+1];o+=d[0]*g[1]-g[0]*d[1]}return o+=e[s-1][0]*e[0][1]-e[0][0]*e[s-1][1]},Geo.polygonRingArea=function(e){return Math.abs(Geo.signedPolygonRingAreaSum(e))/2},Geo.polygonArea=function(e){if(e)return Geo.polygonRingArea(e[0])},Geo.multiPolygonArea=function(e){for(var o=0,s=0;s<e.length;s++)o+=Geo.polygonArea(e[s]);return o},Geo.ringWinding=function(e){var o=Geo.signedPolygonRingAreaSum(e);return 0<o?"CW":o<0?"CCW":void 0},Geo.getTileBoundingBox=function(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,h=Geo.wrapTile(e,{x:!0}),d=Geo.metersForTile(h),g=Geo.metersPerPixel(h.z),_=Geo.metersToLatLng([d.x-s*g,d.y+s*g]),j=Geo.metersToLatLng([d.x+(o+s)*g,d.y-(o+s)*g]),$=Geo.isLastTile(h);return new ns.H.geo.Rect(e.y===0?90:MathUtils$1.clamp(_[1],-90,90),MathUtils$1.clamp(_[0],-180,180),$.row?-90:MathUtils$1.clamp(j[1],-90,90),$.column?180:MathUtils$1.clamp(j[0],-180,180))},Geo.isLastTile=function(e){var o=e.x,s=e.y,h=e.z;return{row:s===Math.pow(2,h)-1,column:o===Math.pow(2,h)-1}};var MethodNotImplemented=function(){_inherits(o,_wrapNativeSuper(Error));var e=_createSuper(o);function o(s){var h;return _classCallCheck(this,o),(h=e.call(this)).name="MethodNotImplemented",h.message="Method "+s+" must be implemented in subclass",h}return o}(),is_worker=!1,is_main=!1,force_main,force_worker;try{window.document!==HTMLDocument&&(is_main=!0)}catch(e){self!==void 0&&(is_worker=!0,self.window={document:{}},self.document=self.window.document)}var Thread={get is_fake_worker(){return self.is_fake_worker},get is_worker(){return force_worker!==void 0?force_worker:is_worker||self.is_fake_worker},set is_worker(e){force_worker=e},get is_main(){return force_main!==void 0?force_main:is_main&&!self.is_fake_worker},set is_main(e){force_main=e},is_native_worker:is_worker},WorkerBroker={},message_id=0,messages={},targets={},main_worker_targets={};function findTarget(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:targets,h=[];if(typeof e=="string"&&(e=(h=e.split(".")).pop()),Thread.is_main&&o&&h.length===1&&h[0]==="self")s=o;else for(var d=0;d<h.length;d++){if(!s[h[d]])return[];s=s[h[d]]}return[e,s]}WorkerBroker.addTarget=function(e,o){Thread.is_fake_worker?main_worker_targets[e]=o:targets[e]=o},WorkerBroker.removeTarget=function(e){delete targets[e],delete main_worker_targets[e]};var ERROR_NO_TARGET=" No object with that name is registered on main thread.",ERROR_NO_METHOD=" Object has no method with that name.",ERROR_NOT_SET="_worker_broker_error_not_set_";function setupMainThread(){WorkerBroker.postMessage=function(e,o){for(var s=arguments.length,h=new Array(2<s?s-2:0),d=2;d<s;d++)h[d-2]=arguments[d];if(Array.isArray(e))return Promise.all(e.map(function(_r){return WorkerBroker.postMessage.apply(WorkerBroker,[_r,o].concat(_toConsumableArray(h)))}));var g,_={};_typeof(o)==="object"&&(o=(_=o).method);var j="main_send";typeof e=="string"?(o=e,h=Array.prototype.slice.call(arguments,1),g=!0,j="worker_send"):e.init&&(g=!0);var $,_t=[];if(h&&h.length===1&&h[0]instanceof WorkerBroker.withTransferables&&(_t=h[0].transferables,h=h[0].value),$={type:j,message_id:++message_id,method:o,message:h},g)return function(_r,_n){var _o=_r.type,ga=_slicedToArray(findTarget(_r.method,_n,_o==="main_send"?main_worker_targets:targets),2),_l=ga[0],_f=ga[1],_c="Worker broker could not dispatch message type ".concat(_r.method," on target ").concat(_r.target,".");if(!_f)throw Error(_c+ERROR_NO_TARGET);var _p=typeof _f[_l]=="function"&&_f[_l];if(!_p)throw Error(_c+ERROR_NO_METHOD);return new Promise(function(_g,ty){var oy;try{oy=_p.apply(_f,_r.message)}catch(ry){return void ty(ry)}oy instanceof Promise?oy.then(function(ry){ry instanceof WorkerBroker.withTransferables&&(ry=ry.value[0]),_g(ry)},function(ry){ty(ry instanceof Error?"".concat(ry.message,": ").concat(ry.stack):ry)}):(oy instanceof WorkerBroker.withTransferables&&(oy=oy.value[0]),_g(oy))})}($,e&&e.init?e:void 0);var _e=new Promise(function(_r,_n){messages[message_id]={method:o,message:h,resolve:_r,reject:_n}});return _.stringify&&($=JSON.stringify($)),e.postMessage($,_t.map(function(_r){return _r.object})),freeTransferables(_t),_e},WorkerBroker.addWorker=function(e){if(!(e instanceof Worker))throw Error("Worker broker could not add non-Worker object",e);e.addEventListener("message",function(o){var s=typeof o.data=="string"?JSON.parse(o.data):o.data,h=s.message_id;if(s.type==="worker_reply")messages[h]&&(s.error?messages[h].reject(s.error):messages[h].resolve(s.message),delete messages[h]);else if(s.type==="worker_send"&&h!=null){var d=_slicedToArray(findTarget(s.method),2),g=d[0],_=d[1],j="Worker broker could not dispatch message type ".concat(s.method," on target ").concat(s.target,".");if(!_)throw Error(j+ERROR_NO_TARGET);var $=typeof _[g]=="function"&&_[g];if(!$)throw Error(j+ERROR_NO_METHOD);var _t,_e=ERROR_NOT_SET;try{_t=$.apply(_,s.message)}catch(_o){_e=_o}var _r,_n=[];_t&&typeof _t.then=="function"?_t.then(function(_o){_o instanceof WorkerBroker.withTransferables&&(_n=_o.transferables,_o=_o.value[0]),_r={type:"main_reply",message_id:h,message:_o},e.postMessage(_r,_n.map(function(ga){return ga.object})),freeTransferables(_n)},function(_o){e.postMessage({type:"main_reply",message_id:h,error:_o instanceof Error?"".concat(_o.message,": ").concat(_o.stack):_o})}):(_t instanceof WorkerBroker.withTransferables&&(_n=_t.transferables,_t=_t.value[0]),_r={type:"main_reply",message_id:h,message:_t,error:_e instanceof Error?"".concat(_e.message,": ").concat(_e.stack):_e},e.postMessage(_r,_n.map(function(_o){return _o.object})),freeTransferables(_n))}})},WorkerBroker.getMessages=function(){return messages},WorkerBroker.getMessageId=function(){return message_id}}function setupWorkerThread(){WorkerBroker.postMessage=function(e){for(var o=arguments.length,s=new Array(1<o?o-1:0),h=1;h<o;h++)s[h-1]=arguments[h];var d={};_typeof(e)==="object"&&(e=(d=e).method);var g,_=new Promise(function($,_t){messages[message_id]={method:e,message:s,resolve:$,reject:_t}}),j=[];return s&&s.length===1&&s[0]instanceof WorkerBroker.withTransferables&&(j=s[0].transferables,s=s[0].value),g={type:"worker_send",message_id,method:e,message:s},d.stringify&&(g=JSON.stringify(g)),self.postMessage(g,j.map(function($){return $.object})),freeTransferables(j),message_id++,_},self.addEventListener("message",function(e){var o=typeof e.data=="string"?JSON.parse(e.data):e.data,s=o.message_id;if(o.type==="main_reply")messages[s]&&(o.hasOwnProperty("error")&&o.error!==ERROR_NOT_SET?messages[s].reject(o.error):messages[s].resolve(o.message),delete messages[s]);else if(o.type==="main_send"&&s!=null){var h=_slicedToArray(findTarget(o.method),2),d=h[0],g=h[1],_="Worker broker could not dispatch message type ".concat(o.method," on target ").concat(o.target,".");if(!g)throw Error(_+ERROR_NO_TARGET);var j,$,_t=typeof g[d]=="function"&&g[d];if(!_t)throw Error(_+ERROR_NO_METHOD);try{j=_t.apply(g,o.message)}catch(_n){$=_n}var _e,_r=[];j instanceof Promise?j.then(function(_n){_n instanceof WorkerBroker.withTransferables&&(_r=_n.transferables,_n=_n.value[0]),_e={type:"worker_reply",message_id:s,message:_n},self.postMessage(_e,_r.map(function(_o){return _o.object})),freeTransferables(_r)},function(_n){self.postMessage({type:"worker_reply",message_id:s,error:_n instanceof Error?"".concat(_n.message,": ").concat(_n.stack):_n})}):(j instanceof WorkerBroker.withTransferables&&(_r=j.transferables,j=j.value[0]),_e={type:"worker_reply",message_id:s,message:j,error:$ instanceof Error?"".concat($.message,": ").concat($.stack):$},self.postMessage(_e,_r.map(function(_n){return _n.object})),freeTransferables(_r))}})}function findTransferables(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null,s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:[];if(!e)return h;if(Array.isArray(e))e.forEach(function(g,_){return findTransferables(g,e,_,h)});else if(_typeof(e)==="object")if(e instanceof ArrayBuffer)h.push({object:e,parent:o,property:s});else if(e.buffer instanceof ArrayBuffer)h.push({object:e.buffer,parent:o,property:s});else for(var d in e)findTransferables(e[d],e,d,h);return h}function freeTransferables(e){Array.isArray(e)&&e.filter(function(o){return o.parent&&o.property}).forEach(function(o){return delete o.parent[o.property]})}WorkerBroker.withTransferables=function(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];if(!(this instanceof WorkerBroker.withTransferables))return _construct(WorkerBroker.withTransferables,o);this.value=o,this.transferables=findTransferables(this.value)},Thread.is_main&&setupMainThread(),Thread.is_worker&&setupWorkerThread();var LEVELS={silent:-1,error:0,warn:1,info:2,debug:3,trace:4},methods={},logged_once={},Utils;function methodForLevel(e){return methods[e]=methods[e]||(console[e]?console[e]:console.log).bind(console),methods[e]}function log(e){var o=_typeof(e)==="object"?e.level:e;if(LEVELS[o]<=LEVELS[log.level]){for(var s=arguments.length,h=new Array(1<s?s-1:0),d=1;d<s;d++)h[d-1]=arguments[d];if(Thread.is_native_worker)WorkerBroker.postMessage.apply(WorkerBroker,[{method:"_logProxy",stringify:!0},e].concat(h));else{if(_typeof(e)==="object"&&e.once===!0){if(logged_once[JSON.stringify(h)])return;logged_once[JSON.stringify(h)]=!0}var g=methodForLevel(o);1<h.length?g.apply(void 0,["Tangram [".concat(o,"]: ").concat(h[0])].concat(_toConsumableArray(h.slice(1)))):g("Tangram [".concat(o,"]: ").concat(h[0]))}}}function debounce(e,o,s){var h,d;return s=s||0,function(){var g=this,_=arguments;function j(){d=0,e.apply(g,_)}clearTimeout(h),d&&s&&Date.now()-d>=s?j():(d=d||Date.now(),h=setTimeout(function(){j()},o))}}log.level="info",log.workers=null,log.setLevel=function(e){log.level=e,Thread.is_main&&Array.isArray(log.workers)&&WorkerBroker.postMessage(log.workers,"_logSetLevelProxy",e)},Thread.is_main&&(log.setWorkers=function(e){log.workers=e},log.reset=function(){logged_once={}}),WorkerBroker.addTarget("_logProxy",log),WorkerBroker.addTarget("_logSetLevelProxy",log.setLevel);var Utils$1=Utils={};WorkerBroker.addTarget("Utils",Utils),Utils.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},Utils.isMicrosoft=function(){return/(Trident\/7.0|Edge[ /](\d+[\.\d]+))/i.test(navigator.userAgent)},Utils._requests={},Utils._proxy_requests={},Utils.io=function(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:6e4,s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"text",h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:"GET",d=4<arguments.length&&arguments[4]!==void 0?arguments[4]:{},g=5<arguments.length&&arguments[5]!==void 0?arguments[5]:null,_=6<arguments.length&&arguments[6]!==void 0&&arguments[6];if(Thread.is_worker&&Utils.isMicrosoft())return log("debug","Proxying request for URL to worker",e),g&&(Utils._proxy_requests[g]=!0),WorkerBroker.postMessage("Utils.io",e,o,s,h,d,g,!0);var j=new XMLHttpRequest,$=($=new Promise(function(_t,_e){j.open(h,e,!0),j.timeout=o,j.responseType=s,j.onload=function(){j.status===200?-1<["text","json"].indexOf(j.responseType)?_t(j.responseText):_t(j.response):_e(Error("Request error with a status of "+j.statusText))},j.onerror=function(_r){_e(Error("There was a network error"+_r.toString()))},j.ontimeout=function(_r){_e(Error("timeout "+_r.toString()))},j.send()})).then(function(_t){return g&&delete Utils._requests[g],_?WorkerBroker.withTransferables(_t):_t});return g&&(Utils._requests[g]=j),$},Utils.cancelRequest=function(e){if(Thread.is_worker&&Utils._proxy_requests[e])return WorkerBroker.postMessage("Utils.cancelRequest",e);Utils._requests[e]?(log("trace","Cancelling network request key '".concat(e,"'")),Utils._requests[e].abort(),delete Utils._requests[e]):log("trace","Could not find network request key '".concat(e,"'"))},Utils.requestAnimationFramePolyfill=function(){typeof window.requestAnimationFrame!="function"&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,16.666666666666668)})},Utils.serializeWithFunctions=function(e){return typeof e=="function"?e.toString():JSON.stringify(e,function(o,s){return typeof s=="function"?s.toString():s})},Utils.stringsToFunctions=function(e,o){if(typeof e=="string")e=Utils.stringToFunction(e,o);else if(e!=null&&_typeof(e)==="object")for(var s in e)e[s]=Utils.stringsToFunctions(e[s],o);return e},Utils._use_count=0,Utils._function_cache={};var _clear_function_cache=debounce(function(){log("trace","Cleared cached ".concat(Object.keys(Utils._function_cache).length," functions (reused ").concat(Utils._use_count," times)")),Utils._use_count=0,Utils._function_cache={}},1e4),FUNCTION_MATCH_RGX=/^\s*function[^(]*\(([^)]*)\)\s*?\{([\s\S]*)\}$/m,_createObjectURL,_revokeObjectURL;function addBaseURL(e,o){if(!e||!isRelativeURL(e))return e;var s,h=e[0]!=="/";return o?(s=document.createElement("a")).href=o:s=window.location,e=h?pathForURL(s.href)+e:(s.origin||s.protocol+"//"+s.host)+e}function pathForURL(e){if(typeof e!="string"||e.search(/^(data|blob):/)!==-1)return"";var o=e.indexOf("?");-1<o&&(e=e.substr(0,o));var s=e.indexOf("#");return-1<s&&(e=e.substr(0,s)),e.substr(0,e.lastIndexOf("/")+1)||""}function extensionForURL(e){var o=(e=e.split("/").pop()).lastIndexOf(".");if(-1<o)return e.substring(o+1)}function isRelativeURL(e){return typeof e=="string"&&!(-1<e.search(/^(http|https|data|blob):/)||e.substr(0,2)==="//")}function addParamsToURL(e,o){if(!o||Object.keys(o).length===0)return[e,[]];var s=e.indexOf("?"),h=e.indexOf("#"),d="";-1<h&&(d=e.slice(h),e=e.slice(0,h)),s===-1&&(s=e.length,e+="?"),s++;var g="",_=[];for(var j in o)getURLParameter(j,e)===""?g+="".concat(j,"=").concat(o[j],"&"):_.push([j,o[j]]);return[e=e.slice(0,s)+g+e.slice(s)+d,_]}function createObjectURL(e){return _createObjectURL===void 0&&typeof(_createObjectURL=window.URL&&window.URL.createObjectURL||window.webkitURL&&window.webkitURL.createObjectURL)!="function"&&(_createObjectURL=null,log("warn","window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs")),_createObjectURL?_createObjectURL(e):e}function revokeObjectURL(e){return _revokeObjectURL===void 0&&typeof(_revokeObjectURL=window.URL&&window.URL.revokeObjectURL||window.webkitURL&&window.webkitURL.revokeObjectURL)!="function"&&(_revokeObjectURL=null,log("warn","window.URL.revokeObjectURL (or vendor prefix) not found, unable to create local blob URLs")),_revokeObjectURL?_revokeObjectURL(e):e}function getURLParameter(e,o){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var s=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(o);return s===null?"":decodeURIComponent(s[1].replace(/\+/g," "))}Utils.stringToFunction=function(e,o){var s=e;o&&(s+=o.toString());var h=Utils._function_cache[s];if(_clear_function_cache(),h)return Utils._use_count++,h;var d=typeof e=="string"&&e.match(FUNCTION_MATCH_RGX);if(d&&2<d.length)try{var g=d[2],_=0<(_=0<d[1].length&&d[1].split(",").map(function($){return $.trim()}).filter(function($){return $})).length?_:["context"],j=new Function(_.toString(),typeof o=="function"?o(g):g);return Utils._function_cache[s]=j}catch{return e}return e},Utils.device_pixel_ratio=1,Utils.isPowerOf2=function(e){return(e&e-1)==0},Utils.interpolate=function(e,o,s){if(!Array.isArray(o)||!Array.isArray(o[0])||o.length<1)return o;var h,d,g,_,j;if(e<=o[0][0])_=o[0][1],typeof s=="function"&&(_=s(_));else if(e>=o[o.length-1][0])_=o[o.length-1][1],typeof s=="function"&&(_=s(_));else for(var $=0;$<o.length-1;$++)if(e>=o[$][0]&&e<o[$+1][0]){if(h=o[$][0],d=o[$+1][0],Array.isArray(o[$][1])){_=[];for(var _t=0;_t<o[$][1].length;_t++)typeof s=="function"?(j=s(o[$][1][_t]),g=s(o[$+1][1][_t])-j,_[_t]=g*(e-h)/(d-h)+j):(g=o[$+1][1][_t]-o[$][1][_t],_[_t]=g*(e-h)/(d-h)+o[$][1][_t])}else _=typeof s=="function"?(j=s(o[$][1]),(g=s(o[$+1][1])-j)*(e-h)/(d-h)+j):(g=o[$+1][1]-o[$][1])*(e-h)/(d-h)+o[$][1];break}return _},Utils.toCSSColor=function(e){return e[3]===1?"rgb(".concat(e.slice(0,3).map(function(o){return Math.round(255*o)}).join(", "),")"):"rgba(".concat(e.map(function(o,s){return s<3&&Math.round(255*o)||o}).join(", "),")")},Utils.pointInTile=function(e){return 0<=e[0]&&e[1]>-Geo$1.tile_scale&&e[0]<Geo$1.tile_scale&&e[1]<=0},Utils.zoomToTileLevel=function(e){return Math.floor(e)};var DataSource=function(){function e(o,s){var h=this;if(_classCallCheck(this,e),this.config=o,this.sources=s,this.id=o.id,this.name=o.name,this.pad_scale=o.pad_scale||1e-4,this.default_winding=null,this.rasters=[],Array.isArray(o.rasters)&&o.rasters.forEach(function(g){h.rasters.indexOf(g)===-1&&h.rasters.push(g)}),this.preprocess=o.preprocess,typeof this.preprocess=="function"&&this.preprocess.bind(this),this.transform=o.transform,typeof this.transform=="function")this.transform=this.transform.bind(this);else if(_typeof(this.transform)==="object")for(var d in this.transform)typeof this.transform[d]=="function"&&(this.transform[d]=this.transform[d].bind(this));this.extra_data=o.extra_data,this.scripts=o.scripts,this.max_zoom=o.max_zoom!=null?o.max_zoom:Geo$1.default_source_max_zoom,this.setTileSize(o.tile_size),this.max_coord_zoom=this.max_zoom+this.zoom_bias,this.min_display_zoom=o.min_display_zoom!=null?o.min_display_zoom:0,this.max_display_zoom=o.max_display_zoom!=null?o.max_display_zoom:null,this._has_volatile_data=!!o.has_volatile_data}return _createClass(e,[{key:"hasLabeledData",value:function(){return!0}},{key:"_transformTile",value:function(o){if(o.source_data.layers){var s={coords:o.coords},h=[];if(typeof this.transform=="function")h.push(this.transform);else if(_typeof(this.transform)==="object")for(var d=Object.keys(this.transform).sort(),g=0;g<d.length;g++)h.push(this.transform[d[g]]);for(var _=Object.keys(o.source_data.layers).length===1&&o.source_data.layers._default,j=0;j<h.length;j++)_?o.source_data.layers._default=h[j](o.source_data.layers._default,this.extra_data,s):o.source_data.layers=h[j](o.source_data.layers,this.extra_data,s)}}},{key:"_postProcessTile",value:function(o){var s=this;for(var h in this._transformTile(o),o.source_data.layers){var d=o.source_data.layers[h];d&&d.features&&d.features.forEach(function(g){Geo$1.transformGeometry(g.geometry,function(_){_[1]=-_[1],s.pad_scale&&(_[0]=Math.round(_[0]*(1+s.pad_scale)-Geo$1.tile_scale*s.pad_scale/2),_[1]=Math.round(_[1]*(1+s.pad_scale)-Geo$1.tile_scale*s.pad_scale/2))}),s.updateDefaultWinding(g.geometry)})}o.default_winding=this.default_winding||"CCW"}},{key:"load",value:function(o){return o.source_data={},o.source_data.layers={},o.pad_scale=this.pad_scale,o.rasters=_toConsumableArray(this.rasters),this._load(o)}},{key:"_load",value:function(){throw new MethodNotImplemented("_load")}},{key:"setTileSize",value:function(o){this.tile_size=o||256,(typeof this.tile_size!="number"||this.tile_size<256||!Utils$1.isPowerOf2(this.tile_size))&&(log({level:"warn",once:!0},"Data source '".concat(this.name,"': 'tile_size' parameter must be a number that is a power of 2 greater than or equal to 256, but was '").concat(o,"'")),this.tile_size=256),this.zoom_bias=Math.log2(this.tile_size)-8}},{key:"updateDefaultWinding",value:function(o){return this.default_winding==null&&(o.type==="Polygon"?this.default_winding=Geo$1.ringWinding(o.coordinates[0]):o.type==="MultiPolygon"&&(this.default_winding=Geo$1.ringWinding(o.coordinates[0][0]))),this.default_winding}},{key:"includesTile",value:function(o,s){if(o.z<this.min_display_zoom||this.max_display_zoom!=null&&s>this.max_display_zoom)return!1;for(var h=0;h<this.rasters.length;h++){var d=this.rasters[h];if(this.sources[d]&&this.sources[d]!==this&&!this.sources[d].includesTile(o,o.z))return!1}return!0}},{key:"has_volatile_data",get:function(){return this._has_volatile_data},set:function(o){var s=0<arguments.length&&o!==void 0&&o;this._has_volatile_data=s}}],[{key:"create",value:function(o,s){for(var h in s)if(s[h].config.name===o.name&&e.sameConfig(s[h],{config:o}))return s[h];if(e.types[o.type])return new e.types[o.type](o,s)}},{key:"sameConfig",value:function(o,s){if(!o||!s)return!1;var h=Object.assign({},o.config,{id:null,tiled:null,url:null}),d=Object.assign({},s.config,{id:null,tiled:null,url:null});return JSON.stringify(h)===JSON.stringify(d)}},{key:"coordsToMeters",value:function(o){var s=_slicedToArray(Geo$1.latLngToMeters(o),2),h=s[0],d=s[1];o[0]=h,o[1]=d}},{key:"projectData",value:function(o){for(var s in o.layers)for(var h=o.layers[s].features.length,d=0;d<h;d++){var g=o.layers[s].features[d];Geo$1.transformGeometry(g.geometry,e.coordsToMeters)}}},{key:"metersToTileUnits",value:function(o,s,h){h[0]=Math.round((h[0]-s.x)*o),h[1]=-1*Math.round((h[1]-s.y)*o)}},{key:"scaleData",value:function(o,s){var h=s.coords.z,d=s.min,g=(s.max,e.metersToTileUnits.bind(this,Geo$1.unitsPerMeter(h),d));for(var _ in o.layers)for(var j=o.layers[_].features.length,$=0;$<j;$++){var _t=o.layers[_].features[$];Geo$1.transformGeometry(_t.geometry,g)}}},{key:"register",value:function(o,s){o&&s&&(e.types[s]=o)}}]),e}();DataSource.types={};var network_request_id=0,NetworkSource=function(){_inherits(o,DataSource);var e=_createSuper(o);function o(s,h){var d;_classCallCheck(this,o),(d=e.call(this,s,h)).response_type="";var g=_slicedToArray(addParamsToURL(s.url,s.url_params),2),_=g[0],j=g[1];if(d.url=_,j.forEach(function($){var _t=_slicedToArray($,2),_e=_t[0],_r=_t[1];log({level:"warn",once:!0},"Data source '".concat(d.name,"': parameter '").concat(_e,"' already present in URL '").concat(s.url,"', ")+"skipping value '".concat(_e,"=").concat(_r,"' specified in 'url_params'"))}),typeof d.url!="string")throw Error("Network data source must provide a string `url` property");return d}return _createClass(o,[{key:"_load",value:function(s){var h=this,d=this.formatUrl(this.url,s),g=s.source_data;return g.url=d,new Promise(function(_,j){g.error=null;var $=network_request_id+++"-"+d,_t=Utils$1.io(d,6e4,h.response_type,"GET",{},$);g.request_id=$,_t.then(function(_e){typeof h.preprocess=="function"&&(_e=h.preprocess(_e)),(_e=_e instanceof Promise?_e:Promise.resolve(_e)).then(function(_r){h.parseSourceData(s,g,_r),h._postProcessTile(s),_(s)})},function(_e){g.error=_e.stack,h._postProcessTile(s),_(s)})})}},{key:"formatUrl",value:function(){throw new MethodNotImplemented("formatUrl")}},{key:"parseSourceData",value:function(){throw new MethodNotImplemented("parseSourceData")}}]),o}(),NetworkTileSource=function(){_inherits(o,NetworkSource);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),(d=e.call(this,s,h)).tiled=!0,d.parseBounds(s),d.builds_geometry_tiles=!1,d.tms=s.tms===!0,-1<d.url.search("{s}")&&(Array.isArray(s.url_subdomains)&&0<s.url_subdomains.length?(d.url_subdomains=s.url_subdomains,d.next_url_subdomain=0):log({level:"warn",once:!0},"Data source '".concat(d.name,"': source URL includes '{s}' subdomain marker ('").concat(d.url,"'), but no subdomains ")+"were specified in 'url_subdomains' parameter")),d}return _createClass(o,[{key:"parseBounds",value:function(s){var h,d,g,_,j;Array.isArray(s.bounds)&&s.bounds.length===4&&(this.bounds=s.bounds,d=(h=_slicedToArray(this.bounds,4))[0],g=h[1],_=h[2],j=h[3],this.bounds_meters={min:Geo$1.latLngToMeters([d,j]),max:Geo$1.latLngToMeters([_,g])},this.bounds_tiles={min:{},max:{}})}},{key:"checkBounds",value:function(s){if(this.bounds){s=Geo$1.wrapTile(s,{x:!0});var h=(h=this.bounds_tiles.min[s.z])||(this.bounds_tiles.min[s.z]=Geo$1.tileForMeters(this.bounds_meters.min,s.z)),d=(d=this.bounds_tiles.max[s.z])||(this.bounds_tiles.max[s.z]=Geo$1.tileForMeters(this.bounds_meters.max,s.z));if(s.x<h.x||s.x>d.x||s.y<h.y||s.y>d.y)return!1}return!0}},{key:"includesTile",value:function(s,h){return!!_get(_getPrototypeOf(o.prototype),"includesTile",this).call(this,s,h)&&!!this.checkBounds(s)}},{key:"formatUrl",value:function(s,h){var d=Geo$1.wrapTile(h.coords,{x:!0});this.tms&&(d.y=Math.pow(2,d.z)-1-d.y);var g=s.replace("{x}",d.x).replace("{y}",d.y).replace("{z}",d.z);return this.url_subdomains!=null&&(g=g.replace("{s}",this.url_subdomains[this.next_url_subdomain]),this.next_url_subdomain=(this.next_url_subdomain+1)%this.url_subdomains.length),g}},{key:"urlHasTilePattern",value:function(s){return s&&-1<s.search("{x}")&&-1<s.search("{y}")&&-1<s.search("{z}")}}]),o}(),MapsJsSource=function(){_inherits(o,DataSource);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),(d=e.call(this,s,h)).target_name="MapsJsSource"+s.uid,d.tiled=!!s.tiled,WorkerBroker.addTarget(d.target_name,_assertThisInitialized(d)),Thread.is_worker&&WorkerBroker.postMessage(d.target_name+".onWorkerInitialized"),Thread.is_main&&(d._workers_left=0),d}return _createClass(o,[{key:"initialize",value:function(s,h,d,g){this._main_initialized||(this.provider=s,this.worker=g,this._workers_left+=d,this._on_update=h,this._main_initialized=!0,this._onProviderUpdate=this._onProviderUpdate.bind(this),s.addEventListener("update",this._onProviderUpdate),this._isReady()&&this.onReady())}},{key:"onWorkerInitialized",value:function(){--this._workers_left,this._isReady()&&this.onReady()}},{key:"onReady",value:function(){}},{key:"_isReady",value:function(){return this._main_initialized&&!this._workers_left}},{key:"_onProviderUpdate",value:function(s){this._isReady()&&this.onProviderUpdate(s)}},{key:"onProviderUpdate",value:function(s){this.dispatchUpdate(void 0,s.data)}},{key:"dispatchUpdate",value:function(s,h){this._on_update(this.name,s,h)}},{key:"dispose",value:function(){WorkerBroker.removeTarget(this.target_name),this.provider.removeEventListener("update",this._onProviderUpdate)}}]),o}(),read=function(e,o,s,h,d){var g,_,j=8*d-h-1,$=(1<<j)-1,_t=$>>1,_e=-7,_r=s?d-1:0,_n=s?-1:1,_o=e[o+_r];for(_r+=_n,g=_o&(1<<-_e)-1,_o>>=-_e,_e+=j;0<_e;g=256*g+e[o+_r],_r+=_n,_e-=8);for(_=g&(1<<-_e)-1,g>>=-_e,_e+=h;0<_e;_=256*_+e[o+_r],_r+=_n,_e-=8);if(g===0)g=1-_t;else{if(g===$)return _?NaN:1/0*(_o?-1:1);_+=Math.pow(2,h),g-=_t}return(_o?-1:1)*_*Math.pow(2,g-h)},write=function(e,o,s,h,d,g){var _,j,$,_t=8*g-d-1,_e=(1<<_t)-1,_r=_e>>1,_n=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,_o=h?0:g-1,ga=h?1:-1,_l=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(j=isNaN(o)?1:0,_=_e):(_=Math.floor(Math.log(o)/Math.LN2),o*($=Math.pow(2,-_))<1&&(_--,$*=2),2<=(o+=1<=_+_r?_n/$:_n*Math.pow(2,1-_r))*$&&(_++,$/=2),_e<=_+_r?(j=0,_=_e):1<=_+_r?(j=(o*$-1)*Math.pow(2,d),_+=_r):(j=o*Math.pow(2,_r-1)*Math.pow(2,d),_=0));8<=d;e[s+_o]=255&j,_o+=ga,j/=256,d-=8);for(_=_<<d|j,_t+=d;0<_t;e[s+_o]=255&_,_o+=ga,_/=256,_t-=8);e[s+_o-ga]|=128*_l},ieee754={read,write},pbf=Pbf;function Pbf(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;var SHIFT_LEFT_32=4294967296,SHIFT_RIGHT_32=1/SHIFT_LEFT_32;function readVarintRemainder(e,o,s){var h=s.buf,d=h[s.pos++],g=(112&d)>>4;if(d<128||(g|=(127&(d=h[s.pos++]))<<3,d<128)||(g|=(127&(d=h[s.pos++]))<<10,d<128)||(g|=(127&(d=h[s.pos++]))<<17,d<128)||(g|=(127&(d=h[s.pos++]))<<24,d<128)||(g|=(1&(d=h[s.pos++]))<<31,d<128))return toNum(e,g,o);throw new Error("Expected varint not more than 10 bytes")}function readPackedEnd(e){return e.type===Pbf.Bytes?e.readVarint()+e.pos:e.pos+1}function toNum(e,o,s){return s?4294967296*o+(e>>>0):4294967296*(o>>>0)+(e>>>0)}function writeBigVarint(e,o){var s,h;if(0<=e?(s=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:h=h+1|(s=0)),18446744073709552e3<=e||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),writeBigVarintLow(s,h,o),writeBigVarintHigh(h,o)}function writeBigVarintLow(e,o,s){s.buf[s.pos++]=127&e|128,e>>>=7,s.buf[s.pos++]=127&e|128,e>>>=7,s.buf[s.pos++]=127&e|128,e>>>=7,s.buf[s.pos++]=127&e|128,e>>>=7,s.buf[s.pos]=127&e}function writeBigVarintHigh(e,o){var s=(7&e)<<4;o.buf[o.pos++]|=s|((e>>>=3)?128:0),e&&(o.buf[o.pos++]=127&e|((e>>>=7)?128:0),e&&(o.buf[o.pos++]=127&e|((e>>>=7)?128:0),e&&(o.buf[o.pos++]=127&e|((e>>>=7)?128:0),e&&(o.buf[o.pos++]=127&e|((e>>>=7)?128:0),e&&(o.buf[o.pos++]=127&e)))))}function makeRoomForExtraLength(e,o,s){var h=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.ceil(Math.log(o)/(7*Math.LN2));s.realloc(h);for(var d=s.pos-1;e<=d;d--)s.buf[d+h]=s.buf[d]}function writePackedVarint(e,o){for(var s=0;s<e.length;s++)o.writeVarint(e[s])}function writePackedSVarint(e,o){for(var s=0;s<e.length;s++)o.writeSVarint(e[s])}function writePackedFloat(e,o){for(var s=0;s<e.length;s++)o.writeFloat(e[s])}function writePackedDouble(e,o){for(var s=0;s<e.length;s++)o.writeDouble(e[s])}function writePackedBoolean(e,o){for(var s=0;s<e.length;s++)o.writeBoolean(e[s])}function writePackedFixed32(e,o){for(var s=0;s<e.length;s++)o.writeFixed32(e[s])}function writePackedSFixed32(e,o){for(var s=0;s<e.length;s++)o.writeSFixed32(e[s])}function writePackedFixed64(e,o){for(var s=0;s<e.length;s++)o.writeFixed64(e[s])}function writePackedSFixed64(e,o){for(var s=0;s<e.length;s++)o.writeSFixed64(e[s])}function readUInt32(e,o){return(e[o]|e[o+1]<<8|e[o+2]<<16)+16777216*e[o+3]}function writeInt32(e,o,s){e[s]=o,e[s+1]=o>>>8,e[s+2]=o>>>16,e[s+3]=o>>>24}function readInt32(e,o){return(e[o]|e[o+1]<<8|e[o+2]<<16)+(e[o+3]<<24)}function readUtf8(e,o,s){for(var h="",d=o;d<s;){var g,_,j,$=e[d],_t=null,_e=239<$?4:223<$?3:191<$?2:1;if(s<d+_e)break;_e===1?$<128&&(_t=$):_e===2?(192&(g=e[d+1]))==128&&(_t=(31&$)<<6|63&g)<=127&&(_t=null):_e===3?(g=e[d+1],_=e[d+2],(192&g)==128&&(192&_)==128&&((_t=(15&$)<<12|(63&g)<<6|63&_)<=2047||55296<=_t&&_t<=57343)&&(_t=null)):_e===4&&(g=e[d+1],_=e[d+2],j=e[d+3],(192&g)==128&&(192&_)==128&&(192&j)==128&&((_t=(15&$)<<18|(63&g)<<12|(63&_)<<6|63&j)<=65535||1114112<=_t)&&(_t=null)),_t===null?(_t=65533,_e=1):65535<_t&&(_t-=65536,h+=String.fromCharCode(_t>>>10&1023|55296),_t=56320|1023&_t),h+=String.fromCharCode(_t),d+=_e}return h}function writeUtf8(e,o,s){for(var h,d,g=0;g<o.length;g++){if(55295<(h=o.charCodeAt(g))&&h<57344){if(!d){56319<h||g+1===o.length?(e[s++]=239,e[s++]=191,e[s++]=189):d=h;continue}if(h<56320){e[s++]=239,e[s++]=191,e[s++]=189,d=h;continue}h=d-55296<<10|h-56320|65536,d=null}else d&&(e[s++]=239,e[s++]=191,e[s++]=189,d=null);h<128?e[s++]=h:(h<2048?e[s++]=h>>6|192:(h<65536?e[s++]=h>>12|224:(e[s++]=h>>18|240,e[s++]=h>>12&63|128),e[s++]=h>>6&63|128),e[s++]=63&h|128)}return s}Pbf.prototype={destroy:function(){this.buf=null},readFields:function(e,o,s){for(s=s||this.length;this.pos<s;){var h=this.readVarint(),d=h>>3,g=this.pos;this.type=7&h,e(d,o,this),this.pos===g&&this.skip(h)}return o},readMessage:function(e,o){return this.readFields(e,o,this.readVarint()+this.pos)},readFixed32:function(){var e=readUInt32(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=readInt32(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=readUInt32(this.buf,this.pos)+readUInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,e},readSFixed64:function(){var e=readUInt32(this.buf,this.pos)+readInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,e},readFloat:function(){var e=ieee754.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ieee754.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var o=this.buf,s=o[this.pos++],h=127&s;return s<128?h:(h|=(127&(s=o[this.pos++]))<<7,s<128?h:(h|=(127&(s=o[this.pos++]))<<14,s<128?h:(h|=(127&(s=o[this.pos++]))<<21,s<128?h:readVarintRemainder(h|=(15&(s=o[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,o=readUtf8(this.buf,this.pos,e);return this.pos=e,o},readBytes:function(){var e=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,e);return this.pos=e,o},readPackedVarint:function(e,o){var s=readPackedEnd(this);for(e=e||[];this.pos<s;)e.push(this.readVarint(o));return e},readPackedSVarint:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readBoolean());return e},readPackedFloat:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readFloat());return e},readPackedDouble:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readDouble());return e},readPackedFixed32:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readSFixed64());return e},skip:function(e){var o=7&e;if(o===Pbf.Varint)for(;127<this.buf[this.pos++];);else if(o===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Pbf.Fixed32)this.pos+=4;else{if(o!==Pbf.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(e,o){this.writeVarint(e<<3|o)},realloc:function(e){for(var o,s=this.length||16;s<this.pos+e;)s*=2;s!==this.length&&((o=new Uint8Array(s)).set(this.buf),this.buf=o,this.length=s)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeVarint:function(e){268435455<(e=+e||0)||e<0?writeBigVarint(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var o=this.pos;this.pos=writeUtf8(this.buf,e,this.pos);var s=this.pos-o;128<=s&&makeRoomForExtraLength(o,s,this),this.pos=o-1,this.writeVarint(s),this.pos+=s},writeFloat:function(e){this.realloc(4),ieee754.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ieee754.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var o=e.length;this.writeVarint(o),this.realloc(o);for(var s=0;s<o;s++)this.buf[this.pos++]=e[s]},writeRawMessage:function(e,o){this.pos++;var s=this.pos;e(o,this);var h=this.pos-s;128<=h&&makeRoomForExtraLength(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h},writeMessage:function(e,o,s){this.writeTag(e,Pbf.Bytes),this.writeRawMessage(o,s)},writePackedVarint:function(e,o){this.writeMessage(e,writePackedVarint,o)},writePackedSVarint:function(e,o){this.writeMessage(e,writePackedSVarint,o)},writePackedBoolean:function(e,o){this.writeMessage(e,writePackedBoolean,o)},writePackedFloat:function(e,o){this.writeMessage(e,writePackedFloat,o)},writePackedDouble:function(e,o){this.writeMessage(e,writePackedDouble,o)},writePackedFixed32:function(e,o){this.writeMessage(e,writePackedFixed32,o)},writePackedSFixed32:function(e,o){this.writeMessage(e,writePackedSFixed32,o)},writePackedFixed64:function(e,o){this.writeMessage(e,writePackedFixed64,o)},writePackedSFixed64:function(e,o){this.writeMessage(e,writePackedSFixed64,o)},writeBytesField:function(e,o){this.writeTag(e,Pbf.Bytes),this.writeBytes(o)},writeFixed32Field:function(e,o){this.writeTag(e,Pbf.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(e,o){this.writeTag(e,Pbf.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(e,o){this.writeTag(e,Pbf.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(e,o){this.writeTag(e,Pbf.Fixed64),this.writeSFixed64(o)},writeVarintField:function(e,o){this.writeTag(e,Pbf.Varint),this.writeVarint(o)},writeSVarintField:function(e,o){this.writeTag(e,Pbf.Varint),this.writeSVarint(o)},writeStringField:function(e,o){this.writeTag(e,Pbf.Bytes),this.writeString(o)},writeFloatField:function(e,o){this.writeTag(e,Pbf.Fixed32),this.writeFloat(o)},writeDoubleField:function(e,o){this.writeTag(e,Pbf.Fixed64),this.writeDouble(o)},writeBooleanField:function(e,o){this.writeVarintField(e,!!o)}};var pointGeometry=Point;function Point(e,o){this.x=e,this.y=o}Point.prototype={clone:function(){return new Point(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,o){return this.clone()._rotateAround(e,o)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var o=e.x-this.x,s=e.y-this.y;return o*o+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,o){return Math.atan2(this.x*o-this.y*e,this.x*e+this.y*o)},_matMult:function(e){var o=e[0]*this.x+e[1]*this.y,s=e[2]*this.x+e[3]*this.y;return this.x=o,this.y=s,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var o=Math.cos(e),s=Math.sin(e),h=o*this.x-s*this.y,d=s*this.x+o*this.y;return this.x=h,this.y=d,this},_rotateAround:function(e,o){var s=Math.cos(e),h=Math.sin(e),d=o.x+s*(this.x-o.x)-h*(this.y-o.y),g=o.y+h*(this.x-o.x)+s*(this.y-o.y);return this.x=d,this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Point.convert=function(e){return!(e instanceof Point)&&Array.isArray(e)?new Point(e[0],e[1]):e};var vectortilefeature=VectorTileFeature;function VectorTileFeature(e,o,s,h,d){this.properties={},this.extent=s,this.type=0,this._pbf=e,this._geometry=-1,this._keys=h,this._values=d,e.readFields(readFeature,this,o)}function readFeature(e,o,s){e==1?o.id=s.readVarint():e==2?readTag(s,o):e==3?o.type=s.readVarint():e==4&&(o._geometry=s.pos)}function readTag(e,o){for(var s=e.readVarint()+e.pos;e.pos<s;){var h=o._keys[e.readVarint()],d=o._values[e.readVarint()];o.properties[h]=d}}function classifyRings(e){var o=e.length;if(o<=1)return[e];for(var s,h,d=[],g=0;g<o;g++){var _=signedArea(e[g]);_!==0&&(h===void 0&&(h=_<0),h===_<0?(s&&d.push(s),s=[e[g]]):s.push(e[g]))}return s&&d.push(s),d}function signedArea(e){for(var o,s,h=0,d=0,g=e.length,_=g-1;d<g;_=d++)o=e[d],h+=((s=e[_]).x-o.x)*(o.y+s.y);return h}VectorTileFeature.types=["Unknown","Point","LineString","Polygon"],VectorTileFeature.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var o,s,h=e.readVarint()+e.pos,d=1,g=0,_=0,j=0,$=[];e.pos<h;)if(g||(d=7&(s=e.readVarint()),g=s>>3),g--,d===1||d===2)_+=e.readSVarint(),j+=e.readSVarint(),d===1&&(o&&$.push(o),o=[]),o.push(new pointGeometry(_,j));else{if(d!==7)throw new Error("unknown command "+d);o&&o.push(o[0].clone())}return o&&$.push(o),$},VectorTileFeature.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var o,s=e.readVarint()+e.pos,h=1,d=0,g=0,_=0,j=1/0,$=-1/0,_t=1/0,_e=-1/0;e.pos<s;)if(d||(h=7&(o=e.readVarint()),d=o>>3),d--,h===1||h===2)(g+=e.readSVarint())<j&&(j=g),$<g&&($=g),(_+=e.readSVarint())<_t&&(_t=_),_e<_&&(_e=_);else if(h!==7)throw new Error("unknown command "+h);return[j,_t,$,_e]},VectorTileFeature.prototype.toGeoJSON=function(e,o,s){var h,d=this.extent*Math.pow(2,s),g=this.extent*e,_=this.extent*o,j=this.loadGeometry(),$=VectorTileFeature.types[this.type];function _t(_o){for(var ga=0;ga<_o.length;ga++){var _l=_o[ga],_f=180-360*(_l.y+_)/d;_o[ga]=[360*(_l.x+g)/d-180,360/Math.PI*Math.atan(Math.exp(_f*Math.PI/180))-90]}}switch(this.type){case 1:for(var _e=[],_r=0;_r<j.length;_r++)_e[_r]=j[_r][0];_t(j=_e);break;case 2:for(_r=0;_r<j.length;_r++)_t(j[_r]);break;case 3:for(j=classifyRings(j),_r=0;_r<j.length;_r++)for(h=0;h<j[_r].length;h++)_t(j[_r][h])}j.length===1?j=j[0]:$="Multi"+$;var _n={type:"Feature",geometry:{type:$,coordinates:j},properties:this.properties};return"id"in this&&(_n.id=this.id),_n};var VectorTileFeature$1=vectortilefeature,long_1=Long,wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,o,s){this.low=0|e,this.high=0|o,this.unsigned=!!s}function isLong(e){return(e&&e.__isLong__)===!0}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(e,o){var s,h,d;return o?(d=0<=(e>>>=0)&&e<256)&&(h=UINT_CACHE[e])?h:(s=fromBits(e,(0|e)<0?-1:0,!0),d&&(UINT_CACHE[e]=s),s):(d=-128<=(e|=0)&&e<128)&&(h=INT_CACHE[e])?h:(s=fromBits(e,e<0?-1:0,!1),d&&(INT_CACHE[e]=s),s)}function fromNumber(e,o){if(isNaN(e))return o?UZERO:ZERO;if(o){if(e<0)return UZERO;if(TWO_PWR_64_DBL<=e)return MAX_UNSIGNED_VALUE}else{if(e<=-TWO_PWR_63_DBL)return MIN_VALUE;if(TWO_PWR_63_DBL<=e+1)return MAX_VALUE}return e<0?fromNumber(-e,o).neg():fromBits(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0,o)}function fromBits(e,o,s){return new Long(e,o,s)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(e,o,s){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return ZERO;if(o=typeof o=="number"?(s=o,!1):!!o,(s=s||10)<2||36<s)throw RangeError("radix");var h;if(0<(h=e.indexOf("-")))throw Error("interior hyphen");if(h===0)return fromString(e.substring(1),o,s).neg();for(var d=fromNumber(pow_dbl(s,8)),g=ZERO,_=0;_<e.length;_+=8){var j,$=Math.min(8,e.length-_),_t=parseInt(e.substring(_,_+$),s);g=$<8?(j=fromNumber(pow_dbl(s,$)),g.mul(j).add(fromNumber(_t))):(g=g.mul(d)).add(fromNumber(_t))}return g.unsigned=o,g}function fromValue(e,o){return typeof e=="number"?fromNumber(e,o):typeof e=="string"?fromString(e,o):fromBits(e.low,e.high,typeof o=="boolean"?o:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var o=fromNumber(e),s=this.div(o),h=s.mul(o).sub(this);return s.toString(e)+h.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var d=fromNumber(pow_dbl(e,6),this.unsigned),g=this,_="";;){var j=g.div(d),$=(g.sub(j.mul(d)).toInt()>>>0).toString(e);if((g=j).isZero())return $+_;for(;$.length<6;)$="0"+$;_=""+$+_}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,o=31;0<o&&!(e&1<<o);o--);return this.high!=0?o+33:o+1},LongPrototype.isZero=function(){return this.high===0&&this.low===0},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||0<=this.high},LongPrototype.isOdd=function(){return(1&this.low)==1},LongPrototype.isEven=function(){return(1&this.low)==0},LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(e){return!this.eq(e)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(e){return this.comp(e)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(e){return 0<this.comp(e)},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(e){return 0<=this.comp(e)},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var o=this.isNegative(),s=e.isNegative();return o&&!s?-1:!o&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var o=this.high>>>16,s=65535&this.high,h=this.low>>>16,d=65535&this.low,g=e.high>>>16,_=65535&e.high,j=e.low>>>16,$=0,_t=0,_e=0,_r=0;return _e+=(_r+=d+(65535&e.low))>>>16,_t+=(_e+=h+j)>>>16,$+=(_t+=s+_)>>>16,$+=o+g,fromBits((_e&=65535)<<16|(_r&=65535),($&=65535)<<16|(_t&=65535),this.unsigned)},LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(e){if(this.isZero())return ZERO;if(isLong(e)||(e=fromValue(e)),wasm)return fromBits(wasm.mul(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned);if(e.isZero())return ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var o=this.high>>>16,s=65535&this.high,h=this.low>>>16,d=65535&this.low,g=e.high>>>16,_=65535&e.high,j=e.low>>>16,$=65535&e.low,_t=0,_e=0,_r=0,_n=0;return _r+=(_n+=d*$)>>>16,_e+=(_r+=h*$)>>>16,_r&=65535,_e+=(_r+=d*j)>>>16,_t+=(_e+=s*$)>>>16,_e&=65535,_t+=(_e+=h*j)>>>16,_e&=65535,_t+=(_e+=d*_)>>>16,_t+=o*$+s*j+h*_+d*g,fromBits((_r&=65535)<<16|(_n&=65535),(_t&=65535)<<16|(_e&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");var o,s,h;if(wasm)return this.unsigned||this.high!==-2147483648||e.low!==-1||e.high!==-1?fromBits((this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?UZERO:ZERO;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;s=UZERO}else{if(this.eq(MIN_VALUE))return e.eq(ONE)||e.eq(NEG_ONE)?MIN_VALUE:e.eq(MIN_VALUE)?ONE:(h=this.shr(1).div(e).shl(1)).eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(o=this.sub(e.mul(h)),s=h.add(o.div(e)));if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=ZERO}for(o=this;o.gte(e);){h=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var d=Math.ceil(Math.log(h)/Math.LN2),g=d<=48?1:pow_dbl(2,d-48),_=fromNumber(h),j=_.mul(e);j.isNegative()||j.gt(o);)j=(_=fromNumber(h-=g,this.unsigned)).mul(e);_.isZero()&&(_=ONE),s=s.add(_),o=o.sub(j)}return s},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(e){return isLong(e)||(e=fromValue(e)),wasm?fromBits((this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(e){if(isLong(e)&&(e=e.toInt()),(e&=63)===0)return this;var o=this.high;return e<32?fromBits(this.low>>>e|o<<32-e,o>>>e,this.unsigned):fromBits(e===32?o:o>>>e-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var e=this.high,o=this.low;return[255&o,o>>>8&255,o>>>16&255,o>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},LongPrototype.toBytesBE=function(){var e=this.high,o=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,o>>>24,o>>>16&255,o>>>8&255,255&o]},Long.fromBytes=function(e,o,s){return s?Long.fromBytesLE(e,o):Long.fromBytesBE(e,o)},Long.fromBytesLE=function(e,o){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,o)},Long.fromBytesBE=function(e,o){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],o)};var aspromise=asPromise;function asPromise(e,o){for(var s=new Array(arguments.length-1),h=0,d=2,g=!0;d<arguments.length;)s[h++]=arguments[d++];return new Promise(function(_,j){s[h]=function($){if(g)if(g=!1,$)j($);else{for(var _t=new Array(arguments.length-1),_e=0;_e<_t.length;)_t[_e++]=arguments[_e];_.apply(null,_t)}};try{e.apply(o||null,s)}catch($){g&&(g=!1,j($))}})}var base64_1=createCommonjsModule(function(e,o){var s=o;s.length=function(j){var $=j.length;if(!$)return 0;for(var _t=0;1<--$%4&&j.charAt($)==="=";)++_t;return Math.ceil(3*j.length)/4-_t};for(var h=new Array(64),d=new Array(123),g=0;g<64;)d[h[g]=g<26?g+65:g<52?g+71:g<62?g-4:g-59|43]=g++;s.encode=function(j,$,_t){for(var _e,_r=null,_n=[],_o=0,ga=0;$<_t;){var _l=j[$++];switch(ga){case 0:_n[_o++]=h[_l>>2],_e=(3&_l)<<4,ga=1;break;case 1:_n[_o++]=h[_e|_l>>4],_e=(15&_l)<<2,ga=2;break;case 2:_n[_o++]=h[_e|_l>>6],_n[_o++]=h[63&_l],ga=0}8191<_o&&((_r=_r||[]).push(String.fromCharCode.apply(String,_n)),_o=0)}return ga&&(_n[_o++]=h[_e],_n[_o++]=61,ga===1&&(_n[_o++]=61)),_r?(_o&&_r.push(String.fromCharCode.apply(String,_n.slice(0,_o))),_r.join("")):String.fromCharCode.apply(String,_n.slice(0,_o))};var _="invalid encoding";s.decode=function(j,$,_t){for(var _e,_r=_t,_n=0,_o=0;_o<j.length;){var ga=j.charCodeAt(_o++);if(ga===61&&1<_n)break;if((ga=d[ga])===void 0)throw Error(_);switch(_n){case 0:_e=ga,_n=1;break;case 1:$[_t++]=_e<<2|(48&ga)>>4,_e=ga,_n=2;break;case 2:$[_t++]=(15&_e)<<4|(60&ga)>>2,_e=ga,_n=3;break;case 3:$[_t++]=(3&_e)<<6|ga,_n=0}}if(_n===1)throw Error(_);return _t-_r},s.test=function(j){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(j)}}),eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,o,s){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:o,ctx:s||this}),this},EventEmitter.prototype.off=function(e,o){if(e===void 0)this._listeners={};else if(o===void 0)this._listeners[e]=[];else for(var s=this._listeners[e],h=0;h<s.length;)s[h].fn===o?s.splice(h,1):++h;return this},EventEmitter.prototype.emit=function(e){var o=this._listeners[e];if(o){for(var s=[],h=1;h<arguments.length;)s.push(arguments[h++]);for(h=0;h<o.length;)o[h].fn.apply(o[h++].ctx,s)}return this};var float_1=factory(factory);function factory(e){function o(_g,ty,oy,ry){var ly,py=ty<0?1:0;py&&(ty=-ty),ty===0?_g(0<1/ty?0:2147483648,oy,ry):isNaN(ty)?_g(2143289344,oy,ry):_g(34028234663852886e22<ty?(py<<31|2139095040)>>>0:ty<11754943508222875e-54?(py<<31|Math.round(ty/1401298464324817e-60))>>>0:(py<<31|(ly=Math.floor(Math.log(ty)/Math.LN2))+127<<23|8388607&Math.round(ty*Math.pow(2,-ly)*8388608))>>>0,oy,ry)}function s(_g,ty,oy){var ry=_g(ty,oy),ly=2*(ry>>31)+1,py=ry>>>23&255,gy=8388607&ry;return py==255?gy?NaN:1/0*ly:py==0?1401298464324817e-60*ly*gy:ly*Math.pow(2,py-150)*(8388608+gy)}function h(_g,ty,oy){j[0]=_g,ty[oy]=$[0],ty[oy+1]=$[1],ty[oy+2]=$[2],ty[oy+3]=$[3]}function d(_g,ty,oy){j[0]=_g,ty[oy]=$[3],ty[oy+1]=$[2],ty[oy+2]=$[1],ty[oy+3]=$[0]}function g(_g,ty){return $[0]=_g[ty],$[1]=_g[ty+1],$[2]=_g[ty+2],$[3]=_g[ty+3],j[0]}function _(_g,ty){return $[3]=_g[ty],$[2]=_g[ty+1],$[1]=_g[ty+2],$[0]=_g[ty+3],j[0]}var j,$,_t,_e,_r,_n;function _o(_g,ty,oy,ry,ly,py){var gy,by,wy=ry<0?1:0;wy&&(ry=-ry),ry===0?(_g(0,ly,py+ty),_g(0<1/ry?0:2147483648,ly,py+oy)):isNaN(ry)?(_g(0,ly,py+ty),_g(2146959360,ly,py+oy)):17976931348623157e292<ry?(_g(0,ly,py+ty),_g((wy<<31|2146435072)>>>0,ly,py+oy)):ry<22250738585072014e-324?(_g((gy=ry/5e-324)>>>0,ly,py+ty),_g((wy<<31|gy/4294967296)>>>0,ly,py+oy)):((by=Math.floor(Math.log(ry)/Math.LN2))===1024&&(by=1023),_g(4503599627370496*(gy=ry*Math.pow(2,-by))>>>0,ly,py+ty),_g((wy<<31|by+1023<<20|1048576*gy&1048575)>>>0,ly,py+oy))}function ga(_g,ty,oy,ry,ly){var py=_g(ry,ly+ty),gy=_g(ry,ly+oy),by=2*(gy>>31)+1,wy=gy>>>20&2047,Cy=4294967296*(1048575&gy)+py;return wy==2047?Cy?NaN:1/0*by:wy==0?5e-324*by*Cy:by*Math.pow(2,wy-1075)*(Cy+4503599627370496)}function _l(_g,ty,oy){_e[0]=_g,ty[oy]=_r[0],ty[oy+1]=_r[1],ty[oy+2]=_r[2],ty[oy+3]=_r[3],ty[oy+4]=_r[4],ty[oy+5]=_r[5],ty[oy+6]=_r[6],ty[oy+7]=_r[7]}function _f(_g,ty,oy){_e[0]=_g,ty[oy]=_r[7],ty[oy+1]=_r[6],ty[oy+2]=_r[5],ty[oy+3]=_r[4],ty[oy+4]=_r[3],ty[oy+5]=_r[2],ty[oy+6]=_r[1],ty[oy+7]=_r[0]}function _c(_g,ty){return _r[0]=_g[ty],_r[1]=_g[ty+1],_r[2]=_g[ty+2],_r[3]=_g[ty+3],_r[4]=_g[ty+4],_r[5]=_g[ty+5],_r[6]=_g[ty+6],_r[7]=_g[ty+7],_e[0]}function _p(_g,ty){return _r[7]=_g[ty],_r[6]=_g[ty+1],_r[5]=_g[ty+2],_r[4]=_g[ty+3],_r[3]=_g[ty+4],_r[2]=_g[ty+5],_r[1]=_g[ty+6],_r[0]=_g[ty+7],_e[0]}return typeof Float32Array<"u"?(j=new Float32Array([-0]),$=new Uint8Array(j.buffer),_t=$[3]===128,e.writeFloatLE=_t?h:d,e.writeFloatBE=_t?d:h,e.readFloatLE=_t?g:_,e.readFloatBE=_t?_:g):(e.writeFloatLE=o.bind(null,writeUintLE),e.writeFloatBE=o.bind(null,writeUintBE),e.readFloatLE=s.bind(null,readUintLE),e.readFloatBE=s.bind(null,readUintBE)),typeof Float64Array<"u"?(_e=new Float64Array([-0]),_r=new Uint8Array(_e.buffer),_n=_r[7]===128,e.writeDoubleLE=_n?_l:_f,e.writeDoubleBE=_n?_f:_l,e.readDoubleLE=_n?_c:_p,e.readDoubleBE=_n?_p:_c):(e.writeDoubleLE=_o.bind(null,writeUintLE,0,4),e.writeDoubleBE=_o.bind(null,writeUintBE,4,0),e.readDoubleLE=ga.bind(null,readUintLE,0,4),e.readDoubleBE=ga.bind(null,readUintBE,4,0)),e}function writeUintLE(e,o,s){o[s]=255&e,o[s+1]=e>>>8&255,o[s+2]=e>>>16&255,o[s+3]=e>>>24}function writeUintBE(e,o,s){o[s]=e>>>24,o[s+1]=e>>>16&255,o[s+2]=e>>>8&255,o[s+3]=255&e}function readUintLE(e,o){return(e[o]|e[o+1]<<8|e[o+2]<<16|e[o+3]<<24)>>>0}function readUintBE(e,o){return(e[o]<<24|e[o+1]<<16|e[o+2]<<8|e[o+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8_1=createCommonjsModule(function(e,o){var s=o;s.length=function(h){for(var d=0,g=0,_=0;_<h.length;++_)(g=h.charCodeAt(_))<128?d+=1:g<2048?d+=2:(64512&g)==55296&&(64512&h.charCodeAt(_+1))==56320?(++_,d+=4):d+=3;return d},s.read=function(h,d,g){if(g-d<1)return"";for(var _,j=null,$=[],_t=0;d<g;)(_=h[d++])<128?$[_t++]=_:191<_&&_<224?$[_t++]=(31&_)<<6|63&h[d++]:239<_&&_<365?(_=((7&_)<<18|(63&h[d++])<<12|(63&h[d++])<<6|63&h[d++])-65536,$[_t++]=55296+(_>>10),$[_t++]=56320+(1023&_)):$[_t++]=(15&_)<<12|(63&h[d++])<<6|63&h[d++],8191<_t&&((j=j||[]).push(String.fromCharCode.apply(String,$)),_t=0);return j?(_t&&j.push(String.fromCharCode.apply(String,$.slice(0,_t))),j.join("")):String.fromCharCode.apply(String,$.slice(0,_t))},s.write=function(h,d,g){for(var _,j,$=g,_t=0;_t<h.length;++_t)(_=h.charCodeAt(_t))<128?d[g++]=_:(_<2048?d[g++]=_>>6|192:((64512&_)==55296&&(64512&(j=h.charCodeAt(_t+1)))==56320?(_=65536+((1023&_)<<10)+(1023&j),++_t,d[g++]=_>>18|240,d[g++]=_>>12&63|128):d[g++]=_>>12|224,d[g++]=_>>6&63|128),d[g++]=63&_|128);return g-$}}),pool_1=pool;function pool(e,o,s){var h=s||8192,d=h>>>1,g=null,_=h;return function(j){if(j<1||d<j)return e(j);h<_+j&&(g=e(h),_=0);var $=o.call(g,_,_+=j);return 7&_&&(_=1+(7|_)),$}}var longbits=LongBits;function LongBits(e,o){this.lo=e>>>0,this.hi=o>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(e){if(e===0)return zero;var o=e<0;o&&(e=-e);var s=e>>>0,h=(e-s)/4294967296>>>0;return o&&(h=~h>>>0,s=~s>>>0,4294967295<++s&&(s=0,4294967295<++h&&(h=0))),new LongBits(s,h)},LongBits.from=function(e){if(typeof e=="number")return LongBits.fromNumber(e);if(minimal.isString(e)){if(!minimal.Long)return LongBits.fromNumber(parseInt(e,10));e=minimal.Long.fromString(e)}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):zero},LongBits.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var o=1+~this.lo>>>0,s=~this.hi>>>0;return o||(s=s+1>>>0),-(o+4294967296*s)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(e){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(e){return e===zeroHash?zero:new LongBits((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits.prototype.length=function(){var e=this.lo,o=(this.lo>>>28|this.hi<<4)>>>0,s=this.hi>>>24;return s==0?o==0?e<16384?e<128?1:2:e<2097152?3:4:o<16384?o<128?5:6:o<2097152?7:8:s<128?9:10};var minimal=createCommonjsModule(function(e,o){var s=o;function h(g,_,j){for(var $=Object.keys(_),_t=0;_t<$.length;++_t)g[$[_t]]!==void 0&&j||(g[$[_t]]=_[$[_t]]);return g}function d(g){function _(j,$){if(!(this instanceof _))return new _(j,$);Object.defineProperty(this,"message",{get:function(){return j}}),Error.captureStackTrace?Error.captureStackTrace(this,_):Object.defineProperty(this,"stack",{value:new Error().stack||""}),$&&h(this,$)}return(_.prototype=Object.create(Error.prototype)).constructor=_,Object.defineProperty(_.prototype,"name",{get:function(){return g}}),_.prototype.toString=function(){return this.name+": "+this.message},_}s.asPromise=aspromise,s.base64=base64_1,s.EventEmitter=eventemitter,s.float=float_1,s.inquire=inquire_1,s.utf8=utf8_1,s.pool=pool_1,s.LongBits=longbits,s.isNode=!!(commonjsGlobal!==void 0&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),s.global=s.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,s.emptyArray=Object.freeze?Object.freeze([]):[],s.emptyObject=Object.freeze?Object.freeze({}):{},s.isInteger=Number.isInteger||function(g){return typeof g=="number"&&isFinite(g)&&Math.floor(g)===g},s.isString=function(g){return typeof g=="string"||g instanceof String},s.isObject=function(g){return g&&typeof g=="object"},s.isset=s.isSet=function(g,_){var j=g[_];return!(j==null||!g.hasOwnProperty(_))&&(typeof j!="object"||0<(Array.isArray(j)?j.length:Object.keys(j).length))},s.Buffer=function(){try{var g=s.inquire("buffer").Buffer;return g.prototype.utf8Write?g:null}catch{return null}}(),s._Buffer_from=null,s._Buffer_allocUnsafe=null,s.newBuffer=function(g){return typeof g=="number"?s.Buffer?s._Buffer_allocUnsafe(g):new s.Array(g):s.Buffer?s._Buffer_from(g):typeof Uint8Array>"u"?g:new Uint8Array(g)},s.Array=typeof Uint8Array<"u"?Uint8Array:Array,s.Long=s.global.dcodeIO&&s.global.dcodeIO.Long||s.global.Long||s.inquire("long"),s.key2Re=/^true|false|0|1$/,s.key32Re=/^-?(?:0|[1-9][0-9]*)$/,s.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,s.longToHash=function(g){return g?s.LongBits.from(g).toHash():s.LongBits.zeroHash},s.longFromHash=function(g,_){var j=s.LongBits.fromHash(g);return s.Long?s.Long.fromBits(j.lo,j.hi,_):j.toNumber(!!_)},s.merge=h,s.lcFirst=function(g){return g.charAt(0).toLowerCase()+g.substring(1)},s.newError=d,s.ProtocolError=d("ProtocolError"),s.oneOfGetter=function(g){for(var _={},j=0;j<g.length;++j)_[g[j]]=1;return function(){for(var $=Object.keys(this),_t=$.length-1;-1<_t;--_t)if(_[$[_t]]===1&&this[$[_t]]!==void 0&&this[$[_t]]!==null)return $[_t]}},s.oneOfSetter=function(g){return function(_){for(var j=0;j<g.length;++j)g[j]!==_&&delete this[g[j]]}},s.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},s._configure=function(){var g=s.Buffer;g?(s._Buffer_from=g.from!==Uint8Array.from&&g.from||function(_,j){return new g(_,j)},s._Buffer_allocUnsafe=g.allocUnsafe||function(_){return new g(_)}):s._Buffer_from=s._Buffer_allocUnsafe=null}}),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(e,o,s){this.fn=e,this.len=o,this.next=void 0,this.val=s}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create=function(){return minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer}};function writeByte(e,o,s){o[s]=255&e}function writeVarint32(e,o,s){for(;127<e;)o[s++]=127&e|128,e>>>=7;o[s]=e}function VarintOp(e,o){this.len=e,this.next=void 0,this.val=o}function writeVarint64(e,o,s){for(;e.hi;)o[s++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)o[s++]=127&e.lo|128,e.lo=e.lo>>>7;o[s++]=e.lo}function writeFixed32(e,o,s){o[s]=255&e,o[s+1]=e>>>8&255,o[s+2]=e>>>16&255,o[s+3]=e>>>24}Writer.create=create(),Writer.alloc=function(e){return new minimal.Array(e)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(e,o,s){return this.tail=this.tail.next=new Op(e,o,s),this.len+=o,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function(e){var o=LongBits$1.from(e);return this._push(writeVarint64,o.length(),o)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(e){var o=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,o.length(),o)},Writer.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(e){var o=LongBits$1.from(e);return this._push(writeFixed32,4,o.lo)._push(writeFixed32,4,o.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(e){return this._push(minimal.float.writeFloatLE,4,e)},Writer.prototype.double=function(e){return this._push(minimal.float.writeDoubleLE,8,e)};var writeBytes=minimal.Array.prototype.set?function(e,o,s){o.set(e,s)}:function(e,o,s){for(var h=0;h<e.length;++h)o[s+h]=e[h]};Writer.prototype.bytes=function(e){var o,s=e.length>>>0;return s?(minimal.isString(e)&&(o=Writer.alloc(s=base64.length(e)),base64.decode(e,o,0),e=o),this.uint32(s)._push(writeBytes,s,e)):this._push(writeByte,1,0)},Writer.prototype.string=function(e){var o=utf8.length(e);return o?this.uint32(o)._push(utf8.write,o,e):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var e=this.head,o=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=e.next,this.tail=o,this.len+=s),this},Writer.prototype.finish=function(){for(var e=this.head.next,o=this.constructor.alloc(this.len),s=0;e;)e.fn(e.val,o,s),s+=e.len,e=e.next;return o},Writer._configure=function(e){BufferWriter=e,Writer.create=create(),BufferWriter._configure()};var writer_buffer=BufferWriter$1;function BufferWriter$1(){writer.call(this)}function writeStringBuffer(e,o,s){e.length<40?minimal.utf8.write(e,o,s):o.utf8Write?o.utf8Write(e,s):o.write(e,s)}(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1,BufferWriter$1._configure=function(){BufferWriter$1.alloc=minimal._Buffer_allocUnsafe,BufferWriter$1.writeBytesBuffer=minimal.Buffer&&minimal.Buffer.prototype instanceof Uint8Array&&minimal.Buffer.prototype.set.name==="set"?function(e,o,s){o.set(e,s)}:function(e,o,s){if(e.copy)e.copy(o,s,0,e.length);else for(var h=0;h<e.length;)o[s++]=e[h++]}},BufferWriter$1.prototype.bytes=function(e){minimal.isString(e)&&(e=minimal._Buffer_from(e,"base64"));var o=e.length>>>0;return this.uint32(o),o&&this._push(BufferWriter$1.writeBytesBuffer,o,e),this},BufferWriter$1.prototype.string=function(e){var o=minimal.Buffer.byteLength(e);return this.uint32(o),o&&this._push(writeStringBuffer,o,e),this},BufferWriter$1._configure();var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(e,o){return RangeError("index out of range: "+e.pos+" + "+(o||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var create_array=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},create$1=function(){return minimal.Buffer?function(e){return(Reader.create=function(o){return minimal.Buffer.isBuffer(o)?new BufferReader(o):create_array(o)})(e)}:create_array},fU;function readLongVarint(){var e=new LongBits$2(0,0),o=0;if(!(4<this.len-this.pos)){for(;o<3;++o){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*o)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*o)>>>0,e}for(;o<4;++o)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*o)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(o=0,4<this.len-this.pos){for(;o<5;++o)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*o+3)>>>0,this.buf[this.pos++]<128)return e}else for(;o<5;++o){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*o+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,o){return(e[o-4]|e[o-3]<<8|e[o-2]<<16|e[o-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=create$1(),Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(fU=4294967295,function(){if(fU=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(fU=(fU|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(fU=(fU|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(fU=(fU|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(fU=(fU|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return fU;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return fU}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function(){return this.uint32()!==0},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function(){var e=this.uint32(),o=this.pos,s=this.pos+e;if(s>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(o,s):o===s?new this.buf.constructor(0):this._slice.call(this.buf,o,s)},Reader.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=7&this.uint32())!=4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){BufferReader=e,Reader.create=create$1(),BufferReader._configure();var o=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[o](!1)},uint64:function(){return readLongVarint.call(this)[o](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[o](!1)},fixed64:function(){return readFixed64.call(this)[o](!0)},sfixed64:function(){return readFixed64.call(this)[o](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(e){reader.call(this,e)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,BufferReader$1._configure=function(){minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice)},BufferReader$1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader$1._configure();var service=Service;function Service(e,o,s){if(typeof e!="function")throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!o,this.responseDelimited=!!s}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(o,s,h,d,g){if(!d)throw TypeError("request must be specified");var _=this;if(!g)return minimal.asPromise(e,_,o,s,h,d);if(_.rpcImpl)try{return _.rpcImpl(o,s[_.requestDelimited?"encodeDelimited":"encode"](d).finish(),function(j,$){if(j)return _.emit("error",j,o),g(j);if($!==null){if(!($ instanceof h))try{$=h[_.responseDelimited?"decodeDelimited":"decode"]($)}catch(_t){return _.emit("error",_t,o),g(_t)}return _.emit("data",$,o),g(null,$)}_.end(!0)})}catch(j){return _.emit("error",j,o),void setTimeout(function(){g(j)},0)}else setTimeout(function(){g(Error("already ended"))},0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=createCommonjsModule(function(e,o){o.Service=service}),roots={},indexMinimal=createCommonjsModule(function(e,o){var s=o;function h(){s.util._configure(),s.Writer._configure(s.BufferWriter),s.Reader._configure(s.BufferReader)}s.build="minimal",s.Writer=writer,s.BufferWriter=writer_buffer,s.Reader=reader,s.BufferReader=reader_buffer,s.util=minimal,s.rpc=rpc_1,s.roots=roots,(s.configure=h)()}),minimal$1=indexMinimal;minimal$1.util.Long=long_1,minimal$1.configure(),VectorTileFeature$1.prototype.loadGeometry=function(e){var o=this._pbf;o.pos=this._geometry;for(var s,h,d=o.readVarint()+o.pos,g=1,_=0,j=0,$=0,_t=[];o.pos<d;)if(_<=0&&(g=7&(h=o.readVarint()),_=h>>3),_--,g===1||g===2)j+=o.readSVarint(),$+=o.readSVarint(),g===1&&(s&&_t.push(s),s=[]),s.push([j*e,$*e]);else{if(g!==7)throw new Error("unknown command "+g);s&&s.push(s[0].slice())}return s&&_t.push(s),_t};var MAX_SAFE_INTEGER=long_1.fromNumber(Number.MAX_SAFE_INTEGER,!0),MIN_SAFE_INTEGER=long_1.fromNumber(Number.MIN_SAFE_INTEGER,!1);function readLong(e,o,s){o.pos=e.pos;var h=s.call(o);return e.pos=o.pos,long_1.isLong(h)?0<h.comp(MAX_SAFE_INTEGER)||h.comp(MIN_SAFE_INTEGER)<0?h.toString():h.toNumber():h}var VectorTileLayer=function(){function e(o,s){_classCallCheck(this,e),this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],this._protobufjsReader=minimal$1.Reader.create(o.buf),o.readFields(readLayer,this,s),this.length=this._features.length}return _createClass(e,[{key:"feature",value:function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var s=this._pbf.readVarint()+this._pbf.pos;return new VectorTileFeature$1(this._pbf,s,this.extent,this._keys,this._values)}}]),e}();function readLayer(e,o,s){e===15?o.version=s.readVarint():e===1?o.name=s.readString():e===5?o.extent=s.readVarint():e===2?o._features.push(s.pos):e===3?o._keys.push(s.readString()):e===4&&o._values.push(readValueMessage(s,o._protobufjsReader))}function readValueMessage(e,o){for(var d=null,s=e.readVarint()+e.pos;e.pos<s;)var h=e.readVarint()>>3,d=h==1?e.readString():h==2?e.readFloat():h==3?e.readDouble():h==4?readLong(e,o,o.int64):h==5?readLong(e,o,o.uint64):h==6?readLong(e,o,o.sint64):h==7?e.readBoolean():null;return d}var VectorTile=function e(o,s){_classCallCheck(this,e),this.layers=o.readFields(readTile,{},s)};function readTile(e,o,s){var h;e!==3||(h=new VectorTileLayer(s,s.readVarint()+s.pos)).length&&(o[h.name]=h)}function getLayersFromMVT(e){var o={};for(var s in e.layers){for(var h=e.layers[s],d=[],g=Geo$1.tile_scale/h.extent,_=0,j=h.length;_<j;_++){var $=h.feature(_),_t=VectorTileFeature$1.types[$.type],_e=$.loadGeometry(g),_r=null;switch(_t){case"Point":_r=decodePoint({coordinates:_e});break;case"LineString":_r=_e.length===1?{type:_t,coordinates:_e[0]}:{type:"MultiLineString",coordinates:_e};break;case"Polygon":_r=decodeMultiPolygon({coordinates:_e})}_r&&_r.coordinates&&d.push({type:"Feature",geometry:_r,properties:$.properties})}o[s]={type:"FeatureCollection",features:d}}return o}var GeomType={UNKNOWN:0,POINT:1,LINESTRING:2,POLYGON:3};function parseGeoJSONVectorTile(e){var o=[],s=e&&e.features;if(s)for(var h=0,d=s.length;h<d;h++){var g=s[h],_=g.type,j=void 0;switch(_){case GeomType.POINT:j={type:"MultiPoint",coordinates:g.geometry.map(function($){return $.slice()})};break;case GeomType.LINESTRING:case GeomType.POLYGON:if(j={type:"MultiLineString",coordinates:g.geometry.map(function($){return $.map(function(_t){return _t.slice()})})},_===GeomType.POLYGON&&(j=decodeMultiPolygon(j))==null)continue;break;default:continue}o.push({id:g.id,type:"Feature",geometry:j,properties:g.tags})}return{type:"FeatureCollection",features:o}}function decodeMultiPolygon(e){for(var o,s=[],h=[],d=0,g=e.coordinates.length;d<g;d++){var _=e.coordinates[d],j=Geo$1.ringWinding(_);j!=null&&(j===(o=o||j)&&h.length&&(s.push(h),h=[]),h.push(_))}return 0<h.length&&s.push(h),s.length===1?(e.type="Polygon",e.coordinates=s[0]):1<s.length?(e.type="MultiPolygon",e.coordinates=s):e=null,e}function decodePoint(e){var o=e.coordinates.length;if(1<o){e.type="MultiPoint";for(var s=[],h=0;h<o;h++)s.push(e.coordinates[h][0]);e.coordinates=s}else e.type="Point",e.coordinates=e.coordinates[0][0];return e}var EMPTY_FEATURE_COLLECTION={type:"FeatureCollection",features:[]},MVTSource=function(){_inherits(o,MapsJsSource);var e=_createSuper(o);function o(s,h){return _classCallCheck(this,o),s.tiled=!0,e.call(this,s,h)}return _createClass(o,[{key:"fetchTile",value:function(s,h,d){return this.provider?this.provider.requestTileAsPromise(s,h,d).then(function(g){return g.data}):Promise.resolve()}},{key:"_load",value:function(s){var h=this,d=Geo$1.wrapTile(s.coords,{x:!0,y:!0}),g=d.x,_=d.y,j=d.z;return WorkerBroker.postMessage(this.target_name+".fetchTile",g,_,j).then(function($){var _t;return $ instanceof ArrayBuffer?(_t=new pbf(new Uint8Array($)),s.source_data.layers=getLayersFromMVT(new VectorTile(_t))):$?s.source_data.error=$:s.source_data.layers={_default:EMPTY_FEATURE_COLLECTION},h._postProcessTile(s),s})}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),o}();DataSource.register(MVTSource,"MVT"),DataSource.register(MVTSource,"OMV");var csscolorparser=createCommonjsModule(function(e,o){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function h($){return($=Math.round($))<0?0:255<$?255:$}function d($){return $<0?0:1<$?1:$}function g($){return $[$.length-1]==="%"?h(parseFloat($)/100*255):h(parseInt($))}function _($){return $[$.length-1]==="%"?d(parseFloat($)/100):d(parseFloat($))}function j($,_t,_e){return _e<0?_e+=1:1<_e&&--_e,6*_e<1?$+(_t-$)*_e*6:2*_e<1?_t:3*_e<2?$+(_t-$)*(2/3-_e)*6:$}try{o.parseCSSColor=function($){var _t,_e=$.replace(/ /g,"").toLowerCase();if(_e in s)return s[_e].slice();if(_e[0]==="#")return _e.length===4?0<=(_t=parseInt(_e.substr(1),16))&&_t<=4095?[(3840&_t)>>4|(3840&_t)>>8,240&_t|(240&_t)>>4,15&_t|(15&_t)<<4,1]:null:_e.length===7&&0<=(_t=parseInt(_e.substr(1),16))&&_t<=16777215?[(16711680&_t)>>16,(65280&_t)>>8,255&_t,1]:null;var _r=_e.indexOf("("),_n=_e.indexOf(")");if(_r!==-1&&_n+1===_e.length){var _o=_e.substr(0,_r),ga=_e.substr(_r+1,_n-(_r+1)).split(","),_l=1;switch(_o){case"rgba":if(ga.length!==4)return null;_l=_(ga.pop());case"rgb":return ga.length!==3?null:[g(ga[0]),g(ga[1]),g(ga[2]),_l];case"hsla":if(ga.length!==4)return null;_l=_(ga.pop());case"hsl":if(ga.length!==3)return null;var _f=(parseFloat(ga[0])%360+360)%360/360,_c=_(ga[1]),_p=_(ga[2]),_g=_p<=.5?_p*(_c+1):_p+_c-_p*_c,ty=2*_p-_g;return[h(255*j(ty,_g,_f+1/3)),h(255*j(ty,_g,_f)),h(255*j(ty,_g,_f-1/3)),_l];default:return null}}return null}}catch{}});csscolorparser.parseCSSColor;var StyleParser={},clampPositive=function(e){return Math.max(e,0)},noNaN=function(e){return isNaN(e)?0:e},parseNumber=function(e){return Array.isArray(e)?e.map(parseFloat).map(noNaN):noNaN(parseFloat(e))},parsePositiveNumber=function(e){return Array.isArray(e)?e.map(parseNumber).map(clampPositive):clampPositive(parseNumber(e))};Object.assign(StyleParser,{clampPositive,noNaN,parseNumber,parsePositiveNumber}),StyleParser.wrapFunction=function(e){return`
        var feature = context.feature.properties;
        var global = context.global;
        var $zoom = context.zoom;
        var $layer = context.layer;
        var $source = context.source;
        var sources = context.sources;
        var $geometry = context.geometry;
        var $meters_per_pixel = context.meters_per_pixel;

        var val = (function(){ `.concat(e,` }());

        if (typeof val === 'number' && isNaN(val)) {
            val = null; // convert NaNs to nulls
        }

        return val;
    `)},StyleParser.zeroPair=Object.freeze([0,0]),StyleParser.defaults={color:[1,1,1,1],width:1,size:1,extrude:!1,height:20,min_height:0,order:0,z:0,outline:{color:[0,0,0,0],width:0},material:{ambient:1,diffuse:1}},StyleParser.macros={"Style.color.pseudoRandomColor":function(){return[parseInt(feature.id,16)/100%1*.7,parseInt(feature.id,16)/1e4%1*.7,parseInt(feature.id,16)/1e6%1*.7,1]},"Style.color.randomColor":function(){return[.7*Math.random(),.7*Math.random(),.7*Math.random(),1]}},StyleParser.getFeatureParseContext=function(e,o,s,h){return{feature:e,tile:o,global:s,sources:h,zoom:o.style_zoom,geometry:Geo$1.geometryType(e.geometry.type),meters_per_pixel:o.meters_per_pixel,meters_per_pixel_sq:o.meters_per_pixel_sq,units_per_meter_overzoom:o.units_per_meter_overzoom}};var CACHE_TYPE={STATIC:0,DYNAMIC:1,ZOOM:2};StyleParser.CACHE_TYPE=CACHE_TYPE,StyleParser.createPropertyCache=function(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;if(e!=null){if(e.value)return{value:e.value,zoom:e.zoom?{}:null,type:e.type};var s={value:e,type:CACHE_TYPE.STATIC};return Array.isArray(s.value)&&Array.isArray(s.value[0])?(s.zoom={},s.type=CACHE_TYPE.ZOOM):typeof s.value=="function"&&(s.type=CACHE_TYPE.DYNAMIC),typeof o=="function"&&(s.zoom?s.value=s.value.map(function(h,d){return[h[0],o(h[1],d)]}):typeof s.value!="function"&&(s.value=o(s.value,0))),s}},StyleParser.createColorPropertyCache=function(e){return StyleParser.createPropertyCache(e,function(o){return o==="Style.color.pseudoRandomColor"?Utils$1.stringToFunction(StyleParser.wrapFunction(StyleParser.macros["Style.color.pseudoRandomColor"])):o==="Style.color.randomColor"?StyleParser.macros["Style.color.randomColor"]:o})};var isPercent=function(e){return typeof e=="string"&&e[e.length-1]==="%"},isRatio=function(e){return e==="auto"},isComputed=function(e){return isPercent(e)||isRatio(e)},dualRatioError="'size' can specify either width or height as derived from aspect ratio, but not both";StyleParser.createPointSizePropertyCache=function(e){var o=null,s=null;if(isPercent(e))o=[!0];else if(Array.isArray(e)){if(Array.isArray(e[0])){if(e.some(function(h){return Array.isArray(h[1])?h[1].some(function(d){return isComputed(d)}):isPercent(h[1])})&&(o=e.map(function(h){return Array.isArray(h[1])?h[1].map(function(d){return isPercent(d)}):isPercent(h[1])}),(s=e.map(function(h){return Array.isArray(h[1])&&h[1].map(function(d){return isRatio(d)})})).some(function(h){return Array.isArray(h)&&h.every(function(d){return d})})))throw dualRatioError}else if(e.some(isComputed)&&(o=[e.map(isPercent)],(s=[e.map(isRatio)])[0].every(function(h){return h})))throw dualRatioError}return o?((e={value:e}).has_pct=o,e.has_ratio=s,e.sprites={}):e=StyleParser.createPropertyCache(e,parsePositiveNumber),e},StyleParser.evalCachedPointSizeProperty=function(e,o,s){return e.has_pct||e.has_ratio?o?(e.sprites[o.sprite]||(e.sprites[o.sprite]=StyleParser.createPropertyCache(e.value,function(h,d){return Array.isArray(h)?(h=h.map(function(g,_){return e.has_ratio[d][_]?g:parsePositiveNumber(g)}).map(function(g,_){return e.has_pct[d][_]?o.css_size[_]*g/100:g}),e.has_ratio[d][0]?h[0]=h[1]*o.aspect:e.has_ratio[d][1]&&(h[1]=h[0]/o.aspect)):(h=parsePositiveNumber(h),h=e.has_pct[d]?o.css_size.map(function(g){return g*h/100}):[h,h]),h})),StyleParser.evalCachedProperty(e.sprites[o.sprite],s)):void 0:StyleParser.evalCachedProperty(e,s)},StyleParser.evalCachedProperty=function(e,o){if(e!=null)return e.dynamic?e.dynamic(o):e.static?e.static:e.zoom&&e.zoom[o.zoom]?e.zoom[o.zoom]:typeof e.value!="function"?Array.isArray(e.value)&&Array.isArray(e.value[0])?(e.zoom=e.zoom||{},e.zoom[o.zoom]=Utils$1.interpolate(o.zoom,e.value),e.zoom[o.zoom]):(e.static=e.value,e.static):(e.dynamic=e.value,e.dynamic(o))},StyleParser.convertUnits=function(e,o){if(e.val!=null)return e.units==="px"?e.val*Geo$1.metersPerPixel(o.zoom):e.val;if(typeof e=="string")e.trim().slice(-2)==="px"?(e=parseNumber(e),e*=Geo$1.metersPerPixel(o.zoom)):e=parseNumber(e);else if(Array.isArray(e))return Array.isArray(e[0])?e.map(function(s){return[s[0],StyleParser.convertUnits(s[1],o)]}):e.map(function(s){return StyleParser.convertUnits(s,o)});return e},StyleParser.parseUnits=function(e){var o={val:parseNumber(e)};return o.val!==0&&typeof e=="string"&&e.trim().slice(-2)==="px"&&(o.units="px"),o},StyleParser.evalCachedDistanceProperty=function(e,o){return e.dynamic?e.dynamic(o):e.zoom&&e.zoom[o.zoom]?e.zoom[o.zoom]:typeof e.value!="function"?e.zoom?(e.zoom[o.zoom]=Utils$1.interpolate(o.zoom,e.value,function(s){return StyleParser.convertUnits(s,o)}),e.zoom[o.zoom]):StyleParser.convertUnits(e.value,o):(e.dynamic=e.value,e.dynamic(o))},StyleParser.string_colors={},StyleParser.colorForString=function(e){if(StyleParser.string_colors[e])return StyleParser.string_colors[e];var o=null;return e!=="none"&&((o=csscolorparser.parseCSSColor(e))&&o.length===4?(o[0]/=255,o[1]/=255,o[2]/=255):o=StyleParser.defaults.color),StyleParser.string_colors[e]=o},StyleParser.evalCachedColorProperty=function(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(e.dynamic){var s=e.dynamic(o);return typeof s=="string"&&(s=StyleParser.colorForString(s)),s&&s[3]==null&&(s[3]=1),s}if(e.static)return e.static;if(e.zoom&&e.zoom[o.zoom])return e.zoom[o.zoom];if(typeof e.value=="function"){e.dynamic=e.value;var h=e.dynamic(o);return typeof h=="string"&&(h=StyleParser.colorForString(h)),h&&h[3]==null&&(h[3]=1),h}if(typeof e.value=="string")return e.static=StyleParser.colorForString(e.value),e.static;if(e.zoom){if(!e.zoom_preprocessed){for(var d=0;d<e.value.length;d++){var g=e.value[d];g&&typeof g[1]=="string"&&(g[1]=StyleParser.colorForString(g[1]))}e.zoom_preprocessed=!0}return e.zoom[o.zoom]=Utils$1.interpolate(o.zoom,e.value),e.zoom[o.zoom][3]=e.zoom[o.zoom][3]||1,e.zoom[o.zoom]}return e.static=e.value.map(function(_){return _}),e.static&&e.static[3]==null&&(e.static[3]=1),e.static},StyleParser.parseColor=function(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="function"&&(e=e(o)),typeof e=="string")e=StyleParser.colorForString(e);else if(Array.isArray(e)&&Array.isArray(e[0])){for(var s=0;s<e.length;s++){var h=e[s];typeof h[1]=="string"&&(h[1]=StyleParser.colorForString(h[1]))}o.zoom&&(e=Utils$1.interpolate(o.zoom,e))}return Array.isArray(e)?(e=e.map(function(d){return d}))[3]==null&&(e[3]=1):e=[0,0,0,1],e},StyleParser.calculateOrder=function(e,o){return typeof e=="function"?e=e(o):typeof e=="string"&&(e=o.feature.properties[e]?o.feature.properties[e]:parsePositiveNumber(e)),e},StyleParser.evalProperty=function(e,o){return typeof e=="function"?e(o):e};var RepeatGroup=function(){function e(o,s){_classCallCheck(this,e),this.key=o,this.repeat_dist=s,this.repeat_dist_sq=this.repeat_dist*this.repeat_dist,this.positions=[]}return _createClass(e,[{key:"check",value:function(o){for(var s=o.position,h=0;h<this.positions.length;h++){var d=this.positions[h],g=s[0]-d[0],_=s[1]-d[1],j=g*g+_*_;if(j<this.repeat_dist_sq)return{dist_sq:j,repeat_dist_sq:this.repeat_dist_sq}}}},{key:"add",value:function(o){o&&o.position&&this.positions.push(o.position)}}],[{key:"clear",value:function(o){this.groups[o]={}}},{key:"check",value:function(o,s,h){if(s.repeat_distance&&s.repeat_group&&this.groups[h][s.repeat_group])return this.groups[h][s.repeat_group].check(o)}},{key:"add",value:function(o,s,h){s.repeat_distance&&s.repeat_group&&(this.groups[h][s.repeat_group]==null&&(this.groups[h][s.repeat_group]=new e(s.repeat_group,s.repeat_distance*s.repeat_scale)),this.groups[h][s.repeat_group].add(o))}}]),e}();RepeatGroup.groups={};var GridIndex=function(){function e(o,s,h){_classCallCheck(this,e);var d=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(o/h),this.yCellCount=Math.ceil(s/h);for(var _=0;_<this.xCellCount*this.yCellCount;_++)d.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=s,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}return _createClass(e,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(o,s,h,d,g){this._forEachCell(s,h,d,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(d),this.bboxes.push(g)}},{key:"insertCircle",value:function(o,s,h,d){this._forEachCell(s-d,h-d,s+d,h+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(s),this.circles.push(h),this.circles.push(d)}},{key:"insertCircleList",value:function(o,s){for(var h=0;h<s.length-2;h+=3)this.insertCircle("".concat(o,"/").concat(h),s[h],s[h+1],s[h+2])}},{key:"_insertBoxCell",value:function(o,s,h,d,g,_){this.boxCells[g].push(_)}},{key:"_insertCircleCell",value:function(o,s,h,d,g,_){this.circleCells[g].push(_)}},{key:"_query",value:function(o,s,h,d,g,_){if(h<0||o>this.width||d<0||s>this.height)return!g&&[];var j=[];if(o<=0&&s<=0&&this.width<=h&&this.height<=d){if(g)return!0;for(var $=0;$<this.boxKeys.length;$++)j.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(var _t=0;_t<this.circleKeys.length;_t++){var _e=this.circles[3*_t],_r=this.circles[3*_t+1],_n=this.circles[3*_t+2];j.push({key:this.circleKeys[_t],x1:_e-_n,y1:_r-_n,x2:_e+_n,y2:_r+_n})}return _?j.filter(_):j}var _o={hitTest:g,seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,h,d,this._queryCell,j,_o,_),g?0<j.length:j}},{key:"_queryCircle",value:function(o,s,h,d,g){var _=o-h,j=o+h,$=s-h,_t=s+h;if(j<0||_>this.width||_t<0||$>this.height)return!d&&[];var _e=[],_r={hitTest:d,circle:{x:o,y:s,radius:h},seenUids:{box:{},circle:{}}};return this._forEachCell(_,$,j,_t,this._queryCellCircle,_e,_r,g),d?0<_e.length:_e}},{key:"query",value:function(o,s,h,d,g){return this._query(o,s,h,d,!1,g)}},{key:"hitTest",value:function(o,s,h,d,g){return this._query(o,s,h,d,!0,g)}},{key:"hitTestCircle",value:function(o,s,h,d){return this._queryCircle(o,s,h,!0,d)}},{key:"hitTestCircleList",value:function(o,s){for(var h=0;h<o.length-2;h+=3)if(this.hitTestCircle(o[h],o[h+1],o[h+2],s))return!0;return!1}},{key:"_queryCell",value:function(o,s,h,d,g,_,j,$){var _t=j.seenUids,_e=this.boxCells[g];if(_e!==null){var _r,_n=this.bboxes,_o=_createForOfIteratorHelper(_e);try{for(_o.s();!(_r=_o.n()).done;){var ga=_r.value;if(!_t.box[ga]){_t.box[ga]=!0;var _l=4*ga;if(o<=_n[2+_l]&&s<=_n[3+_l]&&h>=_n[0+_l]&&d>=_n[1+_l]&&(!$||$(this.boxKeys[ga]))){if(j.hitTest)return _.push(!0),!0;_.push({key:this.boxKeys[ga],x1:_n[_l],y1:_n[1+_l],x2:_n[2+_l],y2:_n[3+_l]})}}}}catch(gy){_o.e(gy)}finally{_o.f()}}var _f=this.circleCells[g];if(_f!==null){var _c,_p=this.circles,_g=_createForOfIteratorHelper(_f);try{for(_g.s();!(_c=_g.n()).done;){var ty=_c.value;if(!_t.circle[ty]){_t.circle[ty]=!0;var oy=3*ty;if(this._circleAndRectCollide(_p[oy],_p[1+oy],_p[2+oy],o,s,h,d)&&(!$||$(this.circleKeys[ty]))){if(j.hitTest)return _.push(!0),!0;var ry=_p[oy],ly=_p[1+oy],py=_p[2+oy];_.push({key:this.circleKeys[ty],x1:ry-py,y1:ly-py,x2:ry+py,y2:ly+py})}}}}catch(gy){_g.e(gy)}finally{_g.f()}}}},{key:"_queryCellCircle",value:function(o,s,h,d,g,_,j,$){var _t=j.circle,_e=j.seenUids,_r=this.boxCells[g];if(_r!==null){var _n,_o=this.bboxes,ga=_createForOfIteratorHelper(_r);try{for(ga.s();!(_n=ga.n()).done;){var _l=_n.value;if(!_e.box[_l]){_e.box[_l]=!0;var _f=4*_l;if(this._circleAndRectCollide(_t.x,_t.y,_t.radius,_o[0+_f],_o[1+_f],_o[2+_f],_o[3+_f])&&(!$||$(this.boxKeys[_l])))return _.push(!0),!0}}}catch(ly){ga.e(ly)}finally{ga.f()}}var _c=this.circleCells[g];if(_c!==null){var _p,_g=this.circles,ty=_createForOfIteratorHelper(_c);try{for(ty.s();!(_p=ty.n()).done;){var oy=_p.value;if(!_e.circle[oy]){_e.circle[oy]=!0;var ry=3*oy;if(this._circlesCollide(_g[ry],_g[1+ry],_g[2+ry],_t.x,_t.y,_t.radius)&&(!$||$(this.circleKeys[oy])))return _.push(!0),!0}}}catch(ly){ty.e(ly)}finally{ty.f()}}}},{key:"_forEachCell",value:function(o,s,h,d,g,_,j,$){for(var _t=this._convertToXCellCoord(o),_e=this._convertToYCellCoord(s),_r=this._convertToXCellCoord(h),_n=this._convertToYCellCoord(d),_o=_t;_o<=_r;_o++)for(var ga=_e;ga<=_n;ga++){var _l=this.xCellCount*ga+_o;if(g.call(this,o,s,h,d,_l,_,j,$))return}}},{key:"_convertToXCellCoord",value:function(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}},{key:"_convertToYCellCoord",value:function(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}},{key:"_circlesCollide",value:function(o,s,h,d,g,_){var j=d-o,$=g-s,_t=h+_;return j*j+$*$<_t*_t}},{key:"_circleAndRectCollide",value:function(o,s,h,d,g,_,j){var $=(_-d)/2,_t=Math.abs(o-(d+$));if($+h<_t)return!1;var _e=(j-g)/2,_r=Math.abs(s-(g+_e));if(_e+h<_r)return!1;if(_t<=$||_r<=_e)return!0;var _n=_t-$,_o=_r-_e;return _n*_n+_o*_o<=h*h}}]),e}(),CollisionUtils={toDiscardLabel:function(e,o,s,h){var d;if(h&&(d=function(ly){return ly!==h.id}),!o){if(e.type==="point"&&!e.angle){var g=e.getAABB(),_=g.left,j=g.top,$=g.right,_t=g.bottom;if(s.hitTest(_,-j,$,-_t,d)){if(Array.isArray(e.layout.anchor))for(var _e=1;_e<e.layout.anchor.length;_e++){e.setAnchor(e.layout.anchor[_e]);var _r=e.getAABB(),_n=_r.left,_o=_r.top,ga=_r.right,_l=_r.bottom;if(!s.hitTest(_n,-_o,ga,-_l,d))return!1}return!0}return!1}var _f=e.getBoundingCircles();return s.hitTestCircleList(_f,d)}if(o){if(e.type==="point"&&!e.isFlat()){var _c=e.getScreenSpaceBoundingBox(),_p=_c.left,_g=_c.top,ty=_c.right,oy=_c.bottom;return s.hitTest(_p,_g,ty,oy,d)}var ry=e.getBoundingCircles();return s.hitTestCircleList(ry,d)}return!1},addLabel:function(e,o,s){var h,d,g,_,j,$,_t,_e,_r,_n,_o,ga,_l=e.id;e.placed=!0,o||(e.type!=="point"||e.angle?(h=e.getBoundingCircles(),s.insertCircleList(_l,h)):(g=(d=e.getAABB()).left,_=d.top,j=d.right,$=d.bottom,s.insert(_l,g,-_,j,-$))),o&&(e.type!=="point"||e.isFlat()?(_t=e.getBoundingCircles(),s.insertCircleList(_l,_t)):(_r=(_e=e.getScreenSpaceBoundingBox()).left,_n=_e.top,_o=_e.right,ga=_e.bottom,s.insert(_l,_r,_n,_o,ga)))}},Collision={tiles:{},startTile:function(e,o){var s=1<arguments.length&&o!==void 0?o:{},h=s.apply_repeat_groups,d=h===void 0||h,g=s.return_hidden,_=g!==void 0&&g,j=s.grid_index,$=j===void 0?null:j,_t=this.tiles[e]={grid_index:$||new GridIndex(Geo$1.tile_scale,Geo$1.tile_scale,240),objects:{},labels:{},styles:{},repeat:d,return_hidden:_};_t.complete==null&&(_t.complete=new Promise(function(_e,_r){_t.resolve=_e,_t.reject=_r}))},resetTile:function(e){delete this.tiles[e]},abortTile:function(e){this.tiles[e]&&this.tiles[e].resolve&&this.tiles[e].resolve([]),this.resetTile(e)},addStyle:function(e,o){this.tiles[o].styles[e]=!0},collide:function(e,o,s){var h=this.tiles[s];if(!h)return Promise.resolve([]);for(var d=h.objects,g=0;g<e.length;g++){var _=e[g],j=_.label.layout.priority;d[j]=d[j]||{},d[j][o]=d[j][o]||[],d[j][o].push(_)}return delete h.styles[o],Object.keys(h.styles).length===0&&this.endTile(s),h.complete.then(function(){return h.resolve=null,h.labels[o]||[]})},endTile:function(e){var o=this.tiles[e],s=o.labels;o.repeat&&RepeatGroup.clear(e);for(var h=Object.keys(o.objects).sort(function(_e,_r){return _e-_r}),d=0;d<h.length;d++){var g=o.objects[h[d]];if(g)for(var _ in g){var j=g[_];s[_]=s[_]||[];for(var $=0;$<j.length;$++){var _t=j[$];this.canBePlaced(_t,e,_t.linked,o)?_t.linked?this.canBePlaced(_t.linked,e,_t,o)?(_t.show=!0,(_t.label.breach||_t.linked.label.breach)&&(_t.label.breach=!0,_t.linked.label.breach=!0),s[_].push(_t),this.place(_t,e,o),this.place(_t.linked,e,o)):o.return_hidden&&(_t.show=!1,s[_].push(_t)):(_t.show=!0,s[_].push(_t),this.place(_t,e,o)):o.return_hidden&&(_t.show=!1,s[_].push(_t))}}}delete this.tiles[e],o.resolve()},canBePlaced:function(e,o,s,h){var d=2<arguments.length&&s!==void 0?s:null,g=(3<arguments.length&&h!==void 0?h:{}).repeat,_=g===void 0||g,j=e.label,$=e.label.layout;if(j.placed!==null)return j.placed;var _t=this.tiles[o].grid_index;if($.collide&&CollisionUtils.toDiscardLabel(j,o==="main",_t,d&&d.label))$.collide&&(j.placed=!1);else{if(!(_&&RepeatGroup.check(j,$,o)))return!0;j.placed=!1}return j.placed},place:function(e,o,s){var h=e.label,d=s.repeat,g=d===void 0||d;h.placed===null&&(g&&RepeatGroup.add(h,h.layout,o),CollisionUtils.addLabel(h,o==="main",this.tiles[o].grid_index))}},Task={id:0,queue:[],max_time:20,start_time:null,state:{},ignore_user_moving_view:!1,_ignoreViewMoveWithDebounce:debounce(function(){Task.ignore_user_moving_view=!0},0,500),add:function(e){e.id=Task.id++,e.max_time=e.max_time||Task.max_time,e.pause_factor=e.pause_factor||1;var o=new Promise(function(s,h){e.resolve=s,e.reject=h});return e.promise=o,e.total_elapsed=0,e.stats={calls:0},this.queue.push(e),this.start_time=this.start_time||performance.now(),this.elapsed=performance.now()-this.start_time,this.elapsed<Task.max_time&&this.process(e),e.promise},remove:function(e){var o=this.queue.indexOf(e);-1<o&&this.queue.splice(o,1)},process:function(e){if(!this.state.user_moving_view||e.user_moving_view!==!1||this.ignore_user_moving_view)return e.pause?(e.pause--,!0):(e.stats.calls++,e.start_time=performance.now(),e.run(e));Task._ignoreViewMoveWithDebounce()},processAll:function(){this.start_time=this.start_time||performance.now(),this.ignore_user_moving_view&&!this.hasPendingTasks()&&(this.ignore_user_moving_view=!1);for(var e=0;e<this.queue.length;e++){var o=this.queue[e];if(this.process(o)!==!0&&(o.pause||(o.pause=o.elapsed>o.max_time?o.pause_factor:0),o.total_elapsed+=o.elapsed),this.elapsed=performance.now()-this.start_time,this.elapsed>=Task.max_time){this.start_time=null;break}}},finish:function(e,o){return e.elapsed=performance.now()-e.start_time,e.total_elapsed+=e.elapsed,this.remove(e),e.resolve(o),e.promise},cancel:function(e){var o;e.cancel instanceof Function&&(o=e.cancel(e)),e.resolve(o||{})},shouldContinue:function(e){return e.elapsed=performance.now()-e.start_time,this.elapsed=performance.now()-this.start_time,e.elapsed<e.max_time&&this.elapsed<Task.max_time},removeForTile:function(e){for(var o=this.queue.length-1;0<=o;o--)this.queue[o].tile_id===e&&(this.cancel(this.queue[o]),this.queue.splice(o,1))},setState:function(e){this.state=e},hasPendingTasks:function(){return!!this.queue.length}};function sliceOptions(e){return{coords:e.coords,uid:e.uid,filtering:e.filtering,sprites:e.sprites,url:e.url,element:e.element,data:e.data,width:e.width,height:e.height,density:e.density,repeat:e.repeat,TEXTURE_WRAP_S:e.TEXTURE_WRAP_S,TEXTURE_WRAP_T:e.TEXTURE_WRAP_T,UNPACK_FLIP_Y_WEBGL:e.UNPACK_FLIP_Y_WEBGL,UNPACK_PREMULTIPLY_ALPHA_WEBGL:e.UNPACK_PREMULTIPLY_ALPHA_WEBGL}}var Texture=function(){function e(o,s,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};_classCallCheck(this,e),d=sliceOptions(d),this.gl=o,this.texture=o.createTexture(),this.texture&&(this.valid=!0),this.manager=h,this.bind(),this.name=s,this.retain_count=0,this.config_type=null,this.loading=null,this.loaded=!1,this.filtering=d.filtering,this.density=d.density||1,this.sprites=d.sprites,this.texcoords={},this.sizes={},this.css_sizes={},this.aspects={},this._byte_length=0,this.setData(1,1,new Uint8Array([0,0,0,0]),{filtering:"nearest"}),this.loaded=!1,this.manager.textures[this.name]&&(this.retain_count=this.manager.textures[this.name].retain_count,this.manager.textures[this.name].retain_count=0,this.manager.textures[this.name].destroy()),(this.manager.textures[this.name]=this).manager.texture_configs[this.name]=JSON.stringify(Object.assign({name:s},d)),this.load(d),log("trace","creating Texture ".concat(this.name))}return _createClass(e,[{key:"destroy",value:function(o){var s=(0<arguments.length&&o!==void 0?o:{}).force;0<this.retain_count&&!s?log("error","Texture '".concat(this.name,"': destroying texture with retain count of '").concat(this.retain_count,"'")):this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,delete this.manager.textures[this.name],delete this.manager.texture_configs[this.name],this.valid=!1,this._byte_length=0,log("trace","destroying Texture ".concat(this.name)))}},{key:"retain",value:function(){this.retain_count++}},{key:"release",value:function(){this.retain_count<=0&&log("error","Texture '".concat(this.name,"': releasing texture with retain count of '").concat(this.retain_count,"'")),this.retain_count--,this.retain_count<=0&&this.destroy()}},{key:"bind",value:function(o){var s=0<arguments.length&&o!==void 0?o:0;this.valid&&(this.manager.activeUnit!==s&&(this.gl.activeTexture(this.gl.TEXTURE0+s),this.manager.activeUnit=s,this.manager.boundTexture=null),this.manager.boundTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.manager.boundTexture=this.texture))}},{key:"load",value:function(o){var s=this;return o?(this.loading=null,typeof o.url=="string"?(this.config_type="url",this.setUrl(o.url,o)):o.element?(this.config_type="element",this.setElement(o.element,o)):o.data&&o.width&&o.height&&(this.config_type="data",this.setData(o.width,o.height,o.data,o)),this.loading=this.loading&&this.loading.then(function(){return s.calculateSprites(),s})||Promise.resolve(this),this.loading):this.loading||Promise.resolve(this)}},{key:"setUrl",value:function(o,s){var h=this,d=1<arguments.length&&s!==void 0?s:{};if(this.valid)return this.url=o,this.loading=new Promise(function(g,_){var j=new Image;j.onload=function(){try{h.setElement(j,d)}catch($){h.loaded=!1,log("warn","Texture '".concat(h.name,"': failed to load url: '").concat(h.url,"'"),$,d),h.manager.trigger("warning",{message:"Failed to load texture from ".concat(h.url),error:$,texture:d})}h.loaded=!0,g(h)},j.onerror=function($){h.loaded=!1,log("warn","Texture '".concat(h.name,"': failed to load url: '").concat(h.url,"'"),$,d),h.manager.trigger("warning",{message:"Failed to load texture from ".concat(h.url),error:$,texture:d}),g(h)},Utils$1.isSafari()&&h.url.slice(0,5)==="data:"||(j.crossOrigin="anonymous"),j.src=h.url}),this.loading}},{key:"setData",value:function(o,s,h,d){var g=3<arguments.length&&d!==void 0?d:{};return this.width=o,this.height=s,Array.isArray(h)&&(h=new Uint8Array(h)),this.update(h,g),this.setFiltering(g),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(o,s){var h,d=o;return typeof o=="string"&&(o=document.querySelector(o)),o instanceof HTMLCanvasElement||o instanceof HTMLImageElement||o instanceof HTMLVideoElement?(this.update(o,s),this.setFiltering(s)):(this.loaded=!1,h="the 'element' parameter (`element: ".concat(JSON.stringify(d),"`) must be a CSS "),h+="selector string, or a <canvas>, <image> or <video> object",log("warn","Texture '".concat(this.name,"': ").concat(h),s),this.manager.trigger("warning",{message:"Failed to load texture because ".concat(h),texture:s})),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(o,s){var h=1<arguments.length&&s!==void 0?s:{};this.valid&&(this.bind(),o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof HTMLImageElement&&o.complete?(this.width=o.width,this.height=o.height,this._byte_length=this.width*this.height*4,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,h.UNPACK_FLIP_Y_WEBGL!==!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,o)):(this._byte_length=o?o.byteLength:0,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,o)),this.manager.trigger("update",this))}},{key:"getByteLength",value:function(){return this._byte_length}},{key:"setFiltering",value:function(o){var s,h=0<arguments.length&&o!==void 0?o:{};this.valid&&(h.filtering=h.filtering||"linear",s=this.gl,this.bind(),Utils$1.isPowerOf2(this.width)&&Utils$1.isPowerOf2(this.height)?(this.power_of_2=!0,s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,h.TEXTURE_WRAP_S||h.repeat&&s.REPEAT||s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,h.TEXTURE_WRAP_T||h.repeat&&s.REPEAT||s.CLAMP_TO_EDGE),h.filtering==="mipmap"?(this.filtering="mipmap",s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR_MIPMAP_LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.generateMipmap(s.TEXTURE_2D)):h.filtering==="linear"?(this.filtering="linear",s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR)):h.filtering==="nearest"&&(this.filtering="nearest",s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST))):(this.power_of_2=!1,s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),h.filtering==="nearest"?(this.filtering="nearest",s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST)):(this.filtering="linear",s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR))),this.manager.trigger("update",this))}},{key:"calculateSprites",value:function(){if(this.sprites)for(var o in this.sprites){var s=this.sprites[o];this.texcoords[o]=this.manager.getTexcoordsForSprite([s[0],s[1]],[s[2],s[3]],[this.width,this.height]),this.sizes[o]=[s[2],s[3]],this.css_sizes[o]=[s[2]/this.density,s[3]/this.density],this.aspects[o]=s[2]/s[3]}}}]),e}();function subscribeMixin(e){var o=[];return Object.assign(e,{subscribe:function(s){o.indexOf(s)===-1&&o.push(s)},unsubscribe:function(s){var h=o.indexOf(s);-1<h&&o.splice(h,1)},unsubscribeAll:function(){o=[]},trigger:function(s){for(var h=arguments.length,d=new Array(1<h?h-1:0),g=1;g<h;g++)d[g-1]=arguments[g];o.forEach(function(_){if(typeof _[s]=="function")try{_[s].apply(_,d)}catch(j){log("warn","Caught exception in listener for event '".concat(s,"':"),j)}})},hasSubscribersFor:function(s){var h=!1;return o.forEach(function(d){typeof d[s]=="function"&&(h=!0)}),h}})}var TextureManager=function(){function e(o){_classCallCheck(this,e),this.default=e.DEFAULT_TEXTURE_NAME,this.textures={},this.texture_configs={},this.boundTexture=null,this.activeUnit=null,this.scene_id=o,WorkerBroker.addTarget("Texture"+this.scene_id,this),subscribeMixin(this)}return _createClass(e,[{key:"create",value:function(o,s,h){for(var d=e.matchers_,g=0;g<d.length;g++){var _=d[g][0],j=d[g][1];if(j&&j(h))return new _(o,s,this,h)}return new Texture(o,s,this,h)}},{key:"retain",value:function(o){this.textures[o]&&this.textures[o].retain()}},{key:"release",value:function(o){this.textures[o]&&this.textures[o].release()}},{key:"getRetainCount",value:function(o){if(this.textures[o])return this.textures[o].retain_count}},{key:"getByteLength",value:function(o){if(this.textures[o])return this.textures[o].getByteLength()}},{key:"destroy",value:function(o){var s=this;Object.keys(this.textures).forEach(function(h){var d=s.textures[h];h!==s.default&&d.gl===o&&d.destroy({force:!0})})}},{key:"getSpriteInfo",value:function(o,s){var h=this.textures[o];return h&&{size:h.sizes[s],css_size:h.css_sizes[s],aspect:h.aspects[s],texcoords:h.texcoords[s]}}},{key:"getTexcoordsForSprite",value:function(o,s,h){var d=h[1]-o[1]-s[1];return[o[0]/h[0],d/h[1],(s[0]+o[0])/h[0],(s[1]+d)/h[1]]}},{key:"createFromObject",value:function(o,s){var h=[];if(s)for(var d in s){var g,_=s[d];this.changed(d,_)&&(g=this.create(o,d,_),h.push(g.loading))}return Promise.all(h)}},{key:"createDefault",value:function(o){return this.create(o,this.default)}},{key:"changed",value:function(o,s){var h=this.textures[o];if(h){if(h.config_type==="element"||s.element!=null)return!0;if(s=sliceOptions(s),this.texture_configs[o]===JSON.stringify(Object.assign({name:o},s)))return!1}return!0}},{key:"getInfo",value:function(o){var s=this;if(o=o||Object.keys(this.textures),Array.isArray(o))return Promise.all(o.map(function(d){return s.getInfo(d)}));var h=this.textures[o];return h?(h.loading||Promise.resolve(h)).then(function(){return{name:h.name,width:h.width,height:h.height,density:h.density,sprites:h.sprites,texcoords:h.texcoords,sizes:h.sizes,css_sizes:h.css_sizes,aspects:h.aspects,filtering:h.filtering,power_of_2:h.power_of_2,valid:h.valid}}):Promise.resolve(null)}},{key:"syncTexturesToWorker",value:function(o){var s=this;return Thread.is_main?Promise.all(o.map(function(h){var d=s.textures[h];return d&&d.loading||Promise.resolve()})).then(function(){return s.textures}):WorkerBroker.postMessage("Texture"+this.scene_id+".getInfo",o).then(function(h){return h.forEach(function(d){s.textures[d.name]=d}),s.textures})}},{key:"getMaxTextureSize",value:function(o){return o.getParameter(o.MAX_TEXTURE_SIZE)}}],[{key:"register",value:function(o,s){var h=e.matchers_;if(!(o instanceof Function&&s instanceof Function))throw"Invalid texture constructor or matcher";this.deRegister(o),h.push([o,s])}},{key:"deRegister",value:function(o){for(var s=e.matchers_,h=0;h<s.length;h++)s[h][0]===o&&s.splice(h,1)}}]),e}();TextureManager.DEFAULT_TEXTURE_NAME="__default",TextureManager.matchers_=[];var Registry={};function getTextureManager(e){return Registry[e]||(Registry[e]=new TextureManager(e)),Registry[e]}var transformMat4_1=transformMat4;function transformMat4(e,o,s){var h=o[0],d=o[1],g=o[2],_=(_=s[3]*h+s[7]*d+s[11]*g+s[15])||1;return e[0]=(s[0]*h+s[4]*d+s[8]*g+s[12])/_,e[1]=(s[1]*h+s[5]*d+s[9]*g+s[13])/_,e[2]=(s[2]*h+s[6]*d+s[10]*g+s[14])/_,e}var normalFromMat4_1=normalFromMat4;function normalFromMat4(e,o){var s=o[0],h=o[1],d=o[2],g=o[3],_=o[4],j=o[5],$=o[6],_t=o[7],_e=o[8],_r=o[9],_n=o[10],_o=o[11],ga=o[12],_l=o[13],_f=o[14],_c=o[15],_p=s*j-h*_,_g=s*$-d*_,ty=s*_t-g*_,oy=h*$-d*j,ry=h*_t-g*j,ly=d*_t-g*$,py=_e*_l-_r*ga,gy=_e*_f-_n*ga,by=_e*_c-_o*ga,wy=_r*_f-_n*_l,Cy=_r*_c-_o*_l,Gy=_n*_c-_o*_f,Ly=_p*Gy-_g*Cy+ty*wy+oy*by-ry*gy+ly*py;return Ly?(Ly=1/Ly,e[0]=(j*Gy-$*Cy+_t*wy)*Ly,e[1]=($*by-_*Gy-_t*gy)*Ly,e[2]=(_*Cy-j*by+_t*py)*Ly,e[3]=(d*Cy-h*Gy-g*wy)*Ly,e[4]=(s*Gy-d*by+g*gy)*Ly,e[5]=(h*by-s*Cy-g*py)*Ly,e[6]=(_l*ly-_f*ry+_c*oy)*Ly,e[7]=(_f*ty-ga*ly-_c*_g)*Ly,e[8]=(ga*ry-_l*ty+_c*_p)*Ly,e):null}var invert_1=invert;function invert(e,o){var s=o[0],h=o[1],d=o[2],g=o[3],_=o[4],j=o[5],$=o[6],_t=o[7],_e=o[8],_r=_e*_-j*_t,_n=-_e*g+j*$,_o=_t*g-_*$,ga=s*_r+h*_n+d*_o;return ga?(ga=1/ga,e[0]=_r*ga,e[1]=(-_e*h+d*_t)*ga,e[2]=(j*h-d*_)*ga,e[3]=_n*ga,e[4]=(_e*s-d*$)*ga,e[5]=(-j*s+d*g)*ga,e[6]=_o*ga,e[7]=(-_t*s+h*$)*ga,e[8]=(_*s-h*g)*ga,e):null}var identity_1=identity;function identity(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}var multiply_1=multiply;function multiply(e,o,s){var h=o[0],d=o[1],g=o[2],_=o[3],j=o[4],$=o[5],_t=o[6],_e=o[7],_r=o[8],_n=o[9],_o=o[10],ga=o[11],_l=o[12],_f=o[13],_c=o[14],_p=o[15],_g=s[0],ty=s[1],oy=s[2],ry=s[3];return e[0]=_g*h+ty*j+oy*_r+ry*_l,e[1]=_g*d+ty*$+oy*_n+ry*_f,e[2]=_g*g+ty*_t+oy*_o+ry*_c,e[3]=_g*_+ty*_e+oy*ga+ry*_p,_g=s[4],ty=s[5],oy=s[6],ry=s[7],e[4]=_g*h+ty*j+oy*_r+ry*_l,e[5]=_g*d+ty*$+oy*_n+ry*_f,e[6]=_g*g+ty*_t+oy*_o+ry*_c,e[7]=_g*_+ty*_e+oy*ga+ry*_p,_g=s[8],ty=s[9],oy=s[10],ry=s[11],e[8]=_g*h+ty*j+oy*_r+ry*_l,e[9]=_g*d+ty*$+oy*_n+ry*_f,e[10]=_g*g+ty*_t+oy*_o+ry*_c,e[11]=_g*_+ty*_e+oy*ga+ry*_p,_g=s[12],ty=s[13],oy=s[14],ry=s[15],e[12]=_g*h+ty*j+oy*_r+ry*_l,e[13]=_g*d+ty*$+oy*_n+ry*_f,e[14]=_g*g+ty*_t+oy*_o+ry*_c,e[15]=_g*_+ty*_e+oy*ga+ry*_p,e}var translate_1=translate;function translate(e,o,s){var h,d,g,_,j,$,_t,_e,_r,_n,_o,ga,_l=s[0],_f=s[1],_c=s[2];return o===e?(e[12]=o[0]*_l+o[4]*_f+o[8]*_c+o[12],e[13]=o[1]*_l+o[5]*_f+o[9]*_c+o[13],e[14]=o[2]*_l+o[6]*_f+o[10]*_c+o[14],e[15]=o[3]*_l+o[7]*_f+o[11]*_c+o[15]):(h=o[0],d=o[1],g=o[2],_=o[3],j=o[4],$=o[5],_t=o[6],_e=o[7],_r=o[8],_n=o[9],_o=o[10],ga=o[11],e[0]=h,e[1]=d,e[2]=g,e[3]=_,e[4]=j,e[5]=$,e[6]=_t,e[7]=_e,e[8]=_r,e[9]=_n,e[10]=_o,e[11]=ga,e[12]=h*_l+j*_f+_r*_c+o[12],e[13]=d*_l+$*_f+_n*_c+o[13],e[14]=g*_l+_t*_f+_o*_c+o[14],e[15]=_*_l+_e*_f+ga*_c+o[15]),e}var scale_1=scale;function scale(e,o,s){var h=s[0],d=s[1],g=s[2];return e[0]=o[0]*h,e[1]=o[1]*h,e[2]=o[2]*h,e[3]=o[3]*h,e[4]=o[4]*d,e[5]=o[5]*d,e[6]=o[6]*d,e[7]=o[7]*d,e[8]=o[8]*g,e[9]=o[9]*g,e[10]=o[10]*g,e[11]=o[11]*g,e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15],e}var perspective_1=perspective;function perspective(e,o,s,h,d){var g=1/Math.tan(o/2),_=1/(h-d);return e[0]=g/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(d+h)*_,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*d*h*_,e[15]=0,e}var identity_1$1=identity$1;function identity$1(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var lookAt_1=lookAt;function lookAt(e,o,s,h){var d,g,_,j,$,_t,_e,_r,_n,_o,ga=o[0],_l=o[1],_f=o[2],_c=h[0],_p=h[1],_g=h[2],ty=s[0],oy=s[1],ry=s[2];return Math.abs(ga-ty)<1e-6&&Math.abs(_l-oy)<1e-6&&Math.abs(_f-ry)<1e-6?identity_1$1(e):(_e=ga-ty,_r=_l-oy,_n=_f-ry,d=_p*(_n*=_o=1/Math.sqrt(_e*_e+_r*_r+_n*_n))-_g*(_r*=_o),g=_g*(_e*=_o)-_c*_n,_=_c*_r-_p*_e,(_o=Math.sqrt(d*d+g*g+_*_))?(d*=_o=1/_o,g*=_o,_*=_o):_=g=d=0,j=_r*_-_n*g,$=_n*d-_e*_,_t=_e*g-_r*d,(_o=Math.sqrt(j*j+$*$+_t*_t))?(j*=_o=1/_o,$*=_o,_t*=_o):_t=$=j=0,e[0]=d,e[1]=j,e[2]=_e,e[3]=0,e[4]=g,e[5]=$,e[6]=_r,e[7]=0,e[8]=_,e[9]=_t,e[10]=_n,e[11]=0,e[12]=-(d*ga+g*_l+_*_f),e[13]=-(j*ga+$*_l+_t*_f),e[14]=-(_e*ga+_r*_l+_n*_f),e[15]=1,e)}var copy_1=copy;function copy(e,o){return e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e[4]=o[4],e[5]=o[5],e[6]=o[6],e[7]=o[7],e[8]=o[8],e[9]=o[9],e[10]=o[10],e[11]=o[11],e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15],e}var invert_1$1=invert$1;function invert$1(e,o){var s=o[0],h=o[1],d=o[2],g=o[3],_=o[4],j=o[5],$=o[6],_t=o[7],_e=o[8],_r=o[9],_n=o[10],_o=o[11],ga=o[12],_l=o[13],_f=o[14],_c=o[15],_p=s*j-h*_,_g=s*$-d*_,ty=s*_t-g*_,oy=h*$-d*j,ry=h*_t-g*j,ly=d*_t-g*$,py=_e*_l-_r*ga,gy=_e*_f-_n*ga,by=_e*_c-_o*ga,wy=_r*_f-_n*_l,Cy=_r*_c-_o*_l,Gy=_n*_c-_o*_f,Ly=_p*Gy-_g*Cy+ty*wy+oy*by-ry*gy+ly*py;return Ly?(Ly=1/Ly,e[0]=(j*Gy-$*Cy+_t*wy)*Ly,e[1]=(d*Cy-h*Gy-g*wy)*Ly,e[2]=(_l*ly-_f*ry+_c*oy)*Ly,e[3]=(_n*ry-_r*ly-_o*oy)*Ly,e[4]=($*by-_*Gy-_t*gy)*Ly,e[5]=(s*Gy-d*by+g*gy)*Ly,e[6]=(_f*ty-ga*ly-_c*_g)*Ly,e[7]=(_e*ly-_n*ty+_o*_g)*Ly,e[8]=(_*Cy-j*by+_t*py)*Ly,e[9]=(h*by-s*Cy-g*py)*Ly,e[10]=(ga*ry-_l*ty+_c*_p)*Ly,e[11]=(_r*ty-_e*ry-_o*_p)*Ly,e[12]=(j*gy-_*wy-$*py)*Ly,e[13]=(s*wy-h*gy+d*py)*Ly,e[14]=(_l*_g-ga*oy-_f*_p)*Ly,e[15]=(_e*oy-_r*_g+_n*_p)*Ly,e):null}var transformMat4_1$1=transformMat4$1;function transformMat4$1(e,o,s){var h=o[0],d=o[1],g=o[2],_=o[3];return e[0]=s[0]*h+s[4]*d+s[8]*g+s[12]*_,e[1]=s[1]*h+s[5]*d+s[9]*g+s[13]*_,e[2]=s[2]*h+s[6]*d+s[10]*g+s[14]*_,e[3]=s[3]*h+s[7]*d+s[11]*g+s[15]*_,e}var normalize_1=normalize$1;function normalize$1(e,o){var s=o[0],h=o[1],d=o[2],g=o[3],_=s*s+h*h+d*d+g*g;return 0<_&&(_=1/Math.sqrt(_),e[0]=s*_,e[1]=h*_,e[2]=d*_,e[3]=g*_),e}var scale_1$1=scale$1;function scale$1(e,o,s){return e[0]=o[0]*s,e[1]=o[1]*s,e[2]=o[2]*s,e[3]=o[3]*s,e}var vec3={fromValues:function(e,o,s){var h=new Float64Array(3);return h[0]=e,h[1]=o,h[2]=s,h},transformMat4:transformMat4_1},mat3={normalFromMat4:normalFromMat4_1,invert:invert_1,identity:identity_1},mat4={multiply:multiply_1,translate:translate_1,scale:scale_1,perspective:perspective_1,lookAt:lookAt_1,identity:identity_1$1,copy:copy_1,invert:invert_1$1},vec4={transformMat4:transformMat4_1$1,normalize:normalize_1,scale:scale_1$1},FeatureSelection=function(){function e(o,s){_classCallCheck(this,e),this._gl=o,this._requests={},this._pixels=null,this._has_dirty_buffer=!1,this._fbo=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._fbo_size={width:256,height:256};var h=getTextureManager(s).create(this._gl,"selection_fbo",{filtering:"nearest"});h.setData(this._fbo_size.width,this._fbo_size.height,null,{filtering:"nearest"}),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,h.texture,0);var d=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,d),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._fbo_size.width,this._fbo_size.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,d),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return _createClass(e,[{key:"destroy",value:function(){this._gl&&this._fbo&&(this._gl.deleteFramebuffer(this._fbo),this._fbo=null,this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null))}},{key:"bind",value:function(){var o;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._gl.viewport(0,0,this._fbo_size.width,this._fbo_size.height),(o=this._gl).clearColor.apply(o,_toConsumableArray(e.defaultColor))}},{key:"getFeatureAt",value:function(o,s,h){var d=s.radius,g=s.top_most_only,_=g===void 0||g;!o||o.x<0||o.y<0||1<o.x||1<o.y?h({features:null}):(this.selection_request_id=this.selection_request_id+1||0,this._requests[this.selection_request_id]={id:this.selection_request_id,point:o,radius:d,top_most_only:_,ttl:_?1:e.MAX_PICKING_TRIES,callback:h})}},{key:"hasPendingRequests",value:function(){return 0<Object.keys(this._requests).length}},{key:"clearPendingRequests",value:function(){for(var o in this._requests)this._requests[o].callback(new Error("cleared")),delete this._requests[o];this._pending_deep_request=null}},{key:"read",value:function(o){if(this.hasPendingRequests()){var s=this._gl;for(var h in s.bindFramebuffer(s.FRAMEBUFFER,this._fbo),this._pending_deep_request&&this.processRequest(this._pending_deep_request,o),this._requests)if(this.processRequest(this._requests[h],o))break;s.bindFramebuffer(s.FRAMEBUFFER,null)}}},{key:"processRequest",value:function(o,s){var h,d,g,_=this._gl,j=255,$=o.point,_t=o.radius,_e=(g=_t?(d=Math.min(this._fbo_size.width,this._fbo_size.height),{x:Math.min(Math.ceil(2*_t.x*this._fbo_size.width),d),y:Math.min(Math.ceil(2*_t.y*this._fbo_size.height),d)}):(_t={x:0,y:0},{x:1,y:1})).x*g.y*4;if(this._pixels==null||this._pixels.byteLength<_e)this._pixels=new Uint8Array(_e);else if(this._pixels.fill instanceof Function)this._pixels.fill(0,0,_e);else for(var _r=0;_r<_e;_r++)this._pixels[_r]=0;_.readPixels(Math.round(($.x-_t.x)*this._fbo_size.width),Math.round((1-$.y-_t.y)*this._fbo_size.height),g.x,g.y,_.RGBA,_.UNSIGNED_BYTE,this._pixels),o.ttl--;var _n=Math.floor(g.x/2),_o=Math.floor(g.y/2),ga=4*(_o*g.x+_n),_l=this._pixels.slice(ga,ga+4),_f=_l[0]+(_l[1]<<8)+(_l[2]<<16);if(0<_f)h=_f+(_l[3]<<24)>>>0,j=_l[3];else if(4<_e)for(var _c=1/0,ga=0,_p=0;_p<g.y;_p++)for(var _g,ty=0;ty<g.x;ty++,ga+=4)0<(_f=(_l=this._pixels.slice(ga,ga+4))[0]+(_l[1]<<8)+(_l[2]<<16))&&(_g=Math.pow(ty-_n,2)+Math.pow(_p-_o,2))<_c&&(h=_f+(_l[3]<<24)>>>0,j=_l[3],_c=_g);if(j!==255){var oy=this._getFeatureByKey(h,s);if(o.features||(o.features=[]),!oy)return void this._finishRead(o);if(o.features.every(function(ry){return ry.id!==oy.id})&&o.features.push(oy),o.ttl)return this._pending_deep_request=o,e._discardColor(_l),this._has_dirty_buffer=!0;this._finishRead(o)}else this._finishRead(o)}},{key:"_finishRead",value:function(o){var s=o.features||e.EMPTY_ARRAY;o.top_most_only||(this._pending_deep_request=null,e._resetDiscardedColors()),delete this._requests[o.id],o.callback({features:s})}},{key:"_getFeatureByKey",value:function(o,s){for(var h=null,d=0;d<s.length;d++){var g=s[d];if(g.selection_data&&(h=g.selection_data[o])){h.tile={coords:g.coords};break}}return h}},{key:"setupDiscards",value:function(o){for(var s=e.MAX_PICKING_TRIES;s--;)o.uniform("4fv","u_selection_discard".concat(s),e._discarded_colors[s]||e.defaultColor)}},{key:"has_dirty_buffer",get:function(){return this._has_dirty_buffer},set:function(){this._has_dirty_buffer=!!this._pending_deep_request}}],[{key:"makeEntry",value:function(){this.map_entry++;var o=255&this.map_entry,s=this.map_entry>>8&255,h=this.map_entry>>16&255,d=this.map_prefix;return{key:o+(s<<8)+(h<<16)+(d<<24)>>>0,color:[o/255,s/255,h/255,d/255]}}},{key:"reset",value:function(){this.map_entry=0}},{key:"setPrefix",value:function(o){this.map_prefix=o}},{key:"_discardColor",value:function(o){this._discarded_colors.push([o[0]/255,o[1]/255,o[2]/255,o[3]/255])}},{key:"_resetDiscardedColors",value:function(){this._discarded_colors.length=0}}]),e}();FeatureSelection._discarded_colors=[],FeatureSelection.map_entry=0,FeatureSelection.map_prefix=0,FeatureSelection.defaultColor=[0,0,0,1],FeatureSelection.MAX_PICKING_TRIES=10,FeatureSelection.EMPTY_ARRAY=Object.freeze([]);var GLSL={parseUniforms:function(e){var o=[];for(var s in e){var h,d=s,g=e[s];if(typeof g=="number")o.push({type:"float",method:"1f",name:s,value:g,key:d,uniforms:e});else if(Array.isArray(g)){if(typeof g[0]=="number")2<=g.length&&g.length<=4?o.push({type:"vec"+g.length,method:g.length+"fv",name:s,value:g,key:d,uniforms:e}):4<g.length&&o.push({type:"float[]",method:"1fv",name:s+"[0]",value:g,key:d,uniforms:e});else if(typeof g[0]=="string")for(h=0;h<g.length;h++)o.push({type:"sampler2D",method:"1i",name:s+"["+h+"]",value:g[h],key:h,uniforms:g});else if(Array.isArray(g[0])&&typeof g[0][0]=="number"&&2<=g[0].length&&g[0].length<=4)for(h=0;h<g.length;h++)o.push({type:"vec"+g[0].length,method:g[h].length+"fv",name:s+"["+h+"]",value:g[h],key:h,uniforms:g})}else typeof g=="boolean"?o.push({type:"bool",method:"1i",name:s,value:g,key:d,uniforms:e}):typeof g=="string"&&o.push({type:"sampler2D",method:"1i",name:s,value:g,key:d,uniforms:e})}return o},defineVariable:function(e,o){var s,h;if(typeof o=="number")s="float";else if(Array.isArray(o))typeof o[0]=="number"?2<=o.length&&o.length<=4?s="vec"+o.length:(s="float",h=o.length):typeof o[0]=="string"&&(s="sampler2D",h=o.length);else if(typeof o=="boolean")s="bool";else{if(typeof o!="string")return;s="sampler2D"}var d="";return d+="".concat(s," ").concat(e),h&&(d+="[".concat(h,"]")),d+=`;
`},defineUniform:function(e,o){var s=GLSL.defineVariable(e,o);if(s)return"uniform "+s},isUniformDefined:function(e,o){var s=new RegExp("uniform[^;]+(?:{[\\s\\S]*})?[^;]*\\b"+e+"\\b","g");return!!o.match(s)},isSymbolReferenced:function(e,o){var s=new RegExp("\\b"+e+"\\b","g");return 0<=o.search(s)},expandVec3:function(e){var o,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;if(Array.isArray(e)){if(e.length!==2)return e;o=[].concat(_toConsumableArray(e),[s]).map(parseFloat)}else o=[e,e,e].map(parseFloat);if(o&&o.every(function(h){return typeof h=="number"&&!isNaN(h)}))return o},expandVec4:function(e){var o,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;if(Array.isArray(e)){if(e.length!==3)return e;o=[].concat(_toConsumableArray(e),[s]).map(parseFloat)}else o=[e,e,e,s].map(parseFloat);if(o&&o.every(function(h){return typeof h=="number"&&!isNaN(h)}))return o}},extensions=[];function getExtension(e,o){var s=extensions.filter(function(h){return h[0]===e})[0];return(s=s&&s[1])||(extensions.push([e,{}]),s=extensions[extensions.length-1][1]),s[o]||(s[o]=e.getExtension(o)),s[o]}function hashString(e){var o,s,h=0;if(e.length===0)return h;for(o=0,s=e.length;o<s;o++)h=(h<<5)-h+e.charCodeAt(o),h|=0;return h}var stripComments=createCommonjsModule(function(e){var o="(.|[\\r\\n]|\\n)*?\\*\\/\\n?\\n?",s=/(^|[^\S\n])(?:\/\/)([\s\S]+?)$/gm,h=/(^|[^\S\n])(?:\/\/[^!])([\s\S]+?)$/gm,d=e.exports=function(g,_){return g?d.block(d.line(g,_),_):""};d.block=function(g,_){_=_||{};var j=new RegExp("\\/\\*"+o,"gm");return _.safe&&(j=new RegExp("\\/\\*(?!\\*?\\!)"+o,"gm")),g?g.replace(j,""):""},d.line=function(g,_){var j=s;return(_=_||{}).safe&&(j=h),g?g.replace(j,""):""}}),glShaderErrors=parseErrors;function parseErrors(e){e=String(e);for(var o,s=[];o=e.match(/ERROR\:([^\n]+)/);){e=e.slice(o.index+1);var h=(_=o[1].trim()).split(":"),d=h.slice(2).join(":").trim(),g=parseInt(h[0],10),_=parseInt(h[1],10);s.push({message:d,file:g,line:_})}return s}var re_pragma=/^\s*#pragma.*$/gm,re_continue_line=/\\\s*\n/gm,ShaderProgram=function(){function e(o,s,h,d,g){if(_classCallCheck(this,e),g=g||{},this.textureManager=getTextureManager(d),this.gl=o,this.program=null,this.compiled=!1,this.compiling=!1,this.error=null,!e.polyfills[d]){e.polyfills[d]={};try{this.gl.uniformMatrix3fv(null,!1,new Float64Array(9))}catch{e.polyfills[d].uniformMatrix3fv=this.gl.uniformMatrix3fv,this.gl.uniformMatrix3fv=function(j,$,_t){e.polyfills[d].uniformMatrix3fv.call(this,j,$,new Float32Array(_t))}}try{this.gl.uniformMatrix4fv(null,!1,new Float64Array(16))}catch{e.polyfills[d].uniformMatrix4fv=this.gl.uniformMatrix4fv,this.gl.uniformMatrix4fv=function(j,$,_t){e.polyfills[d].uniformMatrix4fv.call(this,j,$,new Float32Array(_t))}}}this.defines=Object.assign({},g.defines||{}),this.blocks=Object.assign({},g.blocks||{}),this.block_scopes=Object.assign({},g.block_scopes||{}),this.extensions=g.extensions||[],this.dependent_uniforms=g.uniforms,this.uniforms={},this.attribs={},this.vertex_source=s,this.fragment_source=h,this.id=e.id++,this.name=g.name}return _createClass(e,[{key:"destroy",value:function(){this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.program=null,this.uniforms={},this.attribs={},this.compiled=!1}},{key:"use",value:function(){this.compiled&&(e.current!==this&&this.gl.useProgram(this.program),e.current=this)}},{key:"compile",value:function(){var o=this;if(this.compiling)throw new Error("ShaderProgram.compile(): skipping for ".concat(this.id," (").concat(this.name,") because already compiling"));this.compiling=!0,this.compiled=!1,this.error=null,this.computed_vertex_source=this.vertex_source,this.computed_fragment_source=this.fragment_source;var s,h=this.checkExtensions(),d=this.buildDefineList(),g=this.buildShaderBlockList();for(var _ in g){var j,$,_t,_e=g[_];!_e||Array.isArray(_e)&&_e.length===0||(s=new RegExp("^\\s*#pragma\\s+tangram:\\s+"+_+"\\s*$","m"),j=this.computed_vertex_source.match(s),$=this.computed_fragment_source.match(s),j==null&&$==null||(_t="",_e.forEach(function(_o){var ga="".concat(_o.scope,", ").concat(_o.key,", ").concat(_o.num);_t+=`
// tangram-block-start: `.concat(ga,`
`),_t+=_o.source,_t+=`
// tangram-block-end: `.concat(ga,`
`)}),j!=null&&(this.computed_vertex_source=this.computed_vertex_source.replace(s,_t)),$!=null&&(this.computed_fragment_source=this.computed_fragment_source.replace(s,_t)),d["TANGRAM_BLOCK_"+_.replace(/[\s-]+/g,"_").toUpperCase()]=!0))}this.computed_vertex_source=this.computed_vertex_source.replace(re_pragma,""),this.computed_fragment_source=this.computed_fragment_source.replace(re_pragma,""),this.ensureUniforms(this.dependent_uniforms);var _n="",_r=this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.HIGH_FLOAT),_n=_r&&0<_r.precision?`precision highp float;
`:`precision mediump float;
`;d.TANGRAM_VERTEX_SHADER=!0,d.TANGRAM_FRAGMENT_SHADER=!1,this.computed_vertex_source=_n+e.buildDefineString(d)+this.computed_vertex_source,d.TANGRAM_VERTEX_SHADER=!1,d.TANGRAM_FRAGMENT_SHADER=!0,this.computed_fragment_source=e.buildExtensionString(h)+_n+e.buildDefineString(d)+this.computed_fragment_source,this.computed_vertex_source=this.computed_vertex_source.replace(re_continue_line,""),this.computed_fragment_source=this.computed_fragment_source.replace(re_continue_line,"");try{this.program=e.updateProgram(this.gl,this.program,this.computed_vertex_source,this.computed_fragment_source),this.compiled=!0,this.compiling=!1}catch(_o){throw this.program=null,this.compiled=!1,this.compiling=!1,(this.error=_o).type!=="vertex"&&_o.type!=="fragment"||(this.shader_errors=_o.errors,this.shader_errors.forEach(function(ga){ga.type=_o.type,ga.block=o.block(_o.type,ga.line)})),_o}this.computed_vertex_source=null,this.computed_fragment_source=null,this.use(),this.refreshUniforms(),this.refreshAttributes()}},{key:"buildDefineList",value:function(){var o,s={};for(o in e.defines)s[o]=e.defines[o];for(o in this.defines)s[o]=this.defines[o];return s}},{key:"buildShaderBlockList",value:function(){var o,s,h={};for(o in e.blocks)h[o]=[],Array.isArray(e.blocks[o])?(s=h[o]).push.apply(s,_toConsumableArray(e.blocks[o].map(function($,_t){return{key:o,source:$,num:_t,scope:"ShaderProgram"}}))):h[o]=[{key:o,source:e.blocks[o],num:0,scope:"ShaderProgram"}];for(o in this.blocks)if(h[o]=h[o]||[],Array.isArray(this.blocks[o]))for(var d=this.block_scopes&&this.block_scopes[o]||[],g=null,_=0,j=0;j<this.blocks[o].length;j++)d[j]!==g&&(g=d[j],_=0),h[o].push({key:o,source:this.blocks[o][j],num:_,scope:g||this.name}),_++;else h[o].push({key:o,source:this.blocks[o],num:0,scope:this.name});return h}},{key:"ensureUniforms",value:function(o){if(o){var s,h=stripComments(this.computed_vertex_source),d=stripComments(this.computed_fragment_source),g=[],_=[];for(var j in o){var $=GLSL.isUniformDefined(j,h),_t=GLSL.isUniformDefined(j,d);if(!$||!_t){if(!(s=GLSL.defineUniform(j,o[j])))continue;$||(log("trace","Program ".concat(this.name,": ").concat(j," not defined in vertex shader, injecting: '").concat(s,"'")),g.push(s)),_t||(log("trace","Program ".concat(this.name,": ").concat(j," not defined in fragment shader, injecting: '").concat(s,"'")),_.push(s))}}0<g.length&&(this.computed_vertex_source=g.join(`
`)+this.computed_vertex_source),0<_.length&&(this.computed_fragment_source=_.join(`
`)+this.computed_fragment_source)}}},{key:"setUniforms",value:function(o,s){var h=!(1<arguments.length&&s!==void 0)||s;if(this.compiled){h&&(this.texture_unit=0);for(var d=GLSL.parseUniforms(o),g=0;g<d.length;g++){var _=d[g];_.type==="sampler2D"?this.setTextureUniform(_.name,_.value):this.uniform(_.method,_.name,_.value)}}}},{key:"saveUniforms",value:function(o){var s=o||this.uniforms;for(var h in s){var d=this.uniforms[h];d&&(d.saved_value=d.value)}this.saved_texture_unit=this.texture_unit||0}},{key:"restoreUniforms",value:function(o){var s=o||this.uniforms;for(var h in s){var d=this.uniforms[h];d&&d.saved_value&&(d.value=d.saved_value,this.updateUniform(d))}this.texture_unit=this.saved_texture_unit||0}},{key:"setTextureUniform",value:function(o,s){var h=this.textureManager.textures[s];h!=null?(h.bind(this.texture_unit),this.uniform("1i",o,this.texture_unit),this.texture_unit++):log("warn","Cannot find texture '".concat(s,"'"))}},{key:"uniform",value:function(o,s,h){var d;this.compiled&&(this.uniforms[s]=this.uniforms[s]||{},d=this.uniforms[s],d.name=s,d.location===void 0&&(d.location=this.gl.getUniformLocation(this.program,s)),d.method=o,d.value=h,this.updateUniform(d))}},{key:"updateUniform",value:function(o){this.compiled&&o&&o.location!=null&&(this.use(),this.commitUniform(o))}},{key:"commitUniform",value:function(o){var s=o.location,h=o.value;switch(o.method){case"1i":this.gl.uniform1i(s,h);break;case"1f":this.gl.uniform1f(s,h);break;case"2f":this.gl.uniform2f(s,h[0],h[1]);break;case"3f":this.gl.uniform3f(s,h[0],h[1],h[2]);break;case"4f":this.gl.uniform4f(s,h[0],h[1],h[2],h[3]);break;case"1iv":this.gl.uniform1iv(s,h);break;case"3iv":this.gl.uniform3iv(s,h);break;case"1fv":this.gl.uniform1fv(s,h);break;case"2fv":this.gl.uniform2fv(s,h);break;case"3fv":this.gl.uniform3fv(s,h);break;case"4fv":this.gl.uniform4fv(s,h);break;case"Matrix3fv":this.gl.uniformMatrix3fv(s,!1,h);break;case"Matrix4fv":this.gl.uniformMatrix4fv(s,!1,h)}}},{key:"refreshUniforms",value:function(){if(this.compiled)for(var o in this.uniforms){var s=this.uniforms[o];s.location=this.gl.getUniformLocation(this.program,o),this.updateUniform(s)}}},{key:"refreshAttributes",value:function(){this.attribs={}}},{key:"attribute",value:function(o){if(this.compiled){var s=this.attribs[o]=this.attribs[o]||{};return s.location!=null||(s.name=o,s.location=this.gl.getAttribLocation(this.program,o)),s}}},{key:"source",value:function(o){return o==="vertex"?this.computed_vertex_source:o==="fragment"?this.computed_fragment_source:void 0}},{key:"lines",value:function(o){var s=this.source(o);return s?s.split(`
`):[]}},{key:"line",value:function(o,s){var h=this.lines(o);if(h)return h[s]}},{key:"block",value:function(o,s){for(var h,d=this.lines(o),g=0;g<s&&g<d.length;g++){var _=d[g],j=_.match(/\/\/ tangram-block-start: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/);j&&1<j.length?h={scope:j[1],name:j[2],num:j[3]}:(j=_.match(/\/\/ tangram-block-end: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/))&&1<j.length&&(h=null),h&&(h.line=h.line==null?-1:h.line+1,h.source=_)}return h}},{key:"checkExtensions",value:function(){var o=this,s=[];return this.extensions.forEach(function(h){var d=getExtension(o.gl,h),g="TANGRAM_EXTENSION_".concat(h);o.defines[g]=d!=null,d?s.push(h):log("debug","Could not enable extension '".concat(h,"'"))}),s}}]),e}();ShaderProgram.polyfills={},ShaderProgram.id=0,ShaderProgram.current=null,ShaderProgram.defines={},ShaderProgram.blocks={},ShaderProgram.reset=function(){ShaderProgram.programs_by_source={},ShaderProgram.shaders_by_source={}},ShaderProgram.reset(),ShaderProgram.buildDefineString=function(e){var o="";for(var s in e)e[s]!=null&&e[s]!==!1&&(typeof e[s]=="boolean"&&e[s]===!0?o+="#define "+s+`
`:typeof e[s]=="number"&&Math.floor(e[s])===e[s]?o+="#define "+s+" "+e[s].toFixed(1)+`
`:o+="#define "+s+" "+e[s]+`
`);return o},ShaderProgram.buildExtensionString=function(e){var o="";return(e=e||[]).forEach(function(s){o+="#ifdef GL_".concat(s,`
#extension GL_`).concat(s,` : enable
#endif
`)}),o},ShaderProgram.addBlock=function(e){var o;ShaderProgram.blocks[e]=ShaderProgram.blocks[e]||[];for(var s=arguments.length,h=new Array(1<s?s-1:0),d=1;d<s;d++)h[d-1]=arguments[d];(o=ShaderProgram.blocks[e]).push.apply(o,h)},ShaderProgram.removeBlock=function(e){ShaderProgram.blocks[e]=[]},ShaderProgram.replaceBlock=function(e){ShaderProgram.removeBlock(e);for(var o=arguments.length,s=new Array(1<o?o-1:0),h=1;h<o;h++)s[h-1]=arguments[h];ShaderProgram.addBlock.apply(ShaderProgram,[e].concat(s))},ShaderProgram.updateProgram=function(e,o,s,h){var d=hashString(e._tangram_id+"::"+s+"::"+h);if(ShaderProgram.programs_by_source[d])return log("trace","Reusing identical source GL program object"),ShaderProgram.programs_by_source[d];var g=ShaderProgram.createShader(e,s,e.VERTEX_SHADER),_=ShaderProgram.createShader(e,h,e.FRAGMENT_SHADER);if(e.useProgram(null),o!=null)for(var j=e.getAttachedShaders(o),$=0;$<j.length;$++)e.detachShader(o,j[$]);else o=e.createProgram();if(g==null||_==null)return o;if(e.attachShader(o,g),e.attachShader(o,_),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS))return ShaderProgram.programs_by_source[d]=o;var _t=new Error(`WebGL program error:
            VALIDATE_STATUS: `.concat(e.getProgramParameter(o,e.VALIDATE_STATUS),`
            ERROR: `).concat(e.getError(),`
            --- Vertex Shader ---
            `).concat(s,`
            --- Fragment Shader ---
            `).concat(h));throw Object.assign(new Error(_t),{type:"program"})},ShaderProgram.createShader=function(e,o,s){var h=hashString(e._tangram_id+"::"+o);if(ShaderProgram.shaders_by_source[h])return log("trace","Reusing identical source GL shader object"),ShaderProgram.shaders_by_source[h];var d=e.createShader(s);if(e.shaderSource(d,o),e.compileShader(d),e.getShaderParameter(d,e.COMPILE_STATUS))return ShaderProgram.shaders_by_source[h]=d;var g=s===e.VERTEX_SHADER?"vertex":"fragment",_=e.getShaderInfoLog(d),j=glShaderErrors(_);throw Object.assign(new Error(_),{type:g,errors:j})};var VertexArrayObject={disabled:!1,bound_vao:[],init:function(e){var o;this.disabled!==!0&&(o=getExtension(e,"OES_vertex_array_object")),o!=null?log("info","Vertex Array Object extension available"):this.disabled!==!0?log("warn","Vertex Array Object extension NOT available"):log("warn","Vertex Array Object extension force disabled")},create:function(e,o,s){var h={};h.setup=o,h.teardown=s;var d=getExtension(e,"OES_vertex_array_object");return d!=null&&(h._vao=d.createVertexArrayOES(),d.bindVertexArrayOES(h._vao)),h.setup(!0),h},getCurrentBinding:function(e){var o=this.bound_vao.filter(function(s){return s[0]===e})[0];return o&&o[1]},setCurrentBinding:function(e,o){var s=this.bound_vao,h=s.filter(function(d){return d[0]===e})[0];h==null?s.push([e,o]):h[1]=o},bind:function(e,o){var s,h=getExtension(e,"OES_vertex_array_object");o!=null?h!=null&&o._vao!=null?(h.bindVertexArrayOES(o._vao),this.setCurrentBinding(e,o)):o.setup(!1):(s=this.getCurrentBinding(e),h!=null?h.bindVertexArrayOES(null):s!=null&&typeof s.teardown=="function"&&s.teardown(),this.setCurrentBinding(e,null))},destroy:function(e,o){var s=getExtension(e,"OES_vertex_array_object");s!=null&&o!=null&&o._vao!=null&&(s.deleteVertexArrayOES(o._vao),o._vao=null)}},VBOMesh=function(){function e(o,s,h,d,g,_){_classCallCheck(this,e),_=_||{},this.textureManager=getTextureManager(g),this.gl=o,this.vertex_data=s,this.element_data=h,this.vertex_layout=d,this.vertex_buffer=this.gl.createBuffer(),this.buffer_size=this.vertex_data.byteLength,this.draw_mode=_.draw_mode||this.gl.TRIANGLES,this.data_usage=_.data_usage||this.gl.STATIC_DRAW,this.vertices_per_geometry=3,this.uniforms=_.uniforms,this.textures=_.textures,this.retain=_.retain||!1,this.created_at=+new Date,this.fade_in_time=_.fade_in_time||0,this.vertex_count=this.vertex_data.byteLength/this.vertex_layout.stride,this.element_count=0,this.vaos={},this.toggle_element_array=!1,this.element_data?(this.toggle_element_array=!0,this.element_count=this.element_data.length,this.geometry_count=this.element_count/this.vertices_per_geometry,this.element_type=this.element_data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT,this.element_buffer=this.gl.createBuffer(),this.buffer_size+=this.element_data.byteLength,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.element_buffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.element_data,this.data_usage)):this.geometry_count=this.vertex_count/this.vertices_per_geometry,this.upload(),this.retain||(delete this.vertex_data,delete this.element_data),this.valid=!0}return _createClass(e,[{key:"render",value:function(o){var s=0<arguments.length&&o!==void 0?o:{};if(!this.valid)return!1;var h=s.program||ShaderProgram.current;h.use(),this.uniforms&&(h.saveUniforms(this.uniforms),h.setUniforms(this.uniforms,!1));var d=(new Date-this.created_at)/1e3;return h.uniform("1f","u_visible_time",d),this.bind(h),this.toggle_element_array?this.gl.drawElements(this.draw_mode,this.element_count,this.element_type,0):this.gl.drawArrays(this.draw_mode,0,this.vertex_count),VertexArrayObject.bind(this.gl,null),this.uniforms&&h.restoreUniforms(this.uniforms),d<this.fade_in_time}},{key:"bind",value:function(o){var s=this,h=this.vaos[o.id];h?VertexArrayObject.bind(this.gl,h):this.vaos[o.id]=VertexArrayObject.create(this.gl,function(d){s.gl.bindBuffer(s.gl.ARRAY_BUFFER,s.vertex_buffer),s.toggle_element_array&&s.gl.bindBuffer(s.gl.ELEMENT_ARRAY_BUFFER,s.element_buffer),s.vertex_layout.enable(s.gl,o,d)})}},{key:"upload",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertex_data,this.data_usage)}},{key:"destroy",value:function(){var o=this;if(!this.valid)return!1;for(var s in this.valid=!1,this.vaos)VertexArrayObject.destroy(this.gl,this.vaos[s]);return this.gl.deleteBuffer(this.vertex_buffer),this.vertex_buffer=null,this.element_buffer&&(this.gl.deleteBuffer(this.element_buffer),this.element_buffer=null),delete this.vertex_data,delete this.element_data,this.textures&&this.textures.forEach(function(h){return o.textureManager.release(h)}),!0}}]),e}(),shaderSrc_material=`/*Defines globals:materiallight_accumulator_**/struct Material{
#ifdef TANGRAM_MATERIAL_EMISSION
vec4 emission;
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE
vec3 emissionScale;
#endif
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT
vec4 ambient;
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE
vec3 ambientScale;
#endif
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE
vec4 diffuse;
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE
vec3 diffuseScale;
#endif
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR
vec4 specular;float shininess;
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE
vec3 specularScale;
#endif
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE
vec3 normalScale;float normalAmount;
#endif
};uniform Material u_material;Material material;
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE
uniform sampler2D u_material_emission_texture;
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE
uniform sampler2D u_material_ambient_texture;
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE
uniform sampler2D u_material_diffuse_texture;
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE
uniform sampler2D u_material_specular_texture;
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE
uniform sampler2D u_material_normal_texture;
#endif
vec4 light_accumulator_ambient=vec4(vec3(0.0),1.);vec4 light_accumulator_diffuse=vec4(vec3(0.0),1.);
#ifdef TANGRAM_MATERIAL_SPECULAR
vec4 light_accumulator_specular=vec4(vec3(0.0),1.);
#endif
#ifdef TANGRAM_MATERIAL_TEXTURE_SPHEREMAP
vec4 getSphereMap(in sampler2D _tex,in vec3 _eyeToPoint,in vec3 _normal,in vec2 _skew){vec3 eye=normalize(_eyeToPoint);eye.xy-=_skew;eye=normalize(eye);vec3 r=reflect(eye,_normal);r.z+=1.0;float m=2.*length(r);vec2 uv=r.xy/m+.5;return texture2D(_tex,uv);}
#endif
#ifdef TANGRAM_MATERIAL_TEXTURE_TRIPLANAR
vec3 getTriPlanarBlend(in vec3 _normal){vec3 blending=abs(_normal);blending=normalize(max(blending,0.00001));float b=(blending.x+blending.y+blending.z);return blending/b;}vec4 getTriPlanar(in sampler2D _tex,in vec3 _pos,in vec3 _normal,in vec3 _scale){vec3 blending=getTriPlanarBlend(_normal);vec4 xaxis=texture2D(_tex,fract(_pos.yz*_scale.x));vec4 yaxis=texture2D(_tex,fract(_pos.xz*_scale.y));vec4 zaxis=texture2D(_tex,fract(_pos.xy*_scale.z));return xaxis*blending.x+yaxis*blending.y+zaxis*blending.z;}
#endif
#ifdef TANGRAM_MATERIAL_TEXTURE_PLANAR
vec4 getPlanar(in sampler2D _tex,in vec3 _pos,in vec2 _scale){return texture2D(_tex,fract(_pos.xy*_scale.x));}
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE
void calculateNormal(inout vec3 _normal){
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_UV
_normal+=texture2D(u_material_normal_texture,fract(v_texcoord*material.normalScale.xy)).rgb*2.0-1.0;
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_PLANAR
vec3 normalTex=getPlanar(u_material_normal_texture,v_world_position.xyz,material.normalScale.xy).rgb*2.0-1.0;_normal+=normalTex;
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_TRIPLANAR
vec3 normalTex=getTriPlanar(u_material_normal_texture,v_world_position.xyz,_normal,material.normalScale).rgb*2.0-1.0;_normal+=normalTex;
#endif
_normal=normalize(_normal);}
#endif
void calculateMaterial(in vec3 _eyeToPoint,inout vec3 _normal){
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_UV
material.emission*=texture2D(u_material_emission_texture,v_texcoord);
#endif
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_PLANAR
material.emission*=getPlanar(u_material_emission_texture,v_world_position.xyz,material.emissionScale.xy);
#endif
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_TRIPLANAR
material.emission*=getTriPlanar(u_material_emission_texture,v_world_position.xyz,_normal,material.emissionScale);
#endif
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_SPHEREMAP
material.emission*=getSphereMap(u_material_emission_texture,_eyeToPoint,_normal,u_center_offset);
#endif
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_UV
material.ambient*=texture2D(u_material_ambient_texture,v_texcoord);
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_PLANAR
material.ambient*=getPlanar(u_material_ambient_texture,v_world_position.xyz,material.ambientScale.xy);
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_TRIPLANAR
material.ambient*=getTriPlanar(u_material_ambient_texture,v_world_position.xyz,_normal,material.ambientScale);
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_SPHEREMAP
material.ambient*=getSphereMap(u_material_ambient_texture,_eyeToPoint,_normal,u_center_offset);
#endif
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_UV
material.diffuse*=texture2D(u_material_diffuse_texture,v_texcoord);
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_PLANAR
material.diffuse*=getPlanar(u_material_diffuse_texture,v_world_position.xyz,material.diffuseScale.xy);
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_TRIPLANAR
material.diffuse*=getTriPlanar(u_material_diffuse_texture,v_world_position.xyz,_normal,material.diffuseScale);
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_SPHEREMAP
material.diffuse*=getSphereMap(u_material_diffuse_texture,_eyeToPoint,_normal,u_center_offset);
#endif
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_UV
material.specular*=texture2D(u_material_specular_texture,v_texcoord);
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_PLANAR
material.specular*=getPlanar(u_material_specular_texture,v_world_position.xyz,material.specularScale.xy);
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_TRIPLANAR
material.specular*=getTriPlanar(u_material_specular_texture,v_world_position.xyz,_normal,material.specularScale);
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_SPHEREMAP
material.specular*=getSphereMap(u_material_specular_texture,_eyeToPoint,_normal,u_center_offset);
#endif
#endif
}`,material_props=["emission","ambient","diffuse","specular"],Material=function(){function e(o){var s=this;_classCallCheck(this,e),o=o||{},material_props.forEach(function(h){var d=o[h];d!=null&&(d.texture?s[h]={texture:d.texture,mapping:d.mapping||"spheremap",scale:GLSL.expandVec3(d.scale!=null?d.scale:1),amount:GLSL.expandVec4(d.amount!=null?d.amount:1)}:typeof d=="number"||Array.isArray(d)?s[h]={amount:GLSL.expandVec4(d)}:s[h]=typeof d=="string"?{amount:StyleParser.parseColor(d)}:d)}),this.specular&&(this.specular.shininess=o.shininess?parseFloat(o.shininess):.2),o.normal!=null&&(this.normal={texture:o.normal.texture,mapping:o.normal.mapping||"triplanar",scale:GLSL.expandVec3(o.normal.scale!=null?o.normal.scale:1),amount:o.normal.amount!=null?o.normal.amount:1})}return _createClass(e,[{key:"inject",value:function(o){var s=this;material_props.forEach(function(h){var d="TANGRAM_MATERIAL_".concat(h.toUpperCase()),g=d+"_TEXTURE";o.defines[d]=s[h]!=null,s[h]&&s[h].texture&&(o.defines[g]=!0,o.defines[g+"_"+s[h].mapping.toUpperCase()]=!0,o.defines["TANGRAM_MATERIAL_TEXTURE_".concat(s[h].mapping.toUpperCase())]=!0,o.texcoords=o.texcoords||s[h].mapping==="uv")}),this.normal&&this.normal.texture&&(o.defines.TANGRAM_MATERIAL_NORMAL_TEXTURE=!0,o.defines["TANGRAM_MATERIAL_NORMAL_TEXTURE_"+this.normal.mapping.toUpperCase()]=!0,o.defines["TANGRAM_MATERIAL_TEXTURE_".concat(this.normal.mapping.toUpperCase())]=!0,o.texcoords=o.texcoords||this.normal.mapping==="uv"),o.replaceShaderBlock(e.block,shaderSrc_material,"Material"),o.addShaderBlock("setup",`
material = u_material;
`,"Material")}},{key:"setupProgram",value:function(o){var s=this;material_props.forEach(function(h){s[h]&&(s[h].texture?(o.setTextureUniform("u_material_".concat(h,"_texture"),s[h].texture),o.uniform("3fv","u_material.".concat(h,"Scale"),s[h].scale),o.uniform("4fv","u_material.".concat(h),s[h].amount)):s[h].amount&&o.uniform("4fv","u_material.".concat(h),s[h].amount))}),this.specular&&o.uniform("1f","u_material.shininess",this.specular.shininess),this.normal&&this.normal.texture&&(o.setTextureUniform("u_material_normal_texture",this.normal.texture),o.uniform("3fv","u_material.normalScale",this.normal.scale),o.uniform("1f","u_material.normalAmount",this.normal.amount))}}],[{key:"isValid",value:function(o){return o!=null&&(o.emission!=null||o.ambient!=null||o.diffuse!=null||o.specular!=null)}}]),e}(),Vector;Material.block="material";var Vector$1=Vector={};Vector.copy=function(e){for(var o=[],s=e.length,h=0;h<s;h++)o[h]=e[h];return o},Vector.neg=function(e){for(var o=[],s=e.length,h=0;h<s;h++)o[h]=-e[h];return o},Vector.add=function(e,o){for(var s=[],h=Math.min(e.length,o.length),d=0;d<h;d++)s[d]=e[d]+o[d];return s},Vector.sub=function(e,o){for(var s=[],h=Math.min(e.length,o.length),d=0;d<h;d++)s[d]=e[d]-o[d];return s},Vector.signed_area=function(e,o,s){return(o[0]-e[0])*(s[1]-e[1])-(s[0]-e[0])*(o[1]-e[1])},Vector.mult=function(e,o){var s,h=[],d=e.length;if(typeof o=="number")for(s=0;s<d;s++)h[s]=e[s]*o;else for(d=Math.min(e.length,o.length),s=0;s<d;s++)h[s]=e[s]*o[s];return h},Vector.multMatrix=function(e,o){return[e[0][0]*o[0]+e[0][1]*o[1],e[1][0]*o[0]+e[1][1]*o[1]]},Vector.div=function(e,o){var s=[];if(typeof o=="number")for(d=0;d<e.length;d++)s[d]=e[d]/o;else for(var h=Math.min(e.length,o.length),d=0;d<h;d++)s[d]=e[d]/o[d];return s},Vector.perp=function(e,o){return[o[1]-e[1],e[0]-o[0]]},Vector.rot=function(e,o){var s=Math.cos(o),h=Math.sin(o);return[e[0]*s-e[1]*h,e[0]*h+e[1]*s]},Vector.angle=function(e){var o=_slicedToArray(e,2),s=o[0],h=o[1];return Math.atan2(h,s)},Vector.angleBetween=function(e,o){var s=Vector.dot(Vector.normalize(Vector.copy(e)),Vector.normalize(Vector.copy(o)));return 1<s&&(s=1),Math.acos(s)},Vector.signedAngleBetween=function(e,o){return Math.atan2(e[0]*o[1]-e[1]*o[0],e[0]*o[0]+e[1]*o[1])},Vector.isEqual=function(e,o){for(var s=e.length,h=0;h<s;h++)if(e[h]!==o[h])return!1;return!0},Vector.lengthSq=function(e){return e.length===2?e[0]*e[0]+e[1]*e[1]:3<=e.length?e[0]*e[0]+e[1]*e[1]+e[2]*e[2]:0},Vector.length=function(e){return Math.sqrt(Vector.lengthSq(e))},Vector.normalize=function(e){var o;if(e.length===2){if((o=e[0]*e[0]+e[1]*e[1])===1)return e;(o=Math.sqrt(o))!==0?(e[0]/=o,e[1]/=o):(e[0]=0,e[1]=0)}else if(3<=e.length){if((o=e[0]*e[0]+e[1]*e[1]+e[2]*e[2])===1)return e;(o=Math.sqrt(o))!==0?(e[0]/=o,e[1]/=o,e[2]/=o):(e[0]=0,e[1]=0,e[2]=0)}return e},Vector.cross=function(e,o){return e.length===2?e[0]*o[1]-e[1]*o[0]:e.length===3?[e[1]*o[2]-e[2]*o[1],e[2]*o[0]-e[0]*o[2],e[0]*o[1]-e[1]*o[0]]:void 0},Vector.dot=function(e,o){for(var s=0,h=Math.min(e.length,o.length),d=0;d<h;d++)s+=e[d]*o[d];return s};var shaderSrc_ambientLight="/*Expected globals:light_accumulator_**/struct AmbientLight{vec3 ambient;};void calculateLight(in AmbientLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;}",shaderSrc_directionalLight=`/*Expected globals:materiallight_accumulator_**/struct DirectionalLight{vec3 ambient;vec3 diffuse;vec3 specular;vec3 direction;};void calculateLight(in DirectionalLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;float nDotVP=clamp(dot(_normal,-_light.direction),0.0,1.0);
#ifdef TANGRAM_MATERIAL_DIFFUSE
light_accumulator_diffuse.rgb+=_light.diffuse*nDotVP;
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR
float pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(_light.direction,_normal);float eyeDotR=max(dot(normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf;
#endif
}`,shaderSrc_pointLight=`/*Expected globals:materiallight_accumulator_**/struct PointLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT
float attenuationExponent;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
float innerRadius;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float outerRadius;
#endif
};void calculateLight(in PointLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(VP,_normal),0.0,1.0);float attenuation=1.0;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT
float Rin=1.0;float e=_light.attenuationExponent;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
Rin=_light.innerRadius;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));
#else
float d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);
#endif
#else
float Rin=0.0;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
Rin=_light.innerRadius;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;
#else
float d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);
#endif
#else
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;
#else
attenuation=1.0;
#endif
#endif
#endif
light_accumulator_ambient.rgb+=_light.ambient*attenuation;
#ifdef TANGRAM_MATERIAL_DIFFUSE
light_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation;
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR
float pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(0.0,dot(-normalize(_eyeToPoint),reflectVector));pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation;
#endif
}`,shaderSrc_spotLight=`/*Expected globals:materiallight_accumulator_**/struct SpotLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT
float attenuationExponent;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
float innerRadius;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float outerRadius;
#endif
vec3 direction;float spotCosCutoff;float spotExponent;};void calculateLight(in SpotLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(_normal,VP),0.0,1.0);float attenuation=1.0;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT
float Rin=1.0;float e=_light.attenuationExponent;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
Rin=_light.innerRadius;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));
#else
float d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);
#endif
#else
float Rin=0.0;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
Rin=_light.innerRadius;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;
#else
float d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);
#endif
#else
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;
#else
attenuation=1.0;
#endif
#endif
#endif
float spotAttenuation=0.0;float spotDot=clamp(dot(-VP,_light.direction),0.0,1.0);if(spotDot>=_light.spotCosCutoff){spotAttenuation=pow(spotDot,_light.spotExponent);}light_accumulator_ambient.rgb+=_light.ambient*attenuation*spotAttenuation;
#ifdef TANGRAM_MATERIAL_DIFFUSE
light_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation*spotAttenuation;
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR
float pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(dot(-normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation*spotAttenuation;
#endif
}`,Light=function(){function e(o,s){_classCallCheck(this,e),this.name=s.name,this.view=o,s.ambient==null||typeof s.ambient=="number"?this.ambient=GLSL.expandVec3(s.ambient||0):this.ambient=StyleParser.parseColor(s.ambient).slice(0,3),s.diffuse==null||typeof s.diffuse=="number"?this.diffuse=GLSL.expandVec3(s.diffuse!=null?s.diffuse:1):this.diffuse=StyleParser.parseColor(s.diffuse).slice(0,3),s.specular==null||typeof s.specular=="number"?this.specular=GLSL.expandVec3(s.specular||0):this.specular=StyleParser.parseColor(s.specular).slice(0,3)}return _createClass(e,[{key:"inject",value:function(){var o=`
            uniform `.concat(this.struct_name," u_").concat(this.name,`;
            `).concat(this.struct_name," ").concat(this.name,`;
            `),s=`
            `.concat(this.name," = u_").concat(this.name,`;

        `);ShaderProgram.addBlock(e.block,o),ShaderProgram.addBlock("setup",s)}},{key:"update",value:function(){}},{key:"setupProgram",value:function(o){o.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient),o.uniform("3fv","u_".concat(this.name,".diffuse"),this.diffuse),o.uniform("3fv","u_".concat(this.name,".specular"),this.specular)}}],[{key:"create",value:function(o,s){if(e.types[s.type])return new e.types[s.type](o,s)}},{key:"setMode",value:function(o,s){o===!0&&(o="fragment"),o=e.enabled&&(o??"fragment"),s.defines.TANGRAM_LIGHTING_FRAGMENT=o==="fragment",s.defines.TANGRAM_LIGHTING_VERTEX=o==="vertex"}},{key:"inject",value:function(o){if(ShaderProgram.removeBlock(e.block),e.enabled){var s="";if(o&&0<Object.keys(o).length){var h={};for(var d in o)h[o[d].type]=!0;for(var g in h)e.types[g].inject();for(var _ in o)o[_].inject(),s+="calculateLight(".concat(_,`, _eyeToPoint, _normal);
`)}var j=`
            vec4 calculateLighting(in vec3 _eyeToPoint, in vec3 _normal, in vec4 _color) {

                // Do initial material calculations over normal, emission, ambient, diffuse and specular values
                calculateMaterial(_eyeToPoint,_normal);

                // Un roll the loop of individual ligths to calculate
                `.concat(s,`

                //  Final light intensity calculation
                vec4 color = vec4(vec3(0.), _color.a); // start with vertex color alpha

                #ifdef TANGRAM_MATERIAL_EMISSION
                    color.rgb = material.emission.rgb;
                    color.a *= material.emission.a;
                #endif

                #ifdef TANGRAM_MATERIAL_AMBIENT
                    color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.ambient.rgb;
                    color.a *= material.ambient.a;
                #else
                    #ifdef TANGRAM_MATERIAL_DIFFUSE
                        color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.diffuse.rgb;
                    #endif
                #endif

                #ifdef TANGRAM_MATERIAL_DIFFUSE
                    color.rgb += light_accumulator_diffuse.rgb * _color.rgb * material.diffuse.rgb;
                    color.a *= material.diffuse.a;
                #endif

                #ifdef TANGRAM_MATERIAL_SPECULAR
                    color.rgb += light_accumulator_specular.rgb * material.specular.rgb;
                    color.a *= material.specular.a;
                #endif

                // Clamp final color
                color = clamp(color, 0.0, 1.0);

                return color;
            }`);ShaderProgram.addBlock(e.block,j)}}}]),e}();Light.types={},Light.block="lighting",Light.enabled=!0;var AmbientLight=function(){_inherits(o,Light);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),(d=e.call(this,s,h)).type="ambient",d.struct_name="AmbientLight",d}return _createClass(o,[{key:"setupProgram",value:function(s){s.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient)}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_ambientLight)}}]),o}();Light.types.ambient=AmbientLight;var DirectionalLight=function(){_inherits(o,Light);var e=_createSuper(o);function o(s,h){var d,g;return _classCallCheck(this,o),(d=e.call(this,s,h)).type="directional",d.struct_name="DirectionalLight",h.direction?d._direction=h.direction:(g=Math.sin(60*Math.PI/180),d._direction=[Math.cos(135*Math.PI/180)*g,Math.sin(135*Math.PI/180)*g,-.5]),h.ambient==null&&(d.ambient=GLSL.expandVec3(.5)),d.direction=d._direction.map(parseFloat),d._initial_direction=[d.direction[0],d.direction[1],d.direction[2]],d}return _createClass(o,[{key:"update",value:function(){vec3.transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"setupProgram",value:function(s){_get(_getPrototypeOf(o.prototype),"setupProgram",this).call(this,s),s.uniform("3fv","u_".concat(this.name,".direction"),this.direction)}},{key:"direction",get:function(){return this._direction},set:function(s){this._direction=Vector$1.normalize(Vector$1.copy(s))}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_directionalLight)}}]),o}();Light.types.directional=DirectionalLight;var PointLight=function(){_inherits(o,Light);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),(d=e.call(this,s,h)).type="point",d.struct_name="PointLight",d.position=h.position||[0,0,"100px"],d.position_eye=[],d.origin=h.origin||"ground",d.attenuation=isNaN(parseFloat(h.attenuation))?0:parseFloat(h.attenuation),h.radius?Array.isArray(h.radius)&&h.radius.length===2?d.radius=h.radius:d.radius=[null,h.radius]:d.radius=null,d}return _createClass(o,[{key:"inject",value:function(){_get(_getPrototypeOf(o.prototype),"inject",this).call(this),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT=this.attenuation!==0,ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS=this.radius!=null&&this.radius[0]!=null,ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS=this.radius!=null}},{key:"update",value:function(){var s,h,d,g=this.view.lookAtManipulator.getLookAtData().zoom;this.origin==="world"?(h=(s=_slicedToArray(Geo$1.latLngToMeters(this.position),2))[0],d=s[1],this.position_eye[0]=h-this.view.lookAtManipulator.getLookAtData().position[0],this.position_eye[1]=d-this.view.lookAtManipulator.getLookAtData().position[1],this.position_eye[2]=StyleParser.convertUnits(this.position[2],{zoom:g,meters_per_pixel:Geo$1.metersPerPixel(g)}),this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance):this.origin!=="ground"&&this.origin!=="camera"||(this.position_eye=StyleParser.convertUnits(this.position,{zoom:g,meters_per_pixel:Geo$1.metersPerPixel(g)}),this.origin==="ground"&&(this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance)),this.position_eye[3]=1}},{key:"setupProgram",value:function(s){_get(_getPrototypeOf(o.prototype),"setupProgram",this).call(this,s),s.uniform("4fv","u_".concat(this.name,".position"),this.position_eye),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT&&s.uniform("1f","u_".concat(this.name,".attenuationExponent"),this.attenuation);var h=this.view.lookAtManipulator.getLookAtData().zoom;ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS&&s.uniform("1f","u_".concat(this.name,".innerRadius"),StyleParser.convertUnits(this.radius[0],{zoom:h,meters_per_pixel:Geo$1.metersPerPixel(h)})),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS&&s.uniform("1f","u_".concat(this.name,".outerRadius"),StyleParser.convertUnits(this.radius[1],{zoom:h,meters_per_pixel:Geo$1.metersPerPixel(h)}))}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_pointLight)}}]),o}();Light.types.point=PointLight;var SpotLight=function(){_inherits(o,PointLight);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),(d=e.call(this,s,h)).type="spotlight",d.struct_name="SpotLight",d.direction=d._direction=(h.direction||[0,0,-1]).map(parseFloat),d._initial_direction=[d.direction[0],d.direction[1],d.direction[2]],d.exponent=h.exponent?parseFloat(h.exponent):.2,d.angle=h.angle?parseFloat(h.angle):20,d}return _createClass(o,[{key:"setupProgram",value:function(s){_get(_getPrototypeOf(o.prototype),"setupProgram",this).call(this,s),s.uniform("3fv","u_".concat(this.name,".direction"),this.direction),s.uniform("1f","u_".concat(this.name,".spotCosCutoff"),Math.cos(3.14159*this.angle/180)),s.uniform("1f","u_".concat(this.name,".spotExponent"),this.exponent)}},{key:"update",value:function(){_get(_getPrototypeOf(o.prototype),"update",this).call(this),vec3.transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"direction",get:function(){return this._direction},set:function(s){this._direction=Vector$1.normalize(Vector$1.copy(s))}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_spotLight)}}]),o}();function mergeObjects(e){for(var o=0;o<(arguments.length<=1?0:arguments.length-1);o++){var s=o+1<1||arguments.length<=o+1?void 0:arguments[o+1];if(s)for(var h in s){var d=s[h];d===null||_typeof(d)!=="object"||Array.isArray(d)?d!==void 0&&(e[h]=d):e[h]===null||_typeof(e[h])!=="object"||Array.isArray(e[h])?e[h]=mergeObjects({},d):e[h]=mergeObjects(e[h],d)}}return e}Light.types.spotlight=SpotLight;var shaderSrc_selectionFragment=`
#ifdef TANGRAM_FEATURE_SELECTION
varying vec4 v_selection_color;
#endif
void main(void){
#ifdef TANGRAM_FEATURE_SELECTION
gl_FragColor=v_selection_color;
#else
gl_FragColor=vec4(0.,0.,0.,1.);
#endif
}`,shaderSrc_selectionCropFragment=`
#pragma tangram: utils
#ifdef TANGRAM_FEATURE_SELECTION
uniform float u_meters_per_pixel;varying vec4 v_selection_color;varying vec4 v_local_space_position;
#endif
void main(void){
#ifdef TANGRAM_FEATURE_SELECTION
if(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}else{gl_FragColor=v_selection_color;}
#else
gl_FragColor=vec4(0.,0.,0.,1.);
#endif
}`,shaderSrc_rasters=`#ifdef TANGRAM_FRAGMENT_SHADER
uniform sampler2D u_raster;uniform vec3 u_raster_offset;
#define sampleRaster() (texture2D(u_raster, v_modelpos_base_zoom.xy * u_raster_offset.z + u_raster_offset.xy))
#endif
`,Style={init:function(e){var o=0<arguments.length&&e!==void 0?e:{},s=o.generation,h=o.styles,d=o.sources,g=d===void 0?{}:d,_=o.introspection,j=o.id,$=j!==void 0?j+"/":"";this.scene_id=j,this.textureManager=getTextureManager(j),this.main_thread_target="".concat($,"Style/").concat(this.name),this.setGeneration(s),this.styles=h,this.sources=g,this.defines=this.hasOwnProperty("defines")&&this.defines||{},this.shaders=this.hasOwnProperty("shaders")&&this.shaders||{},this.introspection=_||!1,this.selection=this.selection||this.introspection||!1,this.compile_setup=!1,this.program=null,this.selection_program=null,this.feature_style={},this.vertex_template=[],this.tile_data={},this.defines.TANGRAM_WORLD_POSITION_WRAP=1e5,this.blend=this.blend||"opaque",this.defines["TANGRAM_BLEND_".concat(this.blend.toUpperCase())]=!0,this.blend_order==null&&(this.blend_order=-1),this.removeShaderBlock("setup"),this.material instanceof Material||(Material.isValid(this.material)||(this.material=StyleParser.defaults.material),this.material=new Material(this.material)),this.material.inject(this),Light.setMode(this.lighting,this),this.setupRasters(),this.initialized=!0},destroy:function(){this.program&&(this.program.destroy(),this.program=null),this.selection_program&&(this.selection_program.destroy(),this.selection_program=null),WorkerBroker.removeTarget(this.main_thread_target),this.gl=null,this.initialized=!1},reset:function(){},baseStyle:function(){return this.base||this.name},setGeneration:function(e){this.generation=e,Thread.is_main&&WorkerBroker.addTarget(this.main_thread_target,this)},fillVertexTemplate:function(e,o,s,h){var d=h.size,g=(g=h.offset)===void 0?0:g,_=e.index[o];if(_!==void 0)for(var j=0;j<d;++j){var $=s.length>j?s[j]:s;this.vertex_template[_+j+g]=$}else log("warn","Style: in style '".concat(this.name,"', no index found in vertex layout for attribute '").concat(o,"'"))},startData:function(e){this.tile_data[e.id]=this.tile_data[e.id]||{meshes:{},uniforms:{},textures:[]}},endData:function(e){var o=this.tile_data[e.id];if(this.tile_data[e.id]=null,o&&0<Object.keys(o.meshes).length){for(var s in o.meshes){var h=o.meshes[s];h.vertex_data.vertex_count!==0?(h.vertex_data.end(),h.vertex_elements=h.vertex_data.element_buffer,h.vertex_data=h.vertex_data.vertex_buffer):delete o.meshes[s]}return e.mesh_data[this.name]=o,this.buildRasterTextures(e,o).then(function(d){return d})}return Promise.resolve(null)},hasDataForTile:function(e){return this.tile_data[e.id]!=null},getTileMesh:function(e,o){var s=this.tile_data[e.id].meshes;return s[o.key]==null&&(s[o.key]={variant:o,vertex_data:this.vertexLayoutForMeshVariant(o).createVertexData()}),s[o.key]},vertexLayoutForMeshVariant:function(){return this.vertex_layout},default_mesh_variant:{key:0},style_mesh_variants:{default:{variants:{0:{variant:{key:0},times_unref:0}}}},addMeshVariantForDraw:function(e,o){this.style_mesh_variants[e]||(this.style_mesh_variants[e]={variants:{}});var s=this.computeVariantForDraw(o);return this.style_mesh_variants[e].variants[s.key]={variant:s,times_unref:0},this.style_mesh_variants[e].variants[s.key].variant},getMeshVariantTypeForDraw:function(e){return this.getMeshVariantType(this.base,e)},getMeshVariantType:function(e,o){e===void 0&&(e="default");var s=this.style_mesh_variants[e];if(o.variantKey===void 0||!s||!s.variants[o.variantKey])return this.addMeshVariantForDraw(e,o);var h=o.variantKey,d=s.variants[h];return d.times_unref=0,d.variant},updateMeshVariantTypeCache:function(e){for(var o in this.style_mesh_variants){var s=this.style_mesh_variants[o].variants;for(var h in s){var d=s[h];d.times_unref++,d.times_unref>e&&(o!=="default"||+h!=0)&&(delete s[h],Object.keys(s).length===0&&delete this.style_mesh_variants[o])}}},computeVariantForDraw:function(){return this.default_mesh_variant},addFeature:function(e,o,s){var h=s.tile;this.tile_data[h.id]||this.startData(h);var d,g,_,j,$=this.parseFeature(e,o,s);$&&(d=this.base==="lines"?this.getMeshVariantTypeForDraw(o):this.getMeshVariantTypeForDraw($),_=(g=this.getTileMesh(h,d)).vertex_data.offset,j=g.vertex_data.vertex_count,0<this.buildGeometry(e.geometry,$,g,s)?e.generation=this.generation:g.vertex_data.vertex_count>j&&(g.vertex_data.vertex_buffer.fill(0,_,g.vertex_data.offset),g.vertex_data.vertex_count=j,g.vertex_data.offset=_))},buildGeometry:function(e,o,s,h){var d;return e.type==="Polygon"?d=this.buildPolygons([e.coordinates],o,s,h):e.type==="MultiPolygon"?d=this.buildPolygons(e.coordinates,o,s,h):e.type==="LineString"?d=this.buildLines([e.coordinates],o,s,h):e.type==="MultiLineString"?d=this.buildLines(e.coordinates,o,s,h):e.type==="Point"?d=this.buildPoints([e.coordinates],o,s,h):e.type==="MultiPoint"&&(d=this.buildPoints(e.coordinates,o,s,h)),d},parseFeature:function(e,o,s){try{var h,d,g,_=this.feature_style;if(_.order=this.parseOrder(o.order,s),_.order==null&&this.blend!=="overlay"){var j="Layer '".concat(o.layers.join(", "),"', draw group '").concat(o.group,"': ");return j+="'order' parameter is required unless blend mode is 'overlay'",o.order!=null&&(j+="; 'order' was set to a dynamic value (e.g. string tied to feature property, ",j+="or JS function), but evaluated to null for one or more features"),void log({level:"warn",once:!0},j)}return(_=this._parseFeature(e,o,s))?(this.selection?_.interactive=StyleParser.evalProperty(this.introspection||o.interactive,s):_.interactive=!1,_.interactive===!0?(d=(h=FeatureSelection.makeEntry()).color,g=h.key,_.selection_color=d,s.tile.selection_data||(s.tile.selection_data={}),s.tile.selection_data[g]={id:e.id||g,properties:e.properties,source_name:s.source,source_layer:s.layer,layers:s.layers}):_.selection_color=FeatureSelection.defaultColor,_):void 0}catch($){log("error","Style.parseFeature: style parsing error",e,_,$.stack)}},_parseFeature:function(){return this.feature_style},preprocess:function(e,o){if(!e.preprocessed){if(this.draw)for(var s in this.draw){var h=this.draw[s];_typeof(h)!=="object"||Array.isArray(h)?e[s]==null&&(e[s]=h):e[s]=mergeObjects({},h,e[s])}var d=o||"";if(!(e=this._preprocess(e,d)))return;e.preprocessed=!0}return e},_preprocess:function(e){return e},parseOrder:function(e,o){return typeof e!="number"?StyleParser.calculateOrder(e,o):e},scaleOrder:function(e){return 2*e},parseColor:function(e,o){return e?StyleParser.evalCachedColorProperty(e,o):this.shaders.blocks.color||this.shaders.blocks.filter?StyleParser.defaults.color:void 0},buildPolygons:function(){return 0},buildLines:function(){return 0},buildPoints:function(){return 0},setGL:function(e){this.gl=e,this.max_texture_size=this.textureManager.getMaxTextureSize(this.gl)},makeMesh:function(e,o,s){var h=2<arguments.length&&s!==void 0?s:{},d=this.vertexLayoutForMeshVariant(h.variant);return new VBOMesh(this.gl,e,o,d,this.scene_id,h)},render:function(e){return e.render()},getProgram:function(e){var o=0<arguments.length&&e!==void 0?e:"program";this.compileSetup();var s=this[o];if(s&&!s.error){if(!s.compiled)try{s.compile()}catch(h){log("error","Style: error compiling program for style '".concat(this.name,"' (program key '").concat(o,"')"),this,h.stack)}return s}},compileSetup:function(){if(!this.compile_setup){if(!this.gl)throw new Error("style.compile(): skipping for ".concat(this.name," because no GL context"));var e,o=this.buildDefineList();this.selection&&((e=Object.assign({},o)).TANGRAM_FEATURE_SELECTION=!0);var s=this.shaders&&this.shaders.blocks,h=this.shaders&&this.shaders.block_scopes,d=Object.assign({},this.shaders&&this.shaders.uniforms);for(var g in d)d[g]==null&&log({level:"warn",once:!0},"Style '".concat(this.name,"' has invalid uniform '").concat(g,"': uniform values must be non-null"));var _=this.shaders&&this.shaders.extensions;typeof _=="string"&&(_=[_]),this.program=new ShaderProgram(this.gl,this.vertex_shader_src,this.fragment_shader_src,this.scene_id,{name:this.name,defines:o,uniforms:d,blocks:s,block_scopes:h,extensions:_}),this.selection?this.selection_program=new ShaderProgram(this.gl,this.vertex_shader_src,this.crop_by_tile?shaderSrc_selectionCropFragment:shaderSrc_selectionFragment,this.scene_id,{name:this.name+" (selection)",defines:e,uniforms:d,blocks:s,block_scopes:h,extensions:_}):this.selection_program=null,this.compile_setup=!0}},addShaderBlock:function(e,o,s){var h=2<arguments.length&&s!==void 0?s:null;this.shaders.blocks=this.shaders.blocks||{},this.shaders.blocks[e]=this.shaders.blocks[e]||[],this.shaders.blocks[e].push(o),this.shaders.block_scopes=this.shaders.block_scopes||{},this.shaders.block_scopes[e]=this.shaders.block_scopes[e]||[],this.shaders.block_scopes[e].push(h)},removeShaderBlock:function(e){this.shaders.blocks&&(this.shaders.blocks[e]=null)},replaceShaderBlock:function(e,o,s){var h=2<arguments.length&&s!==void 0?s:null;this.removeShaderBlock(e),this.addShaderBlock(e,o,h)},buildDefineList:function(){var e={};if(this.defines!=null)for(var o in this.defines)e[o]=this.defines[o];if(this.shaders!=null&&this.shaders.defines!=null)for(o in this.shaders.defines)e[o]=this.shaders.defines[o];return e},hasRasters:function(){return-1<["color","normal","custom"].indexOf(this.raster)},setupRasters:function(){if(!Thread.is_main||!this.hasRasters())return!1;this.raster==="color"?this.defines.TANGRAM_RASTER_TEXTURE_COLOR=!0:this.raster==="normal"&&(this.defines.TANGRAM_RASTER_TEXTURE_NORMAL=!0);var e=!1;for(var o in this.sources)if(this.sources[o]instanceof RasterTileSource){e=!0;break}return!!e&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",shaderSrc_rasters,"Raster"),!0)},buildRasterTextures:function(e,o){var s=this;if(!this.hasRasters())return Promise.resolve(o);var h={};return e.rasters.map(function(d){return s.sources[d]}).filter(function(d){return d}).forEach(function(d,g){var _;d instanceof RasterTileSource&&(_=d.tileTexture(e),h[_.url]=_)}),Object.keys(h).length===0?Promise.resolve(o):WorkerBroker.postMessage(this.main_thread_target+".loadTextures",h).then(function(d){if(!d||d.length<1)return log("trace","Missing texture info for tile ".concat(e.key)),null;if(d.some(function(_t){return!_t.loaded}))return null;o.uniforms=o.uniforms||{},o.textures=o.textures||[];var g,_,j=d[0].name,$=h[j].coords;return o.uniforms.u_raster=j,o.textures.push(j),e.coords.z>$.z?(g=e.coords.z-$.z,_=Math.pow(2,g),o.uniforms.u_raster_offset=[(e.coords.x%_+_)%_/_,(_-1-e.coords.y%_)/_,1/_]):o.uniforms.u_raster_offset=[0,0,1],o})},loadTextures:function(e){var o=this;return this.textureManager.createFromObject(this.gl,e).then(function(){return Promise.all(Object.keys(e).map(function(s){return o.textureManager.textures[s]&&o.textureManager.textures[s].load()}).filter(function(s){return s}))}).then(function(s){return s.forEach(function(h){return h.retain()}),s.map(function(h){return{name:h.name,width:h.width,height:h.height,loaded:h.loaded}})})},setup:function(){this.setUniforms(),this.material.setupProgram(ShaderProgram.current)},setUniforms:function(){var e=ShaderProgram.current;e&&e.setUniforms(this.shaders&&this.shaders.uniforms,!0)},render_states:{opaque:{depth_test:!0,depth_write:!0},translucent:{depth_test:!0,depth_write:!0},add:{depth_test:!0,depth_write:!1},multiply:{depth_test:!0,depth_write:!1},inlay:{depth_test:!0,depth_write:!1},overlay:{depth_test:!1,depth_write:!1}},default_blend_orders:{opaque:0,add:1,multiply:2,inlay:3,translucent:4,overlay:5},sortByBlendOrderWithinLayers:function(e){var o=[],s={};for(var h in e.forEach(function(d){var g=parseInt(d.name,10)||0;s[g]||(s[g]=[]),s[g].push(d)}),s)o.push.apply(o,_toConsumableArray(s[h].sort(Style.blendOrderSort)));return o},blendOrderSort:function(e,o){return e.blend==="opaque"||o.blend==="opaque"?e.blend==="opaque"&&o.blend==="opaque"?e.name<o.name?-1:1:e.blend==="opaque"?-1:1:e.blend_order<o.blend_order||!(e.blend_order>o.blend_order)&&(Style.default_blend_orders[e.blend]<Style.default_blend_orders[o.blend]||!(Style.default_blend_orders[e.blend]>Style.default_blend_orders[o.blend])&&e.name<o.name)?-1:1}},id$1=0,build_id=0,Tile=function(){function e(o){var s=o.coords,h=o.style_zoom,d=o.source,g=o.worker,_=o.view,j=o.sceneId;_classCallCheck(this,e),this.textureManager=getTextureManager(j),this.id=id$1++,this.worker=g,this.view=_,this.source=d,this.generation=null,this.valid=!0,this.proxy_for=null,this.proxy_depth=0,this.proxied_as=null,this.fade_in=!0,this.loading=!1,this.loaded=!1,this.built=!1,this.labeled=!1,this.error=null,this.style_zoom=h,this.coords=e.normalizedCoordinate(s,this.source,this.style_zoom),this.key=e.key(this.coords,this.source,this.style_zoom),this.overzoom=Math.max(this.style_zoom-this.coords.z,0),this.overzoom2=Math.pow(2,this.overzoom),this.min=Geo$1.metersForTile(this.coords),this.max=Geo$1.metersForTile({x:this.coords.x+1,y:this.coords.y+1,z:this.coords.z}),this.span={x:this.max.x-this.min.x,y:this.max.y-this.min.y},this.bounds={sw:{x:this.min.x,y:this.max.y},ne:{x:this.max.x,y:this.min.y}},this.center_dist=0,this.meters_per_pixel=Geo$1.metersPerPixel(this.style_zoom),this.meters_per_pixel_sq=this.meters_per_pixel*this.meters_per_pixel,this.units_per_pixel=Geo$1.units_per_pixel/this.overzoom2,this.units_per_meter_overzoom=Geo$1.unitsPerMeter(this.coords.z)*this.overzoom2,this.meshes={},this.new_mesh_styles=[]}return _createClass(e,[{key:"freeResources",value:function(){for(var o in this.meshes)this.meshes[o].forEach(function(s){return s.destroy()});this.meshes={}}},{key:"destroy",value:function(){Task.removeForTile(this.id),this.workerMessage("self.removeTile",this.id),this.freeResources(),this.worker=null,this.valid=!1}},{key:"buildAsMessage",value:function(){return{id:this.id,key:this.key,source:this.source.name,coords:this.coords,min:this.min,max:this.max,units_per_pixel:this.units_per_pixel,meters_per_pixel:this.meters_per_pixel,meters_per_pixel_sq:this.meters_per_pixel_sq,units_per_meter_overzoom:this.units_per_meter_overzoom,style_zoom:this.style_zoom,overzoom:this.overzoom,overzoom2:this.overzoom2,generation:this.generation}}},{key:"workerMessage",value:function(){for(var o=arguments.length,s=new Array(o),h=0;h<o;h++)s[h]=arguments[h];return WorkerBroker.postMessage.apply(WorkerBroker,[this.worker].concat(s))}},{key:"build",value:function(o,s){var h=(1<arguments.length&&s!==void 0?s:{}).fade_in,d=h===void 0||h;return this.generation=o,this.fade_in=d,this.loaded||(this.loading=!0,this.built=!1,this.labeled=!1),this.workerMessage("self.buildTile",{tile:this.buildAsMessage()})}},{key:"buildMeshes",value:function(o,s){if(!this.error){this.build_id=build_id++;var h={},d=this.mesh_data;if(d)for(var g in d){for(var _ in d[g].meshes){var j=d[g].meshes[_];if(j.vertex_data){if(!o[g]){log("warn","Could not create mesh because style '".concat(g,"' not found, for tile ").concat(this.key,", aborting tile"));break}var $=Object.assign({},d[g]);$.uniforms=Object.assign({},$.uniforms,j.uniforms),$.variant=j.variant,j.textures&&($.textures=j.textures),j.labels&&($.retain=!0);var _t=o[g].makeMesh(j.vertex_data,j.vertex_elements,$);_t.variant=$.variant,_t.labels=j.labels,h[g]=h[g]||[],h[g].push(_t),_t.variant.order==null&&(_t.variant.order=h[g].length-1)}}h[g]&&h[g].sort(function(_n,_o){var ga=_n.variant.order,_l=_o.variant.order;return ga!=null&&(_l==null||ga<_l)?-1:1})}for(var _e in delete this.mesh_data,h)this.meshes[_e]&&this.meshes[_e].forEach(function(_n){return _n.destroy()}),this.meshes[_e]=h[_e],this.new_mesh_styles.push(_e);if(s.done){for(var _r in this.meshes)this.new_mesh_styles.indexOf(_r)===-1&&(this.meshes[_r].forEach(function(_n){return _n.destroy()}),delete this.meshes[_r]);this.new_mesh_styles=[]}}}},{key:"setProxyFor",value:function(o){o?(this.proxy_for=this.proxy_for||[],this.proxy_for.push(o),this.proxy_depth=1,o.proxied_as=o.style_zoom>this.style_zoom?"child":"parent"):(this.proxy_for=null,this.proxy_depth=0)}},{key:"isProxy",value:function(){return this.proxy_for!=null}},{key:"shouldProxyForStyle",value:function(o){return!this.proxy_for||this.proxy_for.some(function(s){return s.meshes[o]==null})}},{key:"setupProgram",value:function(o,s){var h=o.model,d=o.model32;s.uniform("4fv","u_tile_origin",[this.min.x,this.min.y,this.style_zoom,this.coords.z]),s.uniform("1f","u_tile_proxy_depth",this.proxy_depth),mat4.identity(h),mat4.translate(h,h,vec3.fromValues(this.min.x,this.min.y,0)),mat4.scale(h,h,vec3.fromValues(this.span.x/Geo$1.tile_scale,-1*this.span.y/Geo$1.tile_scale,1)),mat4.copy(d,h),s.uniform("Matrix4fv","u_model",d),s.uniform("1i","u_tile_fade_in",this.fade_in&&this.proxied_as!=="child")}},{key:"merge",value:function(o){return this.loading=o.loading,this.loaded=o.loaded,this.generation=o.generation,this.error=o.error,this.mesh_data=o.mesh_data,this.selection_data?Object.assign(this.selection_data,o.selection_data):this.selection_data=o.selection_data,this}}],[{key:"coord",value:function(o){return{x:o.x,y:o.y,z:o.z,key:e.coordKey(o)}}},{key:"coordKey",value:function(o){return o.x+"/"+o.y+"/"+o.z}},{key:"key",value:function(o,s,h){if(!(o.y<0||o.y>=1<<o.z||o.z<0))return[s.name,h,o.x,o.y,o.z].join("/")}},{key:"normalizedKey",value:function(o,s,h){return e.key(e.normalizedCoordinate(o,s,h),s,h)}},{key:"normalizedCoordinate",value:function(o,s){return s.zoom_bias&&(o=e.coordinateAtZoom(o,Math.max(0,o.z-s.zoom_bias))),e.coordinateWithMaxZoom(o,s.max_zoom)}},{key:"coordinateAtZoom",value:function(o,s){var h,d=o.x,g=o.y,_=o.z;return _!==s&&(h=Math.pow(2,_-s),d=Math.floor(d/h),g=Math.floor(g/h),_=s),e.coord({x:d,y:g,z:_})}},{key:"coordinateWithMaxZoom",value:function(o,s){var h=o.x,d=o.y,g=o.z;return s!==void 0&&s<g?e.coordinateAtZoom({x:h,y:d,z:g},s):e.coord({x:h,y:d,z:g})}},{key:"childrenForCoordinate",value:function(o){var s=o.x,h=o.y,d=o.z,g=o.key;return e.coord_children[g]||(d++,s*=2,h*=2,e.coord_children[g]=[e.coord({x:s,y:h,z:d}),e.coord({x:s+1,y:h,z:d}),e.coord({x:s,y:h+1,z:d}),e.coord({x:s+1,y:h+1,z:d})]),e.coord_children[g]}},{key:"isDescendant",value:function(o,s){if(s.z>o.z){var h=e.coordinateAtZoom(s,o.z),d=h.x,g=h.y;return o.x===d&&o.y===g}return!1}},{key:"cancel",value:function(o){o&&(o.canceled=!0,o.source_data&&o.source_data.request_id&&(Utils$1.cancelRequest(o.source_data.request_id),o.source_data.request_id=null),e.abortBuild(o))}},{key:"buildGeometry",value:function(o,s){var h=s.scene_id,d=s.layers,g=s.styles,_=s.global,j=s.sources,$=s.meshVariantMaxLife,_t=o.source_data;for(var _e in Collision.startTile(o.id,{apply_repeat_groups:!0}),d){var _r=d[_e];if(_r&&_r.config_data){if(_r.config_data.source===o.source)for(var _n=e._getDataForSource(_t,_r.config_data,_e),_o=0;_o<_n.length;_o++){var ga=_n[_o],_l=ga.geom;if(_l)for(var _f=0;_f<_l.features.length;_f++){var _c=_l.features[_f];if(_c.geometry!=null){var _p=StyleParser.getFeatureParseContext(_c,o,_,j);_p.winding=o.default_winding,_p.source=o.source,_p.layer=ga.layer;var _g=_r.buildDrawGroups(_p,!0);if(_g)for(var ty in _g){var oy=_g[ty],ry=oy.style||ty,ly=g[ry];ly?(oy=ly.preprocess(oy,o.source))!=null&&oy.visible!==!1&&(_p.layers=oy.layers,ly.addFeature(_c,oy,_p)):log("warn","Style '".concat(ry,"' not found, skipping layer '").concat(_e,"':"),oy,_c)}}}}}else log("warn","Layer ".concat(_e," was defined without a geometry data source and will not be rendered."))}var py=e._stylesForTile(o,g);e._sendStyleGroups(o,py,{scene_id:h,meshVariantMaxLife:$},function(gy){return gy.collision?"collision":"non-collision"})}},{key:"_stylesForTile",value:function(o,s){var h=[];for(var d in s)s[d].hasDataForTile(o)&&h.push(s[d]);return h}},{key:"_sendStyleGroups",value:function(o,s,h,d){var g=h.scene_id,_=h.meshVariantMaxLife,j={};s.forEach(function($){var _t=d($);j[_t]=j[_t]||[],j[_t].push($)}),0<Object.keys(j).length?function(){var $={start:!0};o.mesh_data={};for(var _t in j)(function(_e){var _r=j[_e];Promise.all(_r.map(function(_n){return _n.endData(o)})).then(function(){log("trace","Finished style group '".concat(_e,"' for tile ").concat(o.key)),j[_e]=[],Object.keys(j).every(function(_n){return j[_n].length===0})&&($.done=!0),WorkerBroker.postMessage("TileManager_".concat(g,".buildTileStylesCompleted"),WorkerBroker.withTransferables({tile:e.slice(o,["mesh_data","selection_data"]),progress:$})),$.start=null,o.mesh_data={},o.selection_data={},$.done&&Collision.resetTile(o.id)},function(_n){log("error","Error for style group '".concat(_e,"' for tile ").concat(o.key),_n)})})(_t);Style.updateMeshVariantTypeCache(_)}():(WorkerBroker.postMessage("TileManager_".concat(g,".buildTileStylesCompleted"),WorkerBroker.withTransferables({tile:e.slice(o),progress:{start:!0,done:!0}})),Collision.resetTile(o.id))}},{key:"_getDataForSource",value:function(o,s,h){var d=2<arguments.length&&h!==void 0?h:null,g=[];return s!=null&&o!=null&&o.layers!=null&&(!s.layer&&o.layers._default||typeof s.layer=="string"&&!o.layers[s.layer]&&new RegExp("^\\d+_"+s.layer+"$").test(d)&&o.layers._default?g.push({geom:o.layers._default}):!s.layer&&d?g.push({layer:d,geom:o.layers[d]}):typeof s.layer=="string"?g.push({layer:s.layer,geom:o.layers[s.layer]}):Array.isArray(s.layer)&&s.layer.forEach(function(_){o.layers[_]&&o.layers[_].features&&g.push({layer:_,geom:o.layers[_]})})),g}},{key:"abortBuild",value:function(o,s){if(Task.removeForTile(o.id),Collision.abortTile(o.id),o.mesh_data)for(var h in o.mesh_data){var d=o.mesh_data[h].textures;d&&d.forEach(function(g){var _=getTextureManager(s).textures[g];_&&(log("trace","releasing texture ".concat(g," for tile ").concat(o.key)),_.release())})}}},{key:"slice",value:function(o,s){var h=["id","key","loading","loaded","generation","error","debug"];Array.isArray(s)&&h.push.apply(h,_toConsumableArray(s));for(var d={},g=0;g<h.length;g++){var _=h[g];d[_]=o[_]}return d}}]),e}();Tile.coord_children={};var RasterTileSource=function(){_inherits(o,NetworkTileSource);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),(d=e.call(this,s,h)).rasters.indexOf(d.name)===-1&&d.rasters.unshift(d.name),d.filtering=s.filtering,d.textures={},d}return _createClass(o,[{key:"load",value:function(s){s.source_data={},s.source_data.layers={},s.pad_scale=this.pad_scale,s.rasters=_toConsumableArray(this.rasters);var h=Geo$1.tile_scale;return s.source_data.layers={_default:{type:"FeatureCollection",features:[{geometry:{type:"Polygon",coordinates:[[[0,0],[h,0],[h,-h],[0,-h],[0,0]]]},properties:{}}]}},s.default_winding="CW",Promise.resolve(s)}},{key:"tileTexture",value:function(s){var h,d,g=s.coords.key;return this.textures[g]||(h=Tile.coordinateWithMaxZoom(s.coords,this.max_zoom),d=this.formatUrl(this.url,{coords:h}),this.textures[g]={url:d,filtering:this.filtering,coords:h}),this.textures[g]}}]),o}(),ArrayUtils;DataSource.register(RasterTileSource,"Raster");var ArrayUtils$1=ArrayUtils={};function simplify(e,o,s,h){for(var d,g=h,_=s-o>>1,j=s-o,$=e[o],_t=e[o+1],_e=e[s],_r=e[s+1],_n=o+3;_n<s;_n+=3){var _o,ga=getSqSegDist(e[_n],e[_n+1],$,_t,_e,_r);g<ga?(d=_n,g=ga):ga!==g||(_o=Math.abs(_n-_))<j&&(d=_n,j=_o)}h<g&&(3<d-o&&simplify(e,o,d,h),e[d+2]=g,3<s-d&&simplify(e,d,s,h))}function getSqSegDist(e,o,s,h,d,g){var _,j=d-s,$=g-h;return j===0&&$===0||(1<(_=((e-s)*j+(o-h)*$)/(j*j+$*$))?(s=d,h=g):0<_&&(s+=j*_,h+=$*_)),(j=e-s)*j+($=o-h)*$}function createFeature(e,o,s,h){var d={id:e===void 0?null:e,type:o,geometry:s,tags:h,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return calcBBox(d),d}function calcBBox(e){var o=e.geometry,s=e.type;if(s==="Point"||s==="MultiPoint"||s==="LineString")calcLineBBox(e,o);else if(s==="Polygon"||s==="MultiLineString")for(var h=0;h<o.length;h++)calcLineBBox(e,o[h]);else if(s==="MultiPolygon")for(h=0;h<o.length;h++)for(var d=0;d<o[h].length;d++)calcLineBBox(e,o[h][d])}function calcLineBBox(e,o){for(var s=0;s<o.length;s+=3)e.minX=Math.min(e.minX,o[s]),e.minY=Math.min(e.minY,o[s+1]),e.maxX=Math.max(e.maxX,o[s]),e.maxY=Math.max(e.maxY,o[s+1])}function convert(e,o){var s=[];if(e.type==="FeatureCollection")for(var h=0;h<e.features.length;h++)convertFeature(s,e.features[h],o,h);else e.type==="Feature"?convertFeature(s,e,o):convertFeature(s,{geometry:e},o);return s}function convertFeature(e,o,s,h){if(o.geometry){var d=o.geometry.coordinates,g=o.geometry.type,_=Math.pow(s.tolerance/((1<<s.maxZoom)*s.extent),2),j=[],$=o.id;if(s.promoteId?$=o.properties[s.promoteId]:s.generateId&&($=h||0),g==="Point")convertPoint(d,j);else if(g==="MultiPoint")for(var _t=0;_t<d.length;_t++)convertPoint(d[_t],j);else if(g==="LineString")convertLine(d,j,_,!1);else if(g==="MultiLineString"){if(s.lineMetrics){for(_t=0;_t<d.length;_t++)j=[],convertLine(d[_t],j,_,!1),e.push(createFeature($,"LineString",j,o.properties));return}convertLines(d,j,_,!1)}else if(g==="Polygon")convertLines(d,j,_,!0);else{if(g!=="MultiPolygon"){if(g!=="GeometryCollection")throw new Error("Input data is not a valid GeoJSON object.");for(_t=0;_t<o.geometry.geometries.length;_t++)convertFeature(e,{id:$,geometry:o.geometry.geometries[_t],properties:o.properties},s,h);return}for(_t=0;_t<d.length;_t++){var _e=[];convertLines(d[_t],_e,_,!0),j.push(_e)}}e.push(createFeature($,g,j,o.properties))}}function convertPoint(e,o){o.push(projectX(e[0])),o.push(projectY(e[1])),o.push(0)}function convertLine(e,o,s,h){for(var d,g,_=0,j=0;j<e.length;j++){var $=projectX(e[j][0]),_t=projectY(e[j][1]);o.push($),o.push(_t),o.push(0),0<j&&(_+=h?(d*_t-$*g)/2:Math.sqrt(Math.pow($-d,2)+Math.pow(_t-g,2))),d=$,g=_t}var _e=o.length-3;o[2]=1,simplify(o,0,_e,s),o[2+_e]=1,o.size=Math.abs(_),o.start=0,o.end=o.size}function convertLines(e,o,s,h){for(var d=0;d<e.length;d++){var g=[];convertLine(e[d],g,s,h),o.push(g)}}function projectX(e){return e/360+.5}function projectY(e){var o=Math.sin(e*Math.PI/180),s=.5-.25*Math.log((1+o)/(1-o))/Math.PI;return s<0?0:1<s?1:s}function clip(e,o,s,h,d,g,_,j){if(h/=o,(s/=o)<=g&&_<h)return e;if(_<s||h<=g)return null;for(var $=[],_t=0;_t<e.length;_t++){var _e=e[_t],_r=_e.geometry,_n=_e.type,_o=d===0?_e.minX:_e.minY,ga=d===0?_e.maxX:_e.maxY;if(s<=_o&&ga<h)$.push(_e);else if(!(ga<s||h<=_o)){var _l=[];if(_n==="Point"||_n==="MultiPoint")clipPoints(_r,_l,s,h,d);else if(_n==="LineString")clipLine(_r,_l,s,h,d,!1,j.lineMetrics);else if(_n==="MultiLineString")clipLines(_r,_l,s,h,d,!1);else if(_n==="Polygon")clipLines(_r,_l,s,h,d,!0);else if(_n==="MultiPolygon")for(var _f=0;_f<_r.length;_f++){var _c=[];clipLines(_r[_f],_c,s,h,d,!0),_c.length&&_l.push(_c)}if(_l.length){if(j.lineMetrics&&_n==="LineString"){for(_f=0;_f<_l.length;_f++)$.push(createFeature(_e.id,_n,_l[_f],_e.tags));continue}_n!=="LineString"&&_n!=="MultiLineString"||(_l.length===1?(_n="LineString",_l=_l[0]):_n="MultiLineString"),_n!=="Point"&&_n!=="MultiPoint"||(_n=_l.length===3?"Point":"MultiPoint"),$.push(createFeature(_e.id,_n,_l,_e.tags))}}}return $.length?$:null}function clipPoints(e,o,s,h,d){for(var g=0;g<e.length;g+=3){var _=e[g+d];s<=_&&_<=h&&(o.push(e[g]),o.push(e[g+1]),o.push(e[g+2]))}}function clipLine(e,o,s,h,d,g,_){for(var j,$,_t=newSlice(e),_e=d===0?intersectX:intersectY,_r=e.start,_n=0;_n<e.length-3;_n+=3){var _g=e[_n],ty=e[_n+1],oy=e[_n+2],_o=e[_n+3],ga=e[_n+4],_l=d===0?_g:ty,_f=d===0?_o:ga,_c=!1;_&&(j=Math.sqrt(Math.pow(_g-_o,2)+Math.pow(ty-ga,2))),_l<s?s<_f&&($=_e(_t,_g,ty,_o,ga,s),_&&(_t.start=_r+j*$)):h<_l?_f<h&&($=_e(_t,_g,ty,_o,ga,h),_&&(_t.start=_r+j*$)):addPoint(_t,_g,ty,oy),_f<s&&s<=_l&&($=_e(_t,_g,ty,_o,ga,s),_c=!0),h<_f&&_l<=h&&($=_e(_t,_g,ty,_o,ga,h),_c=!0),!g&&_c&&(_&&(_t.end=_r+j*$),o.push(_t),_t=newSlice(e)),_&&(_r+=j)}var _p=e.length-3,_g=e[_p],ty=e[_p+1],oy=e[_p+2];s<=(_l=d===0?_g:ty)&&_l<=h&&addPoint(_t,_g,ty,oy),_p=_t.length-3,g&&3<=_p&&(_t[_p]!==_t[0]||_t[_p+1]!==_t[1])&&addPoint(_t,_t[0],_t[1],_t[2]),_t.length&&o.push(_t)}function newSlice(e){var o=[];return o.size=e.size,o.start=e.start,o.end=e.end,o}function clipLines(e,o,s,h,d,g){for(var _=0;_<e.length;_++)clipLine(e[_],o,s,h,d,g,!1)}function addPoint(e,o,s,h){e.push(o),e.push(s),e.push(h)}function intersectX(e,o,s,h,d,g){var _=(g-o)/(h-o);return e.push(g),e.push(s+(d-s)*_),e.push(1),_}function intersectY(e,o,s,h,d,g){var _=(g-s)/(d-s);return e.push(o+(h-o)*_),e.push(g),e.push(1),_}function wrap(e,o){var s=o.buffer/o.extent,h=e,d=clip(e,1,-1-s,s,0,-1,2,o),g=clip(e,1,1-s,2+s,0,-1,2,o);return(d||g)&&(h=clip(e,1,-s,1+s,0,-1,2,o)||[],d&&(h=shiftFeatureCoords(d,1).concat(h)),g&&(h=h.concat(shiftFeatureCoords(g,-1)))),h}function shiftFeatureCoords(e,o){for(var s=[],h=0;h<e.length;h++){var d,g=e[h],_=g.type;if(_==="Point"||_==="MultiPoint"||_==="LineString")d=shiftCoords(g.geometry,o);else if(_==="MultiLineString"||_==="Polygon"){d=[];for(var j=0;j<g.geometry.length;j++)d.push(shiftCoords(g.geometry[j],o))}else if(_==="MultiPolygon")for(d=[],j=0;j<g.geometry.length;j++){for(var $=[],_t=0;_t<g.geometry[j].length;_t++)$.push(shiftCoords(g.geometry[j][_t],o));d.push($)}s.push(createFeature(g.id,_,d,g.tags))}return s}function shiftCoords(e,o){var s=[];s.size=e.size,e.start!==void 0&&(s.start=e.start,s.end=e.end);for(var h=0;h<e.length;h+=3)s.push(e[h]+o,e[h+1],e[h+2]);return s}function transformTile(e,o){if(e.transformed)return e;for(var s,h=1<<e.z,d=e.x,g=e.y,_=0;_<e.features.length;_++){var j=e.features[_],$=j.geometry,_t=j.type;if(j.geometry=[],_t===1)for(s=0;s<$.length;s+=2)j.geometry.push(transformPoint($[s],$[s+1],o,h,d,g));else for(s=0;s<$.length;s++){for(var _e=[],_r=0;_r<$[s].length;_r+=2)_e.push(transformPoint($[s][_r],$[s][_r+1],o,h,d,g));j.geometry.push(_e)}}return e.transformed=!0,e}function transformPoint(e,o,s,h,d,g){return[Math.round(s*(e*h-d)),Math.round(s*(o*h-g))]}function createTile(e,o,s,h,d){for(var g=o===d.maxZoom?0:d.tolerance/((1<<o)*d.extent),_={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:s,y:h,z:o,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},j=0;j<e.length;j++){_.numFeatures++,addFeature(_,e[j],g,d);var $=e[j].minX,_t=e[j].minY,_e=e[j].maxX,_r=e[j].maxY;$<_.minX&&(_.minX=$),_t<_.minY&&(_.minY=_t),_e>_.maxX&&(_.maxX=_e),_r>_.maxY&&(_.maxY=_r)}return _}function addFeature(e,o,s,h){var d=o.geometry,g=o.type,_=[];if(g==="Point"||g==="MultiPoint")for(var j=0;j<d.length;j+=3)_.push(d[j]),_.push(d[j+1]),e.numPoints++,e.numSimplified++;else if(g==="LineString")addLine(_,d,e,s,!1,!1);else if(g==="MultiLineString"||g==="Polygon")for(j=0;j<d.length;j++)addLine(_,d[j],e,s,g==="Polygon",j===0);else if(g==="MultiPolygon")for(var $=0;$<d.length;$++)for(var _t=d[$],j=0;j<_t.length;j++)addLine(_,_t[j],e,s,!0,j===0);if(_.length){var _e=o.tags||null;if(g==="LineString"&&h.lineMetrics){for(var _r in _e={},o.tags)_e[_r]=o.tags[_r];_e.mapbox_clip_start=d.start/d.size,_e.mapbox_clip_end=d.end/d.size}var _n={geometry:_,type:g==="Polygon"||g==="MultiPolygon"?3:g==="LineString"||g==="MultiLineString"?2:1,tags:_e};o.id!==null&&(_n.id=o.id),e.features.push(_n)}}function addLine(e,o,s,h,d,g){var _=h*h;if(0<h&&o.size<(d?_:h))s.numPoints+=o.length/3;else{for(var j=[],$=0;$<o.length;$+=3)(h===0||o[$+2]>_)&&(s.numSimplified++,j.push(o[$]),j.push(o[$+1])),s.numPoints++;d&&rewind(j,g),e.push(j)}}function rewind(e,o){for(var s=0,h=0,d=e.length,g=d-2;h<d;g=h,h+=2)s+=(e[h]-e[g])*(e[h+1]+e[g+1]);if(0<s===o)for(h=0,d=e.length;h<d/2;h+=2){var _=e[h],j=e[h+1];e[h]=e[d-2-h],e[h+1]=e[d-1-h],e[d-2-h]=_,e[d-1-h]=j}}ArrayUtils.deepClone=function(e){return Array.isArray(e)?e.map(ArrayUtils.deepClone):e};var defaults={maxZoom:14,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1};function createGeoJsonTile(e,o,s,h,d){var g=Object.assign({},defaults,d),_=convert(e,g),j=getBBox(_=wrap(_,g)),$=j.minX,_t=j.minY,_e=j.maxX,_r=j.maxY,_n=1<<o,_o=g.buffer/g.extent,ga=1+_o;return _=clip(_,_n,s-_o,s+ga,0,$,_e,g)||[],transformTile(createTile(_=clip(_,_n,h-_o,h+ga,1,_t,_r,g)||[],o,s,h,g),g.extent)}function getBBox(e){var o,s=2,h=-1,d=1,g=0,_=_createForOfIteratorHelper(e);try{for(_.s();!(o=_.n()).done;){var j=o.value;j.minX<s&&(s=j.minX),j.maxX>h&&(h=j.maxX),j.minY<d&&(d=j.minY),j.maxY>g&&(g=j.maxY)}}catch($){_.e($)}finally{_.f()}return{minX:s,maxX:h,minY:d,maxY:g}}function PackingSmith(e,o){this.items=[],this.algorithm=e;var s=(o=o||{}).sort===void 0||o.sort;this.sort=s}PackingSmith.prototype={addItem:function(e){this.items.push(e)},normalizeCoordinates:function(){var e=this.items,o=1/0,s=1/0;e.forEach(function(h){var d=h;o=Math.min(o,d.x),s=Math.min(s,d.y)}),e.forEach(function(h){var d=h;d.x-=o,d.y-=s})},getStats:function(){var e=this.items.map(function(g){return g}),o=e.map(function(g){return g.x}),s=e.map(function(g){return g.y}),h=e.map(function(g){return g.x+g.width}),d=e.map(function(g){return g.y+g.height});return{minX:Math.max.apply(Math,o),minY:Math.max.apply(Math,s),maxX:Math.max.apply(Math,h),maxY:Math.max.apply(Math,d)}},getItems:function(){return this.items},processItems:function(){var e=this.items;return this.sort&&(e=this.algorithm.sort(e)),e=this.algorithm.placeItems(e),this.items=e},exportItems:function(){return this.processItems(),this.normalizeCoordinates(),this.items},export:function(){var e=this.exportItems(),o=this.getStats();return{height:o.maxY,width:o.maxX,items:e}}};var packing_smith=PackingSmith,lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=e.length;o<s;++o)lookup[o]=e[o],revLookup[e.charCodeAt(o)]=o;revLookup[45]=62,revLookup[95]=63}function toByteArray(e){var o,s,h,d;inited||init();var g=e.length;if(0<g%4)throw new Error("Invalid string. Length must be a multiple of 4");h=e[g-2]==="="?2:e[g-1]==="="?1:0,d=new Arr(3*g/4-h),o=0<h?g-4:g;for(var _=0,j=0;j<o;j+=4,0)s=revLookup[e.charCodeAt(j)]<<18|revLookup[e.charCodeAt(j+1)]<<12|revLookup[e.charCodeAt(j+2)]<<6|revLookup[e.charCodeAt(j+3)],d[_++]=s>>16&255,d[_++]=s>>8&255,d[_++]=255&s;return h==2?(s=revLookup[e.charCodeAt(j)]<<2|revLookup[e.charCodeAt(j+1)]>>4,d[_++]=255&s):h==1&&(s=revLookup[e.charCodeAt(j)]<<10|revLookup[e.charCodeAt(j+1)]<<4|revLookup[e.charCodeAt(j+2)]>>2,d[_++]=s>>8&255,d[_++]=255&s),d}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,o,s){for(var h,d=[],g=o;g<s;g+=3)h=(e[g]<<16)+(e[g+1]<<8)+e[g+2],d.push(tripletToBase64(h));return d.join("")}function fromByteArray(e){var o;inited||init();for(var s=e.length,h=s%3,d="",g=[],_=0,j=s-h;_<j;_+=16383)g.push(encodeChunk(e,_,j<_+16383?j:_+16383));return h==1?(o=e[s-1],d+=lookup[o>>2],d+=lookup[o<<4&63],d+="=="):h==2&&(o=(e[s-2]<<8)+e[s-1],d+=lookup[o>>10],d+=lookup[o>>4&63],d+=lookup[o<<2&63],d+="="),g.push(d),g.join("")}function read$1(e,o,s,h,d){var g,_,j=8*d-h-1,$=(1<<j)-1,_t=$>>1,_e=-7,_r=s?d-1:0,_n=s?-1:1,_o=e[o+_r];for(_r+=_n,g=_o&(1<<-_e)-1,_o>>=-_e,_e+=j;0<_e;g=256*g+e[o+_r],_r+=_n,_e-=8);for(_=g&(1<<-_e)-1,g>>=-_e,_e+=h;0<_e;_=256*_+e[o+_r],_r+=_n,_e-=8);if(g===0)g=1-_t;else{if(g===$)return _?NaN:1/0*(_o?-1:1);_+=Math.pow(2,h),g-=_t}return(_o?-1:1)*_*Math.pow(2,g-h)}function write$1(e,o,s,h,d,g){var _,j,$,_t=8*g-d-1,_e=(1<<_t)-1,_r=_e>>1,_n=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,_o=h?0:g-1,ga=h?1:-1,_l=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(j=isNaN(o)?1:0,_=_e):(_=Math.floor(Math.log(o)/Math.LN2),o*($=Math.pow(2,-_))<1&&(_--,$*=2),2<=(o+=1<=_+_r?_n/$:_n*Math.pow(2,1-_r))*$&&(_++,$/=2),_e<=_+_r?(j=0,_=_e):1<=_+_r?(j=(o*$-1)*Math.pow(2,d),_+=_r):(j=o*Math.pow(2,_r-1)*Math.pow(2,d),_=0));8<=d;e[s+_o]=255&j,_o+=ga,j/=256,d-=8);for(_=_<<d|j,_t+=d;0<_t;e[s+_o]=255&_,_o+=ga,_/=256,_t-=8);e[s+_o-ga]|=128*_l}var toString$1={}.toString,isArray=Array.isArray||function(e){return toString$1.call(e)=="[object Array]"},INSPECT_MAX_BYTES=50;Buffer.TYPED_ARRAY_SUPPORT=global$1.TYPED_ARRAY_SUPPORT===void 0||global$1.TYPED_ARRAY_SUPPORT;var _kMaxLength=kMaxLength();function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(e,o){if(kMaxLength()<o)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(o)).__proto__=Buffer.prototype:(e===null&&(e=new Buffer(o)),e.length=o),e}function Buffer(e,o,s){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(e,o,s);if(typeof e!="number")return from(this,e,o,s);if(typeof o=="string")throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,e)}function from(e,o,s,h){if(typeof o=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&o instanceof ArrayBuffer?fromArrayBuffer(e,o,s,h):typeof o=="string"?fromString$1(e,o,s):fromObject(e,o)}function assertSize(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function alloc(e,o,s,h){return assertSize(o),!(o<=0)&&s!==void 0?typeof h=="string"?createBuffer(e,o).fill(s,h):createBuffer(e,o).fill(s):createBuffer(e,o)}function allocUnsafe(e,o){if(assertSize(o),e=createBuffer(e,o<0?0:0|checked(o)),!Buffer.TYPED_ARRAY_SUPPORT)for(var s=0;s<o;++s)e[s]=0;return e}function fromString$1(e,o,s){if(typeof s=="string"&&s!==""||(s="utf8"),!Buffer.isEncoding(s))throw new TypeError('"encoding" must be a valid string encoding');var h=0|byteLength(o,s),d=(e=createBuffer(e,h)).write(o,s);return d!==h&&(e=e.slice(0,d)),e}function fromArrayLike(e,o){var s=o.length<0?0:0|checked(o.length);e=createBuffer(e,s);for(var h=0;h<s;h+=1)e[h]=255&o[h];return e}function fromArrayBuffer(e,o,s,h){if(o.byteLength,s<0||o.byteLength<s)throw new RangeError("'offset' is out of bounds");if(o.byteLength<s+(h||0))throw new RangeError("'length' is out of bounds");return o=s===void 0&&h===void 0?new Uint8Array(o):h===void 0?new Uint8Array(o,s):new Uint8Array(o,s,h),Buffer.TYPED_ARRAY_SUPPORT?(e=o).__proto__=Buffer.prototype:e=fromArrayLike(e,o),e}function fromObject(e,o){if(internalIsBuffer(o)){var s=0|checked(o.length);return(e=createBuffer(e,s)).length===0||o.copy(e,0,0,s),e}if(o){if(typeof ArrayBuffer<"u"&&o.buffer instanceof ArrayBuffer||"length"in o)return typeof o.length!="number"||isnan(o.length)?createBuffer(e,0):fromArrayLike(e,o);if(o.type==="Buffer"&&isArray(o.data))return fromArrayLike(e,o.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(e){if(e>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer.alloc(+e)}function internalIsBuffer(e){return e!=null&&e._isBuffer}function byteLength(e,o){if(internalIsBuffer(e))return e.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var s=e.length;if(s===0)return 0;for(var h=!1;;)switch(o){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*s;case"hex":return s>>>1;case"base64":return base64ToBytes(e).length;default:if(h)return utf8ToBytes(e).length;o=(""+o).toLowerCase(),h=!0}}function slowToString(e,o,s){var h=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0)<=(o>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return hexSlice(this,o,s);case"utf8":case"utf-8":return utf8Slice(this,o,s);case"ascii":return asciiSlice(this,o,s);case"latin1":case"binary":return latin1Slice(this,o,s);case"base64":return base64Slice(this,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,o,s);default:if(h)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),h=!0}}function swap(e,o,s){var h=e[o];e[o]=e[s],e[s]=h}function bidirectionalIndexOf(e,o,s,h,d){if(e.length===0)return-1;if(typeof s=="string"?(h=s,s=0):2147483647<s?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,isNaN(s)&&(s=d?0:e.length-1),s<0&&(s=e.length+s),s>=e.length){if(d)return-1;s=e.length-1}else if(s<0){if(!d)return-1;s=0}if(typeof o=="string"&&(o=Buffer.from(o,h)),internalIsBuffer(o))return o.length===0?-1:arrayIndexOf$1(e,o,s,h,d);if(typeof o=="number")return o&=255,Buffer.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?d?Uint8Array.prototype.indexOf.call(e,o,s):Uint8Array.prototype.lastIndexOf.call(e,o,s):arrayIndexOf$1(e,[o],s,h,d);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf$1(e,o,s,h,d){var g=1,_=e.length,j=o.length;if(h!==void 0&&((h=String(h).toLowerCase())==="ucs2"||h==="ucs-2"||h==="utf16le"||h==="utf-16le")){if(e.length<2||o.length<2)return-1;_/=g=2,j/=2,s/=2}function $(_o,ga){return g===1?_o[ga]:_o.readUInt16BE(ga*g)}if(d)for(var _t=-1,_e=s;_e<_;_e++)if($(e,_e)===$(o,_t===-1?0:_e-_t)){if(_t===-1&&(_t=_e),_e-_t+1===j)return _t*g}else _t!==-1&&(_e-=_e-_t),_t=-1;else for(_<s+j&&(s=_-j),_e=s;0<=_e;_e--){for(var _r=!0,_n=0;_n<j;_n++)if($(e,_e+_n)!==$(o,_n)){_r=!1;break}if(_r)return _e}return-1}function hexWrite(e,o,s,h){s=Number(s)||0;var d=e.length-s;(!h||d<(h=Number(h)))&&(h=d);var g=o.length;if(g%2!=0)throw new TypeError("Invalid hex string");g/2<h&&(h=g/2);for(var _=0;_<h;++_){var j=parseInt(o.substr(2*_,2),16);if(isNaN(j))return _;e[s+_]=j}return _}function utf8Write(e,o,s,h){return blitBuffer(utf8ToBytes(o,e.length-s),e,s,h)}function asciiWrite(e,o,s,h){return blitBuffer(asciiToBytes(o),e,s,h)}function latin1Write(e,o,s,h){return asciiWrite(e,o,s,h)}function base64Write(e,o,s,h){return blitBuffer(base64ToBytes(o),e,s,h)}function ucs2Write(e,o,s,h){return blitBuffer(utf16leToBytes(o,e.length-s),e,s,h)}function base64Slice(e,o,s){return o===0&&s===e.length?fromByteArray(e):fromByteArray(e.slice(o,s))}function utf8Slice(e,o,s){s=Math.min(e.length,s);for(var h=[],d=o;d<s;){var g,_,j,$,_t=e[d],_e=null,_r=239<_t?4:223<_t?3:191<_t?2:1;if(d+_r<=s)switch(_r){case 1:_t<128&&(_e=_t);break;case 2:(192&(g=e[d+1]))==128&&127<($=(31&_t)<<6|63&g)&&(_e=$);break;case 3:g=e[d+1],_=e[d+2],(192&g)==128&&(192&_)==128&&2047<($=(15&_t)<<12|(63&g)<<6|63&_)&&($<55296||57343<$)&&(_e=$);break;case 4:g=e[d+1],_=e[d+2],j=e[d+3],(192&g)==128&&(192&_)==128&&(192&j)==128&&65535<($=(15&_t)<<18|(63&g)<<12|(63&_)<<6|63&j)&&$<1114112&&(_e=$)}_e===null?(_e=65533,_r=1):65535<_e&&(_e-=65536,h.push(_e>>>10&1023|55296),_e=56320|1023&_e),h.push(_e),d+=_r}return decodeCodePointsArray(h)}Buffer.poolSize=8192,Buffer._augment=function(e){return e.__proto__=Buffer.prototype,e},Buffer.from=function(e,o,s){return from(null,e,o,s)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array),Buffer.alloc=function(e,o,s){return alloc(null,e,o,s)},Buffer.allocUnsafe=function(e){return allocUnsafe(null,e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(null,e)},Buffer.isBuffer=isBuffer,Buffer.compare=function(e,o){if(!internalIsBuffer(e)||!internalIsBuffer(o))throw new TypeError("Arguments must be Buffers");if(e===o)return 0;for(var s=e.length,h=o.length,d=0,g=Math.min(s,h);d<g;++d)if(e[d]!==o[d]){s=e[d],h=o[d];break}return s<h?-1:h<s?1:0},Buffer.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(e,o){if(!isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return Buffer.alloc(0);if(o===void 0)for(d=o=0;d<e.length;++d)o+=e[d].length;for(var s=Buffer.allocUnsafe(o),h=0,d=0;d<e.length;++d){var g=e[d];if(!internalIsBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(s,h),h+=g.length}return s},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var o=0;o<e;o+=2)swap(this,o,o+1);return this},Buffer.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var o=0;o<e;o+=4)swap(this,o,o+3),swap(this,o+1,o+2);return this},Buffer.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var o=0;o<e;o+=8)swap(this,o,o+7),swap(this,o+1,o+6),swap(this,o+2,o+5),swap(this,o+3,o+4);return this},Buffer.prototype.toString=function(){var e=0|this.length;return e==0?"":arguments.length===0?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(e){if(!internalIsBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||Buffer.compare(this,e)===0},Buffer.prototype.inspect=function(){var e="",o=INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,o).match(/.{2}/g).join(" "),this.length>o&&(e+=" ... ")),"<Buffer "+e+">"},Buffer.prototype.compare=function(e,o,s,h,d){if(!internalIsBuffer(e))throw new TypeError("Argument must be a Buffer");if(o===void 0&&(o=0),s===void 0&&(s=e?e.length:0),h===void 0&&(h=0),d===void 0&&(d=this.length),o<0||s>e.length||h<0||d>this.length)throw new RangeError("out of range index");if(d<=h&&s<=o)return 0;if(d<=h)return-1;if(s<=o)return 1;if(this===e)return 0;for(var g=(d>>>=0)-(h>>>=0),_=(s>>>=0)-(o>>>=0),j=Math.min(g,_),$=this.slice(h,d),_t=e.slice(o,s),_e=0;_e<j;++_e)if($[_e]!==_t[_e]){g=$[_e],_=_t[_e];break}return g<_?-1:_<g?1:0},Buffer.prototype.includes=function(e,o,s){return this.indexOf(e,o,s)!==-1},Buffer.prototype.indexOf=function(e,o,s){return bidirectionalIndexOf(this,e,o,s,!0)},Buffer.prototype.lastIndexOf=function(e,o,s){return bidirectionalIndexOf(this,e,o,s,!1)},Buffer.prototype.write=function(e,o,s,h){if(o===void 0)h="utf8",s=this.length,o=0;else if(s===void 0&&typeof o=="string")h=o,s=this.length,o=0;else{if(!isFinite(o))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");o|=0,isFinite(s)?(s|=0,h===void 0&&(h="utf8")):(h=s,s=void 0)}var d=this.length-o;if((s===void 0||d<s)&&(s=d),0<e.length&&(s<0||o<0)||o>this.length)throw new RangeError("Attempt to write outside buffer bounds");h=h||"utf8";for(var g=!1;;)switch(h){case"hex":return hexWrite(this,e,o,s);case"utf8":case"utf-8":return utf8Write(this,e,o,s);case"ascii":return asciiWrite(this,e,o,s);case"latin1":case"binary":return latin1Write(this,e,o,s);case"base64":return base64Write(this,e,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,o,s);default:if(g)throw new TypeError("Unknown encoding: "+h);h=(""+h).toLowerCase(),g=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){var o=e.length;if(o<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);for(var s="",h=0;h<o;)s+=String.fromCharCode.apply(String,e.slice(h,h+=MAX_ARGUMENTS_LENGTH));return s}function asciiSlice(e,o,s){var h="";s=Math.min(e.length,s);for(var d=o;d<s;++d)h+=String.fromCharCode(127&e[d]);return h}function latin1Slice(e,o,s){var h="";s=Math.min(e.length,s);for(var d=o;d<s;++d)h+=String.fromCharCode(e[d]);return h}function hexSlice(e,o,s){var h=e.length;(!o||o<0)&&(o=0),(!s||s<0||h<s)&&(s=h);for(var d="",g=o;g<s;++g)d+=toHex(e[g]);return d}function utf16leSlice(e,o,s){for(var h=e.slice(o,s),d="",g=0;g<h.length;g+=2)d+=String.fromCharCode(h[g]+256*h[g+1]);return d}function checkOffset(e,o,s){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(s<e+o)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,o,s,h,d,g){if(!internalIsBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(d<o||o<g)throw new RangeError('"value" argument is out of bounds');if(s+h>e.length)throw new RangeError("Index out of range")}function objectWriteUInt16(e,o,s,h){o<0&&(o=65535+o+1);for(var d=0,g=Math.min(e.length-s,2);d<g;++d)e[s+d]=(o&255<<8*(h?d:1-d))>>>8*(h?d:1-d)}function objectWriteUInt32(e,o,s,h){o<0&&(o=4294967295+o+1);for(var d=0,g=Math.min(e.length-s,4);d<g;++d)e[s+d]=o>>>8*(h?d:3-d)&255}function checkIEEE754(e,o,s,h,d,g){if(s+h>e.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function writeFloat(e,o,s,h,d){return d||checkIEEE754(e,o,s,4),write$1(e,o,s,h,23,4),s+4}function writeDouble(e,o,s,h,d){return d||checkIEEE754(e,o,s,8),write$1(e,o,s,h,52,8),s+8}Buffer.prototype.slice=function(e,o){var s=this.length;if((e=~~e)<0?(e+=s)<0&&(e=0):s<e&&(e=s),(o=o===void 0?s:~~o)<0?(o+=s)<0&&(o=0):s<o&&(o=s),o<e&&(o=e),Buffer.TYPED_ARRAY_SUPPORT)(d=this.subarray(e,o)).__proto__=Buffer.prototype;else for(var h=o-e,d=new Buffer(h,void 0),g=0;g<h;++g)d[g]=this[g+e];return d},Buffer.prototype.readUIntLE=function(e,o,s){e|=0,o|=0,s||checkOffset(e,o,this.length);for(var h=this[e],d=1,g=0;++g<o&&(d*=256);)h+=this[e+g]*d;return h},Buffer.prototype.readUIntBE=function(e,o,s){e|=0,o|=0,s||checkOffset(e,o,this.length);for(var h=this[e+--o],d=1;0<o&&(d*=256);)h+=this[e+--o]*d;return h},Buffer.prototype.readUInt8=function(e,o){return o||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function(e,o){return o||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function(e,o){return o||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function(e,o){return o||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function(e,o){return o||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function(e,o,s){e|=0,o|=0,s||checkOffset(e,o,this.length);for(var h=this[e],d=1,g=0;++g<o&&(d*=256);)h+=this[e+g]*d;return(d*=128)<=h&&(h-=Math.pow(2,8*o)),h},Buffer.prototype.readIntBE=function(e,o,s){e|=0,o|=0,s||checkOffset(e,o,this.length);for(var h=o,d=1,g=this[e+--h];0<h&&(d*=256);)g+=this[e+--h]*d;return(d*=128)<=g&&(g-=Math.pow(2,8*o)),g},Buffer.prototype.readInt8=function(e,o){return o||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer.prototype.readInt16LE=function(e,o){o||checkOffset(e,2,this.length);var s=this[e]|this[e+1]<<8;return 32768&s?4294901760|s:s},Buffer.prototype.readInt16BE=function(e,o){o||checkOffset(e,2,this.length);var s=this[e+1]|this[e]<<8;return 32768&s?4294901760|s:s},Buffer.prototype.readInt32LE=function(e,o){return o||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function(e,o){return o||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function(e,o){return o||checkOffset(e,4,this.length),read$1(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function(e,o){return o||checkOffset(e,4,this.length),read$1(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function(e,o){return o||checkOffset(e,8,this.length),read$1(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function(e,o){return o||checkOffset(e,8,this.length),read$1(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function(e,o,s,h){e=+e,o|=0,s|=0,h||checkInt(this,e,o,s,Math.pow(2,8*s)-1,0);var d=1,g=0;for(this[o]=255&e;++g<s&&(d*=256);)this[o+g]=e/d&255;return o+s},Buffer.prototype.writeUIntBE=function(e,o,s,h){e=+e,o|=0,s|=0,h||checkInt(this,e,o,s,Math.pow(2,8*s)-1,0);var d=s-1,g=1;for(this[o+d]=255&e;0<=--d&&(g*=256);)this[o+d]=e/g&255;return o+s},Buffer.prototype.writeUInt8=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[o]=255&e,o+1},Buffer.prototype.writeUInt16LE=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[o]=255&e,this[o+1]=e>>>8):objectWriteUInt16(this,e,o,!0),o+2},Buffer.prototype.writeUInt16BE=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[o]=e>>>8,this[o+1]=255&e):objectWriteUInt16(this,e,o,!1),o+2},Buffer.prototype.writeUInt32LE=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[o+3]=e>>>24,this[o+2]=e>>>16,this[o+1]=e>>>8,this[o]=255&e):objectWriteUInt32(this,e,o,!0),o+4},Buffer.prototype.writeUInt32BE=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[o]=e>>>24,this[o+1]=e>>>16,this[o+2]=e>>>8,this[o+3]=255&e):objectWriteUInt32(this,e,o,!1),o+4},Buffer.prototype.writeIntLE=function(e,o,s,h){var d;e=+e,o|=0,h||checkInt(this,e,o,s,(d=Math.pow(2,8*s-1))-1,-d);var g=0,_=1,j=0;for(this[o]=255&e;++g<s&&(_*=256);)e<0&&j===0&&this[o+g-1]!==0&&(j=1),this[o+g]=(e/_>>0)-j&255;return o+s},Buffer.prototype.writeIntBE=function(e,o,s,h){var d;e=+e,o|=0,h||checkInt(this,e,o,s,(d=Math.pow(2,8*s-1))-1,-d);var g=s-1,_=1,j=0;for(this[o+g]=255&e;0<=--g&&(_*=256);)e<0&&j===0&&this[o+g+1]!==0&&(j=1),this[o+g]=(e/_>>0)-j&255;return o+s},Buffer.prototype.writeInt8=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[o]=255&e,o+1},Buffer.prototype.writeInt16LE=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[o]=255&e,this[o+1]=e>>>8):objectWriteUInt16(this,e,o,!0),o+2},Buffer.prototype.writeInt16BE=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[o]=e>>>8,this[o+1]=255&e):objectWriteUInt16(this,e,o,!1),o+2},Buffer.prototype.writeInt32LE=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[o]=255&e,this[o+1]=e>>>8,this[o+2]=e>>>16,this[o+3]=e>>>24):objectWriteUInt32(this,e,o,!0),o+4},Buffer.prototype.writeInt32BE=function(e,o,s){return e=+e,o|=0,s||checkInt(this,e,o,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Buffer.TYPED_ARRAY_SUPPORT?(this[o]=e>>>24,this[o+1]=e>>>16,this[o+2]=e>>>8,this[o+3]=255&e):objectWriteUInt32(this,e,o,!1),o+4},Buffer.prototype.writeFloatLE=function(e,o,s){return writeFloat(this,e,o,!0,s)},Buffer.prototype.writeFloatBE=function(e,o,s){return writeFloat(this,e,o,!1,s)},Buffer.prototype.writeDoubleLE=function(e,o,s){return writeDouble(this,e,o,!0,s)},Buffer.prototype.writeDoubleBE=function(e,o,s){return writeDouble(this,e,o,!1,s)},Buffer.prototype.copy=function(e,o,s,h){if(s=s||0,h||h===0||(h=this.length),o>=e.length&&(o=e.length),o=o||0,0<h&&h<s&&(h=s),h===s||e.length===0||this.length===0)return 0;if(o<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("sourceStart out of bounds");if(h<0)throw new RangeError("sourceEnd out of bounds");h>this.length&&(h=this.length),e.length-o<h-s&&(h=e.length-o+s);var d,g=h-s;if(this===e&&s<o&&o<h)for(d=g-1;0<=d;--d)e[d+o]=this[d+s];else if(g<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(d=0;d<g;++d)e[d+o]=this[d+s];else Uint8Array.prototype.set.call(e,this.subarray(s,s+g),o);return g},Buffer.prototype.fill=function(e,o,s,h){if(typeof e=="string"){var d;if(typeof o=="string"?(h=o,o=0,s=this.length):typeof s=="string"&&(h=s,s=this.length),e.length!==1||(d=e.charCodeAt(0))<256&&(e=d),h!==void 0&&typeof h!="string")throw new TypeError("encoding must be a string");if(typeof h=="string"&&!Buffer.isEncoding(h))throw new TypeError("Unknown encoding: "+h)}else typeof e=="number"&&(e&=255);if(o<0||this.length<o||this.length<s)throw new RangeError("Out of range index");if(s<=o)return this;if(o>>>=0,s=s===void 0?this.length:s>>>0,typeof(e=e||0)=="number")for(j=o;j<s;++j)this[j]=e;else for(var g=internalIsBuffer(e)?e:utf8ToBytes(new Buffer(e,h).toString()),_=g.length,j=0;j<s-o;++j)this[j+o]=g[j%_];return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(e){if((e=stringtrim(e).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function stringtrim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,o){var s;o=o||1/0;for(var h=e.length,d=null,g=[],_=0;_<h;++_){if(55295<(s=e.charCodeAt(_))&&s<57344){if(!d){if(56319<s){-1<(o-=3)&&g.push(239,191,189);continue}if(_+1===h){-1<(o-=3)&&g.push(239,191,189);continue}d=s;continue}if(s<56320){-1<(o-=3)&&g.push(239,191,189),d=s;continue}s=65536+(d-55296<<10|s-56320)}else d&&-1<(o-=3)&&g.push(239,191,189);if(d=null,s<128){if(--o<0)break;g.push(s)}else if(s<2048){if((o-=2)<0)break;g.push(s>>6|192,63&s|128)}else if(s<65536){if((o-=3)<0)break;g.push(s>>12|224,s>>6&63|128,63&s|128)}else{if(!(s<1114112))throw new Error("Invalid code point");if((o-=4)<0)break;g.push(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}}return g}function asciiToBytes(e){for(var o=[],s=0;s<e.length;++s)o.push(255&e.charCodeAt(s));return o}function utf16leToBytes(e,o){for(var s,h,d,g=[],_=0;_<e.length&&!((o-=2)<0);++_)h=(s=e.charCodeAt(_))>>8,d=s%256,g.push(d),g.push(h);return g}function base64ToBytes(e){return toByteArray(base64clean(e))}function blitBuffer(e,o,s,h){for(var d=0;d<h&&!(d+s>=o.length||d>=e.length);++d)o[d+s]=e[d];return d}function isnan(e){return e!=e}function isBuffer(e){return e!=null&&(!!e._isBuffer||isFastBuffer(e)||isSlowBuffer(e))}function isFastBuffer(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&isFastBuffer(e.slice(0,0))}var bufferEs6=Object.freeze({INSPECT_MAX_BYTES,kMaxLength:_kMaxLength,Buffer,SlowBuffer,isBuffer});global$1.setTimeout,global$1.clearTimeout;var performance$1=global$1.performance||{};performance$1.now||performance$1.mozNow||performance$1.msNow||performance$1.oNow||performance$1.webkitNow;var inherits,inherits=typeof Object.create=="function"?function(e,o){e.super_=o,e.prototype=Object.create(o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,o){e.super_=o;function s(){}s.prototype=o.prototype,e.prototype=new s,e.prototype.constructor=e},inherits$1=inherits;function inspect(e,o){var s={seen:[],stylize:stylizeNoColor};return 3<=arguments.length&&(s.depth=arguments[2]),4<=arguments.length&&(s.colors=arguments[3]),isBoolean(o)?s.showHidden=o:o&&_extend(s,o),isUndefined(s.showHidden)&&(s.showHidden=!1),isUndefined(s.depth)&&(s.depth=2),isUndefined(s.colors)&&(s.colors=!1),isUndefined(s.customInspect)&&(s.customInspect=!0),s.colors&&(s.stylize=stylizeWithColor),formatValue(s,e,s.depth)}function stylizeWithColor(e,o){var s=inspect.styles[o];return s?"\x1B["+inspect.colors[s][0]+"m"+e+"\x1B["+inspect.colors[s][1]+"m":e}function stylizeNoColor(e,o){return e}function arrayToHash(e){var o={};return e.forEach(function(s,h){o[s]=!0}),o}function formatValue(e,o,s){if(e.customInspect&&o&&isFunction(o.inspect)&&o.inspect!==inspect&&(!o.constructor||o.constructor.prototype!==o)){var h=o.inspect(s,e);return isString(h)||(h=formatValue(e,h,s)),h}var d=formatPrimitive(e,o);if(d)return d;var g=Object.keys(o),_=arrayToHash(g);if(e.showHidden&&(g=Object.getOwnPropertyNames(o)),isError(o)&&(0<=g.indexOf("message")||0<=g.indexOf("description")))return formatError(o);if(g.length===0){if(isFunction(o)){var j=o.name?": "+o.name:"";return e.stylize("[Function"+j+"]","special")}if(isRegExp(o))return e.stylize(RegExp.prototype.toString.call(o),"regexp");if(isDate(o))return e.stylize(Date.prototype.toString.call(o),"date");if(isError(o))return formatError(o)}var $,_t="",_e=!1,_r=["{","}"];return isArray$1(o)&&(_e=!0,_r=["[","]"]),isFunction(o)&&(_t=" [Function"+(o.name?": "+o.name:"")+"]"),isRegExp(o)&&(_t=" "+RegExp.prototype.toString.call(o)),isDate(o)&&(_t=" "+Date.prototype.toUTCString.call(o)),isError(o)&&(_t=" "+formatError(o)),g.length!==0||_e&&o.length!=0?s<0?isRegExp(o)?e.stylize(RegExp.prototype.toString.call(o),"regexp"):e.stylize("[Object]","special"):(e.seen.push(o),$=_e?formatArray(e,o,s,_,g):g.map(function(_n){return formatProperty(e,o,s,_,_n,_e)}),e.seen.pop(),reduceToSingleString($,_t,_r)):_r[0]+_t+_r[1]}function formatPrimitive(e,o){if(isUndefined(o))return e.stylize("undefined","undefined");if(isString(o)){var s="'"+JSON.stringify(o).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(s,"string")}return isNumber(o)?e.stylize(""+o,"number"):isBoolean(o)?e.stylize(""+o,"boolean"):isNull(o)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,o,s,h,d){for(var g=[],_=0,j=o.length;_<j;++_)hasOwnProperty$1(o,String(_))?g.push(formatProperty(e,o,s,h,String(_),!0)):g.push("");return d.forEach(function($){$.match(/^\d+$/)||g.push(formatProperty(e,o,s,h,$,!0))}),g}function formatProperty(e,o,s,h,d,g){var _,j,$=Object.getOwnPropertyDescriptor(o,d)||{value:o[d]};if($.get?j=$.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):$.set&&(j=e.stylize("[Setter]","special")),hasOwnProperty$1(h,d)||(_="["+d+"]"),j||(e.seen.indexOf($.value)<0?-1<(j=isNull(s)?formatValue(e,$.value,null):formatValue(e,$.value,s-1)).indexOf(`
`)&&(j=g?j.split(`
`).map(function(_t){return"  "+_t}).join(`
`).substr(2):`
`+j.split(`
`).map(function(_t){return"   "+_t}).join(`
`)):j=e.stylize("[Circular]","special")),isUndefined(_)){if(g&&d.match(/^\d+$/))return j;_=(_=JSON.stringify(""+d)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(_=_.substr(1,_.length-2),e.stylize(_,"name")):(_=_.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e.stylize(_,"string"))}return _+": "+j}function reduceToSingleString(e,o,s){return 60<e.reduce(function(h,d){return d.indexOf(`
`),h+d.replace(/\u001b\[\d\d?m/g,"").length+1},0)?s[0]+(o===""?"":o+`
 `)+" "+e.join(`,
  `)+" "+s[1]:s[0]+o+" "+e.join(", ")+" "+s[1]}function isArray$1(e){return Array.isArray(e)}function isBoolean(e){return typeof e=="boolean"}function isNull(e){return e===null}function isNumber(e){return typeof e=="number"}function isString(e){return typeof e=="string"}function isUndefined(e){return e===void 0}function isRegExp(e){return isObject$1(e)&&objectToString$1(e)==="[object RegExp]"}function isObject$1(e){return typeof e=="object"&&e!==null}function isDate(e){return isObject$1(e)&&objectToString$1(e)==="[object Date]"}function isError(e){return isObject$1(e)&&(objectToString$1(e)==="[object Error]"||e instanceof Error)}function isFunction(e){return typeof e=="function"}function isPrimitive(e){return e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||typeof e=="symbol"||e===void 0}function objectToString$1(e){return Object.prototype.toString.call(e)}function _extend(e,o){if(!o||!isObject$1(o))return e;for(var s=Object.keys(o),h=s.length;h--;)e[s[h]]=o[s[h]];return e}function hasOwnProperty$1(e,o){return Object.prototype.hasOwnProperty.call(e,o)}function compare(e,o){if(e===o)return 0;for(var s=e.length,h=o.length,d=0,g=Math.min(s,h);d<g;++d)if(e[d]!==o[d]){s=e[d],h=o[d];break}return s<h?-1:h<s?1:0}inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var hasOwn=Object.prototype.hasOwnProperty,objectKeys$1=Object.keys||function(e){var o=[];for(var s in e)hasOwn.call(e,s)&&o.push(s);return o},pSlice=Array.prototype.slice,_functionsHaveNames;function functionsHaveNames(){return _functionsHaveNames!==void 0?_functionsHaveNames:_functionsHaveNames=(function(){}).name==="foo"}function pToString(e){return Object.prototype.toString.call(e)}function isView(e){if(!isBuffer(e)&&typeof global$1.ArrayBuffer=="function"){if(typeof ArrayBuffer.isView=="function")return ArrayBuffer.isView(e);if(e)return e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)}}function assert(e,o){e||fail(e,!0,o,"==",ok)}var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(e){if(isFunction(e)){if(functionsHaveNames())return e.name;var o=e.toString().match(regex);return o&&o[1]}}function AssertionError(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var o,s,h,d,g,_=e.stackStartFunction||fail;Error.captureStackTrace?Error.captureStackTrace(this,_):(o=new Error).stack&&(g=o.stack,s=getName(_),0<=(h=g.indexOf(`
`+s))&&(d=g.indexOf(`
`,h+1),g=g.substring(d+1)),this.stack=g)}function truncate(e,o){return typeof e!="string"||e.length<o?e:e.slice(0,o)}function inspect$1(e){if(functionsHaveNames()||!isFunction(e))return inspect(e);var o=getName(e);return"[Function"+(o?": "+o:"")+"]"}function getMessage(e){return truncate(inspect$1(e.actual),128)+" "+e.operator+" "+truncate(inspect$1(e.expected),128)}function fail(e,o,s,h,d){throw new AssertionError({message:s,actual:e,expected:o,operator:h,stackStartFunction:d})}function ok(e,o){e||fail(e,!0,o,"==",ok)}function equal(e,o,s){e!=o&&fail(e,o,s,"==",equal)}function notEqual(e,o,s){e==o&&fail(e,o,s,"!=",notEqual)}function deepEqual(e,o,s){_deepEqual(e,o,!1)||fail(e,o,s,"deepEqual",deepEqual)}function deepStrictEqual(e,o,s){_deepEqual(e,o,!0)||fail(e,o,s,"deepStrictEqual",deepStrictEqual)}function _deepEqual(e,o,s,h){if(e===o)return!0;if(isBuffer(e)&&isBuffer(o))return compare(e,o)===0;if(isDate(e)&&isDate(o))return e.getTime()===o.getTime();if(isRegExp(e)&&isRegExp(o))return e.source===o.source&&e.global===o.global&&e.multiline===o.multiline&&e.lastIndex===o.lastIndex&&e.ignoreCase===o.ignoreCase;if(e!==null&&typeof e=="object"||o!==null&&typeof o=="object"){if(isView(e)&&isView(o)&&pToString(e)===pToString(o)&&!(e instanceof Float32Array||e instanceof Float64Array))return compare(new Uint8Array(e.buffer),new Uint8Array(o.buffer))===0;if(isBuffer(e)!==isBuffer(o))return!1;var d=(h=h||{actual:[],expected:[]}).actual.indexOf(e);return d!==-1&&d===h.expected.indexOf(o)||(h.actual.push(e),h.expected.push(o),objEquiv(e,o,s,h))}return s?e===o:e==o}function isArguments(e){return Object.prototype.toString.call(e)=="[object Arguments]"}function objEquiv(e,o,s,h){if(e==null||o==null)return!1;if(isPrimitive(e)||isPrimitive(o))return e===o;if(s&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(o))return!1;var d=isArguments(e),g=isArguments(o);if(d&&!g||!d&&g)return!1;if(d)return _deepEqual(e=pSlice.call(e),o=pSlice.call(o),s);var _,j,$=objectKeys$1(e),_t=objectKeys$1(o);if($.length!==_t.length)return!1;for($.sort(),_t.sort(),j=$.length-1;0<=j;j--)if($[j]!==_t[j])return!1;for(j=$.length-1;0<=j;j--)if(!_deepEqual(e[_=$[j]],o[_],s,h))return!1;return!0}function notDeepEqual(e,o,s){_deepEqual(e,o,!1)&&fail(e,o,s,"notDeepEqual",notDeepEqual)}function notDeepStrictEqual(e,o,s){_deepEqual(e,o,!0)&&fail(e,o,s,"notDeepStrictEqual",notDeepStrictEqual)}function strictEqual(e,o,s){e!==o&&fail(e,o,s,"===",strictEqual)}function notStrictEqual(e,o,s){e===o&&fail(e,o,s,"!==",notStrictEqual)}function expectedException(e,o){if(e&&o){if(Object.prototype.toString.call(o)=="[object RegExp]")return o.test(e);try{if(e instanceof o)return 1}catch{}if(!Error.isPrototypeOf(o))return o.call({},e)===!0}}function _tryBlock(e){var o;try{e()}catch(s){o=s}return o}function _throws(e,o,s,h){var d;if(typeof o!="function")throw new TypeError('"block" argument must be a function');typeof s=="string"&&(h=s,s=null),d=_tryBlock(o),h=(s&&s.name?" ("+s.name+").":".")+(h?" "+h:"."),e&&!d&&fail(d,s,"Missing expected exception"+h);var g=typeof h=="string",_=!e&&d&&!s;if((!e&&isError(d)&&g&&expectedException(d,s)||_)&&fail(d,s,"Got unwanted exception"+h),e&&d&&s&&!expectedException(d,s)||!e&&d)throw d}function throws(e,o,s){_throws(!0,e,o,s)}function doesNotThrow(e,o,s){_throws(!1,e,o,s)}function ifError(e){if(e)throw e}assert.AssertionError=AssertionError,inherits$1(AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=equal,assert.notEqual=notEqual,assert.deepEqual=deepEqual,assert.deepStrictEqual=deepStrictEqual,assert.notDeepEqual=notDeepEqual,assert.notDeepStrictEqual=notDeepStrictEqual,assert.strictEqual=strictEqual,assert.notStrictEqual=notStrictEqual,assert.throws=throws,assert.doesNotThrow=doesNotThrow,assert.ifError=ifError;var sort=function(e){return e.sort(function(o,s){return o.height-s.height}),e},placeItems=function(e){var o=0;return e.forEach(function(s){s.x=0,s.y=o,o+=s.height}),e},topDown_algorithm={sort,placeItems},sort$1=function(e){return e.sort(function(o,s){return o.width-s.width}),e},placeItems$1=function(e){var o=0;return e.forEach(function(s){s.x=o,s.y=0,o+=s.width}),e},leftRight_algorithm={sort:sort$1,placeItems:placeItems$1},sort$2=function(e){return e.sort(function(o,s){return Math.sqrt(Math.pow(o.height,2)+Math.pow(o.width,2))-Math.sqrt(Math.pow(s.height,2)+Math.pow(s.width,2))}),e},placeItems$2=function(e){var o=0,s=0;return e.forEach(function(h){h.x=o,h.y=s,o+=h.width,s+=h.height}),e},diagonal_algorithm={sort:sort$2,placeItems:placeItems$2},sort$3=function(e){return e.sort(function(o,s){return Math.sqrt(Math.pow(o.height,2)+Math.pow(o.width,2))-Math.sqrt(Math.pow(s.height,2)+Math.pow(s.width,2))}),e},placeItems$3=function(e){var o=0,s=0;return e.forEach(function(h){var d=h.width;h.x=o-d,h.y=s,o-=d,s+=h.height}),e},altDiagonal_algorithm={sort:sort$3,placeItems:placeItems$3},GrowingPacker=function(){};GrowingPacker.prototype={fit:function(e){var o,s,h,d,g=e.length,_=0<g?e[0].width:0,j=0<g?e[0].height:0;for(this.root={x:0,y:0,width:_,height:j},o=0;o<g;o++)h=e[o],d=(s=this.findNode(this.root,h.width,h.height))?this.splitNode(s,h.width,h.height):this.growNode(h.width,h.height),h.x=d.x,h.y=d.y},findNode:function(e,o,s){return e.used?this.findNode(e.right,o,s)||this.findNode(e.down,o,s):o<=e.width&&s<=e.height?e:null},splitNode:function(e,o,s){return e.used=!0,e.down={x:e.x,y:e.y+s,width:e.width,height:e.height-s},e.right={x:e.x+o,y:e.y,width:e.width-o,height:s},e},growNode:function(e,o){var s=e<=this.root.width,h=o<=this.root.height,d=h&&this.root.height>=this.root.width+e,g=s&&this.root.width>=this.root.height+o;return d?this.growRight(e,o):g?this.growDown(e,o):h?this.growRight(e,o):s?this.growDown(e,o):null},growRight:function(e,o){var s;return this.root={used:!0,x:0,y:0,width:this.root.width+e,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:e,height:this.root.height}},(s=this.findNode(this.root,e,o))?this.splitNode(s,e,o):null},growDown:function(e,o){var s;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+o,down:{x:0,y:this.root.height,width:this.root.width,height:o},right:this.root},(s=this.findNode(this.root,e,o))?this.splitNode(s,e,o):null}};var packer_growing=GrowingPacker,binPack=function(e,o){o=o||{};var s=new packer_growing,h=o.inPlace||!1,d=(d=e.map(function(_){return h?_:{width:_.width,height:_.height,item:_}})).sort(function(_,j){return j.width*j.height-_.width*_.height});s.fit(d);var g={width:d.reduce(function(_,j){return Math.max(_,j.x+j.width)},0),height:d.reduce(function(_,j){return Math.max(_,j.y+j.height)},0)};return h||(g.items=d),g},sort$4=function(e){return e},placeItems$4=function(e){return binPack(e,{inPlace:!0}),e},binaryTree_algorithm={sort:sort$4,placeItems:placeItems$4},algorithms={};function Layout(e,o){var s=e||"top-down";return typeof s=="string"&&assert(s=algorithms[e],"Sorry, the '"+e+"' algorithm could not be loaded."),new packing_smith(s,o)}function addAlgorithm(e,o){algorithms[e]=o}Layout.PackingSmith=packing_smith,Layout.addAlgorithm=addAlgorithm,Layout.algorithms=algorithms,addAlgorithm("top-down",topDown_algorithm),addAlgorithm("left-right",leftRight_algorithm),addAlgorithm("diagonal",diagonal_algorithm),addAlgorithm("alt-diagonal",altDiagonal_algorithm),addAlgorithm("binary-tree",binaryTree_algorithm);var layout=Layout;function isTainting(e){var o;try{e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1)}catch(s){o=s.message}return o}function bitmapToCanvas(e,o,s){var h;return e instanceof HTMLImageElement&&((h=e.ownerDocument.createElement("canvas")).width=o,h.height=s,h.getContext("2d").drawImage(e,0,0,o,s),e=h),e}var MAX_LNG_LAT=Geo$1.metersToLatLng([Geo$1.half_circumference_meters,Geo$1.half_circumference_meters]),TILE_EXPONENT=Math.log(Geo$1.tile_size)/Math.LN2,ICON_READY=1,DOM_MARKER_TYPE=8,GROUP_TYPE=16,TILE_MARGIN=100,AFFECTED_BBOX_CALC_THRESHOLD=10,ObjectSource=function(){_inherits(o,MapsJsSource);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),d=e.call(this,s,h),Thread.is_worker&&(d._quad_tree=new ns.H.geo.QuadTree,d._marker_quad_tree=new ns.H.geo.QuadTree,d._tree_entries_by_object_id={},d._groups_by_id={},d._layersCache=new ns.H.util.Cache(100)),Thread.is_main&&(d._objects_by_id={},d._commands=[],d._sendCommands=debounce(d._sendCommands,100,200),d.dispatchUpdate=d.dispatchUpdate.bind(_assertThisInitialized(d))),d}return _createClass(o,[{key:"hasLabeledData",value:function(){return!1}},{key:"onReady",value:function(){this._synced_at=this.provider.getInvalidations().getMark();var s,h,d=this.provider.getRootGroup(),g=d.getObjects(!0),_=[];for(g.push(d),s=g.length;s--;)h=g[s],this._isObjectSupported(h)&&this._shouldBeStored(h)&&(this._objects_by_id[h.getId()]=h,_.push(h.forWorkerMessage()));var j=[{method_name:"addObjects",arguments:[_]}];this._sendImmediateCommands(j)}},{key:"onProviderUpdate",value:function(s){var h,d,g,_,j=s.target,$=s.currentTarget.getInvalidations(j.type);this._isObjectSupported(j)&&(h=this._synced_at,d=j.getId(),$.isRemove(h)?(delete this._objects_by_id[d],this._commands.push({method_name:"removeObjectsByIds",arguments:[[d],!0]})):$.isAdd(h)?this._shouldBeStored(j)&&(this._objects_by_id[d]=j,this._commands.push({method_name:"addObjects",arguments:[[j.forWorkerMessage()]]})):$.isSpatial(h)||$.isZOrder(h)?this._shouldBeStored(j)&&(g=[{method_name:"removeObjectsByIds",arguments:[[d],!0]},{method_name:"addObjects",arguments:[[(this._objects_by_id[d]=j).forWorkerMessage()]]}],this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands(g):this._commands.push(g[0],g[1])):$.isVisual(h)?this._shouldBeStored(j)&&(_={method_name:"updateObjectProperties",arguments:[(this._objects_by_id[d]=j).forWorkerMessage()]},this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands([_]):this._commands.push(_)):$.isVolatility(h)&&(delete this._objects_by_id[d],this._commands.push({method_name:"removeObjectsByIds",arguments:[[d],!0]}),this._shouldBeStored(j)&&(this._objects_by_id[d]=j,this._commands.push({method_name:"addObjects",arguments:[[j.forWorkerMessage()]]}))),this._commands.length&&this._sendCommands()),this._synced_at=$.getMark()}},{key:"_shouldBeStored",value:function(s){return s.type===GROUP_TYPE||(!s.getIcon||s.getIcon().getState()===ICON_READY)&&this._hasSameVolatility(s)}},{key:"_hasSameVolatility",value:function(s){return s.getVolatility(!0)===this.has_volatile_data}},{key:"hasPendingCommands",value:function(){return 0<this._commands.length}},{key:"_sendCommands",value:function(){this._sendImmediateCommands(this._commands),this._commands=[]}},{key:"_sendImmediateCommands",value:function(s){s.length&&WorkerBroker.postMessage(this.worker,this.target_name+".executeCommands",s).then(this.dispatchUpdate)}},{key:"_isObjectSupported",value:function(s){return s.forWorkerMessage&&s.type!==DOM_MARKER_TYPE}},{key:"getSyncedAt",value:function(){return this._synced_at}},{key:"getMapObjectById",value:function(s){return this._objects_by_id[s]}},{key:"getIconBitmapByObjectId",value:function(s,h){var d=this.getMapObjectById(s);if(d){var g=d.getIcon();if(g.uid===h&&g.getState()===ICON_READY){var _=g.getSize();return bitmapToCanvas(g.getBitmap(),_.w,_.h)}}}},{key:"_getRastersForMarkers",value:function(s){for(var h={},d=layout("binary-tree"),g=0;g<s.length;g++){var _=s[g],j=_.properties.icon;h[j.id]||(d.addItem({width:j.size.w,height:j.size.h,meta:{objectId:_.id,id:j.id}}),h[j.id]=!0)}return d.export()}},{key:"fetchFeaturesForTile",value:function(s){var h=[],d=[],g=[],_=[],j=[],$=this._marker_quad_tree.intersectBoundingBox(Geo$1.getTileBoundingBox(s.coords,this.tile_size));s.source_data.error=null;for(var _t=0;_t<$.length;_t++){var _e={id:$[_t].$feature$.id,properties:Object.assign({},$[_t].$feature$.properties),geometry:{type:$[_t].$feature$.geometry.type,coordinates:ArrayUtils$1.deepClone($[_t].$feature$.geometry.coordinates)}};h.push(_e)}$=this._quad_tree.intersectBoundingBox(Geo$1.getTileBoundingBox(s.coords,this.tile_size,TILE_MARGIN));for(var _r=0;_r<$.length;_r++){var _n,_o={id:$[_r].$feature$.id,properties:Object.assign({},$[_r].$feature$.properties),geometry:{type:$[_r].$feature$.geometry.type,coordinates:ArrayUtils$1.deepClone($[_r].$feature$.geometry.coordinates)}};_o.properties.overlay?d.push(_o):_o.geometry.type.includes("LineString")?g.push(_o):_o.geometry.type.includes("Polygon")&&(_.push(_o),_n={id:_o.id,properties:_o.properties,geometry:{type:_o.geometry.type,coordinates:ArrayUtils$1.deepClone(_o.geometry.coordinates)}},j.push(_n))}h.sort(o._compareZInfo),_.sort(o._compareZInfo),d.sort(o._compareZInfo);var ga=this.has_volatile_data?4096:0;j.sort(o._compareZInfo);for(var _l=0;_l<j.length;_l++)j[_l].properties.effectiveZIdx=ga++;g.sort(o._compareZInfo);for(var _f=0;_f<g.length;_f++)g[_f].properties.effectiveZIdx=ga++;s.source_data.layers.markers={type:"FeatureCollection",features:h},s.source_data.layers.polylines={type:"FeatureCollection",features:g},s.source_data.layers.polygons={type:"FeatureCollection",features:_},s.source_data.layers.outlines={type:"FeatureCollection",features:j},s.source_data.layers.overlays={type:"FeatureCollection",features:d}}},{key:"tileTexture",value:function(s){var h=s.source_data.layers.overlays;if(h){var d=this.name+"_"+s.coords.key,g=Tile.coordinateWithMaxZoom(s.coords,this.max_zoom),_=h.features[0].properties.overlays_config;return{name:d,filtering:this.filtering,coords:g,width:Geo$1.tile_size,height:Geo$1.tile_size,overlays_config:_,source:this.name}}}},{key:"_load",value:function(s){var h=Geo$1.wrapTile(s.coords,{x:!0}),d=h.z,g=h.x,_=h.y,j="".concat(d,"_").concat(g,"_").concat(_),$=this._layersCache.get(j),_t=!1;if($)s.source_data.layers=$;else{this.fetchFeaturesForTile(s);var _e={maxZoom:this.max_zoom,tolerance:1.5,extent:Geo$1.tile_scale},_r=s.source_data.layers.overlays;_r.features.length&&delete s.source_data.layers.overlays;var _n=s.source_data.layers.markers;for(var _o in _n.features.length&&delete s.source_data.layers.markers,s.source_data.layers){var ga,_l=s.source_data.layers[_o];_l.features.length&&(_e.buffer=_o.includes("lines")?TILE_MARGIN*Geo$1.units_per_pixel:0,ga=createGeoJsonTile(_l,d,g,_,_e),s.source_data.layers[_o]=parseGeoJSONVectorTile(ga))}s.source_data.layers.overlays=this._processOverlays(s,_r);for(var _f=s.source_data.layers.overlays.features.length;_f--;)if(!s.source_data.layers.overlays.features[_f].id){_t=!0,this._layersCache.drop(j);break}s.source_data.layers.markers=this._processMarkers(s,_n),this._postProcessTile(s),_t||this._layersCache.add(j,s.source_data.layers,1)}return s.rasters=this._getRastersForMarkers(s.source_data.layers.markers.features),Promise.resolve(s)}},{key:"_processMarkers",value:function(s,h){var d=h.features.length;if(d){for(var g=Geo$1.unitsPerMeter(s.coords.z),_=Geo$1.wrapTile(s.coords,{x:!0}),j=Geo$1.metersForTile(_),$=Geo$1.isLastTile(_),_t=Geo$1.wrapMeters(s.min),_e=Geo$1.wrapMeters(s.max),_r=function(_c){DataSource.coordsToMeters(_c);var _p=_slicedToArray(_c,2),_g=_p[0],ty=_p[1],oy=_g>=_t.x&&($.column||_g<_e.x)&&ty>=_e.y&&($.row||!s.coords.y||ty<_t.y);return DataSource.metersToTileUnits(g,j,_c),oy},_n=[],_o=0;_o<d;_o++){var ga,_l=h.features[_o].geometry,_f=!1;_l.type==="Point"?_r(ga=_l.coordinates)?_l.coordinates=ga:_f=!0:_l.type==="MultiPoint"&&(_l.coordinates=_l.coordinates.filter(_r),_l.coordinates.length===0&&(_f=!0)),_f||_n.push(h.features[_o])}h.features=_n}return h}},{key:"_processOverlays",value:function(s,h){var d=this;if(!h.features.length)return h;var g={coords:s.coords,min:Geo$1.metersForTile(Geo$1.wrapTile(s.coords,{x:!0}))},_={coords:s.coords,source_data:{layers:{_default:{type:"FeatureCollection",features:h.features}}}},j=Math.pow(2,s.coords.z+TILE_EXPONENT);MapsJsSource.projectData(_.source_data),MapsJsSource.scaleData(_.source_data,g);var $=h.features.map(function(_e){var _r=_e.geometry.coordinates[0],_n=_r[0],_o=_r[_r.length===5?2:3],ga=Math.floor(_n[0]/Geo$1.tile_scale*Geo$1.tile_size),_l=Math.floor(_n[1]/Geo$1.tile_scale*Geo$1.tile_size),_f=Math.floor(_o[0]/Geo$1.tile_scale*Geo$1.tile_size),_c=Math.floor(_o[1]/Geo$1.tile_scale*Geo$1.tile_size)-_l,_p=_f<=ga,_g=_p?j-(ga-_f):_f-ga,ty=[];return ga<=Geo$1.tile_size&&ty.push([ga,_l,_g,_c]),_p&&0<_f&&ty.push([ga-j,_l,_g,_c]),{id:_e.id,properties:_e.properties,texcoords:ty}}).filter(function(_e){return d._isVisible(_e.properties)&&d.isInMinMaxRange(_e.properties,s.style_zoom)}),_t=Geo$1.tile_scale;return s.pad_scale=this.pad_scale,s.default_winding="CW",h.features=$.length?[{geometry:{type:"Polygon",coordinates:[[[0,0],[_t,0],[_t,_t],[0,_t],[0,0]]]},properties:{overlays_config:$}}]:$,h}},{key:"executeCommands",value:function(s){for(var h,d=s.length<AFFECTED_BBOX_CALC_THRESHOLD,g=0;g<s.length;g++){var _=s[g];_.arguments.push(d);var j=this[_.method_name].apply(this,_.arguments);d&&(j&&h?h.mergeRect(j,!0,h):j&&(h=j))}return h?h.forWorkerMessage():void 0}},{key:"_getClampedGeoRectForFeature",value:function(s){var h=s.geometry.boundingBox;return new ns.H.geo.Rect(MathUtils$1.clamp(h[0],-MAX_LNG_LAT[1],MAX_LNG_LAT[1]),h[1],MathUtils$1.clamp(h[2],-MAX_LNG_LAT[1],MAX_LNG_LAT[1]),h[3])}},{key:"addObjects",value:function(s,h){for(var d,g=1<arguments.length&&h!==void 0&&h,_=0;_<s.length;_++){var j,$,_t,_e=s[_];_e.type==="Group"?(_e.$children_ids$={},this._groups_by_id[_e.id]=_e):(o._preprocessGeometry(_e.geometry),j=this._getClampedGeoRectForFeature(_e),g&&(d?d.mergeRect(j,!0,d):d=j),(_t=($=_e.geometry.type.indexOf("Point")!==-1?this._marker_quad_tree:this._quad_tree).insertBoundingBox(j)).$tree=$,_t.$feature$=_e,this._tree_entries_by_object_id[_e.id]=_t)}for(var _r=0;_r<s.length;_r++){var _n=s[_r];_n.properties.parent&&(this._groups_by_id[_n.properties.parent].$children_ids$[_n.id]=_n.id),_n.properties.ref={effectiveVisibility:this._isVisible(_n.properties),zInfo:this._getZInfo([],_n)}}return this._layersCache.removeAll(),d}},{key:"removeObjectsByIds",value:function(s,h,d){for(var g,_=2<arguments.length&&d!==void 0&&d,j=0;j<s.length;j++){var $,_t=s[j],_e=void 0,_r=void 0;(_e=this._tree_entries_by_object_id[_t])?(_&&($=this._getClampedGeoRectForFeature(_e.$feature$),g?g.mergeRect($,!0,g):g=$),delete this._groups_by_id[_e.$feature$.properties.parent].$children_ids$[_t],_e.$tree.remove(_e),delete this._tree_entries_by_object_id[_t]):(_r=this._groups_by_id[_t])&&(_r.properties.parent&&delete this._groups_by_id[_r.properties.parent].$children_ids$[_t],h&&this.removeObjectsByIds(Object.keys(_r.$children_ids$),!0),delete this._groups_by_id[_t])}return this._layersCache.removeAll(),g}},{key:"updateObjectProperties",value:function(s,h){var d,g=1<arguments.length&&h!==void 0&&h;return s.type==="Group"?(mergeObjects(this._groups_by_id[s.id].properties,s.properties),this._groups_by_id[s.id].properties.ref.effectiveVisibility=this._isVisible(s.properties)):(this._tree_entries_by_object_id[s.id]||this.addObjects([s]),mergeObjects(this._tree_entries_by_object_id[s.id].$feature$.properties,s.properties),this._tree_entries_by_object_id[s.id].$feature$.properties.ref.effectiveVisibility=this._isVisible(s.properties),g&&(d=this._getClampedGeoRectForFeature(s))),d}},{key:"_getZInfo",value:function(s,h){var d=h.properties.zIdx,g=h.properties.sIdx;return s[0]|=d!==void 0,s.splice(1,0,d||0,g<0?h.id:g),h.properties.parent===0?s:this._getZInfo(s,this._groups_by_id[h.properties.parent])}},{key:"_isVisible",value:function(s){var h=s.visible,d=!s.parent||this._isVisible(this._groups_by_id[s.parent].properties);return h&&d}},{key:"isInMinMaxRange",value:function(s,h){var d=s.min<=h&&s.max>=h,g=!s.parent||this.isInMinMaxRange(this._groups_by_id[s.parent].properties,h);return d&&g}},{key:"dispose",value:function(){this._commands=[],_get(_getPrototypeOf(o.prototype),"dispose",this).call(this)}}],[{key:"_compareZInfo",value:function(s,h){for(var d,g=s.properties.ref.zInfo,_=h.properties.ref.zInfo,j=g.length,$=_.length,_t=Math.min(j,$),_e=1;_e<_t;_e++)if(d=g[_e]-_[_e])return d;return j-$}},{key:"_preprocessGeometry",value:function(s){var h=s.type;s.coordinates=h==="Point"?o._processPointCoordinates(s.coordinates):h==="MultiPoint"?s.coordinates.map(o._processPointCoordinates):h==="LineString"?o._processLineStringCoordinates(s.coordinates):h==="MultiLineString"?s.coordinates.map(o._processLineStringCoordinates):h==="Polygon"?s.coordinates.map(o._processPolygonCoordinates):h==="MultiPolygon"?s.coordinates.map(o._processMultiPolygonCoordinates):[]}},{key:"_processPointCoordinates",value:function(s){return[s[1],s[0],s[2]]}},{key:"_processLineStringCoordinates",value:function(s){return o._latLngAltArrayToLineString(s,!1)}},{key:"_processPolygonCoordinates",value:function(s){return o._latLngAltArrayToLineString(s,!0)}},{key:"_processMultiPolygonCoordinates",value:function(s){return s.map(o._processPolygonCoordinates)}},{key:"_latLngAltArrayToLineString",value:function(s,h){for(var d=[],g=s.length,_=0;_<g;_+=3)d.push([s[_+1],s[_]]);return h&&d.push([s[1],s[0]]),d}}]),o}();MapsJsSource.register(ObjectSource,"ObjectSource");var GEOMETRY_TYPE={POLYGON:1,POLYLINE:2,OUTLINE:3},IconMap=function(){function e(){_classCallCheck(this,e),this._map={}}return _createClass(e,[{key:"set",value:function(o,s,h){var d;this._map[o]?this._map[o].accumulator.add(h):((d=new Set).add(h),this._map[o]={value:s,accumulator:d})}},{key:"get",value:function(o){return this._map[o]&&this._map[o].value}},{key:"delete",value:function(o,s){var h=this._map[o];h&&h.accumulator&&(h.accumulator.delete(s),h.accumulator.size===0&&delete this._map[o])}}]),e}(),ObjectTileSource=function(){_inherits(o,MapsJsSource);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),d=e.call(this,s,h),Thread.is_worker||(d._icons=new IconMap),d}return _createClass(o,[{key:"onProviderUpdate",value:function(s){s.target instanceof H.map.provider.Tile?this.dispatchUpdate(s.target,s.data):this.dispatchUpdate(void 0,s.data)}},{key:"onReady",value:function(){var s=this.provider;s.setTileCanvasRendering&&s.setTileCanvasRendering(!1),s.providesMarkers()&&(this._onCacheDrop=this._onCacheDrop.bind(this),s.getCache().registerOnDrop(this._onCacheDrop)),this.dispatchUpdate()}},{key:"dispose",value:function(){_get(_getPrototypeOf(o.prototype),"dispose",this).call(this);var s=this.provider;s.providesMarkers()&&s.getCache().deRegisterOnDrop(this._onCacheDrop)}},{key:"_onCacheDrop",value:function(s,h){this.provider.cacheFilter(s)&&this._deleteIcons(s,h.data)}},{key:"_deleteIcons",value:function(s,h){for(var d=0,g=h.length;d<g;d++){var _=h[d].getIcon();this._icons.delete(_.uid,s)}}},{key:"getIconBitmapByObjectId",value:function(s,h){var d=this._icons.get(h);return d&&d.getBitmap()}},{key:"requestMarkerTile",value:function(s){var h=this;return new Promise(function(d,g){h.provider?h.provider.requestTileAsPromise(s.x,s.y,s.z,!1).then(function(_){var j,$,_t=[];if(_.data)for($=(j=_.data).length;$--;){var _e=j[$],_r=_e.getIcon();h._icons.set(_r.uid,_r,_.key),_t.push(_e.forWorkerMessage())}d(_t)}):d([])})}},{key:"requestSpatialTile",value:function(s){var h=this;return new Promise(function(d,g){h.provider?h.provider.requestTileAsPromise(s.x,s.y,s.z,!1).then(function(_){var j,$=[];if(_.getObjects){j=_.getObjects();for(var _t=0;_t<j.length;_t++){var _e=j[_t];$.push({id:_e.getId(),geometries:_e.getGeometriesForTile(_),isClosed:_e.isClosed(),style:_e.getStyle().forWorkerMessage()})}}d($)}):d([])})}},{key:"_pointToArray",value:function(s){var h=Geo$1.tile_scale/this.tile_size;return[s.x*h,s.y*h]}},{key:"_getGeoJsonMultiPolygon",value:function(s){for(var h=s.geometries,d=h.length,g=[],_={coordinates:g,type:"MultiPolygon"},j=0;j<d;j++){for(var $=h[j],_t=$.paths,_e=_t.length,_r=$.interiorsIndex,_n=$.outlinesIndex,_o=Math.min(_r,_n,_e),ga=void 0,_l=void 0,_l=0;_l<_o;_l++)ga=[_t[_l].map(this._pointToArray,this)],g.push(ga);if(_o===1)for(_o=Math.min(_n,_e),_l=_r;_l<_o;_l++)ga.push(_t[_l].map(this._pointToArray,this))}return _}},{key:"_getGeoJsonMultiLineString",value:function(s,h){for(var d=1<arguments.length&&h!==void 0&&h,g={coordinates:[],type:"MultiLineString"},_=s.geometries,j=0;j<_.length;j++)for(var $=_[j],_t=d?$.outlinesIndex:0,_e=d?$.paths.length:Math.min($.interiorsIndex,$.outlinesIndex,$.paths.length),_r=_t;_r<_e;_r++){var _n=$.paths[_r].map(this._pointToArray,this);g.coordinates.push(_n)}return g}},{key:"_getGeoJsonGeometry",value:function(s,h){var d=h===GEOMETRY_TYPE.POLYGON?this._getGeoJsonMultiPolygon(s):this._getGeoJsonMultiLineString(s,h===GEOMETRY_TYPE.OUTLINE);return d.coordinates.length?d:null}},{key:"_load",value:function(s){var h=this;return new Promise(function(d,g){var _=WorkerBroker.postMessage(h.target_name+".requestMarkerTile",s.coords).then(h._prepareTileData.bind(h,s)),j=new Promise(function($,_t){WorkerBroker.postMessage(h.target_name+".requestSpatialTile",s.coords).then(function(_e){for(var _r=[],_n=[],_o=[],ga=0;ga<_e.length;ga++){var _l,_f=_e[ga],_c=void 0,_p=void 0,_p=_f.isClosed?(_c=_n,GEOMETRY_TYPE.POLYGON):(_c=_r,GEOMETRY_TYPE.POLYLINE),_g=h._getGeoJsonGeometry(_f,_p);_g&&(_l={id:_f.id,type:"Feature",properties:{height:0,style:_f.style},geometry:_g},_p===GEOMETRY_TYPE.POLYLINE&&(_l.properties.effectiveZIdx=_r.length),_c.push(_l));var ty=h._getGeoJsonGeometry(_f,GEOMETRY_TYPE.OUTLINE);ty&&_o.push({id:_f.id,type:"Feature",properties:{height:0,style:_f.style,effectiveZIdx:_o.length},geometry:ty})}s.source_data.layers.polylines={type:"FeatureCollection",features:_r},s.source_data.layers.polygons={type:"FeatureCollection",features:_n},s.source_data.layers.outlines={type:"FeatureCollection",features:_o},$(s)})});Promise.all([_,j]).then(function($){h._postProcessTile(s),d(s)})})}},{key:"_prepareTileData",value:function(s,h){var d=Geo$1.wrapTile(s.coords,{x:!0,y:!0}),g=Geo$1.metersForTile(d);s.source_data.layers={markers:{features:h,type:"FeatureCollection"}};var _={coords:d,min:g},j=s.source_data,$=layout("binary-tree"),_t={};for(var _e in j.layers)for(var _r=j.layers[_e].features.length,_n=0;_n<_r;_n++){var _o=j.layers[_e].features[_n],ga=_o.properties.icon;_t[ga.id]||($.addItem({width:ga.size.w,height:ga.size.h,meta:{objectId:_o.id,id:ga.id}}),_t[ga.id]=!0),Geo$1.transformGeometry(_o.geometry,function(_l){var _f=_l[0];_l[0]=_l[1],_l[1]=_f})}return s.rasters=$.export(),MapsJsSource.projectData(s.source_data),MapsJsSource.scaleData(s.source_data,_),s}}]),o}();MapsJsSource.register(ObjectTileSource,"ObjectTileSource");var RemoteRasterTileSource=function(){_inherits(o,RasterTileSource);var e=_createSuper(o);function o(s,h){var d;return _classCallCheck(this,o),(d=e.call(this,s,h)).uid_=s.uid,d}return _createClass(o,[{key:"initialize",value:function(s,h){this.provider=s,this._on_update=h,this._onProviderUpdate=this._onProviderUpdate.bind(this),s.addEventListener("update",this._onProviderUpdate)}},{key:"_onProviderUpdate",value:function(){this._on_update(this.name)}},{key:"tileTexture",value:function(s){return Object.assign(_get(_getPrototypeOf(o.prototype),"tileTexture",this).call(this,s),{uid:this.uid_,url:this.uid_+"_"+s.coords.key,coords:s.coords})}},{key:"dispose",value:function(){this.provider.removeEventListener("update",this._onProviderUpdate)}}]),o}();function geojsonvt(e,o){return new GeoJSONVT(e,o)}function GeoJSONVT(e,o){var s=(o=this.options=extend(Object.create(this.options),o)).debug;if(s&&console.time("preprocess data"),o.maxZoom<0||24<o.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(o.promoteId&&o.generateId)throw new Error("promoteId and generateId cannot be used together.");var h=convert(e,o);this.tiles={},this.tileCoords=[],s&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",o.indexMaxZoom,o.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(h=wrap(h,o)).length&&this.splitTile(h,0,0,0),s&&(h.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function toID(e,o,s){return 32*((1<<e)*s+o)+e}function extend(e,o){for(var s in o)e[s]=o[s];return e}DataSource.register(RemoteRasterTileSource,"RemoteRasterTileSource"),GeoJSONVT.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},GeoJSONVT.prototype.splitTile=function(e,o,s,h,d,g,_){for(var j=[e,o,s,h],$=this.options,_t=$.debug;j.length;){h=j.pop(),s=j.pop(),o=j.pop(),e=j.pop();var _e,_r,_n,_o,ga,_l,_f,_c,_p,_g,ty,oy=1<<o,ry=toID(o,s,h),ly=this.tiles[ry];if(ly||(1<_t&&console.time("creation"),ly=this.tiles[ry]=createTile(e,o,s,h,$),this.tileCoords.push({z:o,x:s,y:h}),_t&&(1<_t&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",o,s,h,ly.numFeatures,ly.numPoints,ly.numSimplified),console.timeEnd("creation")),_e="z"+o,this.stats[_e]=(this.stats[_e]||0)+1,this.total++)),ly.source=e,d){if(o===$.maxZoom||o===d)continue;var py=1<<d-o;if(s!==Math.floor(g/py)||h!==Math.floor(_/py))continue}else if(o===$.indexMaxZoom||ly.numPoints<=$.indexMaxPoints)continue;ly.source=null,e.length!==0&&(1<_t&&console.time("clipping"),_n=.5-(_r=.5*$.buffer/$.extent),ga=1+_r,_p=_l=_f=_c=null,_g=clip(e,oy,s-_r,s+(_o=.5+_r),0,ly.minX,ly.maxX,$),ty=clip(e,oy,s+_n,s+ga,0,ly.minX,ly.maxX,$),e=null,_g&&(_p=clip(_g,oy,h-_r,h+_o,1,ly.minY,ly.maxY,$),_l=clip(_g,oy,h+_n,h+ga,1,ly.minY,ly.maxY,$),_g=null),ty&&(_f=clip(ty,oy,h-_r,h+_o,1,ly.minY,ly.maxY,$),_c=clip(ty,oy,h+_n,h+ga,1,ly.minY,ly.maxY,$),ty=null),1<_t&&console.timeEnd("clipping"),j.push(_p||[],o+1,2*s,2*h),j.push(_l||[],o+1,2*s,2*h+1),j.push(_f||[],o+1,2*s+1,2*h),j.push(_c||[],o+1,2*s+1,2*h+1))}},GeoJSONVT.prototype.getTile=function(e,o,s){var h=this.options,d=h.extent,g=h.debug;if(e<0||24<e)return null;var _=1<<e,j=toID(e,o=(o%_+_)%_,s);if(this.tiles[j])return transformTile(this.tiles[j],d);1<g&&console.log("drilling down to z%d-%d-%d",e,o,s);for(var $,_t=e,_e=o,_r=s;!$&&0<_t;)_t--,_e=Math.floor(_e/2),_r=Math.floor(_r/2),$=this.tiles[toID(_t,_e,_r)];return $&&$.source?(1<g&&console.log("found parent tile z%d-%d-%d",_t,_e,_r),1<g&&console.time("drilling down"),this.splitTile($.source,_t,_e,_r,e,o,s),1<g&&console.timeEnd("drilling down"),this.tiles[j]?transformTile(this.tiles[j],d):null):null};var EMPTY_FEATURE_COLLECTION$1={type:"FeatureCollection",features:[]},GeoJSONTileSource=function(){_inherits(o,MapsJsSource);var e=_createSuper(o);function o(s,h){return _classCallCheck(this,o),s.tiled=!0,s.url="",e.call(this,s,h)}return _createClass(o,[{key:"fetchTile",value:function(s,h,d){return this.provider?this.provider.requestTileAsPromise(s,h,d).then(function(g){return g.data}):Promise.resolve(EMPTY_FEATURE_COLLECTION$1)}},{key:"_load",value:function(s){var h=this,d=Geo$1.wrapTile(s.coords,{x:!0,y:!0}),g={indexMaxZoom:0,maxZoom:this.max_zoom,tolerance:1.5,extent:Geo$1.tile_scale};return WorkerBroker.postMessage(this.target_name+".fetchTile",d.x,d.y,d.z).then(function(_){for(var j in s.source_data.layers=_.type==="FeatureCollection"?{_default:_}:_,s.source_data.layers){var $=geojsonvt(s.source_data.layers[j],g).getTile(d.z,d.x,d.y);s.source_data.layers[j]=parseGeoJSONVectorTile($)}return h._postProcessTile(s),s})}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),o}();DataSource.register(GeoJSONTileSource,"GeoJSONTileSource");var DEFAULT_RESPONSE={layers:{_default:{type:"FeatureCollection",features:[{type:"Point",geometry:{}}]}}},SkyBoxSource=function(){_inherits(o,DataSource);var e=_createSuper(o);function o(s,h){return _classCallCheck(this,o),s.max_zoom=0,e.call(this,s,h)}return _createClass(o,[{key:"load",value:function(s){return s.source_data=s.coords.key==="0/0/0"?DEFAULT_RESPONSE:void 0,Promise.resolve(s)}}]),o}(),debugSettings;DataSource.register(SkyBoxSource,"SkyBox");var debugSettings$1=debugSettings={draw_label_collision_boxes:!1,draw_label_texture_boxes:!1,suppress_label_fade_in:!1,suppress_snap_animation:!1,show_hidden_labels:!1,layer_stats:!1};function mergeDebugSettings(e){Object.assign(debugSettings,e)}var WorkerType={NATIVE:0,FAKE:1},Context;function sliceObject(e,o){var s={};return o.forEach(function(h){return s[h]=e[h]}),s}var Context$1=Context={},context_id=0,gl;Context.getContext=function(e,o){var s=!1;e==null&&((e=document.createElement("canvas")).style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=-1,document.body.appendChild(e),s=!0);var h=e.getContext("webgl",o)||e.getContext("experimental-webgl",o);if(!h)throw new Error("Couldn't create WebGL context.");return h._tangram_id=context_id++,s?(Context.resize(h,window.innerWidth,window.innerHeight,o.device_pixel_ratio),window.addEventListener("resize",function(){Context.resize(h,window.innerWidth,window.innerHeight,o.device_pixel_ratio)})):Context.resize(h,parseFloat(e.style.width),parseFloat(e.style.height),o.device_pixel_ratio),h},Context.resize=function(e,o,s,h){e.canvas.style.width=o+"px",e.canvas.style.height=s+"px",e.canvas.width=Math.round(o*h),e.canvas.height=Math.round(s*h),e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.canvas.width,e.canvas.height)};var gl$1=gl={};gl.BYTE=5120,gl.UNSIGNED_BYTE=5121,gl.SHORT=5122,gl.UNSIGNED_SHORT=5123,gl.INT=5124,gl.UNSIGNED_INT=5125,gl.FLOAT=5126;var MAX_VALUE$1=Math.pow(2,16)-1,DEFAULT_SIZE=1024,HAS_ELEMENT_INDEX_UINT=!1,VertexElements=function(){function e(o){_classCallCheck(this,e),this.size_=o||DEFAULT_SIZE,this.position_=0,this.ArrayType_=Uint16Array,this.buffer_=new this.ArrayType_(this.size_),this.overflows_=!1}return _createClass(e,[{key:"push",value:function(o){if(!this.overflows_||HAS_ELEMENT_INDEX_UINT){if(MAX_VALUE$1<o){if(this.overflows_=!0,!HAS_ELEMENT_INDEX_UINT)return;this.ArrayType_===Uint16Array&&(this.ArrayType_=Uint32Array,this.buffer_=new this.ArrayType_(this.buffer_))}this.position_===this.size_&&this.expand_(),this.buffer_[this.position_]=o,this.position_+=1}}},{key:"end",value:function(){if(this.position_===0)return!1;var o=this.buffer_,s=this.position_;return this.buffer_=new this.ArrayType_(this.size_),this.position_=0,this.overflows_=!1,o.subarray(0,s)}},{key:"expand_",value:function(){this.size_=this.size_<<1;var o=new this.ArrayType_(this.size_);o.set(this.buffer_),this.buffer_=o}}]),e}(),_array_types;VertexElements.setElementIndexUint=function(e){HAS_ELEMENT_INDEX_UINT=e};var array_types=(_array_types={},_defineProperty(_array_types,gl$1.FLOAT,Float32Array),_defineProperty(_array_types,gl$1.BYTE,Int8Array),_defineProperty(_array_types,gl$1.UNSIGNED_BYTE,Uint8Array),_defineProperty(_array_types,gl$1.INT,Int32Array),_defineProperty(_array_types,gl$1.UNSIGNED_INT,Uint32Array),_defineProperty(_array_types,gl$1.SHORT,Int16Array),_defineProperty(_array_types,gl$1.UNSIGNED_SHORT,Uint16Array),_array_types),VertexData=function(){function e(o){var s=(1<arguments.length&&arguments[1]!==void 0?arguments[1]:{}).prealloc,h=s===void 0?500:s;_classCallCheck(this,e),this.vertex_layout=o,this.vertex_elements=new VertexElements,this.stride=this.vertex_layout.stride,0<e.array_pool.length?(this.vertex_buffer=e.array_pool.pop(),this.byte_length=this.vertex_buffer.byteLength,this.size=Math.floor(this.byte_length/this.stride),log("trace","VertexData: reused buffer of bytes ".concat(this.byte_length,", ").concat(this.size," vertices"))):(this.size=h,this.byte_length=this.stride*this.size,this.vertex_buffer=new Uint8Array(this.byte_length)),this.offset=0,this.vertex_count=0,this.realloc_count=0,this.setBufferViews(),this.setAddVertexFunction()}return _createClass(e,[{key:"setBufferViews",value:function(){var o=this;this.views={},this.views[gl$1.UNSIGNED_BYTE]=this.vertex_buffer,this.vertex_layout.dynamic_attribs.forEach(function(s){var h;o.views[s.type]==null&&(h=array_types[s.type],o.views[s.type]=new h(o.vertex_buffer.buffer))})}},{key:"checkBufferSize",value:function(){var o;this.offset+this.stride>this.byte_length&&(this.size=Math.floor(1.5*this.size),this.size-=this.size%4,this.byte_length=this.stride*this.size,(o=new Uint8Array(this.byte_length)).set(this.vertex_buffer),e.array_pool.push(this.vertex_buffer),this.vertex_buffer=o,this.setBufferViews(),this.realloc_count++)}},{key:"setAddVertexFunction",value:function(){this.vertexLayoutAddVertex=this.vertex_layout.getAddVertexFunction()}},{key:"addVertex",value:function(o){this.checkBufferSize(),this.vertexLayoutAddVertex(o,this.views,this.offset),this.offset+=this.stride,this.vertex_count++}},{key:"end",value:function(){return this.vertex_buffer=this.vertex_buffer.subarray(0,this.offset),this.element_buffer=this.vertex_elements.end(),log("trace","VertexData: ".concat(this.size," vertices total, realloc count ").concat(this.realloc_count)),this}}]),e}();VertexData.array_pool=[];var VertexLayout=function(){function e(o){_classCallCheck(this,e),this.attribs=o,this.dynamic_attribs=this.attribs.filter(function(_t){return!_t.static}),this.components=[],this.index={},this.offset={};for(var s=this.stride=0,h=0,d=0;d<this.attribs.length;d++){var g=this.attribs[d];if(g.static==null){g.offset=this.stride,g.byte_size=g.size;var _=0;switch(g.type){case gl$1.FLOAT:case gl$1.INT:case gl$1.UNSIGNED_INT:g.byte_size*=4,_=2;break;case gl$1.SHORT:case gl$1.UNSIGNED_SHORT:g.byte_size*=2,_=1}3&g.byte_size&&(g.byte_size+=4-(3&g.byte_size)),this.stride+=g.byte_size;for(var j=g.offset>>_,$=0;$<g.size;$++)this.components.push({type:g.type,shift:_,offset:j++,index:h++});this.index[g.name]=s,s+=g.size,this.offset[g.name]=g.offset}else g.static=Array.isArray(g.static)?g.static:[g.static],g.method="vertexAttrib".concat(g.static.length,"fv")}}return _createClass(e,[{key:"enable",value:function(o,s,h){for(var d,g,_=0;_<this.attribs.length;_++)d=this.attribs[_],(g=s.attribute(d.name).location)!==-1&&(d.static==null?(e.enabled_attribs[g]&&!h||o.enableVertexAttribArray(g),o.vertexAttribPointer(g,d.size,d.type,d.normalized,this.stride,d.offset),e.enabled_attribs[g]=s):o[d.method]instanceof Function&&(o.enableVertexAttribArray(g),o[d.method](g,d.static),o.disableVertexAttribArray(g),delete e.enabled_attribs[g]));for(g in e.enabled_attribs)this.disableUnusedAttribute(o,g,s)}},{key:"disableUnusedAttribute",value:function(o,s,h){e.enabled_attribs[s]!==h&&(o.disableVertexAttribArray(s),delete e.enabled_attribs[s])}},{key:"createVertexData",value:function(){return new VertexData(this)}},{key:"getAddVertexFunction",value:function(){return this.addVertex==null&&this.createAddVertexFunction(),this.addVertex}},{key:"createAddVertexFunction",value:function(){var o=hashString(JSON.stringify(this.attribs));if(e.add_vertex_funcs[o]==null){var s,h=["var t, o;"],d=_toConsumableArray(this.components);d.sort(function($,_t){return $.type!==_t.type?$.type-_t.type:$.index-_t.index});for(var g=0;g<d.length;g++){var _=d[g];s!==_.type&&(h.push("t = vs[".concat(_.type,"];")),h.push("o = off".concat(_.shift?" >> "+_.shift:"",";")),s=_.type),h.push("t[o + ".concat(_.offset,"] = v[").concat(_.index,"];"))}h=h.join(`
`);var j=new Function("v","vs","off",h);e.add_vertex_funcs[o]=j}this.addVertex=e.add_vertex_funcs[o]}}]),e}();VertexLayout.enabled_attribs={},VertexLayout.add_vertex_funcs={};var tile_bounds=[{x:0,y:0},{x:Geo$1.tile_scale,y:-Geo$1.tile_scale}],default_uvs=[0,0,1,1];function outsideTile(e,o,s){var h=tile_bounds[0],d=tile_bounds[1];return e[0]<=h.x+s&&o[0]<=h.x+s||e[0]>=d.x-s&&o[0]>=d.x-s||e[1]>=h.y-s&&o[1]>=h.y-s||e[1]<=d.y+s&&o[1]<=d.y+s}function isCoordOutsideTile(e,o){o=o||0;var s=tile_bounds[0],h=tile_bounds[1];return e[0]<=s.x+o||e[0]>=h.x-o||e[1]>=s.y-o||e[1]<=h.y+o}var earcut_1=earcut;function earcut(e,o,s){s=s||2;var h,d,g,_,j,$,_t,_e=o&&o.length,_r=_e?o[0]*s:e.length,_n=linkedList(e,0,_r,s,!0),_o=[];if(!_n)return _o;if(_e&&(_n=eliminateHoles(e,o,_n,s)),e.length>80*s){h=g=e[0],d=_=e[1];for(var ga=s;ga<_r;ga+=s)(j=e[ga])<h&&(h=j),($=e[ga+1])<d&&(d=$),g<j&&(g=j),_<$&&(_=$);_t=Math.max(g-h,_-d)}return earcutLinked(_n,_o,s,h,d,_t),_o}function linkedList(e,o,s,h,d){var g,_;if(d===0<signedArea$1(e,o,s,h))for(g=o;g<s;g+=h)_=insertNode(g,e[g],e[g+1],_);else for(g=s-h;o<=g;g-=h)_=insertNode(g,e[g],e[g+1],_);return _&&equals(_,_.next)&&(removeNode(_),_=_.next),_}function filterPoints(e,o){if(!e)return e;o=o||e;var s,h=e;do if(s=!1,h.steiner||!equals(h,h.next)&&area(h.prev,h,h.next)!==0)h=h.next;else{if(removeNode(h),(h=o=h.prev)===h.next)return null;s=!0}while(s||h!==o);return o}function earcutLinked(e,o,s,h,d,g,_){if(e){!_&&g&&indexCurve(e,h,d,g);for(var j,$,_t=e;e.prev!==e.next;)if(j=e.prev,$=e.next,g?isEarHashed(e,h,d,g):isEar(e))o.push(j.i/s),o.push(e.i/s),o.push($.i/s),removeNode(e),e=$.next,_t=$.next;else if((e=$)===_t){_?_===1?earcutLinked(e=cureLocalIntersections(e,o,s),o,s,h,d,g,2):_===2&&splitEarcut(e,o,s,h,d,g):earcutLinked(filterPoints(e),o,s,h,d,g,1);break}}}function isEar(e){var o=e.prev,s=e,h=e.next;if(!(0<=area(o,s,h))){for(var d=e.next.next;d!==e.prev;){if(pointInTriangle(o.x,o.y,s.x,s.y,h.x,h.y,d.x,d.y)&&0<=area(d.prev,d,d.next))return;d=d.next}return 1}}function isEarHashed(e,o,s,h){var d=e.prev,g=e,_=e.next;if(!(0<=area(d,g,_))){for(var j=d.x<g.x?d.x<_.x?d.x:_.x:g.x<_.x?g.x:_.x,$=d.y<g.y?d.y<_.y?d.y:_.y:g.y<_.y?g.y:_.y,_t=d.x>g.x?d.x>_.x?d.x:_.x:g.x>_.x?g.x:_.x,_e=d.y>g.y?d.y>_.y?d.y:_.y:g.y>_.y?g.y:_.y,_r=zOrder(j,$,o,s,h),_n=zOrder(_t,_e,o,s,h),_o=e.nextZ;_o&&_o.z<=_n;){if(_o!==e.prev&&_o!==e.next&&pointInTriangle(d.x,d.y,g.x,g.y,_.x,_.y,_o.x,_o.y)&&0<=area(_o.prev,_o,_o.next))return;_o=_o.nextZ}for(_o=e.prevZ;_o&&_o.z>=_r;){if(_o!==e.prev&&_o!==e.next&&pointInTriangle(d.x,d.y,g.x,g.y,_.x,_.y,_o.x,_o.y)&&0<=area(_o.prev,_o,_o.next))return;_o=_o.prevZ}return 1}}function cureLocalIntersections(e,o,s){var h=e;do{var d=h.prev,g=h.next.next;!equals(d,g)&&intersects(d,h,h.next,g)&&locallyInside(d,g)&&locallyInside(g,d)&&(o.push(d.i/s),o.push(h.i/s),o.push(g.i/s),removeNode(h),removeNode(h.next),h=e=g),h=h.next}while(h!==e);return h}function splitEarcut(e,o,s,h,d,g){var _=e;do{for(var j=_.next.next;j!==_.prev;){if(_.i!==j.i&&isValidDiagonal(_,j)){var $=splitPolygon(_,j),_=filterPoints(_,_.next),$=filterPoints($,$.next);return earcutLinked(_,o,s,h,d,g),void earcutLinked($,o,s,h,d,g)}j=j.next}_=_.next}while(_!==e)}function eliminateHoles(e,o,s,h){for(var d,g=[],_=0,j=o.length;_<j;_++)(d=linkedList(e,o[_]*h,_<j-1?o[_+1]*h:e.length,h,!1))===d.next&&(d.steiner=!0),g.push(getLeftmost(d));for(g.sort(compareX),_=0;_<g.length;_++)eliminateHole(g[_],s),s=filterPoints(s,s.next);return s}function compareX(e,o){return e.x-o.x}function eliminateHole(e,o){var s;(o=findHoleBridge(e,o))&&filterPoints(s=splitPolygon(o,e),s.next)}function findHoleBridge(e,o){var s,h=o,d=e.x,g=e.y,_=-1/0;do{if(g<=h.y&&g>=h.next.y){var j=h.x+(g-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(j<=d&&_<j){if((_=j)===d){if(g===h.y)return h;if(g===h.next.y)return h.next}s=h.x<h.next.x?h:h.next}}h=h.next}while(h!==o);if(!s)return null;if(d===_)return s.prev;for(var $,_t=s,_e=s.x,_r=s.y,_n=1/0,h=s.next;h!==_t;)d>=h.x&&h.x>=_e&&pointInTriangle(g<_r?d:_,g,_e,_r,g<_r?_:d,g,h.x,h.y)&&(($=Math.abs(g-h.y)/(d-h.x))<_n||$===_n&&h.x>s.x)&&locallyInside(h,e)&&(s=h,_n=$),h=h.next;return s}function indexCurve(e,o,s,h){for(var d=e;d.z===null&&(d.z=zOrder(d.x,d.y,o,s,h)),d.prevZ=d.prev,d.nextZ=d.next,(d=d.next)!==e;);d.prevZ.nextZ=null,d.prevZ=null,sortLinked(d)}function sortLinked(e){var o,s,h,d,g,_,j,$,_t=1;do{for(s=e,g=e=null,_=0;s;){for(_++,h=s,o=j=0;o<_t&&(j++,h=h.nextZ);o++);for($=_t;0<j||0<$&&h;)j!==0&&($===0||!h||s.z<=h.z)?(s=(d=s).nextZ,j--):(h=(d=h).nextZ,$--),g?g.nextZ=d:e=d,d.prevZ=g,g=d;s=h}g.nextZ=null,_t*=2}while(1<_);return e}function zOrder(e,o,s,h,d){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)/d)|e<<8))|e<<4))|e<<2))|e<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-h)/d)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function getLeftmost(e){for(var o=e,s=e;o.x<s.x&&(s=o),(o=o.next)!==e;);return s}function pointInTriangle(e,o,s,h,d,g,_,j){return 0<=(d-_)*(o-j)-(e-_)*(g-j)&&0<=(e-_)*(h-j)-(s-_)*(o-j)&&0<=(s-_)*(g-j)-(d-_)*(h-j)}function isValidDiagonal(e,o){return e.next.i!==o.i&&e.prev.i!==o.i&&!intersectsPolygon(e,o)&&locallyInside(e,o)&&locallyInside(o,e)&&middleInside(e,o)}function area(e,o,s){return(o.y-e.y)*(s.x-o.x)-(o.x-e.x)*(s.y-o.y)}function equals(e,o){return e.x===o.x&&e.y===o.y}function intersects(e,o,s,h){return equals(e,o)&&equals(s,h)||equals(e,h)&&equals(s,o)||0<area(e,o,s)!=0<area(e,o,h)&&0<area(s,h,e)!=0<area(s,h,o)}function intersectsPolygon(e,o){var s=e;do{if(s.i!==e.i&&s.next.i!==e.i&&s.i!==o.i&&s.next.i!==o.i&&intersects(s,s.next,e,o))return 1;s=s.next}while(s!==e)}function locallyInside(e,o){return area(e.prev,e,e.next)<0?0<=area(e,o,e.next)&&0<=area(e,e.prev,o):area(e,o,e.prev)<0||area(e,e.next,o)<0}function middleInside(e,o){for(var s=e,h=!1,d=(e.x+o.x)/2,g=(e.y+o.y)/2;s.y>g!=s.next.y>g&&d<(s.next.x-s.x)*(g-s.y)/(s.next.y-s.y)+s.x&&(h=!h),(s=s.next)!==e;);return h}function splitPolygon(e,o){var s=new Node(e.i,e.x,e.y),h=new Node(o.i,o.x,o.y),d=e.next,g=o.prev;return(e.next=o).prev=e,(s.next=d).prev=s,(h.next=s).prev=h,(g.next=h).prev=g,h}function insertNode(e,o,s,h){var d=new Node(e,o,s);return h?(d.next=h.next,(d.prev=h).next.prev=d,h.next=d):(d.prev=d).next=d,d}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,o,s){this.i=e,this.x=o,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea$1(e,o,s,h){for(var d=0,g=o,_=s-h;g<s;g+=h)d+=(e[_]-e[g])*(e[g+1]+e[_+1]),_=g;return d}earcut.deviation=function(e,o,s,h){var d=o&&o.length,g=d?o[0]*s:e.length,_=Math.abs(signedArea$1(e,0,g,s));if(d)for(var j=0,$=o.length;j<$;j++){var _t=o[j]*s,_e=j<$-1?o[j+1]*s:e.length;_-=Math.abs(signedArea$1(e,_t,_e,s))}for(var _r=0,j=0;j<h.length;j+=3){var _n=h[j]*s,_o=h[j+1]*s,ga=h[j+2]*s;_r+=Math.abs((e[_n]-e[ga])*(e[1+_o]-e[1+_n])-(e[_n]-e[_o])*(e[1+ga]-e[1+_n]))}return _===0&&_r===0?0:Math.abs((_r-_)/_)},earcut.flatten=function(e){for(var o=e[0][0].length,s={vertices:[],holes:[],dimensions:o},h=0,d=0;d<e.length;d++){for(var g=0;g<e[d].length;g++)for(var _=0;_<o;_++)s.vertices.push(e[d][g][_]);0<d&&(h+=e[d-1].length,s.holes.push(h))}return s};var up_vec3=[0,0,1];function buildPolygons(e,o,s,h){var d,g,_,j,$,_t=h.texcoord_index,_e=h.texcoord_scale,_r=h.texcoord_normalize,_n=o.vertex_elements;_t&&(_r=_r||1,g=(d=_slicedToArray(_e||default_uvs,4))[0],_=d[1],j=d[2],$=d[3]);for(var _o=0,ga=e.length,_l=0;_l<ga;_l++){var _f,_c,_p,_g,ty,oy=o.vertex_count,ry=e[_l];_t&&(_c=(_f=_slicedToArray(Geo$1.findBoundingBox(ry),4))[0],_p=_f[1],_g=(j-g)/(_f[2]-_c),ty=($-_)/(_f[3]-_p));for(var ly=0;ly<ry.length;ly++)for(var py=ry[ly],gy=0;gy<py.length;gy++){var by=py[gy];s[0]=by[0],s[1]=by[1],_t&&(s[_t+0]=((by[0]-_c)*_g+g)*_r,s[_t+1]=((by[1]-_p)*ty+_)*_r),o.addVertex(s)}for(var wy=triangulatePolygon(earcut_1.flatten(ry)),Cy=0;Cy<wy.length;Cy++)_n.push(oy+wy[Cy]);_o+=wy.length/3}return _o}function buildExtrudedPolygons(e,o,s,h,d,g,_,j,$){var _t=$.remove_tile_edges,_e=$.tile_edge_tolerance,_r=$.texcoord_index,_n=$.texcoord_scale,_o=$.texcoord_normalize,ga=$.winding,_l=o+(h||0),_f=o+s;g[2]=_f;var _c,_p,_g,ty,oy,ry,ly=buildPolygons(e,d,g,{texcoord_index:_r,texcoord_scale:_n,texcoord_normalize:_o}),py=d.vertex_elements,gy=d.vertex_count;_r&&(_o=_o||1,_p=(_c=_slicedToArray(_n||default_uvs,4))[0],_g=_c[1],ty=_c[2],ry=[[_p,oy=_c[3]],[_p,_g],[ty,_g],[ty,oy]]);for(var by=e.length,wy=0;wy<by;wy++)for(var Cy=e[wy],Gy=0;Gy<Cy.length;Gy++)for(var Ly=Cy[Gy],d0=0;d0<Ly.length-1;d0++)if(!_t||!outsideTile(Ly[d0],Ly[d0+1],_e)){var s0=void 0,t0=void 0,Ay=[[Ly[t0=ga==="CCW"?(s0=d0)+1:(s0=d0+1,d0)][0],Ly[t0][1],_f],[Ly[t0][0],Ly[t0][1],_l],[Ly[s0][0],Ly[s0][1],_l],[Ly[s0][0],Ly[s0][1],_f]],Ny=Vector$1.normalize([Ly[t0][0]-Ly[s0][0],Ly[t0][1]-Ly[s0][1],0]),Hy=Vector$1.cross(up_vec3,Ny);g[_+0]=Hy[0]*j,g[_+1]=Hy[1]*j,g[_+2]=Hy[2]*j;for(var n0=0;n0<Ay.length;n0++)g[0]=Ay[n0][0],g[1]=Ay[n0][1],g[2]=Ay[n0][2],_r&&(g[_r+0]=ry[n0][0]*_o,g[_r+1]=ry[n0][1]*_o),d.addVertex(g);py.push(gy+0),py.push(gy+1),py.push(gy+2),py.push(gy+2),py.push(gy+3),py.push(gy+0),gy+=4,ly+=2}return ly}function triangulatePolygon(e){return earcut_1(e.vertices,e.holes,e.dimensions)}var shaderSrc_polygonsVertex=`uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;attribute vec4 a_position;attribute vec4 a_color;
#ifdef TANGRAM_NORMAL_ATTRIBUTE
attribute vec3 a_normal;
#define TANGRAM_NORMAL a_normal
#else
#define TANGRAM_NORMAL vec3(0., 0., 1.)
#endif
#ifdef TANGRAM_EXTRUDE_LINES
attribute vec2 a_extrude;attribute vec2 a_offset;attribute vec2 a_scaling;uniform float u_v_scale_adjust;
#endif
varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;
#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)
attribute vec2 a_texcoord;varying vec2 v_texcoord;
#endif
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
varying vec4 v_modelpos_base_zoom;
#endif
#if defined(TANGRAM_LIGHTING_VERTEX)
varying vec4 v_lighting;
#endif
#define UNPACK_SCALING(x) (x / 1024.)
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: raster
#pragma tangram: global
void main(){
#pragma tangram: setup
#ifdef TANGRAM_TEXTURE_COORDS
v_texcoord=a_texcoord;
#ifdef TANGRAM_EXTRUDE_LINES
v_texcoord.y*=u_v_scale_adjust;
#endif
#endif
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
v_modelpos_base_zoom=modelPositionBaseZoom();
#endif
vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.);
#ifdef TANGRAM_EXTRUDE_LINES
vec2 extrude=a_extrude.xy;vec2 offset=a_offset.xy;float dz=clamp(u_map_position.z-u_tile_origin.z,0.,4.);dz+=step(1.,dz)*(1.-dz)+mix(0.,2.,clamp((dz-2.)/2.,0.,1.));float mdz=(dz-0.5)*2.;extrude-=extrude*UNPACK_SCALING(a_scaling.x)*mdz;float dwdz=UNPACK_SCALING(a_scaling.y);float sdwdz=sign(step(0.,dwdz)-0.5);offset-=offset*abs(dwdz)*((1.-step(0.,sdwdz))-(dz*-sdwdz));float ssz=exp2(-dz-(u_tile_origin.z-u_tile_origin.w));extrude*=ssz;offset*=ssz;
#ifdef TANGRAM_BLOCK_WIDTH
float width=1.;
#pragma tangram: width
extrude*=width;
#endif
position.xy+=extrude+offset;
#endif
v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;
#pragma tangram: position
v_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);v_color=a_color;
#if defined(TANGRAM_LIGHTING_VERTEX)
vec3 normal=v_normal;
#pragma tangram: normal
v_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));
#endif
cameraProjection(position);applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);
#if defined(SNAP_TO_PIXEL_GRID)
snapToPixelGrid(position);
#endif
gl_Position=position;}`,shaderSrc_polygonsFragment=`uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;
#ifdef TANGRAM_EXTRUDE_LINES
uniform bool u_has_line_texture;uniform sampler2D u_texture;uniform float u_texture_ratio;uniform vec4 u_dash_background_color;
#endif
#define TANGRAM_NORMAL v_normal
#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)
varying vec2 v_texcoord;
#endif
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
varying vec4 v_modelpos_base_zoom;
#endif
#if defined(TANGRAM_LIGHTING_VERTEX)
varying vec4 v_lighting;
#endif
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: raster
#pragma tangram: global
#pragma tangram: utils
void main(void){
#pragma tangram: setup
vec4 color=v_color;vec3 normal=TANGRAM_NORMAL;
#ifdef TANGRAM_CROP_BY_TILE
if(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}
#endif
#ifdef TANGRAM_RASTER_TEXTURE_COLOR
color*=sampleRaster();
#endif
#ifdef TANGRAM_EXTRUDE_LINES
if(u_has_line_texture){vec2 _line_st=vec2(v_texcoord.x,fract(v_texcoord.y/u_texture_ratio));vec4 _line_color=texture2D(u_texture,_line_st);if(_line_color.a<TANGRAM_ALPHA_TEST){
#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY)
if(u_dash_background_color.a==0.){discard;}color=u_dash_background_color;
#else
color=vec4(u_dash_background_color.rgb,color.a*step(TANGRAM_EPSILON,u_dash_background_color.a));
#endif
}else{color*=_line_color;}}
#endif
#ifdef TANGRAM_RASTER_TEXTURE_NORMAL
normal=normalize(sampleRaster().rgb*2.-1.);
#endif
#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)
calculateNormal(normal);
#endif
#if !defined(TANGRAM_LIGHTING_VERTEX)
#pragma tangram: normal
#endif
#pragma tangram: color
#if defined(TANGRAM_LIGHTING_FRAGMENT)
color=calculateLighting(v_position.xyz-u_eye,normal,color);
#elif defined(TANGRAM_LIGHTING_VERTEX)
color*=v_lighting;
#endif
#pragma tangram: filter
gl_FragColor=color;}`,Polygons=Object.create(Style);Object.assign(Polygons,{name:"polygons",built_in:!0,vertex_shader_src:shaderSrc_polygonsVertex,fragment_shader_src:shaderSrc_polygonsFragment,selection:!0,init:function(){Style.init.apply(this,arguments),this.defines.TANGRAM_NORMAL_ATTRIBUTE=!0,this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.texcoords&&(this.defines.TANGRAM_TEXTURE_COORDS=!0)},vertexLayoutForMeshVariant:function(){var e;return this.vertex_layout||(e=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_normal",size:3,type:gl$1.BYTE,normalized:!0},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}],this.texcoords&&e.push({name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0}),this.vertex_layout=new VertexLayout(e)),this.vertex_layout},_parseFeature:function(e,o,s){var h=this.feature_style;return h.color=this.parseColor(o.color,s),h.color?(h.z=o.z&&StyleParser.evalCachedDistanceProperty(o.z,s)||StyleParser.defaults.z,h.z*=Geo$1.height_scale,h.extrude=StyleParser.evalProperty(o.extrude,s),h.extrude&&(h.extrude===!0?(h.height=e.properties.height!==void 0?e.properties.height:StyleParser.defaults.height,h.min_height=e.properties.min_height!==void 0?e.properties.min_height:StyleParser.defaults.min_height):typeof h.extrude=="number"?(h.height=h.extrude,h.min_height=0):Array.isArray(h.extrude)&&(h.min_height=h.extrude[0],h.height=h.extrude[1]),h.height*=Geo$1.height_scale,h.min_height*=Geo$1.height_scale),h.tile_edges=o.tile_edges,h):null},_preprocess:function(e){return e.color=StyleParser.createColorPropertyCache(e.color),e.z=StyleParser.createPropertyCache(e.z,StyleParser.parseUnits),e},makeVertexTemplate:function(e){var o=0;return this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=e.z||0,this.vertex_template[o++]=this.scaleOrder(e.order),this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=127,this.vertex_template[o++]=255*e.color[0],this.vertex_template[o++]=255*e.color[1],this.vertex_template[o++]=255*e.color[2],this.vertex_template[o++]=255*e.color[3],this.selection&&(this.vertex_template[o++]=255*e.selection_color[0],this.vertex_template[o++]=255*e.selection_color[1],this.vertex_template[o++]=255*e.selection_color[2],this.vertex_template[o++]=255*e.selection_color[3]),this.texcoords&&(this.vertex_template[o++]=0,this.vertex_template[o++]=0),this.vertex_template},buildPolygons:function(e,o,s,h){var d=this.makeVertexTemplate(o),g={texcoord_index:this.vertex_layout.index.a_texcoord,texcoord_normalize:65535,remove_tile_edges:!o.tile_edges,tile_edge_tolerance:Geo$1.tile_scale*h.tile.pad_scale*4,winding:h.winding};return o.extrude&&o.height?buildExtrudedPolygons(e,o.z,o.height,o.min_height,s.vertex_data,d,this.vertex_layout.index.a_normal,127,g):buildPolygons(e,s.vertex_data,d,g)}});var zero_vec2=[0,0],CAP_TYPE={butt:0,square:1,round:2},JOIN_TYPE={miter:0,bevel:1,round:2},DEFAULT={MITER_LIMIT:3,TEXCOORD_NORMALIZE:1,TEXCOORD_RATIO:1,MIN_FAN_WIDTH:5},v_scale_adjust=Geo$1.tile_scale,zero_v=[0,0],one_v=[1,0],mid_v=[.5,0];function buildPolylines(e,o,s,h,d){var g,_,j=d.closed_polygon,$=d.remove_tile_edges,_t=d.tile_edge_tolerance,_e=d.texcoord_index,_r=(d.texcoord_scale,d.texcoord_width),_n=d.texcoord_ratio,_o=d.texcoord_normalize,ga=d.extrude_index,_l=d.offset_index,_f=d.join,_c=d.cap,_p=d.miter_limit,_g=d.offset,ty=d.crop_by_tile,oy=_c?CAP_TYPE[_c]:CAP_TYPE.butt,ry=_f?JOIN_TYPE[_f]:JOIN_TYPE.miter;ry===JOIN_TYPE.miter&&(g=(_p=_p||DEFAULT.MITER_LIMIT)*_p),_e&&(_o=_o||DEFAULT.TEXCOORD_NORMALIZE,_=1/(_r*(_n=_n||DEFAULT.TEXCOORD_RATIO)*v_scale_adjust));for(var ly={closed_polygon:j,remove_tile_edges:$,tile_edge_tolerance:_t,miter_len_sq:g,join_type:ry,cap_type:oy,vertex_data:s,vertex_template:h,half_width:o/2,extrude_index:ga,offset_index:_l,v_scale:_,texcoord_index:_e,texcoord_width:_r,texcoord_normalize:_o,offset:_g,geom_count:0,crop_by_tile:ty},py=0;py<e.length;py++)buildPolyline(e[py],ly);if(ly.extra_lines)for(var gy=0;gy<ly.extra_lines.length;gy++)buildPolyline(ly.extra_lines[gy],ly);return ly.geom_count}function buildPolyline(e,o){if(!(e.length<2)){var s,h,d=o.join_type,g=o.cap_type,_=o.closed_polygon,j=o.remove_tile_edges,$=o.tile_edge_tolerance,_t=o.v_scale,_e=o.miter_len_sq,_r=o.crop_by_tile,_n=o.texcoord_index!=null,_o=0;if(_&&d===JOIN_TYPE.miter){var ga=getTileBoundaryIndex(e);if(ga!==0){var _l=permuteLine(e,ga);return o.extra_lines=o.extra_lines||[],void o.extra_lines.push(_l)}}var _f=0,_c=e.length-1,_p=0;for(ly=e[_f],py=e[_f+1];Vector$1.isEqual(ly,py);)if(ly=py,py=e[++_f+1],_p++,_f===e.length-1)return;for(;Vector$1.isEqual(e[_c],e[_c-1]);)if(_p++,--_c===0)return;if(!(e.length<2+_p))if(h=Vector$1.normalize(Vector$1.perp(ly,py)),j&&outsideTile(ly,py,$)){var _g=getNextNonBoundarySegment(e,_f,$);_g&&(o.extra_lines=o.extra_lines||[],o.extra_lines.push(_g))}else{_?startPolygon(ly,s=Vector$1.normalize(Vector$1.perp(e[_c-1],ly)),h,d,o):(!_r&&isCoordOutsideTile(ly)||(addCap(ly,_o,h,g,!0,o),_n&&g!==CAP_TYPE.butt&&(_o+=.5*_t*o.texcoord_width)),addVertex(ly,h,h,1,_o,o,1),addVertex(ly,h,h,0,_o,o,-1)),_n&&(_o+=_t*Vector$1.length(Vector$1.sub(py,ly)));for(var ty=_f+1;ty<_c;ty++){var oy=ty,ry=ty+1,ly=e[oy],py=e[ry];if(!Vector$1.isEqual(ly,py)){if(j&&outsideTile(ly,py,$)){addVertex(ly,h,h,1,_o,o,1),addVertex(ly,h,h,0,_o,o,-1),indexPairs(1,o);var gy=getNextNonBoundarySegment(e,oy+1,$);return void(gy&&(o.extra_lines=o.extra_lines||[],o.extra_lines.push(gy)))}s=h,h=Vector$1.normalize(Vector$1.perp(ly,py)),d===JOIN_TYPE.miter?addMiter(_o,ly,s,h,_e,!1,o):addJoin(d,_o,ly,s,h,!1,o),_n&&(_o+=_t*Vector$1.length(Vector$1.sub(py,ly)))}}ly=py,s=h,_?endPolygon(ly,s,h=Vector$1.normalize(Vector$1.perp(ly,e[1])),d,_o,o):(addVertex(ly,s,h,1,_o,o,1),addVertex(ly,s,h,0,_o,o,-1),indexPairs(1,o),!_r&&isCoordOutsideTile(ly)||addCap(ly,_o,s,g,!1,o))}}}function getTileBoundaryIndex(e){if(isCoordOutsideTile(e[0]))return 0;for(var o=0;o<e.length;o++)if(isCoordOutsideTile(e[e.length-1-o]))return e.length-1-o;return 0}function getNextNonBoundarySegment(e,o,s){for(var h=o;e[h+1]&&outsideTile(e[h],e[h+1],s);)h++;return 2<=e.length-h&&e.slice(h)}function startPolygon(e,o,s,h,d){h===void 0||isCoordOutsideTile(e)&&!d.crop_by_tile?(addVertex(e,s,s,1,0,d,1),addVertex(e,s,s,0,0,d,-1)):h===JOIN_TYPE.miter?addMiter(0,e,o,s,d.miter_len_sq,!0,d):addJoin(h,0,e,o,s,!0,d)}function endPolygon(e,o,s,h,d,g){var _;isCoordOutsideTile(e)&&!g.crop_by_tile?(addVertex(e,o,o,1,d,g,1),addVertex(e,o,o,0,d,g,-1)):(_=createMiterVec(o,s),h===JOIN_TYPE.miter&&Vector$1.lengthSq(_)>g.miter_len_sq&&(h=JOIN_TYPE.bevel),h===JOIN_TYPE.miter?(addVertex(e,_,o,1,d,g,1),addVertex(e,_,o,0,d,g,-1)):(addVertex(e,o,o,1,d,g,1),addVertex(e,o,o,0,d,g,-1))),indexPairs(1,g)}function createMiterVec(e,o){var s=Vector$1.normalize(Vector$1.add(e,o)),h=2/(1+Math.abs(Vector$1.dot(e,s)));return Vector$1.mult(s,h*h)}function addMiter(e,o,s,h,d,g,_){var j=createMiterVec(s,h);Vector$1.lengthSq(j)>d?addJoin(JOIN_TYPE.bevel,e,o,s,h,g,_):(addVertex(o,j,j,1,e,_,1),addVertex(o,j,j,0,e,_,-1),g||indexPairs(1,_))}function addJoin(e,o,s,h,d,g,_){var j=createMiterVec(h,d),$=0<d[0]*h[1]-d[1]*h[0];_.texcoord_index!=null&&(zero_v[1]=o,one_v[1]=o),$?(addVertex(s,j,j,1,o,_,1),addVertex(s,h,j,0,o,_,-1),g||indexPairs(1,_),addFan(s,Vector$1.neg(h),j,Vector$1.neg(d),j,zero_v,one_v,zero_v,!1,e===JOIN_TYPE.bevel,_),addVertex(s,j,j,1,o,_,1),addVertex(s,d,j,0,o,_,-1)):(addVertex(s,h,j,1,o,_,1),addVertex(s,j,j,0,o,_,-1),g||indexPairs(1,_),addFan(s,h,Vector$1.neg(j),d,j,one_v,zero_v,one_v,!1,e===JOIN_TYPE.bevel,_),addVertex(s,d,j,1,o,_,1),addVertex(s,j,j,0,o,_,-1))}function indexPairs(e,o){for(var s=o.vertex_data.vertex_elements,h=o.vertex_data.vertex_count-2*e-2,d=0;d<e;d++)s.push(h+2*d+2),s.push(h+2*d+1),s.push(h+2*d),s.push(h+2*d+2),s.push(h+2*d+3),s.push(h+2*d+1),o.geom_count+=2}function addVertex(e,o,s,h,d,g,_){var j=g.vertex_template,$=g.vertex_data;j[0]=e[0],j[1]=e[1];var _t=g.half_width*_;j[g.extrude_index+0]=o[0]*_t,j[g.extrude_index+1]=o[1]*_t,g.offset&&(j[g.offset_index+0]=s[0]*g.offset,j[g.offset_index+1]=s[1]*g.offset),g.texcoord_index!=null&&(j[g.texcoord_index+0]=h*g.texcoord_normalize,j[g.texcoord_index+1]=d*g.texcoord_normalize),$.addVertex(j)}var uvCurr=[0,0];function addFan(e,o,s,h,d,g,_,j,$,_t,_e){for(var _r=o[0]*h[1]-o[1]*h[0],_n=Vector$1.dot(o,h),_o=Math.atan2(_r,_n);_o>=Math.PI;)_o-=2*Math.PI;if(_t)ga=1;else{var ga=trianglesPerArc(_o,_e.half_width);if(ga<1)return}var _l=_e.vertex_data.vertex_count,_f=_e.vertex_data.vertex_elements;addVertex(e,s,d,_[0],_[1],_e,1),addVertex(e,o,d,g[0],g[1],_e,1);var _c,_p,_g=o,ty=_e.texcoord_index!=null;ty&&($?_c=Vector$1.sub(g,_):(uvCurr=Vector$1.copy(g),_p=Vector$1.div(Vector$1.sub(j,g),ga)));for(var oy,ry=_o/ga,ly=_o<0?-1:1,py=0<_r?(oy=2,1):(oy=1,2),gy=0;gy<ga;gy++)gy===0&&_o<0&&(_g=Vector$1.neg(_g)),_g=Vector$1.rot(_g,ry),ty&&($?(_c=Vector$1.rot(_c,ry),uvCurr[0]=_c[0]+_[0],uvCurr[1]=_c[1]*_e.texcoord_width*_e.v_scale+_[1]):uvCurr=Vector$1.add(uvCurr,_p)),addVertex(e,_g,d,uvCurr[0],uvCurr[1],_e,ly),_f.push(_l+gy+oy),_f.push(_l),_f.push(_l+gy+py)}function addCap(e,o,s,h,d,g){var _,j=Vector$1.neg(s),$=g.texcoord_index!=null;switch(h){case CAP_TYPE.square:d?(_=[s[1],-s[0]],addVertex(e,Vector$1.add(s,_),s,1,o,g,1),addVertex(e,Vector$1.add(j,_),s,0,o,g,1),$&&(o+=.5*g.texcoord_width*g.v_scale),addVertex(e,s,s,1,o,g,1),addVertex(e,j,s,0,o,g,1)):(_=[-s[1],s[0]],addVertex(e,s,s,1,o,g,1),addVertex(e,j,s,0,o,g,1),$&&(o+=.5*g.texcoord_width*g.v_scale),addVertex(e,Vector$1.add(s,_),s,1,o,g,1),addVertex(e,Vector$1.add(j,_),s,0,o,g,1)),indexPairs(1,g);break;case CAP_TYPE.round:var _t,_e,_r=zero_v,_n=one_v,_o=mid_v;d?(_t=s,_e=j,$&&(o+=.5*g.texcoord_width*g.v_scale,_r=one_v,_n=zero_v,_o=mid_v)):(_t=j,_e=s),$&&(zero_v[1]=o,one_v[1]=o,mid_v[1]=o),addFan(e,_t,zero_vec2,_e,s,_r,_o,_n,!0,!1,g);break;case CAP_TYPE.butt:return}}function trianglesPerArc(e,o){e<0&&(e=-e);var s=o>2*DEFAULT.MIN_FAN_WIDTH?Math.log2(o/DEFAULT.MIN_FAN_WIDTH):1;return Math.ceil(e/Math.PI*s)}function permuteLine(e,o){for(var s=[],h=0;h<e.length;h++){var d=(h+o)%e.length;d!=0&&s.push(e[d])}return s.push(s[0]),s}var default_dash_color=[255,255,255,255],default_background_color=[0,0,0,0];function renderDashArray(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},s=o.dash_color||default_dash_color,h=o.background_color||default_background_color,d=e,g=o.scale||1;d.length%2==1&&Array.prototype.push.apply(d,d);for(var _=!0,j=[],$=0;$<d.length;$++){for(var _t=Math.floor(d[$]*g),_e=0;_e<_t;_e++)Array.prototype.push.apply(j,_?s:h);_=!_}return{pixels:j=new Uint8Array(j),length:j.length/4}}var Lines=Object.create(Style);Lines.vertex_layouts=[[],[]],Lines.dash_textures={};var DASH_SCALE=20;function buildPolylines$1(e,o,s,h,d,g){for(var _={closed:g,vertex_data:s,vertex_template:h,half_width:o/2,vertex_layout_index:d,geom_count:0},j=0,$=e.length;j<$;j++)buildPolyline$1(e[j],_);return _.geom_count}function buildPolyline$1(e,o){if(!(e.length<2)){for(var s,h,d=[e[0]],g=0,_=[],j=[],$=1,_t=e.length;$<_t;$++)e[$][0]===e[$-1][0]&&e[$][1]===e[$-1][1]||(d.push(e[$]),s=Vector$1.sub(e[$],e[$-1]),h=Vector$1.length(s),_.push(s),j.push([g,g+h]),g+=h);if(!(d.length<2)){var _e=0,_r=_[_.length-1],_n=_[0],_o=_[1],ga=[0,0];2<d.length&&(o.closed&&(ga[0]=Vector$1.signedAngleBetween(_r,_n)),ga[1]=Vector$1.signedAngleBetween(_n,_o));var _l=d[0],_f=j[0];o.closed?(addVertex$1(_l,o,_e++,_f,g,ga,[_r,_n]),addVertex$1(_l,o,_e++,_f,g,ga,[_r,_n])):(addVertex$1(_l,o,_e++,_f,g,ga,[_n,_n]),addVertex$1(_l,o,_e++,_f,g,ga,[_n,_n]));for(var _c=1,_p=d.length-1;_c<_p;_c++)_l=d[_c],_r=_[_c-1],_n=_[_c],_o=_[_c+1],addVertex$1(_l,o,_e++,_f=j[_c-1],g,ga,[_r,_n]),addVertex$1(_l,o,_e++,_f,g,ga,[_r,_n]),triangulate(o),_f=j[_c],ga[0]=ga[1],ga[1]=_c!==_p-1?Vector$1.signedAngleBetween(_n,_o):o.closed?Vector$1.signedAngleBetween(_n,_[0]):0,addVertex$1(_l,o,_e++,_f,g,ga,[_r,_n]),addVertex$1(_l,o,_e++,_f,g,ga,[_r,_n]);_l=d[d.length-1],_f=j[j.length-1],_n=_[_.length-1],o.closed?(addVertex$1(_l,o,_e++,_f,g,ga,[_n,_[0]]),addVertex$1(_l,o,_e++,_f,g,ga,[_n,_[0]])):(addVertex$1(_l,o,_e++,_f,g,ga,[_n,_n]),addVertex$1(_l,o,_e++,_f,g,ga,[_n,_n])),triangulate(o)}}}function triangulate(e){var o=e.vertex_data.vertex_elements,s=e.vertex_data.vertex_count-4;o.push(2+s),o.push(1+s),o.push(s),o.push(2+s),o.push(3+s),o.push(1+s),e.geom_count+=2}Object.assign(Lines,{name:"lines",built_in:!0,vertex_shader_src:shaderSrc_polygonsVertex,fragment_shader_src:shaderSrc_polygonsFragment,selection:!0,init:function(){Style.init.apply(this,arguments),this.styles=this.styles||{},this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_EXTRUDE_LINES=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_TEXTURE_COORDS=!0,this.outline_feature_style={},this.inline_feature_style=this.feature_style},calcDistance:function(e,o){return e&&StyleParser.evalCachedDistanceProperty(e,o)||0},calcDistanceNextZoom:function(e,o){o.zoom++;var s=this.calcDistance(e,o);return o.zoom--,s},calcWidth:function(e,o,s){var h=this.calcDistance(e.width,s);if(!(h<0)){var d,g=e.next_width?this.calcDistanceNextZoom(e.next_width,s):h/2;return h===0&&g===0||g<0?!1:(o.width_unscaled=h,o.next_width_unscaled=g,e.next_width?(d=.5*(h+(g*=2)),o.width=d*s.units_per_meter_overzoom,o.width_scale=1-g/d):(o.width=h*s.units_per_meter_overzoom,o.width_scale=0),e.texcoords&&(e.inline_texcoord_width?o.texcoord_width=e.inline_texcoord_width:o.texcoord_width=(o.width_unscaled||o.next_width_unscaled)*s.units_per_meter_overzoom/s.tile.overzoom2),!0)}},calcOffset:function(e,o,s){var h,d;e.offset_precalc?(o.offset=e.offset_precalc,o.offset_scale=e.offset_scale_precalc):e.offset?(h=this.calcDistance(e.offset,s),e.next_offset?(d=2*this.calcDistanceNextZoom(e.next_offset,s),Math.abs(h)>=Math.abs(d)?(o.offset=h*s.units_per_meter_overzoom,o.offset_scale=h!==0?1-d/h:0):(o.offset=d*s.units_per_meter_overzoom,o.offset_scale=d!=0?-1*(1-h/d):0)):(o.offset=h*s.units_per_meter_overzoom,o.offset_scale=0)):(o.offset=0,o.offset_scale=0),StyleParser.evalProperty(e.offset_reverse,s)&&(o.offset*=-1)},_parseFeature:function(e,o,s){var h,d,g=this.feature_style;if(this.calcWidth(o,g,s)!==!1&&(this.calcOffset(o,g,s),g.color=this.parseColor(o.color,s),g.color))return g.variantKey=o.variantKey,g.z=o.z&&StyleParser.evalCachedDistanceProperty(o.z||0,s)||StyleParser.defaults.z,g.height=e.properties.height||StyleParser.defaults.height,g.extrude=StyleParser.evalProperty(o.extrude,s),g.extrude&&(typeof g.extrude=="number"?g.height=g.extrude:Array.isArray(g.extrude)&&(g.height=g.extrude[1])),g.extrude&&g.height&&(g.z+=g.height),g.z*=Geo$1.height_scale,g.height*=Geo$1.height_scale,g.cap=StyleParser.evalProperty(o.cap,s),g.join=StyleParser.evalProperty(o.join,s),g.miter_limit=StyleParser.evalProperty(o.miter_limit,s),g.tile_edges=o.tile_edges,g.outline=g.outline||{width:{},next_width:{},preprocessed:!0},o.outline&&o.outline.visible!==!1&&o.outline.color&&o.outline.width?(h=2*this.calcDistance(o.outline.width,s),d=2*this.calcDistanceNextZoom(o.outline.next_width,s),h==0&&d==0||h<0||d<0?(g.outline.width.value=null,g.outline.next_width.value=null,g.outline.color=null,g.outline.inline_texcoord_width=null,g.outline.texcoords=!1):(g.outline.width.value=h+g.width_unscaled,g.outline.next_width.value=d+g.next_width_unscaled,g.outline.inline_texcoord_width=g.texcoord_width,g.outline.offset_precalc=g.offset,g.outline.offset_scale_precalc=g.offset_scale,g.outline.color=o.outline.color,g.outline.cap=o.outline.cap,g.outline.join=o.outline.join,g.outline.miter_limit=o.outline.miter_limit,g.outline.texcoords=o.outline.texcoords,g.outline.style=o.outline.style,g.outline.variantKey=o.outline.variantKey,o.outline.order?g.outline.order=this.parseOrder(o.outline.order,s):g.outline.order=g.order,g.outline.order>g.order&&(g.outline.order=g.order),g.outline.order-=.5,g.outline.variant_order=0)):(g.outline.width.value=null,g.outline.next_width.value=null,g.outline.color=null,g.outline.inline_texcoord_width=null),g},_preprocess:function(e,o){var s,h=this.sources[o]?this.sources[o].config.uid:"";return e.color=StyleParser.createColorPropertyCache(e.color),e.width=StyleParser.createPropertyCache(e.width,StyleParser.parseUnits),e.width&&e.width.type!==StyleParser.CACHE_TYPE.STATIC&&(e.next_width=StyleParser.createPropertyCache(e.width,StyleParser.parseUnits)),e.offset=e.offset&&StyleParser.createPropertyCache(e.offset,StyleParser.parseUnits),e.offset&&e.offset.type!==StyleParser.CACHE_TYPE.STATIC&&(e.next_offset=StyleParser.createPropertyCache(e.offset,StyleParser.parseUnits)),e.z=StyleParser.createPropertyCache(e.z,StyleParser.parseUnits),e.dash=e.dash!==void 0?e.dash:this.dash,e.dash_key=e.dash&&this.dashTextureKey(e.dash,h),e.dash_background_color=e.dash_background_color!==void 0?e.dash_background_color:this.dash_background_color,e.dash_background_color=e.dash_background_color&&StyleParser.parseColor(e.dash_background_color),e.texture_merged=e.dash_key||(e.texture!==void 0?e.texture:this.texture),e.texcoords=this.texcoords||e.texture_merged?1:0,this.addMeshVariantForDraw(this.base,e),e.outline&&(e.outline.style=e.outline.style||this.name,e.outline.color=StyleParser.createColorPropertyCache(e.outline.color),e.outline.width=StyleParser.createPropertyCache(e.outline.width,StyleParser.parseUnits),e.outline.next_width=StyleParser.createPropertyCache(e.outline.width,StyleParser.parseUnits),e.outline.cap=e.outline.cap||e.cap,e.outline.join=e.outline.join||e.join,e.outline.miter_limit=e.outline.miter_limit||e.miter_limit,e.outline.offset=e.offset,(s=this.styles[e.outline.style])?(e.outline.dash=e.outline.dash!==void 0?e.outline.dash:s.dash,e.outline.texture=e.outline.texture!==void 0?e.outline.texture:s.texture,e.outline.dash!=null?(e.outline.dash_key=e.outline.dash&&this.dashTextureKey(e.outline.dash,h),e.outline.texture_merged=e.outline.dash_key):e.outline.dash===null||e.outline.texture!=null?(e.outline.dash_key=null,e.outline.texture_merged=e.outline.texture):(e.outline.dash=e.dash,e.outline.dash_key=e.outline.dash&&this.dashTextureKey(e.outline.dash,h),e.outline.texture_merged=e.outline.dash_key),e.outline.dash_background_color=e.outline.dash_background_color!==void 0?e.outline.dash_background_color:s.dash_background_color,e.outline.dash_background_color=e.outline.dash_background_color!==void 0?e.outline.dash_background_color:e.dash_background_color,e.outline.dash_background_color=e.outline.dash_background_color&&StyleParser.parseColor(e.outline.dash_background_color),e.outline.texcoords=s.texcoords||e.outline.texture_merged?1:0,this.addMeshVariantForDraw(this.base,e.outline)):(log({level:"warn",once:!0},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"line 'outline' specifies non-existent draw style '".concat(e.outline.style,"' (or maybe the style is ")+"defined but is missing a 'base' or has another error), skipping outlines in layer"),e.outline=null)),e},dashTextureKey:function(e,o){return"__dash_"+o+"_"+this.scene_id+"_"+JSON.stringify(e)},getDashTexture:function(e,o){var s,h=this.dashTextureKey(e,this.sources[o].config.uid);Lines.dash_textures[h]==null&&(Lines.dash_textures[h]=!0,s=renderDashArray(e,{scale:DASH_SCALE}),this.textureManager.create(this.gl,h,{data:s.pixels,height:s.length,width:1,filtering:"nearest"}))},endData:function(e){var o=this;return Style.endData.call(this,e).then(function(s){if(s){s.uniforms.u_has_line_texture=!1,s.uniforms.u_texture=o.textureManager.default,s.uniforms.u_v_scale_adjust=Geo$1.tile_scale;var h=[];for(var d in s.meshes)(function(g){var _,j,$=s.meshes[g].variant;$.texture&&((_=s.meshes[g].uniforms=s.meshes[g].uniforms||{}).u_has_line_texture=!0,_.u_texture=$.texture,_.u_texture_ratio=1,$.dash&&(_.u_v_scale_adjust=Geo$1.tile_scale*DASH_SCALE,_.u_dash_background_color=$.dash_background_color||[0,0,0,0]),$.dash_key&&Lines.dash_textures[$.dash_key]==null&&(Lines.dash_textures[$.dash_key]=!0,WorkerBroker.postMessage(o.main_thread_target+".getDashTexture",$.dash,e.source)),o.textureManager.textures[$.texture]==null?h.push(o.textureManager.syncTexturesToWorker([$.texture]).then(function(_t){var _e=_t[$.texture];_e&&(_.u_texture_ratio=_e.height/_e.width)})):(j=o.textureManager.textures[$.texture],_.u_texture_ratio=j.height/j.width))})(d);return e.mesh_data[o.name]=s,Promise.all(h).then(function(){return s})}return s})},computeVariantForDraw:function(e){var o=e.offset?1:0;return e.dash_key&&(o+=e.dash_key,e.dash_background_color&&(o+=e.dash_background_color)),e.texture_merged&&(o+=e.texture_merged),o=hashString(o+="/"+e.texcoords),{key:e.variantKey=o,order:e.variant_order,offset:e.offset?1:0,texcoords:e.texcoords,texture:e.texture_merged,dash:e.dash,dash_key:e.dash_key,dash_background_color:e.dash_background_color}},vertexLayoutForMeshVariant:function(e){var o;return Lines.vertex_layouts[e.key]==null&&(o=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_extrude",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1,static:e.offset?null:[0,0]},{name:"a_scaling",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0,static:e.texcoords?null:[0,0]},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}],Lines.vertex_layouts[e.key]=new VertexLayout(o)),Lines.vertex_layouts[e.key]},makeVertexTemplate:function(e,o){var s=0;return this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=e.z||0,this.vertex_template[s++]=this.scaleOrder(e.order),this.vertex_template[s++]=0,this.vertex_template[s++]=0,o.variant.offset&&(this.vertex_template[s++]=0,this.vertex_template[s++]=0),this.vertex_template[s++]=1024*e.width_scale,this.vertex_template[s++]=1024*e.offset_scale,o.variant.texcoords&&(this.vertex_template[s++]=0,this.vertex_template[s++]=0),this.vertex_template[s++]=255*e.color[0],this.vertex_template[s++]=255*e.color[1],this.vertex_template[s++]=255*e.color[2],this.vertex_template[s++]=255*e.color[3],this.selection&&(this.vertex_template[s++]=255*e.selection_color[0],this.vertex_template[s++]=255*e.selection_color[1],this.vertex_template[s++]=255*e.selection_color[2],this.vertex_template[s++]=255*e.selection_color[3]),this.vertex_template},buildLines:function(e,o,s,h,d){var g;this.feature_style=this.outline_feature_style,!o.outline||o.outline.color==null||o.outline.width.value==null||(g=this.styles[o.outline.style])&&g.addFeature(h.feature,o.outline,h),this.feature_style=this.inline_feature_style;var _=s.vertex_data,j=_.vertex_layout,$=this.makeVertexTemplate(o,s);return buildPolylines(e,o.width,_,$,{cap:o.cap,join:o.join,miter_limit:o.miter_limit,extrude_index:j.index.a_extrude,offset_index:j.index.a_offset,texcoord_index:j.index.a_texcoord,texcoord_width:o.texcoord_width,texcoord_normalize:65535,closed_polygon:d&&d.closed_polygon,remove_tile_edges:!o.tile_edges&&d&&d.remove_tile_edges,tile_edge_tolerance:Geo$1.tile_scale*h.tile.pad_scale*2,offset:o.offset,crop_by_tile:this.crop_by_tile})},buildPolygons:function(e,o,s,h){for(var d=0,g=0;g<e.length;g++)d+=this.buildLines(e[g],o,s,h,{closed_polygon:!0,remove_tile_edges:!this.crop_by_tile});return d}});var TEX_COORDS=[[1,1],[1,-1],[-1,1],[-1,-1]];function addVertex$1(e,o,s,h,d,g,_){var j,$=o.vertex_template,_t=o.vertex_data;setAttribute(o,"a_position",e),setAttribute(o,"a_width",o.half_width),o.vertex_layout_index.a_barycentric&&((j=[0,0,0])[s%3]=1,setAttribute(o,"a_barycentric",j)),setAttribute(o,"a_tangents",_[0].concat(_[1])),setAttribute(o,"a_segment",h),setAttribute(o,"a_texcoord",TEX_COORDS[s%4]),setAttribute(o,"a_length",d),setAttribute(o,"a_closed",o.closed?1:0),setAttribute(o,"a_angles",g),_t.addVertex($)}function setAttribute(e,o,s){var h=s.length,d=e.vertex_template,g=e.vertex_layout_index[o],_=0;if(h)for(;_!==h;)d[g+_]=s[_],_++;else d[g+_]=s}function buildPatternBuffer(e,o){for(var s=e.reduce(function(_n,_o){return _n+_o}),h=0,d=[],g=0,_=e.length;g<=_;g+=2){var j=Math.max(1e-4,e[g%_]),$=Math.max(1e-4,e[(g+1)%_]);d.push(h,h+j),h+=j+$}for(var _t=new Uint8Array(4*o),_e=0,_r=0;_r<o;_r++)(function(_n){var _o=s*_n/(o-1),ga=minIdx(d.map(function(_p){return Math.abs(_p-_o)})),_l=void 0,_f=void 0,_c=void 0,_c=ga%2==0?(_l=_o<=d[ga]?1:0,_f=d[ga],d[ga+1]):(_l=_o>d[ga]?2:0,_f=d[ga-1],d[ga]);_t[_e++]=d[ga],_t[_e++]=_l,_t[_e++]=_f,_t[_e++]=_c})(_r);return _t}function minIdx(e){for(var o=e[0],s=0,h=1,d=e.length;h<d;h++)e[h]<o&&(o=e[s=h]);return s}var vertex_shader_src=`uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform sampler2D u_uniforms;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform vec3 u_map_position;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_index;uniform vec2 u_dash_caps;uniform float u_dash_phase;uniform float u_dash_period;attribute vec4 a_position;attribute vec4 a_color;attribute float a_width;
#ifdef TANGRAM_DEBUG_TRIANGLES
attribute vec3 a_barycentric;
#endif
attribute vec2 a_normal;attribute float a_length;attribute vec2 a_segment;attribute vec2 a_texcoord;attribute vec2 a_angles;attribute vec4 a_tangents;attribute float a_closed;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;
#ifdef TANGRAM_DEBUG_TRIANGLES
varying vec3 v_barycentric;
#endif
varying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;
#define TANGRAM_NORMAL vec3(0., 0., 1.)
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
varying vec4 v_modelpos_base_zoom;
#endif
#if defined(TANGRAM_LIGHTING_VERTEX)
varying vec4 v_lighting;
#endif
#ifndef TANGRAM_HEIGHT_SCALE
float TANGRAM_HEIGHT_SCALE=16.0;
#endif
#define UNPACK_SCALING(x) (x / 1024.)
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: global
const float PI=3.141592653589793;const float THETA=15.0*PI/180.0;float cross(in vec2 v1,in vec2 v2){return v1.x*v2.y-v1.y*v2.x;}float signed_distance(in vec2 v1,in vec2 v2,in vec2 v3){return cross(v2-v1,v1-v3)/length(v2-v1);}void rotate(in vec2 v,in float angle,out vec2 result){float cosine=cos(angle);float sine=sin(angle);result=vec2(cosine*v.x-sine*v.y,sine*v.x+cosine*v.y);}void main(){
#pragma tangram: setup
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
v_modelpos_base_zoom=modelPositionBaseZoom();
#endif
float linewidth=a_width*2.0;v_angles=a_angles;v_segment=a_segment;v_color=a_color;v_length=a_length;v_texcoord=a_texcoord;
#ifdef TANGRAM_DEBUG_TRIANGLES
v_barycentric=a_barycentric;
#endif
v_color.a=min(linewidth,v_color.a);linewidth=max(linewidth,1.0);linewidth/=exp2(u_map_position.z-u_tile_origin.w);v_linewidth_and_closed=linewidth*(a_closed>0.0 ?-1.0 : 1.0);if(v_color.a<=0.0){gl_Position=vec4(0.0,0.0,0.0,1.0);return;}float width=ceil(1.25*u_antialias+linewidth)/2.0;vec2 t1=normalize(a_tangents.xy);vec2 t2=normalize(a_tangents.zw);float u=a_texcoord.x;u*=-1.0;float v=a_texcoord.y;vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.0);if(t1!=t2){float angle=a_texcoord.x==1.0 ? a_angles.x : a_angles.y;vec2 t=normalize(t1+t2);vec2 o=vec2(+t.y,-t.x);float segmentLength=a_segment.y-a_segment.x;float magnitude=width/cos(angle/2.0);float sqMagnitude=magnitude*magnitude;float seg1SqMagnitude=dot(a_tangents.xy,a_tangents.xy);float seg2SqMagnitude=dot(a_tangents.zw,a_tangents.zw);if((abs(magnitude)>linewidth)&&(sqMagnitude>=min(seg1SqMagnitude,seg2SqMagnitude))){if(u==1.0){o=vec2(-t2.y,+t2.x);}else{o=vec2(-t1.y,+t1.x);}magnitude=width;angle=0.0;v_angles.x=0.0;v_angles.y=0.0;}if(u_dash_index>0.0){if((abs(angle)>THETA)){position.xy+=v*width*o/cos(angle/2.0);float s=sign(angle);if(angle<0.0){if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==1.0){position.xy-=2.0*width*t1/sin(angle);u-=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==1.0){position.xy+=2.0*width*t2/sin(angle);u+=2.0*width/sin(angle);}}}else{if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==-1.0){position.xy+=2.0*width*t1/sin(angle);u+=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==-1.0){position.xy-=2.0*width*t2/sin(angle);u-=2.0*width/sin(angle);}}}}else{position.xy+=v*width*o/cos(angle/2.0);if(u==+1.0){u=v_segment.y;}else{u=v_segment.x;}}}else{position.xy+=v*o*magnitude;if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);}else{u=v_segment.x-v*width*tan(angle/2.0);}}v_joinIndicator=(segmentLength+v*width*tan(angle/2.0))/segmentLength;}else{v_joinIndicator=-1.0;vec2 o=vec2(+t1.y,-t1.x);position.xy+=v*width*o;if(u==-1.0){u=v_segment.x-width;position.xy-=width*t1;}else{u=v_segment.y+width;position.xy+=width*t2;}}vec2 t;vec2 curr=a_position.xy;if(a_texcoord.x>=0.0){vec2 next=curr+t2*(v_segment.y-v_segment.x);rotate(t1,+a_angles.x/2.0,t);v_miter.x=signed_distance(curr,curr+t,position.xy);rotate(t2,+a_angles.y/2.0,t);v_miter.y=signed_distance(next,next+t,position.xy);}else{vec2 prev=curr-t1*(v_segment.y-v_segment.x);rotate(t1,-a_angles.x/2.0,t);v_miter.x=signed_distance(prev,prev+t,position.xy);rotate(t2,-a_angles.y/2.0,t);v_miter.y=signed_distance(curr,curr+t,position.xy);}v_distances=vec2(u,v*width);v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;
#pragma tangram: position
v_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);
#if defined(TANGRAM_LIGHTING_VERTEX)
vec3 normal=v_normal;
#pragma tangram: normal
v_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));
#endif
cameraProjection(position);
#ifdef TANGRAM_LAYER_ORDER
applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);
#endif
gl_Position=position;}`,fragment_shader_src=`uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_dash_atlas;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_phase;uniform float u_dash_period;uniform float u_dash_index;uniform vec2 u_dash_caps;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;
#ifdef TANGRAM_DEBUG_TRIANGLES
varying vec3 v_barycentric;
#endif
varying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;
#define TANGRAM_NORMAL v_normal
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
varying vec4 v_modelpos_base_zoom;
#endif
#if defined(TANGRAM_LIGHTING_VERTEX)
varying vec4 v_lighting;
#endif
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: global
#pragma tangram: utils
const float PI=3.141592653589793;const float HALF_PI=PI/2.0;const float THETA=15.0*PI/180.0;/***Compute distance to cap.*@param{int}type The Type of the cap(see CAP_TYPE in pattern_lines)*@param{float}dx The distance of the pixel from the beginning of the line(not straight distance,but along the legs)*@param{float}dy The distance of the pixel from the midline(see v_distances in vertex shader,aka ±1*half_line_width)*@param{float}aa_radius The distance from the mid-line from where antialiasing starts.*For example for a linewidth 10px width and 2px filter radius it is 10px/2-2px=3px.*@return{float}distance*/float cap(int type,float dx,float dy,float aa_radius){float dist=0.0;dx=abs(dx);dy=abs(dy);if(type==1)dist=sqrt(dx*dx+dy*dy);else if(type==3)dist=(dx+abs(dy));else if(type==2)dist=max(abs(dy),(aa_radius+dx-abs(dy)));else if(type==4)dist=max(dx,dy);else if(type==5)dist=max(dx+aa_radius,dy);return dist;}/***Compute distance to join.*@param{int}type The type of the join(see JOIN_TYPE in pattern_lines)*@param{vec2}segment Interpolated a_segment attribute from the vertex shader*@param{vec2}texcoord Pair of u/v coordinates to identify the 4 different extruded points of the segment.*@param{vec2}distances 2 component vector where:*x is the distance of the pixel from the beginning of the line(along the legs)*y is the  distance of the pixel from the midline(see v_distances in vertex shader,±1*half_line_width)*@param{vec2}miter Miter point coordiante*@param{float}miter_limit The miter limit*@param{float}linewidth The width of the line*@return{float}computed distance*/float join(in int type,in vec2 segment,in vec2 texcoord,in vec2 distances,in vec2 miter,in float miter_limit,in float linewidth){float dx=distances.x;float result=abs(distances.y);if((dx<segment.x)||(dx>segment.y)){if(type==1){float s=dx<segment.x ? segment.x : segment.y;result=max(result,length(distances-vec2(s,0.0)));}else{float m=abs(texcoord.x>=0.0 ? miter.x : miter.y);if(type==2){result=max(result,m);}else if(type==0){result=max(result,m-miter_limit*linewidth/2.0);}}}return result;}void main(void){
#pragma tangram: setup
vec4 color=v_color;vec3 normal=TANGRAM_NORMAL;
#ifdef TANGRAM_CROP_BY_TILE
if(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}
#endif
#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)
calculateNormal(normal);
#endif
#if !defined(TANGRAM_LIGHTING_VERTEX)
#pragma tangram: normal
#endif
#pragma tangram: color
#if defined(TANGRAM_LIGHTING_FRAGMENT)
color=calculateLighting(v_position.xyz-u_eye,normal,color);
#elif defined(TANGRAM_LIGHTING_VERTEX)
color*=v_lighting;
#endif
#pragma tangram: filter
if(v_color.a<=0.0){discard;}bool solid=(u_dash_index==0.0);bool closed=v_linewidth_and_closed<0.0;float dx=v_distances.x;float dy=v_distances.y;float linewidth=abs(v_linewidth_and_closed);float aa_radius=linewidth/2.0-u_antialias;float dist=0.0;vec2 linecaps=u_linecaps;vec2 dash_caps=u_dash_caps;float line_start=0.0;float line_stop=v_length;if(solid){dist=abs(dy);bool potentialCap=!closed&&v_joinIndicator<0.0;if(potentialCap&&dx<line_start){dist=cap(int(u_linecaps.x),abs(dx),abs(dy),aa_radius);}else if(potentialCap&&dx>line_stop){dist=cap(int(u_linecaps.y),abs(dx)-line_stop,abs(dy),aa_radius);}else{dist=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);}}else{float segment_start=v_segment.x;float segment_stop=v_segment.y;float segment_center=(segment_start+segment_stop)/2.0;float freq=u_dash_period*linewidth;float dash_phase=u_dash_phase-1e-5;float u=mod(dx+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));float dash_center=float(tex.x)*255.0*linewidth;float dash_type=floor(float(tex.y)*255.0+0.5);float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;float dash_start=dx-u+_start;float dash_stop=dx-u+_stop;if((dash_stop<segment_start)&&(dash_caps.x!=5.0)){float u=mod(segment_start+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_start-u+_start;dash_stop=segment_start-u+_stop;}else if((dash_start>segment_stop)&&(dash_caps.y!=5.0)){float u=mod(segment_stop+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_stop-u+_start;dash_stop=segment_stop-u+_stop;}bool discontinuous=((dx<segment_center)&&abs(v_angles.x)>THETA)||((dx>=segment_center)&&abs(v_angles.y)>THETA);float d_join=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);if(closed){line_start+=linewidth/2.0;line_stop-=linewidth/2.0;}if(dash_stop<=line_start){discard;}if(dash_start>=line_stop){discard;}if(discontinuous){if((dash_start>segment_stop)){discard;}if((dash_stop<segment_start)){discard;}if(dash_caps.x==1.0){if((u>_stop)&&(dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){discard;}}if(dash_caps.y==1.0){if((u<_start)&&(dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){discard;}}if((dash_caps.x!=1.0)&&(dash_caps.x!=5.0)){if((dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){float a=v_angles.x/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(segment_start-dx)*cos_a-dy*sin_a;float y=(segment_start-dx)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.x=4.0;}}if((dash_caps.y!=1.0)&&(dash_caps.y!=5.0)){if((dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){float a=v_angles.y/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(dx-segment_stop)*cos_a-dy*sin_a;float y=(dx-segment_stop)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.y=4.0;}}}if((dx<line_start)&&(dash_start<=line_start)&&(dash_stop>line_start)){dist=cap(int(linecaps.x),dx-line_start,dy,aa_radius);}else if((dx>line_stop)&&(dash_stop>line_stop)&&(dash_start<line_stop)){dist=cap(int(linecaps.y),dx-line_stop,dy,aa_radius);}else if(dash_type==1.0){dist=cap(int(dash_caps.x),abs(dash_center-u),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}else if(dash_type==0.0){dist=abs(dy);}else if(dash_type==2.0){dist=cap(int(dash_caps.y),abs(u-dash_center),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}if((dx>line_start)&&(dx<line_stop)){if((dx<=segment_start)&&(dash_start<=segment_start)&&(dash_stop>=segment_start)){dist=d_join;float angle=HALF_PI+v_angles.x;float f=abs((segment_start-dx)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if((dx>segment_stop)&&(dash_start<=segment_stop)&&(dash_stop>=segment_stop)){dist=d_join;float angle=HALF_PI+v_angles.y;float f=abs((dx-segment_stop)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}dist=dist-aa_radius;if(dist>=0.0){if(u_antialias==0.0){discard;}else{color=vec4(color.rgb,exp(-dist*dist)*color.a);}}
#ifdef TANGRAM_DEBUG_TRIANGLES
if(any(lessThan(v_barycentric,vec3(0.0085)))){color=vec4(0.0,1.0,0.0,1.0);}
#endif
gl_FragColor=color;}`,PatternLines=Object.create(Style),CAP_TYPE$1={round:1,"arrow-tail":2,"arrow-head":3,square:4,butt:5},JOIN_TYPE$1={miter:0,round:1,bevel:2},PATTERN_MAX_WIDTH=1024,DEFAULT_LINE_CAP=CAP_TYPE$1.round,DEFAULT_JOIN_TYPE=JOIN_TYPE$1.miter,DEFAULT_DASH_PATTERN=[0,0],VARIANT_UNIQUE_PROP_NAMES="antialias join linecaps miter_limit dash_index dash dash_caps dash_phase".split(" ");function getHashForStyle(e){for(var o=[],s=0,h=VARIANT_UNIQUE_PROP_NAMES.length;s<h;s++){var d=e[VARIANT_UNIQUE_PROP_NAMES[s]];Array.isArray(d)?o.push(d.join("_")):typeof d=="boolean"?o.push(d?1:0):d&&o.push(d.toString())}return o.join("/")}Object.assign(PatternLines,{name:"pattern-lines",built_in:!0,vertex_shader_src,fragment_shader_src,selection:!0,init:function(){Style.init.apply(this,arguments),this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_DEBUG_TRIANGLES=!1,this.defines.TANGRAM_DEBUG_NO_TEXTURE_FLOAT_SUPPORT=!1,this.styles=this.styles||{},PatternLines.vertex_layouts=[]},calcDistance:function(e,o){return e&&StyleParser.evalCachedDistanceProperty(e,o)||0},calcDash:function(e,o){var s=StyleParser.evalProperty(e.dash,o),h=0;return s&&((s=Array.isArray(s)&&s.length?s:DEFAULT_DASH_PATTERN).length%2==1&&(s=s.concat(s)),h=+(h=s.reduce(function(d,g){return d+g}))||0),{dash:s,dash_period:h}},calcWidth:function(e,o,s){var h=this.calcDistance(e.width,s);return!(h<0)&&(o.width=h*s.units_per_meter_overzoom,!0)},getCapType:function(e,o,s){var h=StyleParser.evalProperty(e,o);return CAP_TYPE$1[h]!==void 0?CAP_TYPE$1[h]:s},_parseFeature:function(e,o,s){if(this.calcWidth(o,this.feature_style,s)!==!1){var h=this.parseColor(o.color,s);if(h&&h[3]!==0){var d=this.getCapType(o.cap,s,DEFAULT_LINE_CAP),g=StyleParser.evalProperty(o.join,s),_=+StyleParser.evalProperty(o.miter_limit,s),j=this.calcDash(o,s),$=j.dash,_t=j.dash_period,_e=Object.assign({color:h,antialias:o.antialias,linecaps:[this.getCapType(o.tail_cap,s,d),this.getCapType(o.head_cap,s,d)],join:JOIN_TYPE$1[g]!==void 0?JOIN_TYPE$1[g]:DEFAULT_JOIN_TYPE,miter_limit:0<=_?_:3,dash_index:_t===0?0:1,dash:$,dash_caps:[this.getCapType(o.tail_cap,s,d),this.getCapType(o.head_cap,s,d)],dash_phase:+StyleParser.evalProperty(o.dash_phase,s)||0,dash_period:_t},this.feature_style);return _e.z=o.z&&StyleParser.evalCachedDistanceProperty(o.z||0,s)||StyleParser.defaults.z,_e.z*=Geo$1.height_scale,_e.extrude=StyleParser.evalProperty(o.extrude,s),_e.extrude&&(_e.extrude===!0?(_e.height=e.properties.height!==void 0?e.properties.height:StyleParser.defaults.height,_e.min_height=e.properties.min_height!==void 0?e.properties.min_height:StyleParser.defaults.min_height):typeof _e.extrude=="number"?(_e.height=_e.extrude,_e.min_height=0):Array.isArray(_e.extrude)&&(_e.min_height=_e.extrude[0],_e.height=_e.extrude[1]),_e.height*=Geo$1.height_scale,_e.min_height*=Geo$1.height_scale),this.addMeshVariantForDraw(this.base,_e),_e}}},_preprocess:function(e){e.color=StyleParser.createColorPropertyCache(e.color),e.width=StyleParser.createPropertyCache(e.width,StyleParser.parseUnits),e.width&&e.width.type!==StyleParser.CACHE_TYPE.STATIC&&(e.next_width=StyleParser.createPropertyCache(e.width,StyleParser.parseUnits)),e.z=StyleParser.createPropertyCache(e.z,StyleParser.parseUnits);var o=+e.antialias;return e.antialias=isNaN(o)?0:o,e},buildRasterTextures:function(e,o){var s=[];for(var h in o.meshes){var d,g=this.getMeshVariantTypeForDraw({variantKey:h}),_=g.uniforms,j=g.pattern;_.u_dash_index&&(d="__dash_"+j.join("_")+"_"+e.key+"_"+e.id,s.push({name:d,data:buildPatternBuffer(j,PATTERN_MAX_WIDTH)}),_.u_dash_atlas=d,o.meshes[h].textures=[d]),o.meshes[h].uniforms=_}return o.uniforms=o.uniforms||{},s.length?WorkerBroker.postMessage(this.main_thread_target+".loadTextures",s).then(function($){return o}):Promise.resolve(o)},loadTextures:function(e){for(var o=[],s=0;s<e.length;s++){var h=e[s],d=(d=this.textureManager.textures[h.name])||this.textureManager.create(this.gl,h.name,{filtering:"nearest",repeat:!0,width:PATTERN_MAX_WIDTH,height:1,data:h.data});o.push(d.loading)}return Promise.all(o).then(function(g){return g.map(function(_){return _.retain(),_.name})})},computeVariantForDraw:function(e){var o=getHashForStyle(e);return{key:e.variantKey=o,order:e.variant_order,uniforms:{u_antialias:e.antialias,u_linecaps:e.linecaps,u_linejoin:e.join,u_miter_limit:e.miter_limit,u_dash_index:e.dash_index,u_dash_caps:e.dash_caps,u_dash_phase:e.dash_phase,u_dash_period:e.dash_period},pattern:e.dash}},vertexLayoutForMeshVariant:function(e){var o;return PatternLines.vertex_layouts[e.key]==null&&(o=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_width",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_tangents",size:4,type:gl$1.FLOAT,normalized:!1},{name:"a_segment",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_angles",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.FLOAT,normalized:!0},{name:"a_length",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_closed",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}],this.defines.TANGRAM_DEBUG_TRIANGLES&&o.push({name:"a_barycentric",size:3,type:gl$1.SHORT,normalized:!1}),PatternLines.vertex_layouts[e.key]=new VertexLayout(o)),PatternLines.vertex_layouts[e.key]},makeVertexTemplate:function(e){var o=0;return this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=e.z+e.height||0,this.vertex_template[o++]=this.scaleOrder(e.order),this.vertex_template[o++]=255*e.color[0],this.vertex_template[o++]=255*e.color[1],this.vertex_template[o++]=255*e.color[2],this.vertex_template[o++]=255*e.color[3],this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.selection&&(this.vertex_template[o++]=255*e.selection_color[0],this.vertex_template[o++]=255*e.selection_color[1],this.vertex_template[o++]=255*e.selection_color[2],this.vertex_template[o++]=255*e.selection_color[3]),this.defines.TANGRAM_DEBUG_TRIANGLES&&(this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=0),this.vertex_template},buildLines:function(e,o,s,h,d){var g=4<arguments.length&&d!==void 0&&d,_=s.vertex_data,j=_.vertex_layout,$=this.makeVertexTemplate(o,s);return buildPolylines$1(e,o.width,_,$,j.index,g)},buildPolygons:function(e,o,s,h){for(var d=0,g=0,_=e.length;g<_;g++)d+=this.buildLines(e[g],o,s,h,!0);return d}});var STICK_WIDTH=1;function buildQuadsForPoints(e,o,s,h){var d,g,_,j,$,_t,_e=h.quad,Ly=h.quad_normalize,_r=h.offset,_n=h.offsets,_o=h.offsets_alt,ga=h.pre_angles,_l=h.pre_angles_alt,_f=h.angle,_c=h.angles,_p=h.angles_alt,_g=h.is_flat,ty=h.elevate_by_altitude,oy=h.build_stick_points,ry=h.color,ly=h.stick_color,py=h.curve,gy=h.texcoord_scale,by=h.texcoord_normalize,wy=h.pre_angles_normalize,Cy=h.angles_normalize,Gy=h.offsets_normalize,Ly=Ly||1,d0=_e[0]/2*Ly,s0=_e[1]/2*Ly,t0=[[-d0,-s0],[d0,-s0],[d0,s0],[-d0,s0]],Ay=o.vertex_elements,Ny=o.vertex_count,Hy=o.vertex_layout.index,n0=Hy.a_texcoord,v0=Hy.a_position,f0=Hy.a_shape,A0=Hy.a_offset,q0=Hy.a_offsets,D0=Hy.a_offsets_alt,K0=Hy.a_pre_angles,a1=Hy.a_pre_angles_alt,J0=Hy.a_angles,C0=Hy.a_angles_alt,H0=Hy.a_is_flat,u1=Hy.a_is_stick,t1=Hy.a_color;n0&&(by=by||1,_t=[[g=(d=_slicedToArray(gy||default_uvs,4))[0],_=d[1]],[j=d[2],_],[j,$=d[3]],[g,$]]);for(var n1=0,h1=e.length,s1=0;s1<h1;s1++){var W0=e[s1];if(oy){for(var i1=STICK_WIDTH/2*Ly,w1=+Ly,k1=[[-i1,0],[+i1,0],[+i1,w1],[-i1,w1]],X0=0;X0<4;X0++)n0&&(s[n0+0]=_t[X0][0]*by,s[n0+1]=_t[X0][1]*by),s[v0+0]=W0[0],s[v0+1]=W0[1],ty&&(s[v0+2]=MathUtils$1.clamp(W0[2],0,32767)),s[f0+0]=k1[X0][0],s[f0+1]=k1[X0][1],s[f0+2]=0,s[t1+0]=ly[0],s[t1+1]=ly[1],s[t1+2]=ly[2],s[t1+3]=ly[3],s[u1+0]=255,o.addVertex(s);Ay.push(Ny+0),Ay.push(Ny+1),Ay.push(Ny+2),Ay.push(Ny+2),Ay.push(Ny+3),Ay.push(Ny+0),Ny+=4,n1+=2}for(var l1=0;l1<4;l1++)n0&&(s[n0+0]=_t[l1][0]*by,s[n0+1]=_t[l1][1]*by),s[v0+0]=W0[0],s[v0+1]=W0[1],ty&&(s[v0+2]=MathUtils$1.clamp(W0[2],0,32767)),s[f0+0]=t0[l1][0],s[f0+1]=t0[l1][1],s[f0+2]=_f,s[t1+0]=ry[0],s[t1+1]=ry[1],s[t1+2]=ry[2],s[t1+3]=ry[3],s[A0+0]=_r[0],s[A0+1]=_r[1],s[H0+0]=_g?255:0,oy&&(s[u1+0]=0),py&&(s[K0+0]=wy*ga[0],s[K0+1]=wy*ga[1],s[K0+2]=wy*ga[2],s[K0+3]=wy*ga[3],s[J0+0]=Cy*_c[0],s[J0+1]=Cy*_c[1],s[J0+2]=Cy*_c[2],s[J0+3]=Cy*_c[3],s[q0+0]=Gy*_n[0],s[q0+1]=Gy*_n[1],s[q0+2]=Gy*_n[2],s[q0+3]=Gy*_n[3],_o&&(s[D0+0]=Gy*_o[0],s[D0+1]=Gy*_o[1],s[D0+2]=Gy*_o[2],s[D0+3]=Gy*_o[3],s[a1+0]=wy*_l[0],s[a1+1]=wy*_l[1],s[a1+2]=wy*_l[2],s[a1+3]=wy*_l[3],s[C0+0]=Cy*_p[0],s[C0+1]=Cy*_p[1],s[C0+2]=Cy*_p[2],s[C0+3]=Cy*_p[3])),o.addVertex(s);Ay.push(Ny+0),Ay.push(Ny+1),Ay.push(Ny+2),Ay.push(Ny+2),Ay.push(Ny+3),Ay.push(Ny+0),Ny+=4,n1+=2}return n1}var id$2=0,Label={id_prefix:"",nextLabelId:function(){return"".concat(Label.id_prefix,"/").concat(id$2++)}};function textLayoutToJSON(e){return{priority:e.priority,collide:e.collide,repeat_distance:e.repeat_distance,repeat_group:e.repeat_group,buffer:e.buffer,italic:e.italic}}var lefts=["left","top-left","bottom-left"],rights=["right","top-right","bottom-right"],tops=["top","top-left","top-right"],bottoms=["bottom","bottom-left","bottom-right"],PointAnchor$1={computeOffset:function(e,o,s,h){var g=3<arguments.length&&h!==void 0?h:null;if(!s||s==="center")return e;var d=[e[0],e[1]],g=g||this.default_buffer;return this.isLeftAnchor(s)?(d[0]-=o[0]/2,s==="left"&&(d[0]-=g[0])):this.isRightAnchor(s)&&(d[0]+=o[0]/2,s==="right"&&(d[0]+=g[1])),this.isTopAnchor(s)?(d[1]-=o[1]/2,s==="top"&&(d[1]-=g[2])):this.isBottomAnchor(s)&&(d[1]+=o[1]/2,s==="bottom"&&(d[1]+=g[3])),d},alignForAnchor:function(e){if(e&&e!=="center"){if(this.isLeftAnchor(e))return"right";if(this.isRightAnchor(e))return"left"}return"center"},isLeftAnchor:function(e){return-1<lefts.indexOf(e)},isRightAnchor:function(e){return-1<rights.indexOf(e)},isTopAnchor:function(e){return-1<tops.indexOf(e)},isBottomAnchor:function(e){return-1<bottoms.indexOf(e)},default_buffer:[2.5,2.5,1.5,.75],zero_buffer:[0,0,0,0]};function encircleLine(e,o,s,h,d){var g=[],_=s-e,j=h-o,$=MathUtils$1.getLineLength(e,o,s,h),_t=2*d;if((_e=$/_t)<=1)g.push(e+_/2,o+j/2,d);else{var _e,_r=_t/$,_n=_*_r,_o=j*_r;(_e=$/d/2)%1&&g.push(s-_n/2,h-_o/2,d),_e|=0;for(var ga=e+_n/2,_l=o+_o/2;_e--;)g.push(ga,_l,d),ga+=_n,_l+=_o}return g}var LabelPoint=function(){function e(o,s,h,d){_classCallCheck(this,e),this.id=Label.nextLabelId(),this.position=[o[0],o[1]],o[2]!==void 0&&this.position.push(o[2]),this.size=s,this.layout=d,this.anchor=Array.isArray(this.layout.anchor)?this.layout.anchor[0]:this.layout.anchor,this.placed=null,this.type="point",this.parent=this.layout.parent,this.offset=this.computeOffset(),this.align=this.layout.align||PointAnchor$1.alignForAnchor(this.anchor),this._is_flat=h}return _createClass(e,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,align:this.align,sides:this.getSides(),breach:!this.inTileBounds(),layout:textLayoutToJSON(this.layout)}}},{key:"inTileBounds",value:function(){var o=this.getAABB(),s=o.left,h=o.top,d=o.right,g=o.bottom;return Utils$1.pointInTile([s,h])&&Utils$1.pointInTile([d,g])}},{key:"isFlat",value:function(){return this._is_flat}},{key:"setAnchor",value:function(o){this._circles=void 0,this._aabb=void 0,this.anchor=o,this.offset=this.computeOffset()}},{key:"computeOffset",value:function(){var o,s=[this.layout.offset[0],this.layout.offset[1]];return this.parent&&(o=this.parent,s=PointAnchor$1.computeOffset(s,o.size,o.anchor,PointAnchor$1.zero_buffer),s=PointAnchor$1.computeOffset(s,o.size,this.anchor,PointAnchor$1.zero_buffer),o.offset!==StyleParser.zeroPair&&(s===StyleParser.zeroPair?s=o.offset:(s[0]+=o.offset[0],s[1]+=o.offset[1]))),PointAnchor$1.computeOffset(s,this.size,this.anchor)}},{key:"getBoundingCircles",value:function(){return this.angle?(this._circles||(o=this.layout.units_per_pixel,g=-(h=(s=this.size[0]/2*o)*Math.cos(this.angle)),_=-(d=s*Math.sin(this.angle)),$=(j=_slicedToArray(this.position,2))[0],_t=j[1],h+=$,d+=_t*=-1,g+=$,_+=_t,_e=this.size[1]/2*o,this._circles=encircleLine(h,d,g,_,_e)),this._circles):[];var o,s,h,d,g,_,j,$,_t,_e}},{key:"getAABB",value:function(){var o,s,h,d,g;return this._aabb||(o=this.layout.units_per_pixel,s=(this.size[0]/2+this.layout.buffer[0])*o,h=(this.size[1]/2+this.layout.buffer[1])*o,d=this.position[0]+this.offset[0]*o,g=this.position[1]-this.offset[1]*o,this._aabb={left:d-s,top:g+h,right:d+s,bottom:g-h}),this._aabb}},{key:"getSides",value:function(){var o=this.getAABB(),s=o.left,h=o.top,d=o.right,g=(h+o.bottom)/2;return[s,g,d,g]}}]),e}();LabelPoint.PLACEMENT={VERTEX:0,MIDPOINT:1,SPACED:2,CENTROID:3};var PLACEMENT=LabelPoint.PLACEMENT,default_spacing=80;function placePointsOnLine(e,o,s,h){var d=[],g=h.placement,_=Math.max(o[0],o[1])*h.placement_min_length_ratio*h.units_per_pixel;switch(g){case PLACEMENT.SPACED:var j=getPositionsAndAngles(e,_,h);if(!j)return[];for(var $=j.positions,_t=j.angles,_e=0;_e<$.length;_e++){var _r,_n=$[_e],_o=_t[_e];h.tile_edges!==!0&&isCoordOutsideTile(_n)||((_r=new LabelPoint(_n,o,s,h)).angle=_o,d.push(_r))}break;case PLACEMENT.VERTEX:for(var ga,_l,_f,_c=0;_c<e.length-1;_c++)ga=e[_c],_l=e[_c+1],h.tile_edges!==!0&&isCoordOutsideTile(ga)||((_f=new LabelPoint(ga,o,s,h)).angle=getAngle(ga,_l,h.angle),d.push(_f));(_f=new LabelPoint(_l,o,s,h)).angle=getAngle(ga,_l,h.angle),d.push(_f);break;case PLACEMENT.MIDPOINT:for(var _p=0;_p<e.length-1;_p++){var _g,ty=e[_p],oy=e[_p+1],ry=[.5*(ty[0]+oy[0]),.5*(ty[1]+oy[1])];h.tile_edges!==!0&&isCoordOutsideTile(ry)||(!_||norm(ty,oy)>_)&&((_g=new LabelPoint(ry,o,s,h)).angle=getAngle(ty,oy,h.angle),d.push(_g))}}return d}function getPositionsAndAngles(e,o,s){var h=s.units_per_pixel,d=(s.placement_spacing||default_spacing)*h,g=getLineLength(e);if(g<=o)return!1;for(var _=Math.max(Math.floor(g/d),1),j=[],$=[],_t=.5*(g-(_-1)*d),_e=0;_e<_;_e++){var _r=interpolateLine(e,_t,o,s),_n=_r.position,_o=_r.angle;_n!=null&&_o!=null&&(j.push(_n),$.push(_o)),_t+=d}return{positions:j,angles:$}}function getAngle(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return s==="auto"?Math.atan2(o[0]-e[0],o[1]-e[1]):s}function getLineLength(e){for(var o=0,s=0;s<e.length-1;s++)o+=norm(e[s],e[s+1]);return o}function norm(e,o){return Math.sqrt(Math.pow(e[0]-o[0],2)+Math.pow(e[1]-o[1],2))}function interpolateLine(e,o,s,h){for(var d,g,_=0,j=0;j<e.length-1;j++){var $=e[j],_t=e[j+1],_e=norm($,_t);if(!(_e<=s)&&o<(_+=_e)){d=interpolateSegment($,_t,_-o),g=getAngle($,_t,h.angle);break}}return{position:d,angle:g}}function interpolateSegment(e,o,s){var h=s/norm(e,o);return[h*e[0]+(1-h)*o[0],h*e[1]+(1-h)*o[1]]}var TextSettings$1={key:function(e){return[e.style,e.weight,e.family,e.px_size,e.fill,e.stroke,e.stroke_width,e.transform,e.text_wrap,e.max_lines,e.supersample,e.background_color,e.outline_color,e.outline_width,e.padding,Utils$1.device_pixel_ratio].join("/")},defaults:{style:"normal",weight:null,size:"12px",px_size:12,family:"Helvetica",fill:"white",text_wrap:15,max_lines:5,align:"center",stroke:null,stroke_width:0,background_color:null,outline_color:null,outline_width:0,padding:[0,0,0,0]},compute:function(e,o,s){var h={};if(o.font=o.font||this.defaults,h.can_articulate=o.can_articulate,h.fill=o.font.fill&&Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(o.font.fill,s))||this.defaults.fill,h.style=o.font.style||this.defaults.style,h.weight=o.font.weight||this.defaults.weight,o.font.family?(h.family=o.font.family,h.family!==this.defaults.family&&(h.family+=", "+this.defaults.family)):h.family=this.defaults.family,h.transform=o.font.transform,h.size=o.font.size||this.defaults.size,h.supersample=o.supersample_text?1.5:1,h.px_size=StyleParser.evalCachedProperty(o.font.px_size,s)*h.supersample,h.px_size!==0){o.font.stroke&&o.font.stroke.color&&(h.stroke=Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(o.font.stroke.color,s)||this.defaults.stroke),h.stroke_width=StyleParser.evalCachedProperty(o.font.stroke.width,s)||this.defaults.stroke_width),h.font_css=this.fontCSS(h);var d=o.text_wrap;return d==null&&Geo$1.geometryType(e.geometry.type)!=="line"&&(d=!0),d===!0&&(d=this.defaults.text_wrap),h.text_wrap=d,h.max_lines=o.max_lines||this.defaults.max_lines,h.background_color=o.background&&o.background.color&&!o.can_articulate?Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(o.background.color,s)):this.defaults.background_color,h.outline_color=o.outline&&o.outline.color&&!o.can_articulate?Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(o.outline.color,s)):this.defaults.outline_color,h.outline_width=o.outline&&o.outline.width&&!o.can_articulate?StyleParser.evalCachedProperty(o.outline.width,s):this.defaults.outline_width,h.padding=o.padding&&!o.can_articulate?StyleParser.evalCachedProperty(o.padding,s):this.defaults.padding,h}},fontCSS:function(e){return[e.style,e.weight,e.px_size+"px",e.family].filter(function(o){return o}).join(" ")}},fontfaceobserver_standalone=createCommonjsModule(function(e){function o(_n,_o){document.addEventListener?_n.addEventListener("scroll",_o,!1):_n.attachEvent("scroll",_o)}function s(_n){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(_n)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function h(_n,_o){_n.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+_o+";"}function d(_n){var _o=_n.a.offsetWidth,ga=_o+100;return _n.f.style.width=ga+"px",_n.c.scrollLeft=ga,_n.b.scrollLeft=_n.b.scrollWidth+100,_n.g!==_o&&(_n.g=_o,1)}function g(_n,_o){function ga(){var _f=_l;d(_f)&&_f.a.parentNode&&_o(_f.g)}var _l=_n;o(_n.b,ga),o(_n.c,ga),d(_n)}function _(_n,_o){var ga=_o||{};this.family=_n,this.style=ga.style||"normal",this.weight=ga.weight||"normal",this.stretch=ga.stretch||"normal"}function j(_n,_o){return[_n.style,_n.weight,function(){if(_e===null){var ga=document.createElement("div");try{ga.style.font="condensed 100px sans-serif"}catch{}_e=ga.style.font!==""}return _e}()?_n.stretch:"","100px",_o].join(" ")}var $,_t,_e,_r;_r=_e=_t=$=null,_.prototype.load=function(_n,_o){var ga=this,_l=_n||"BESbswy",_f=0,_c=_o||3e3,_p=new Date().getTime();return new Promise(function(_g,ty){var oy,ry,ly;_r===null&&(_r=!!document.fonts),(oy=_r)&&(_t===null&&(_t=/OS X.*Version\/10\..*Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),oy=!_t),oy?(oy=new Promise(function(py,gy){(function by(){new Date().getTime()-_p>=_c?gy():document.fonts.load(j(ga,'"'+ga.family+'"'),_l).then(function(wy){1<=wy.length?py():setTimeout(by,25)},function(){gy()})})()}),ry=new Promise(function(py,gy){_f=setTimeout(gy,_c)}),Promise.race([ry,oy]).then(function(){clearTimeout(_f),_g(ga)},function(){ty(ga)})):(ly=function(){function py(){var Ny;(Ny=Cy!=-1&&Gy!=-1||Cy!=-1&&Ly!=-1||Gy!=-1&&Ly!=-1)&&((Ny=Cy!=Gy&&Cy!=Ly&&Gy!=Ly)||($===null&&(Ny=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),$=!!Ny&&(parseInt(Ny[1],10)<536||parseInt(Ny[1],10)===536&&parseInt(Ny[2],10)<=11)),Ny=$&&(Cy==d0&&Gy==d0&&Ly==d0||Cy==s0&&Gy==s0&&Ly==s0||Cy==t0&&Gy==t0&&Ly==t0)),Ny=!Ny),Ny&&(Ay.parentNode&&Ay.parentNode.removeChild(Ay),clearTimeout(_f),_g(ga))}var gy=new s(_l),by=new s(_l),wy=new s(_l),Cy=-1,Gy=-1,Ly=-1,d0=-1,s0=-1,t0=-1,Ay=document.createElement("div");Ay.dir="ltr",h(gy,j(ga,"sans-serif")),h(by,j(ga,"serif")),h(wy,j(ga,"monospace")),Ay.appendChild(gy.a),Ay.appendChild(by.a),Ay.appendChild(wy.a),document.body.appendChild(Ay),d0=gy.a.offsetWidth,s0=by.a.offsetWidth,t0=wy.a.offsetWidth,function Ny(){var Hy;new Date().getTime()-_p>=_c?(Ay.parentNode&&Ay.parentNode.removeChild(Ay),ty(ga)):((Hy=document.hidden)!==!0&&Hy!==void 0||(Cy=gy.a.offsetWidth,Gy=by.a.offsetWidth,Ly=wy.a.offsetWidth,py()),_f=setTimeout(Ny,50))}(),g(gy,function(Ny){Cy=Ny,py()}),h(gy,j(ga,'"'+ga.family+'",sans-serif')),g(by,function(Ny){Gy=Ny,py()}),h(by,j(ga,'"'+ga.family+'",serif')),g(wy,function(Ny){Ly=Ny,py()}),h(wy,j(ga,'"'+ga.family+'",monospace'))},document.body?ly():document.addEventListener?document.addEventListener("DOMContentLoaded",function py(){document.removeEventListener("DOMContentLoaded",py),ly()}):document.attachEvent("onreadystatechange",function py(){document.readyState!="interactive"&&document.readyState!="complete"||(document.detachEvent("onreadystatechange",py),ly())}))})},e.exports=_}),FontManager={fonts_loaded:Promise.resolve(),last_loaded:null,loadFonts:function(e){var o=this,s=JSON.stringify(e)===this.last_loaded;return e&&!s&&function(){var h=[];for(var d in e)(function(g){Array.isArray(e[g])?e[g].forEach(function(_){return h.push(o.loadFontFace(g,_))}):h.push(o.loadFontFace(g,e[g]))})(d);o.last_loaded=JSON.stringify(e),o.fonts_loaded=Promise.all(h.filter(function(g){return g}))}(),this.fonts_loaded},loadFontFace:function(e,o){if(o!=null&&(_typeof(o)==="object"||o==="external")){var s={family:e},h=Promise.resolve();_typeof(o)==="object"&&(Object.assign(s,o),typeof o.url=="string"&&(h=this.injectFontFace(s)));var d=new fontfaceobserver_standalone(e,s);return h.then(function(){return d.load()}).then(function(){log("debug","Font face '".concat(e,"' is available"),s)},function(){log("debug","Font face '".concat(e,"' is NOT available"),s)})}},injectFontFace:function(e){var o=this,s=e.family,h=e.url,d=e.weight,g=e.style;this.supports_native_font_loading===void 0&&(this.supports_native_font_loading=window.FontFace!==void 0);var _=Promise.resolve(h);return h.slice(0,5)==="blob:"&&(_=Utils$1.io(h,6e4,"arraybuffer").then(function(j){var $=new Uint8Array(j);if(o.supports_native_font_loading)return $;for(var _t="",_e=0;_e<$.length;_e++)_t+=String.fromCharCode($[_e]);return"data:font/opentype;base64,"+btoa(_t)})),_.then(function(j){var $,_t,_e;o.supports_native_font_loading?(typeof j=="string"?$=new FontFace(s,"url(".concat(encodeURI(j),")"),{weight:d,style:g}):j instanceof Uint8Array&&($=new FontFace(s,j,{weight:d,style:g})),document.fonts.add($),log("trace","Adding FontFace to document.fonts:",$)):(_t=`
                    @font-face {
                        font-family: '`.concat(s,`';
                        font-weight: `).concat(d||"normal",`;
                        font-style: `).concat(g||"normal",`;
                        src: url(`).concat(encodeURI(j),`);
                    }
                `),(_e=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(_e),_e.sheet.insertRule(_t,0),log("trace","Injecting CSS font face:",_t))})}},CanvasText=function(){function e(){_classCallCheck(this,e),this.vertical_text_buffer=1,this.horizontal_text_buffer=1,this.layout=layout("binary-tree")}return _createClass(e,[{key:"createCanvas",value:function(o,s){var h=document.createElement("canvas");return o&&s&&(h.width=o,h.height=s),h.style.backgroundColor="transparent",h}},{key:"setFont",value:function(o,s){var h=s.font_css,d=s.fill,g=s.stroke,_=s.stroke_width,j=s.px_size,$=s.supersample;this.px_size=j;var _t=Utils$1.device_pixel_ratio*$;g&&0<_&&(o.strokeStyle=g,o.lineWidth=_*_t),o.fillStyle=d,o.textBaseline="bottom",o.font=h,o.miterLimit=2}},{key:"textSizes",value:function(o,s,h){var d=this;return FontManager.loadFonts().then(function(){return Task.add({type:"textSizes",run:d.processTextSizesTask.bind(d),texts:s,tile_id:o,cursor:{ctx:h,styles:Object.keys(s),texts:null,style_idx:null,text_idx:null}})})}},{key:"processTextSizesTask",value:function(o){var s=o.cursor,h=o.texts,d=s.ctx;for(s.style_idx=s.style_idx||0;s.style_idx<s.styles.length;){var g=s.styles[s.style_idx];s.text_idx==null&&(s.text_idx=0,s.texts=Object.keys(h[g]));for(var _=h[g],j=!0;s.text_idx<s.texts.length;){var $=s.texts[s.text_idx],_t=_[$],_e=_t.text_settings;if(j&&(this.setFont(d,_e),j=!1),_t.size=this.textSize(d,g,$,_e).size,_e.can_articulate){var _r=!1,_n=!1;if(isTextRTL($)&&(isTextNeutral($)?_r=!0:_n=!0),_t.isRTL=_r,_t.no_curving=_n||isTextCurveBlacklisted($),_t.vertical_buffer=this.vertical_text_buffer+_e.outline_width+(_e.padding[0]+_e.padding[2])/2,_t.segment_sizes=[],!_t.no_curving){var _o=splitLabelText($,_r);_t.segments=_o;for(var ga=0;ga<_o.length;ga++)_t.segment_sizes.push(this.textSize(d,g,_o[ga],_e).size)}}if(s.text_idx++,!Task.shouldContinue(o))return!1}s.text_idx=null,s.style_idx++}return Task.finish(o,{texts:h}),!0}},{key:"textSize",value:function(o,s,h,d){var g=d.transform,_=d.text_wrap,j=d.max_lines,$=d.stroke_width,_t=$===void 0?0:$,_e=d.supersample,_r=d.padding,_n=d.outline_width,_o=d.can_articulate;if(e.cache.text[s]=e.cache.text[s]||{},e.cache.text[s][h])return e.cache.stats.text_hits++,e.cache.text[s][h];e.cache.stats.text_misses++,e.cache.text_count++;var ga=Utils$1.device_pixel_ratio*_e,_l=this.applyTextTransform(h,g),_f=ga*(this.vertical_text_buffer+_n+(_r[0]+_r[2])/2),_c=ga*(this.horizontal_text_buffer+_n+_t+(_r[1]+_r[3])/2),_p=2*ga,_g=this.px_size+_p,ty=MultiLine.parse(_l,_,j,_g,o),oy=ty.height,ry=ty.width,ly=ty.lines,py=[ry/ga,oy/ga];_o||(py[0]+=2*_c/ga,py[1]+=2*_f/ga);var gy=[ry+2*_c,oy+2*_f],by=[gy[0]/ga,gy[1]/ga];return e.cache.text[s][h]={lines:ly,size:{collision_size:py,texture_size:gy,logical_size:by,line_height:_g}},e.cache.text[s][h]}},{key:"drawTextMultiLine",value:function(o,s,h,d,g,_){var j=_slicedToArray(h,2),$=j[0],_t=j[1],_e=Utils$1.device_pixel_ratio*g.supersample,_r=g.stroke_width||0,_n=g.stroke;g.background_color&&(o.fillStyle=g.background_color,o.fillRect($,_t,d.texture_size[0],d.texture_size[1]));var _o=g.outline_width*_e,ga=g.outline_color;_o&&ga&&(o.strokeStyle=ga,o.lineWidth=_o,o.strokeRect($+_o/2,_t+_o/2,d.texture_size[0]-_o,d.texture_size[1]-_o)),(g.background_color||_o&&ga)&&this.setFont(o,g);for(var _l,_f,_c,_p,_g=d.line_height,ty=_t,oy=0;oy<s.length;oy++){var ry=s[oy];this.drawTextLine(o,ry,[$,ty],d,g,_),ty+=_g}debugSettings$1.draw_label_collision_boxes&&(o.save(),_l=_e*(this.horizontal_text_buffer+g.outline_width+_r+(g.padding[1]+g.padding[3])/2),_f=_e*(this.vertical_text_buffer+g.outline_width+(g.padding[0]+g.padding[2])/2),_c=d.collision_size,o.strokeStyle="blue",o.lineWidth=2,o.strokeRect($+_l,_t+_f,_e*_c[0],_e*_c[1]),_==="curved"&&_n&&0<_r&&o.strokeRect($+d.texture_size[0]+_l,_t+_f,_e*_c[0],_e*_c[1]),o.restore()),debugSettings$1.draw_label_texture_boxes&&(o.save(),_p=d.texture_size,o.strokeStyle="green",o.lineWidth=2,o.strokeRect($+2,_t+2,_p[0]-4,_p[1]-4),_==="curved"&&_n&&0<_r&&o.strokeRect($+2+d.texture_size[0],_t+2,_p[0]-4,_p[1]-4),o.restore())}},{key:"drawTextLine",value:function(o,s,h,d,g,_){var j,$=_slicedToArray(h,2),_t=$[0],_e=$[1],_r=g.stroke,_n=g.stroke_width,_o=_n===void 0?0:_n,ga=g.transform,_g=g.align,_l=g.supersample,_f=g.padding,_c=g.outline_width,_p=Utils$1.device_pixel_ratio*_l,_g=_g||"center",ty=d.texture_size,oy=d.line_height,ry=_p*(this.vertical_text_buffer+_c),ly=_p*(this.horizontal_text_buffer+_c+_o),py=this.applyTextTransform(s.text,ga);_g==="left"?j=_t+ly+_f[3]*_p:_g==="center"?j=_t+ty[0]/2-s.width/2-(_f[1]-_f[3])*_p/2:_g==="right"&&(j=_t+ty[0]-s.width-ly-_f[1]*_p);var gy,by=_e+ry+oy+_f[0]*_p;_r&&0<_o&&(gy=_==="curved"?ty[0]:0,o.strokeText(py,j+gy,by)),o.fillText(py,j,by)}},{key:"rasterize",value:function(o,s,h,d,g,_){return Task.removeForTile(h),Task.add({type:"rasterizeLabels",run:this.processRasterizeTask.bind(this),cancel:e.returnNoTextures,pause_factor:2,user_moving_view:!1,texts:o,textures:s,texture_prefix:d,gl:g,tile_id:h,texture_manager:_,cursor:{styles:Object.keys(o),texts:null,style_idx:0,text_idx:null,texture_idx:0,texture_names:[]}})}},{key:"processRasterizeTask",value:function(o){if(!Task.shouldContinue(o))return!1;for(var s=o.cursor,h=o.texts,d=o.textures;s.texture_idx<o.textures.length;){for(var g=!1,_=d[s.texture_idx],j=this.createCanvas.apply(this,_toConsumableArray(_.texture_size)),$=j.getContext("2d");s.style_idx<s.styles.length;){var _t=s.styles[s.style_idx];s.text_idx==null&&(s.text_idx=0,s.texts=Object.keys(h[_t]));for(var _e=h[_t],_r=!0;s.text_idx<s.texts.length;){var _n=s.texts[s.text_idx],_o=_e[_n],ga=_o.text_settings;if(_r&&(this.setFont($,ga),_r=!1),ga.can_articulate){_o.texcoords=_o.texcoords||{};for(var _l=0;_l<_o.type.length;_l++){var _f=_o.type[_l];switch(_f){case"straight":if(_o.textures[_l]!==s.texture_idx)continue;var _c,_p,_g,ty,oy=_o.isRTL?_n.split().reverse().join():_n,ry=_.texcoord_cache[_t][oy],ly=void 0;ry.texcoord?ly=ry.texcoord:(_c=ry.texture_position,_g=(_p=this.textSize($,_t,oy,ga)).size,ty=_p.lines,this.drawTextMultiLine($,ty,_c,_g,ga,_f),ly=o.texture_manager.getTexcoordsForSprite(_c,_g.texture_size,_.texture_size),ry.texcoord=ly),_o.texcoords[_f]={texcoord:ly,texture_id:ry.texture_id};break;case"curved":var py=_o.segments;_o.texcoords.curved=[],_o.texcoords_stroke=[];for(var gy,by,wy,Cy,Gy,Ly,d0,s0,t0=0;t0<py.length;t0++)_o.textures[_l][t0]===s.texture_idx&&(gy=py[t0],Cy=wy=void 0,(by=_.texcoord_cache[_t][gy]).texcoord&&by.texcoord_stroke?(wy=by.texcoord,Cy=by.texcoord_stroke):(Gy=by.texture_position,d0=(Ly=this.textSize($,_t,gy,ga)).size,s0=Ly.lines,this.drawTextMultiLine($,s0,Gy,d0,ga,_f),wy=o.texture_manager.getTexcoordsForSprite(Gy,d0.texture_size,_.texture_size),Cy=ga.stroke&&0<ga.stroke_width?o.texture_manager.getTexcoordsForSprite([Gy[0]+d0.texture_size[0],Gy[1]],d0.texture_size,_.texture_size):(g=!0,o.texture_manager.getTexcoordsForSprite([_.texture_size[0],_.texture_size[1]],[0,0],_.texture_size)),by.texcoord=wy,by.texcoord_stroke=Cy),_o.texcoords_stroke.push(Cy),_o.texcoords.curved.push({texcoord:wy,texture_id:by.texture_id}))}}}else{var Ay=this.textSize($,_t,_n,ga).lines;for(var Ny in _o.align)_o.align[Ny].texture_id===s.texture_idx&&(this.drawTextMultiLine($,Ay,_o.align[Ny].texture_position,_o.size,{stroke:ga.stroke,stroke_width:ga.stroke_width,transform:ga.transform,supersample:ga.supersample,align:Ny,background_color:ga.background_color,outline_width:ga.outline_width,outline_color:ga.outline_color,padding:ga.padding,fill:ga.fill,font_css:ga.font_css,px_size:ga.px_size}),_o.align[Ny].texcoords=o.texture_manager.getTexcoordsForSprite(_o.align[Ny].texture_position,_o.size.texture_size,_.texture_size))}s.text_idx++}s.text_idx=null,s.style_idx++}g===!0&&($.fillStyle="rgba(0, 0, 0, 0)",$.fillRect(j.width-1,j.height-1,1,1));var Hy=o.texture_prefix+s.texture_idx;o.texture_manager.create(o.gl,Hy,{element:j,filtering:"linear",UNPACK_PREMULTIPLY_ALPHA_WEBGL:!0}),s.texture_names.push(Hy),s.texture_idx++,s.style_idx=0,j.width=0,j.height=0}return Task.finish(o,s.texture_names),!0}},{key:"setTextureTextPositions",value:function(o){var s={texture_id:0,texcoord_cache:{}},h=[];for(var d in o){var g=o[d];for(var _ in g){var j=g[_],$=j.text_settings,_t=$.can_articulate,_e=$.stroke,_r=$.stroke_width;if(_t){j.textures=[],s.texcoord_cache[d]=s.texcoord_cache[d]||{};for(var _n=0;_n<j.type.length;_n++)switch(j.type[_n]){case"straight":var _o,ga=j.isRTL?_.split().reverse().join():_;s.texcoord_cache[d][ga]||(_o=j.size.texture_size,s.texcoord_cache[d][ga]={},this.placeText(_o[0],_o[1],{can_articulate:_t,style:d,word:ga})),j.textures[_n]=s.texture_id;break;case"curved":j.textures[_n]=[];for(var _l=0;_l<j.segment_sizes.length;_l++){var _f,_c,_p=j.segments[_l];s.texcoord_cache[d][_p]||(_c=(_f=j.segment_sizes[_l].texture_size)[0],_e&&0<_r&&(_c*=2),s.texcoord_cache[d][_p]={},this.placeText(_c,_f[1],{can_articulate:_t,style:d,word:_p})),j.textures[_n].push(s.texture_id)}}}else{var _g=j.size.texture_size;this.placeText(_g[0],_g[1],{can_articulate:_t,text_info:j})}}}var ty=this.layout.export(),oy=ty.items,ry=ty.width,ly=ty.height;s.texcoord_cache={};for(var py=0,gy=oy.length;py<gy;py++){var by=oy[py],wy=by.x,Cy=by.y;if(by.meta.can_articulate){var d0=by.meta,s0=d0.style,t0=d0.word;s.texcoord_cache[s0]=s.texcoord_cache[s0]||{},s.texcoord_cache[s0][t0]||(s.texcoord_cache[s0][t0]={texture_id:s.texture_id,texture_position:[wy,Cy]})}else{var Gy=by.meta.text_info;for(var Ly in Gy.align)Gy.align[Ly].texture_id=s.texture_id,Gy.align[Ly].texture_position=[wy,Cy]}}return 0<ry&&0<ly&&(h[s.texture_id]={texture_size:[ry,ly],texcoord_cache:s.texcoord_cache}),h}},{key:"placeText",value:function(o,s,h){this.layout.addItem({width:o+this.vertical_text_buffer,height:s+this.vertical_text_buffer,meta:h})}},{key:"applyTextTransform",value:function(o,s){return s==="capitalize"?o.replace(/\w\S*/g,function(h){return h.charAt(0).toUpperCase()+h.substr(1)}):s==="uppercase"?o.toUpperCase():s==="lowercase"?o.toLowerCase():o}}],[{key:"fontPixelSize",value:function(o){if(o!=null){var s=_slicedToArray((o=typeof o=="string"?o:String(o)).match(e.font_size_re)||[],3),h=s[1],d=s[2];return(d=d||"px")==="em"?h*=16:d==="pt"?h/=.75:d==="%"&&(h/=6.25),h=StyleParser.parsePositiveNumber(h),h*=Utils$1.device_pixel_ratio}}},{key:"pruneTextCache",value:function(){e.cache.text_count>e.cache.text_count_max&&(e.cache.text={},e.cache.text_count=0,log("debug","CanvasText: pruning text cache")),Object.keys(e.cache.segment).length>e.cache.segment_count_max&&(e.cache.segment={},log("debug","CanvasText: pruning segment cache"))}}]),e}();CanvasText.font_size_re=/((?:[0-9]*\.)?[0-9]+)\s*(px|pt|em|%)?/,CanvasText.cache={text:{},text_count:0,text_count_max:2e3,segment:{},segment_count_max:2e3,stats:{text_hits:0,text_misses:0,segment_hits:0,segment_misses:0}},CanvasText.EMPTY_TEXTURES_ARR=[],CanvasText.returnNoTextures=function(){return CanvasText.EMPTY_TEXTURES_ARR};var rtlDirCheck=new RegExp("[֑-߿‏‫‮יִ-﷽ﹰ-ﻼ]");function isTextRTL(e){return rtlDirCheck.test(e)}var neutral_chars="\0-/:-@[-`{-¿×÷ʹ-˿ -⯿‐-\u2029‬ -⯿",neutralDirCheck=new RegExp("["+neutral_chars+"]+");function isTextNeutral(e){return neutralDirCheck.test(e)}var markRTL="‏",arabic_range=new RegExp("^["+neutral_chars+"؀-ۿ]+"),arabic_splitters=new RegExp("["+neutral_chars+"آ-إاد-زوٱ-ٷڈ-ڙۄ-ۋۏےۓۮۯ]"),arabic_vowels=new RegExp("^[ؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ۭ]+"),accents_and_vowels="[̀-֑ͯ-ׇֽֿׁׂׅׄަ-ްऀ-ःऺ-ौॎॏ॑-ॗॢॣঁ-ঃ়া-ৌৗৢৣਁ-ਃ਼-ੌੑઁ-ઃ઼ા-ૌૢૣଁ-ଃ଼ା-ୌୖୗୢୣஂா-்ௗఀ-ఃా-ౌౕౖౢౣಁ-ಃ಼ಾ-ೌೕೖೢೣഁ-ഃാ-ൌൎൗൢൣංඃ්-ෟෲෳัิ-ฺ็-๎ັິ-ຼ່-ໍ༹༘༙༵༷༾༿ཱ-ྃ྆྇ྍ-ྼ࿆ါ-း်-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ឴-៑៓ᩕ-ᩞᩡ-᩼᷀-᷿⃐-⃿]",combo_characters="[्্੍્୍్್്྄္្᩠᩿]",graphemeRegex=new RegExp("^.(?:"+accents_and_vowels+"+)?("+combo_characters+"\\W(?:"+accents_and_vowels+"+)?)*"),curve_blacklist={Mongolian:"᠀-᢯"},curve_blacklist_range=Object.keys(curve_blacklist).map(function(e){return curve_blacklist[e]}).join(""),curve_blacklist_test=new RegExp("["+curve_blacklist_range+"]");function isTextCurveBlacklisted(e){return curve_blacklist_test.test(e)}var default_segment_length=2;function splitLabelText(e,o){var s=o?1:default_segment_length;if(e.length<s)return[e];var h=e;if(CanvasText.cache.segment[h])return CanvasText.cache.stats.segment_hits++,CanvasText.cache.segment[h];var d=[];if(arabic_range.exec(e)){d=e.split(arabic_splitters);for(var g,_=-1,j=0;j<d.length-1;j++)0<j&&(g=arabic_vowels.exec(d[j]))&&(d[j]=d[j].substring(g[0].length),d[j-1]+=g[0],_+=g[0].length),_+=1+d[j].length,d[j]+=e.slice(_,_+1);e=""}for(;e.length;){for(var $="",_t=e,_e=0;_e<s&&_t.length;_e++){var _r=(graphemeRegex.exec(_t)||_t)[0];$+=_r,_t=_t.substring(_r.length)}d.push($),e=e.substring($.length)}return o&&d.reverse(),CanvasText.cache.stats.segment_misses++,CanvasText.cache.segment[h]=d}var MultiLine=function(){function e(o){var s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1/0,h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1/0;_classCallCheck(this,e),this.width=0,this.height=0,this.lines=[],this.max_lines=s,this.text_wrap=h,this.context=o}return _createClass(e,[{key:"createLine",value:function(o){return this.lines.length<this.max_lines&&new Line(o,this.text_wrap)}},{key:"push",value:function(o){if(this.lines.length<this.max_lines){var s=this.context.measureText(o.text).width;return(o.width=s)>this.width&&(this.width=Math.ceil(s)),this.lines.push(o),this.height+=o.height,!0}return this.addEllipsis(),!1}},{key:"advance",value:function(o,s){return!!this.push(o)&&this.createLine(s)}},{key:"addEllipsis",value:function(){var o=this.lines[this.lines.length-1],s=Math.ceil(this.context.measureText(e.ellipsis).width);o.append(e.ellipsis),o.width+=s,o.width>this.width&&(this.width=o.width)}},{key:"finish",value:function(o){o?this.push(o):this.addEllipsis()}}],[{key:"parse",value:function(o,s,h,d,g){for(var _=typeof s=="number"?o.split(" "):[o],j=new e(g,h,s),$=j.createLine(d),_t=0;_t<_.length;_t++){for(var _e=_[_t].split(`
`),_r=_t===0,_n=0;_n<_e.length&&$;_n++){var _o=_e[_n];isTextRTL(_o)&&isTextNeutral(_o[_o.length-1])&&(_o+=markRTL);var ga=_r?_o:" "+_o;if(s&&0<_t&&$.exceedsTextwrap(ga)){if(!($=j.advance($,d)))break;$.append(_o),_r=!0}else $.append(ga);_n<_e.length-1&&($=j.advance($,d),_r=!0)}_t===_.length-1&&j.finish($)}return j}}]),e}();MultiLine.ellipsis="...";var Line=function(){function e(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;_classCallCheck(this,e),this.chars=0,this.text="",this.height=Math.ceil(o),this.text_wrap=s}return _createClass(e,[{key:"append",value:function(o){this.chars+=o.length,this.text+=o}},{key:"exceedsTextwrap",value:function(o){return o.length+this.chars>this.text_wrap}}]),e}(),TextLabels={resetText:function(){this.texts={}},freeText:function(e){delete this.texts[e.id]},parseTextFeature:function(e,o,s,h){var d=this.parseTextSource(e,o,s);if(d!=null&&d!==""){var g=TextSettings$1.compute(e,o,s);if(g){var _=TextSettings$1.key(g);this.texts[h.id]=this.texts[h.id]||{};var j=this.texts[h.id][_]=this.texts[h.id][_]||{};if(d instanceof Object){var $=[],_t=d.left+"-"+d.right;for(var _e in d){var _r,_n=d[_e];_n&&(_r=this.computeTextLayout({},e,o,s,h,_n,g,_t,_e),j[_n]||(j[_n]={text_settings:g,ref:0}),$.push({draw:o,text:_n,text_settings_key:_,layout:_r}))}return 0<$.length&&$}var _o=this.computeTextLayout({},e,o,s,h,d,g);return j[d]||(j[d]={text_settings:g,ref:0}),{draw:o,text:d,text_settings_key:_,layout:_o}}}},parseTextSource:function(e,o,s){var h,d=o.text_source||"name";if(d!=null&&_typeof(d)==="object")for(var g in h={},d)h[g]=this.parseTextSourceValue(d[g],e,s);else h=this.parseTextSourceValue(d,e,s);return h},parseTextSourceValue:function(e,o,s){var h;if(Array.isArray(e)){for(var d=0;d<e.length;d++)if(typeof e[d]=="string"?h=o.properties[e[d]]:typeof e[d]=="function"&&(h=e[d](s)),h)return h}else typeof e=="string"?h=o.properties[e]:e instanceof Function&&(h=e(s));return h},prepareTextLabels:function(e,o,s){var h=this;return Object.keys(this.texts[e.id]||{}).length===0?Promise.resolve([]):WorkerBroker.postMessage(this.main_thread_target+".calcTextSizes",e.id,this.texts[e.id]).then(function(d){var g=d.texts;return e.canceled?(log("trace","Style ".concat(h.name,": stop tile build because tile was canceled: ").concat(e.key,", post-calcTextSizes()")),[]):(h.texts[e.id]=g||[],g?h.buildTextLabels(e,s):(Collision.abortTile(e.id),[]))})},collideAndRenderTextLabels:function(e,o,s){var h=this;return this.prepareTextLabels(e,o,s).then(function(d){return d.length===0?(Collision.collide([],o,e.id),Promise.resolve({})):Collision.collide(d,o,e.id).then(function(g){if(e.canceled)return log("trace","stop tile build because tile was canceled: ".concat(e.key,", post-collide()")),{};var _=h.texts[e.id];return _==null||g.length===0?{}:(h.cullTextStyles(_,g),g.forEach(function(j){var $=j.text_settings_key,_t=_[$]&&_[$][j.text];_t.text_settings.can_articulate?(_t.type||(_t.type=[]),_t.type.indexOf(j.label.type)===-1&&_t.type.push(j.label.type)):(_t.align=_t.align||{},_t.align[j.label.align]={})}),{labels:g,texts:_,textures:[]})})})},cullTextStyles:function(e,o){for(var s=0;s<o.length;s++){var h=o[s];e[h.text_settings_key][h.text].ref++}for(var d in e)for(var g in e[d])e[d][g].ref<1&&delete e[d][g];for(var _ in e)Object.keys(e[_]).length===0&&delete e[_]},calcTextSizes:function(e,o){return this._canvas_text||(this._canvas_text=new CanvasText,this._canvas_ctx_for_sizes=this._canvas_text.createCanvas().getContext("2d")),this._canvas_text.textSizes(e,o,this._canvas_ctx_for_sizes)},preprocessText:function(e){if(e&&e.font&&_typeof(e.font)==="object")return e.font.fill=StyleParser.createPropertyCache(e.font.fill),e.font.stroke&&(e.font.stroke.color=StyleParser.createPropertyCache(e.font.stroke.color)),e.background&&e.background.color&&(e.background.color=StyleParser.createPropertyCache(e.background.color)),e.outline&&(e.outline.color&&(e.outline.color=StyleParser.createPropertyCache(e.outline.color)),e.outline.width&&(e.outline.width=StyleParser.createPropertyCache(e.outline.width,StyleParser.parsePositiveNumber))),e.padding&&(Array.isArray(e.padding)?e.padding.length===2&&(e.padding=[e.padding[0],e.padding[1],e.padding[0],e.padding[1]]):e.padding=Array(4).fill(e.padding),e.padding=StyleParser.createPropertyCache(e.padding,function(o){return o.map(StyleParser.parsePositiveNumber)})),e.font.px_size=StyleParser.createPropertyCache(e.font.size||TextSettings$1.defaults.size,CanvasText.fontPixelSize),e.font.stroke&&e.font.stroke.width!=null&&(e.font.stroke.width=StyleParser.createPropertyCache(e.font.stroke.width,StyleParser.parsePositiveNumber)),e.offset=StyleParser.createPropertyCache(e.offset,function(o){return Array.isArray(o)&&o.map(StyleParser.parseNumber)}),e.buffer=StyleParser.createPropertyCache(e.buffer,function(o){return(Array.isArray(o)?o:[o,o]).map(StyleParser.parsePositiveNumber)}),e.repeat_distance=StyleParser.createPropertyCache(e.repeat_distance||Geo$1.tile_size,StyleParser.parsePositiveNumber),e},computeTextLayout:function(e,o,s,h,d,g,_,j,$){var _t=e||{};return(_t=this.computeLayout(_t,o,s,h,d)).repeat_distance&&(j&&(_t.repeat_group+="/"+j),_t.repeat_group+="/"+g),_t.subdiv=d.overzoom2,_t.align=s.align,_t.italic=_.style!=="normal",$==="right"?_t.orientation=1:$==="left"&&(_t.orientation=-1),_t}};function degToRad(e){return e*Math.PI/180}var PI_OVER_180=Math.PI/180,HORIZON_THRESHOLD_MULTIPLIER=.75,ZOOM_FOR_BOUNDS_EPSILON=.001,NEAR_PLANE=1,LookAtManipulator=function(){function e(o,s){_classCallCheck(this,e),this._min_zoom=H.util.constants.DEFAULT_MIN_ZOOM_LEVEL,this._max_zoom=H.util.constants.DEFAULT_MAX_ZOOM_LEVEL,this._viewport=o,this._center_offset=[],this._center_offset_normalized=[],this._viewport_aspect_ratio=1,this._focal_length=[[16,2],[17,2.5],[18,3],[19,4],[20,6]],this._view_matrix=new Float64Array(16),this._projection_matrix=new Float64Array(16),this._heading_matrix=new Float64Array(16),this._tilt_matrix=new Float64Array(16),this._transformation_matrix=new Float64Array(16),this._camera_matrix=new Float64Array(16),this._lookAtData={position:[0,0,0],zoom:0,tile_level:0,tetragon:void 0,bounds:void 0,unpadded_bounds:void 0,distance:void 0,tilt:0,incline:0,heading:180},this._zoom_direction=0,this._horizon=0,this.handleViewportUpdate(!0),s?this.setLookAtData(s):this._updateMatrices(),ShaderProgram.replaceBlock("camera",`
            uniform mat4 u_projection;
            uniform vec3 u_eye;
            uniform vec2 u_center_offset;

            void cameraProjection (inout vec4 position) {
                position = u_projection * position;
            }`)}return _createClass(e,[{key:"getZoomForBounds",value:function(o,s,h,d){var g,_=this.clone(),j=this._max_zoom,$=this._min_zoom,_t=(j-$)/2,_e=j-_t,_r=s,_n=MathUtils$1.getBBoxCenter(MathUtils$1.getBBox(o));for(_r===void 0?_r=_n:(g=_n[0]-_r[0],Math.abs(g)>Geo$1.half_circumference_meters+1e-8&&(_r[0]+=Math.round(g/Geo$1.circumference_meters)*Geo$1.circumference_meters));ZOOM_FOR_BOUNDS_EPSILON<_t;)(function(){_.setLookAtData({zoom:_e,position:_r,tilt:h,heading:d});var _o,ga,_l,_f,_c,_p=_.getLookAtData().bounds;o.every(function(_g){return MathUtils$1.isPointInsidePolygon(_g,_p)})?$=_e:(ga=(_o=_slicedToArray(MathUtils$1.getBBox(_p),4))[0],_l=_o[1],_f=_o[2],_c=_o[3],_f-ga+1e-8>=Geo$1.circumference_meters&&_c-_l+1e-8>=Geo$1.circumference_meters?$=_e:j=_e),_e=j-(_t=(j-$)/2)})();return $}},{key:"setZoomConstraints",value:function(o,s){this._min_zoom=o,this._max_zoom=s,this.setLookAtData(this.getLookAtData())}},{key:"setLookAtData",value:function(o,s){var h,d,g,_,j,$=o.position,_t=o.zoom;$===h&&o.bounds!==h&&($=MathUtils$1.getBBoxCenter(MathUtils$1.getBBox(o.bounds))),_t===h&&o.bounds!==h&&(_t=this.getZoomForBounds(o.bounds,$,o.tilt,o.heading)),s!==h&&(d=$||this.screenToWorld(s)),_t!==h&&(_t=MathUtils$1.clamp(_t,this._min_zoom,this._max_zoom),(g=Utils$1.zoomToTileLevel(_t))!==(_=this._lookAtData.tile_level)&&(this._zoom_direction=_<g?1:-1),this._lookAtData.zoom=_t,this._lookAtData.tile_level=g),o.tilt!==h&&(this._lookAtData.tilt=o.tilt),o.heading!==h&&(this._lookAtData.heading=o.heading),s!==h?(this._updateMatrices(),j=this.screenToWorld(s),this._lookAtData.position[0]-=j[0]-d[0],this._lookAtData.position[1]-=j[1]-d[1]):$&&(this._lookAtData.position=$),this._lookAtData.position[2]=0,this._lookAtData.position[1]=MathUtils$1.clamp(this._lookAtData.position[1],-Geo$1.half_circumference_meters,Geo$1.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"getZoomDirection",value:function(){return this._zoom_direction}},{key:"resetZoomDirection",value:function(){this._zoom_direction=0}},{key:"getLookAtData",value:function(){return this._lookAtData}},{key:"handleViewportUpdate",value:function(o){var s=0<arguments.length&&o!==void 0&&o,h=this._viewport,d=h.width,g=h.height;this._viewport_aspect_ratio=d/g;var _=this._viewport.center.x-(d/2<<0),j=this._viewport.center.y-(g/2<<0);this._center_offset[0]=_,this._center_offset[1]=j,this._center_offset_normalized[0]=_/d,this._center_offset_normalized[1]=j/-g,s||(this._updateMatrices(),this._updateVisibleBounds())}},{key:"setupMatrices",value:function(o,s){mat4.multiply(o.model_view32,this._view_matrix,o.model),s.uniform("Matrix4fv","u_modelView",o.model_view32),mat3.normalFromMat4(o.normal32,o.model_view32),mat3.invert(o.inverse_normal32,o.normal32),s.uniform("Matrix3fv","u_normalMatrix",o.normal32),s.uniform("Matrix3fv","u_inverseNormalMatrix",o.inverse_normal32)}},{key:"_updateMatrices",value:function(){var o=this._viewport.height*Geo$1.metersPerPixel(this._lookAtData.zoom),s=Utils$1.interpolate(this._lookAtData.zoom,this._focal_length);this._lookAtData.distance=o/2*s;var h=this._lookAtData.position[0],d=this._lookAtData.position[1];mat4.lookAt(this._view_matrix,vec3.fromValues(h,d,0),vec3.fromValues(h,d,-1),vec3.fromValues(0,1,0)),this._heading_matrix=mat4.identity(this._heading_matrix);var g=180-this._lookAtData.heading;g*=PI_OVER_180,this._heading_matrix[0]=Math.cos(g),this._heading_matrix[1]=-Math.sin(g),this._heading_matrix[4]=Math.sin(g),this._heading_matrix[5]=Math.cos(g),this._tilt_matrix=mat4.identity(this._tilt_matrix),g=0<(g=this._lookAtData.tilt?this._lookAtData.tilt*PI_OVER_180:0)?-g:g,this._tilt_matrix[5]=Math.cos(g),this._tilt_matrix[6]=Math.sin(g),this._tilt_matrix[9]=-Math.sin(g),this._tilt_matrix[10]=Math.cos(g),mat4.multiply(this._transformation_matrix,this._tilt_matrix,this._heading_matrix),mat4.multiply(this._view_matrix,this._transformation_matrix,this._view_matrix);var _=2*Math.atan(1/s),j=2*this._lookAtData.distance;this._depth_buffer_adjustment=2/Math.log(j/NEAR_PLANE),mat4.perspective(this._projection_matrix,_,this._viewport_aspect_ratio,NEAR_PLANE,j),this._projection_matrix[8]=2*-this._center_offset_normalized[0],this._projection_matrix[9]=2*-this._center_offset_normalized[1],mat4.translate(this._projection_matrix,this._projection_matrix,vec3.fromValues(0,0,-this._lookAtData.distance)),this._camera_matrix=mat4.multiply(this._camera_matrix,this._projection_matrix,this._view_matrix)}},{key:"_updateVisibleBounds",value:function(){var o,s,h,d,g,_=this._viewport,j=_.width,$=_.height,_t=_.padding,_e=degToRad(this._lookAtData.tilt);this._horizon=Math.max((_t.top+$)/2-Math.cos(_e)*(_t.top*(1-Math.sin(_e))+$*HORIZON_THRESHOLD_MULTIPLIER),0),this._lookAtData.tetragon=[this.screenToWorld([0,this._horizon]),this.screenToWorld([j,this._horizon]),this.screenToWorld([j,$]),this.screenToWorld([0,$])],this._lookAtData.unpadded_bounds=this._clipAgainstGeoBounds(this._lookAtData.tetragon),_t.left===0&&_t.top===0&&_t.right===0&&_t.bottom===0?this._lookAtData.bounds=this._lookAtData.unpadded_bounds:(o=_t.left,s=Math.max(this._horizon,_t.top),h=j-_t.right,d=$-_t.bottom,g=[this.screenToWorld([o,s]),this.screenToWorld([h,s]),this.screenToWorld([h,d]),this.screenToWorld([o,d])],this._lookAtData.bounds=this._clipAgainstGeoBounds(g))}},{key:"_clipAgainstGeoBounds",value:function(o){var s,h=_slicedToArray(MathUtils$1.getBBox(o),4),$=h[0],_t=h[1],_e=h[2],_r=h[3],d=Geo$1.half_circumference_meters,g=[[$-1,+d],[_e+1,+d],[_e+1,-d],[$-1,-d]],_=MathUtils$1.clipPolygon(g,o)[0],j=_slicedToArray(MathUtils$1.getBBox(_),4),$=j[0],_t=j[1],_e=j[2],_r=j[3];_e-$>=Geo$1.circumference_meters&&(_=[[(s=(_e-$)/2)-d,_r],[s+d,_r],[s+d,_t],[s-d,_t]]);var _n=[];return _&&(_n=MathUtils$1.splitLegs(_,d)),_n}},{key:"applyPxOffset",value:function(o){var s=_slicedToArray(o,2),h=s[0],d=s[1],g=Math.PI-this._lookAtData.heading*PI_OVER_180,_=Geo$1.metersPerPixel(this._lookAtData.zoom);this._lookAtData.position[0]+=(h*Math.cos(g)+d*Math.sin(g))*_,this._lookAtData.position[1]-=(d*Math.cos(g)-h*Math.sin(g))*_,this._lookAtData.position[1]=MathUtils$1.clamp(this._lookAtData.position[1],-Geo$1.half_circumference_meters,Geo$1.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"screenToWorld",value:function(o){var s=_slicedToArray(o,2),h=s[0],d=s[1],g=this._viewport,_=g.width,j=g.height;return _===0||j===0?[0,0]:(h-=_/2,d-=j/2,this._clipCoordsToWorldPlaneCoords([2*(h+_/2)/_-1,1-2*(d+j/2)/j,-1,1]))}},{key:"_clipToScreenCoords",value:function(o){var s=this._viewport,h=s.width,d=s.height;return[(.5*o[0]+.5)*h,d-(.5*o[1]+.5)*d]}},{key:"_isScreenPointInViewPort",value:function(o){var s=this._viewport,h=s.width,d=s.height;return 0<=o[0]&&o[0]<=h&&0<=o[1]&&o[1]<=d}},{key:"worldToScreen",value:function(o,s){var h,d,g,_,j,$,_t=1<arguments.length&&s!==void 0&&s;return o[2]||(o[2]=0),_t?(h=this._worldToClipCoords(o),j=this._clipToScreenCoords(h)):(d=Math.sign(this._lookAtData.position[0]),g=Math.trunc(this._lookAtData.position[0]/Geo$1.circumference_meters+d/2),o[0]+=Geo$1.circumference_meters*g,_=this._worldToClipCoords(o),$=j=this._clipToScreenCoords(_),this._isScreenPointInViewPort(j)||(_=this._worldToClipCoords([o[0]+Geo$1.circumference_meters,o[1],o[2]]),j=this._clipToScreenCoords(_),this._isScreenPointInViewPort(j)||(_=this._worldToClipCoords([o[0]-Geo$1.circumference_meters,o[1],o[2]]),j=this._clipToScreenCoords(_)),this._isScreenPointInViewPort(j)||(j=$))),j}},{key:"getHorizon",value:function(){return this._horizon}},{key:"_clipCoordsToWorldPlaneCoords",value:function(o){var s=[],h=this._lookAtData.distance,d=this._lookAtData.position,g=[0,0,h,0],_=0,j=h*Math.sin(PI_OVER_180*this._lookAtData.tilt)*Math.cos(PI_OVER_180*this._lookAtData.heading),$=h*Math.sin(PI_OVER_180*this._lookAtData.tilt)*Math.sin(PI_OVER_180*this._lookAtData.heading),_t=new Float64Array(16),_e=new Float64Array(16);return mat4.invert(_t,this._projection_matrix),vec4.transformMat4(s,o,_t),s[2]=-1,s[3]=0,mat4.invert(_e,this._view_matrix),vec4.transformMat4(s,s,_e),vec4.normalize(s,s),vec4.transformMat4(g,g,this._transformation_matrix),s[2]!==0&&(_=-g[2]/s[2]),vec4.scale(s,s,_),[d[0]+(s[0]+$),d[1]+(s[1]+j)]}},{key:"_worldToClipCoords",value:function(o){var s=[o[0],o[1],o[2],1];return vec4.transformMat4(s,s,this._view_matrix),vec4.transformMat4(s,s,this._projection_matrix),vec4.scale(s,s,1/s[3]),s}},{key:"setupProgram",value:function(o){o.uniform("Matrix4fv","u_projection",this._projection_matrix),o.uniform("3f","u_eye",[0,0,this._lookAtData.distance]),o.uniform("2fv","u_center_offset",this._center_offset_normalized),o.uniform("1f","u_tilt",this._lookAtData.tilt*PI_OVER_180),o.uniform("1f","u_heading",this._lookAtData.heading*PI_OVER_180),o.uniform("1f","u_near_plane",NEAR_PLANE),o.uniform("1f","u_depth_buffer_adjustment",this._depth_buffer_adjustment)}},{key:"getTransformationMatrix",value:function(){return this._transformation_matrix}},{key:"getCameraMatrix",value:function(){return this._camera_matrix}},{key:"clone",value:function(){var o=new e(this._viewport,this._lookAtData);return o.setZoomConstraints(this._min_zoom,this._max_zoom),o}},{key:"getViewport",value:function(){return this._viewport}}]),e}();function getX(e){return e.x===void 0?e[0]:e.x}function getY(e){return e.y===void 0?e[1]:e.y}function xAscendingComparator(e,o){return getX(e)-getX(o)}function yAscendingComparator(e,o){return getY(e)-getY(o)}function sortByX(e){return e.sort(xAscendingComparator)}function sortByY(e){return e.sort(yAscendingComparator)}function getMinMax(e,o){for(var s,h=e[0],d=h,g=0;g<e.length;g+=1)o(s=e[g],h)<0?h=s:0<o(s,d)&&(d=s);return[h,d]}function groupByCoord(e,o){return Object.values(o.reduce(function(s,h){var d=h[+e];return s[d]||(s[d]=[]),s[d].push(h),s},{}))}function groupByX(e){return groupByCoord(!1,e)}function groupByY(e){return groupByCoord(!0,e)}function createTileRangeByCoord(e,o,s){var h=+e,d=o[h],g=s[h];if(g<d)return[];var _=[o];if(g<d)return _;for(var j=o[(1+h)%2],$=e?function(_e){return _.push([j,_e])}:function(_e){return _.push([_e,j])},_t=d+1;_t<g;_t+=1)$(_t);return _.push(s),_}function createTileRangeByX(e,o){return createTileRangeByCoord(!1,e,o)}function createTileRangeByY(e,o){return createTileRangeByCoord(!0,e,o)}function deduplicate(e){var o={},s=[];return e.forEach(function(h){var d=h.key||(Array.isArray(h)?"".concat(h[0],"/").concat(h[1]):"".concat(h.x,"/").concat(h.y));o[d]||(o[d]=!0,s.push(h))}),s}function flat(e){return e.reduce(function(o,s){return o.concat(s)})}function applyMargin(e,o){if(o<=0)return e;var s,h=function(g){var _=_slicedToArray(getMinMax(g,xAscendingComparator),2),j=_[0],$=_[1],_t=[j[0]-o,j[1]],_e=[$[0]+o,$[1]];return g.concat(createTileRangeByX(_t,j),createTileRangeByX($,_e))},d=function(g){var _=_slicedToArray(getMinMax(g,yAscendingComparator),2),j=_[0],$=_[1],_t=[j[0],j[1]-o],_e=[$[0],$[1]+o];return g.concat(createTileRangeByY(_t,j),createTileRangeByY($,_e))};return deduplicate((s=groupByY(flat(groupByX(e).map(d))),flat(s.map(h))))}function constructTiles(e,o,s){return e.map(function(h){var d=_slicedToArray(h,2),g=d[0],_=d[1];return Tile.coord(Geo$1.wrapTile({x:g,y:_,z:o},{x:!s,y:!0}))})}function getTileGrid(e,o,s){function h(d){return Object.values(Geo$1.metersToExactTileCoords(d,e.tile_level))}return deduplicate(constructTiles(applyMargin(rasterizeTetragon(h(e.tetragon[0]),h(e.tetragon[1]),h(e.tetragon[3]),h(e.tetragon[2])),o),e.tile_level,s))}function rasterizeTetragon(e,o,s,h){var d=rasterizeTriangle(o,e,s),g=rasterizeTriangle(s,h,o);return deduplicate(d.concat(g))}function rasterizeTriangle(e,o,s){var h=_slicedToArray(sliceTriangle.apply(void 0,_toConsumableArray(sortByY([e,o,s]))),2),d=h[0],g=h[1];return deduplicate(rasterizeBottomFlatTriangle.apply(void 0,_toConsumableArray(d)).concat(rasterizeTopFlatTriangle.apply(void 0,_toConsumableArray(g))))}function sliceTriangle(e,o,s){var h=_slicedToArray(e,2),d=h[0],g=h[1],_=_slicedToArray(o,2),j=_[0],$=_[1],_t=_slicedToArray(s,2),_e=_t[0],_r=_t[1],_n=d+($-g)/(_r-g)*(_e-d);return[[[d,g]].concat(_toConsumableArray(sortByX([[j,$],[_n,$]]))),[].concat(_toConsumableArray(sortByX([[j,$],[_n,$]])),[[_e,_r]])]}function rasterizeBottomFlatTriangle(e,o,s){var h=_slicedToArray(e,2),d=h[0],g=h[1],_=_slicedToArray(o,2),j=_[0],$=_[1];return scanFlatTriangle(d,j,_slicedToArray(s,1)[0],g,$)}function rasterizeTopFlatTriangle(e,o,s){var h=_slicedToArray(e,2),d=h[0],g=h[1],_=_slicedToArray(o,1)[0],j=_slicedToArray(s,2);return scanFlatTriangle(j[0],d,_,j[1],g)}var scanStepStatic=.125;function getScanStep(e,o){return scanStepStatic*(o-e)/(Math.ceil(o)-Math.floor(e))}function scanFlatTriangle(e,o,s,h,d){var g=Math.min(e,o),_=Math.max(e,s),j=Math.min(h,d),$=Math.max(h,d);if(Math.floor(h)===Math.floor(d))return scanRow(g,_,h);if($-j<scanStepStatic)return scanRectangle([g,j],[_,$]);function _t(_g){ga=ga.concat(scanRow(_l,_f,Math.floor(_g))),_l+=_n,_f+=_o}var _e=getScanStep(j,$),_r=($-j)/_e,_n=(o-e)/_r,_o=(s-e)/_r,ga=[],_l=e,_f=e;if(h<d)for(var _c=j;_c<=$;_c+=_e)_t(_c);else for(var _p=$;j<=_p;_p-=_e)_t(_p);return deduplicate(ga)}function xCoordsToPoints(e,o){return e.map(function(s){return[s,o]})}function createCoordRange(e,o){var s=Math.floor(e),h=Math.floor(o);if(h<s)return[];if(s===h)return[s];for(var d=[],g=s;g<=h;g+=1)d.push(g);return d}function scanRow(e,o,s){return xCoordsToPoints(createCoordRange(e,o),s)}function scanRectangle(e,o){var s=_slicedToArray(e,2),h=s[0],d=s[1],g=_slicedToArray(o,2),_=g[0],j=g[1],$=createCoordRange(h,_),_t=xCoordsToPoints($,d),_e=xCoordsToPoints($,j);return _t.concat(_e)}var VIEW_PAN_SNAP_TIME=.5,Z_PRECISION=1e5,View=function(){function e(o,s){_classCallCheck(this,e),subscribeMixin(this),this.scene=o,this.createMatrices(),this.bounds=null,this.center_tile=null,this.panning=!1,this.panning_stop_at=0,this.pan_snap_timer=0,this.user_input_at=0,this.user_input_timeout=50,this.user_input_active=!1,this.size={},this.buffer=0,this.wrap=s.wrapView!==!1,this.preserve_tiles_within_zoom=1,this.lookAtManipulator=new LookAtManipulator(s.viewport),this._viewport=s.viewport,this._offset_buffer=[0,0],this.handleViewportUpdate(!0)}return _createClass(e,[{key:"update",value:function(){this.pan_snap_timer=(new Date-this.panning_stop_at)/1e3,this.user_input_active=new Date-this.user_input_at<this.user_input_timeout,this.scene.tile_manager.updateTilesVisibilityCounters()}},{key:"handleViewportUpdate",value:function(o){var s=0<arguments.length&&o!==void 0&&o,h=this._viewport,d=h.width,g=h.height;this.size.css={width:d,height:g},this.size.device={width:Math.round(d*Utils$1.device_pixel_ratio),height:Math.round(g*Utils$1.device_pixel_ratio)},this.lookAtManipulator.handleViewportUpdate(),s||this.updateBounds()}},{key:"setLookAtData",value:function(o,s){e._setLookAtDataForManipulator(this.lookAtManipulator,o,s),this.updateBounds()}},{key:"getLookAtData",value:function(o){var s=0<arguments.length&&o!==void 0&&o;return e._getLookAtDataFromManipulator(this.lookAtManipulator,s)}},{key:"getBestLookAtData",value:function(o,s,h){var d=2<arguments.length&&h!==void 0&&h,g=this.lookAtManipulator.clone();return e._setLookAtDataForManipulator(g,o,s),e._getLookAtDataFromManipulator(g,d)}},{key:"getTileLevel",value:function(){return this.lookAtManipulator.getLookAtData().tile_level}},{key:"applyPxOffset",value:function(o){var s=this._offset_buffer;s[0]+=o[0],s[1]+=o[1];var h,d,g=Math.abs(s[0]),_=Math.abs(s[1]);(1<=g||1<=_)&&(h=~~s[0],d=~~s[1],this.lookAtManipulator.applyPxOffset([g<1?0:h,_<1?0:d]),1<=g&&(s[0]-=h),1<=_&&(s[1]-=d),this.updateBounds())}},{key:"setPanning",value:function(o){this.panning=o,this.panning||(this.panning_stop_at=+new Date)}},{key:"markUserInput",value:function(){this.user_input_at=+new Date}},{key:"ready",value:function(){return typeof this.size.css.width=="number"&&typeof this.size.css.height=="number"}},{key:"updateBounds",value:function(){var o,s;this.markUserInput(),this.ready()&&(this.center_tile=Geo$1.tileForMeters(this.lookAtManipulator.getLookAtData().position,this.lookAtManipulator.getLookAtData().tile_level),o=this.lookAtManipulator.screenToWorld([0,this.size.css.height]),s=this.lookAtManipulator.screenToWorld([this.size.css.width,0]),this.bounds={sw:{x:o[0],y:o[1]},ne:{x:s[0],y:s[1]}},this.scene.tile_manager.updateTilesForView(!0),this.trigger("move"),this.scene.requestRedraw())}},{key:"getTileGridFlatForBBox",value:function(o,s,h,d,g,_){var j,$=4<arguments.length&&g!==void 0?g:0,_t=!(5<arguments.length&&_!==void 0)||_,_e=this.lookAtManipulator.getLookAtData().tile_level,_r=Geo$1.tileForMeters([s,o],_e),_n=Geo$1.tileForMeters([d,h],_e);_r.x-=$,_r.y-=$,_n.x+=$,_n.y+=$,_t===!1&&(j=(1<<_e)-1,_r.x=Math.min(Math.max(0,_r.x),j),_r.y=Math.min(Math.max(0,_r.y),j),_n.x=Math.min(Math.max(0,_n.x),j),_n.y=Math.min(Math.max(0,_n.y),j));for(var _o=[],ga={},_l=_r.x;_l<=_n.x;_l++)for(var _f=_r.y;_f<=_n.y;_f++){var _c=Tile.coord(Geo$1.wrapTile({x:_l,y:_f,z:_e},{x:!_t,y:!0}));ga[_c.key]||(ga[_c.key]=!0,_o.push(_c))}return _o}},{key:"getTileGridFlat",value:function(){return this.getTileGridFlatForBBox(this.bounds.ne.y,this.bounds.sw.x,this.bounds.sw.y,this.bounds.ne.x,this.buffer,this.wrap)}},{key:"getTileGridDistorted",value:function(){return getTileGrid(this.lookAtManipulator.getLookAtData(),this.buffer,this.wrap)}},{key:"findVisibleTileCoordinates",value:function(){if(!this.bounds)return[];var o=this.lookAtManipulator.getLookAtData(),s=o.tilt,h=o.heading;return s===0&&h===180?this.getTileGridFlat():this.getTileGridDistorted()}},{key:"createMatrices",value:function(){this.matrices={},this.matrices.model=new Float64Array(16),this.matrices.model32=new Float32Array(16),this.matrices.model_view=new Float64Array(16),this.matrices.model_view32=new Float32Array(16),this.matrices.normal=new Float64Array(9),this.matrices.normal32=new Float32Array(9),this.matrices.inverse_normal32=new Float32Array(9)}},{key:"setupTile",value:function(o,s){o.setupProgram(this.matrices,s),this.lookAtManipulator.setupMatrices(this.matrices,s)}},{key:"setupProgram",value:function(o){var s=this.lookAtManipulator.getLookAtData();o.uniform("2fv","u_resolution",[this.size.device.width,this.size.device.height]),o.uniform("3fv","u_map_position",[s.position[0],s.position[1],Math.trunc(s.zoom*Z_PRECISION)/Z_PRECISION]),o.uniform("1f","u_meters_per_pixel",Geo$1.metersPerPixel(s.zoom)),o.uniform("1f","u_device_pixel_ratio",Utils$1.device_pixel_ratio),o.uniform("1f","u_view_pan_snap_timer",this.pan_snap_timer),o.uniform("1i","u_view_panning",this.panning),o.uniform("1f","u_horizon",this.lookAtManipulator.getHorizon()/(this.size.css.height/2)),this.lookAtManipulator.setupProgram(o)}},{key:"isAnimating",value:function(){return this.pan_snap_timer<=VIEW_PAN_SNAP_TIME}},{key:"xyToGeo",value:function(o,s){var h=this.lookAtManipulator.screenToWorld([o,s]),d=_slicedToArray(Geo$1.metersToLatLng(h),2),g=d[0];return{lat:d[1],lng:g}}},{key:"geoToPixel",value:function(o){var s=Geo$1.latLngToMeters([o.lng,o.lat]);s.push(o.alt||0);var h=this.lookAtManipulator.worldToScreen(s);return{x:Math.floor(h[0]),y:Math.floor(h[1])}}},{key:"geoToMeters",value:function(o){var s=_slicedToArray(Geo$1.latLngToMeters([o.lng,o.lat]),2);return{x:s[0],y:s[1],z:o.alt||0}}},{key:"metersToGeo",value:function(o){var s=_slicedToArray(Geo$1.metersToLatLng([o.x,o.y]),2),h=s[0];return{lat:s[1],lng:h,alt:o.z||0}}},{key:"setZoomConstraints",value:function(o,s){this.lookAtManipulator.setZoomConstraints(o,s)}}],[{key:"_setLookAtDataForManipulator",value:function(o,s,h){var d=s.position,g=s.zoom,_=s.tilt,j=s.heading,$=s.bounds,_t={zoom:g,tilt:_,heading:j};if(d&&typeof d.lng=="number"&&typeof d.lat=="number"&&(_t.position=Geo$1.latLngToMeters([d.lng,d.lat])),$){var _e=$.getExterior().getLatLngAltArray(),_r=_e.length/3,_n=Array(_r);if($.getBoundingBox().isCDB())for(var _o=_e[1],ga=0,_l=0;_l<_r;_l++){var _f,_c=_e[3*_l+1];0<_l&&(_f=_c-_o,180<Math.abs(_f)&&(ga+=_o<_c?-360:360)),_o=_c,_n[_l]=Geo$1.latLngToMeters([_c+ga,_e[3*_l]])}else for(var _p=0;_p<_r;_p++)_n[_p]=Geo$1.latLngToMeters([_e[3*_p+1],_e[3*_p]]);_t.bounds=_n}o.setLookAtData(_t,h)}},{key:"_getLookAtDataFromManipulator",value:function(o,s){var h=1<arguments.length&&s!==void 0&&s,d=o.getLookAtData(),g=d.heading,_=d.incline,j=d.tilt,$=d.zoom,_t=d.position,_e=d.bounds,_r=d.unpadded_bounds,_n=_slicedToArray(Geo$1.metersToLatLng(_t),2),_o=_n[0],ga=_n[1],_l=new H.geo.LineString;return(h?_r:_e).forEach(function(_f){var _c=Geo$1.metersToLatLng(_f);_l.pushLatLngAlt(_c[1],_c[0],0)}),{heading:g,incline:_,tilt:j,zoom:$,bounds:new H.geo.Polygon(_l),position:{lat:ga,lng:_o,alt:_t[2]}}}}]),e}(),shaderSrc_pointsVertex=`uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform bool u_tile_fade_in;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform bool u_view_panning;uniform float u_tilt;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform float u_heading;uniform float u_near_plane;uniform float u_depth_buffer_adjustment;attribute vec4 a_position;attribute vec4 a_shape;attribute vec4 a_color;attribute vec2 a_texcoord;attribute vec2 a_offset;uniform float u_point_type;attribute float a_is_flat;
#ifdef TANGRAM_IS_TEXT_STYLE
attribute vec4 a_offsets_alt;attribute vec4 a_pre_angles_alt;attribute vec4 a_angles_alt;attribute vec4 a_offsets;attribute vec4 a_pre_angles;attribute vec4 a_angles;
#endif
#ifdef TANGRAM_POINT_DRAW_STICK
attribute float a_is_stick;attribute float a_stick_height;varying float v_is_stick;
#endif
varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;
#ifdef TANGRAM_HAS_SHADER_POINTS
attribute float a_outline_edge;attribute vec4 a_outline_color;varying float v_outline_edge;varying vec4 v_outline_color;varying float v_aa_offset;
#endif
#ifdef TANGRAM_SHOW_HIDDEN_LABELS
varying float v_label_hidden;
#endif
#define PI 3.14159265359
#define TANGRAM_NORMAL vec3(0., 0., 1.)
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: raster
#pragma tangram: global
vec2 rotate2D(vec2 _st,float _angle){return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle))*_st;}vec3 rotateX3D(vec3 _st,float _angle){return mat3(1.,0.,0.,0.,cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle))*_st;}vec3 rotateZ3D(vec3 _st,float _angle){return mat3(cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle),0.,0.,0.,1.)*_st;}
#ifdef TANGRAM_IS_TEXT_STYLE
float mix4linear(float a,float b,float c,float d,float x){return mix(mix(a,b,3.*x),mix(b,mix(c,d,3.*(max(x,.66)-.66)),3.*(clamp(x,.33,.66)-.33)),step(0.33,x));}
#endif
void main(){
#pragma tangram: setup
#ifndef TANGRAM_SHOW_HIDDEN_LABELS
if(a_shape.w==0.){gl_Position=vec4(0.,0.,0.,1.);return;}
#else
if(a_shape.w==0.){v_label_hidden=1.;}else{v_label_hidden=0.;}
#endif
v_alpha_factor=1.0;v_color=a_color;v_texcoord=a_texcoord;
#ifdef TANGRAM_HAS_SHADER_POINTS
v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;if(u_point_type==TANGRAM_POINT_TYPE_SHADER){v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;float size=abs(a_shape.x/128.);v_texcoord=sign(a_shape.xy)*(size+1.0)/size;size+=2.0;v_aa_offset=2.0/size;}
#endif
vec4 position=u_modelView*vec4(a_position.xyz,1.);vec4 shape=vec4(a_shape.xy,0.,0.);vec2 offset=vec2(a_offset.x,-a_offset.y);
#ifdef TANGRAM_POINT_DRAW_STICK
v_is_stick=a_is_stick;float scaled_stick_height=(sin(u_tilt+(1.5*PI))+1.0)*a_stick_height;offset.y+=(1.0-a_is_stick)*scaled_stick_height;
#endif
float zoom=clamp(u_map_position.z-u_tile_origin.z,0.,1.);float theta=a_shape.z/4096.;float heading=u_heading;float delta=(heading-PI);float new_theta=theta-delta;float reversed=abs(new_theta)>PI/2. ? 1. : 0.;if(a_is_flat==1.0){
#ifdef TANGRAM_IS_TEXT_STYLE
if(a_offsets[0]!=0.){vec4 angles_scaled;vec4 pre_angles_scaled;vec4 offsets_scaled;if(reversed==1.){offsets_scaled=a_offsets_alt*4.;angles_scaled=(PI/16384.)*a_angles_alt;pre_angles_scaled=(PI/128.)*a_pre_angles_alt;}else{offsets_scaled=a_offsets*4.;angles_scaled=(PI/16384.)*a_angles;pre_angles_scaled=(PI/128.)*a_pre_angles;}float pre_angle=mix4linear(pre_angles_scaled[0],pre_angles_scaled[1],pre_angles_scaled[2],pre_angles_scaled[3],zoom);float angle=mix4linear(angles_scaled[0],angles_scaled[1],angles_scaled[2],angles_scaled[3],zoom);float offset_curve=mix4linear(offsets_scaled[0],offsets_scaled[1],offsets_scaled[2],offsets_scaled[3],zoom);shape.xy=rotate2D(shape.xy,pre_angle+PI*reversed);shape.x+=offset_curve;shape.xy=rotate2D(shape.xy,angle);shape.xy+=rotate2D(offset,theta);}else{shape.xy=rotate2D(shape.xy+offset*256.,theta+(PI*reversed));}
#else
shape.xy=rotate2D(shape.xy+offset*256.,theta);
#endif
shape.xy/=pow(2.,4.+(u_map_position.z-u_tile_origin.w));shape=u_modelView*shape;position+=shape;}else{shape.xy/=256.;
#ifdef TANGRAM_POINT_DRAW_STICK
shape.y*=1.0+(scaled_stick_height-1.0)*a_is_stick;
#endif
shape.xy=rotate2D(shape.xy+offset,theta);}
#ifdef TANGRAM_FADE_IN_RATE
if(u_tile_fade_in){v_alpha_factor*=clamp(u_visible_time*TANGRAM_FADE_IN_RATE,0.,1.);}
#endif
#ifdef TANGRAM_FADE_ON_ZOOM_OUT
v_alpha_factor*=clamp(1.+TANGRAM_FADE_ON_ZOOM_OUT_RATE*(u_map_position.z-u_tile_origin.z),0.,1.);
#endif
v_world_position=u_model*position;v_world_position.xy+=shape.xy*u_meters_per_pixel;v_world_position=wrapWorldPosition(v_world_position);
#pragma tangram: position
cameraProjection(position);
#ifdef TANGRAM_LAYER_ORDER
applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);/***Due to the precision loss on depth buffer,we had a z-fighting of translucent points when the distance to the camera was big.*For more information about the problem see: https:*For more information about the fix see: https:*position.z=(2.0*log(position.w/u_near_plane)/log(u_far_plane/u_near_plane)-1.0)*position.w;*/position.z=(log(position.w/u_near_plane)*u_depth_buffer_adjustment-1.0)*position.w;
#endif
if(a_is_flat!=1.){position.xy+=shape.xy*position.w*2.*u_device_pixel_ratio/u_resolution;}
#ifdef TANGRAM_HAS_SHADER_POINTS
if(u_point_type==TANGRAM_POINT_TYPE_SHADER){position.xy+=sign(shape.xy)*position.w*u_device_pixel_ratio/u_resolution;}
#endif
if(!u_view_panning){snapToPixelGrid(position);}gl_Position=position;}`,shaderSrc_pointsFragment=`uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_texture;uniform float u_point_type;uniform bool u_apply_color_blocks;varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;
#ifdef TANGRAM_HAS_SHADER_POINTS
varying vec4 v_outline_color;varying float v_outline_edge;varying float v_aa_offset;
#endif
#ifdef TANGRAM_SHOW_HIDDEN_LABELS
varying float v_label_hidden;
#endif
#ifdef TANGRAM_POINT_DRAW_STICK
varying float v_is_stick;
#endif
#define TANGRAM_NORMAL vec3(0., 0., 1.)
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: raster
#pragma tangram: global
#ifdef TANGRAM_HAS_SHADER_POINTS
float _tangram_antialias(float l,float R){float low=R-v_aa_offset;float high=R+v_aa_offset;return 1.-smoothstep(low,high,l);}
#endif
void mixTextureColor(inout vec4 color){
#ifdef TANGRAM_HAS_SHADER_POINTS
if(u_point_type==TANGRAM_POINT_TYPE_TEXTURE){color*=texture2D(u_texture,v_texcoord);}else if(u_point_type==TANGRAM_POINT_TYPE_LABEL){color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);}else if(u_point_type==TANGRAM_POINT_TYPE_SHADER){float outline_edge=v_outline_edge;vec4 outlineColor=v_outline_color;float l=length(v_texcoord);float outer_alpha=_tangram_antialias(l,1.);float fill_alpha=_tangram_antialias(l,1.-v_outline_edge*0.5)*color.a;float stroke_alpha=(outer_alpha-_tangram_antialias(l,1.-v_outline_edge))*outlineColor.a;
#ifdef TANGRAM_BLEND_ADD
color.a=stroke_alpha+fill_alpha;color.rgb=color.rgb*fill_alpha+outlineColor.rgb*stroke_alpha;
#else
color.a=stroke_alpha+fill_alpha*(1.-stroke_alpha);color.rgb=mix(color.rgb*fill_alpha,outlineColor.rgb,stroke_alpha)/max(color.a,0.001);
#endif
}
#else
color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);
#endif
if(u_apply_color_blocks){
#pragma tangram: color
#pragma tangram: filter
}color.a*=v_alpha_factor;
#ifdef TANGRAM_SHOW_HIDDEN_LABELS
if(v_label_hidden>0.){color.a*=0.5;color.rgb=vec3(1.,0.,0.);}
#endif
#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY) && !defined(TANGRAM_BLEND_ADD)
if(color.a<TANGRAM_ALPHA_TEST){discard;}
#endif
}void main(void){
#pragma tangram: setup
vec4 color=v_color;
#ifdef TANGRAM_POINT_DRAW_STICK
if(v_is_stick==0.0){mixTextureColor(color);}
#else
mixTextureColor(color);
#endif
gl_FragColor=color;}`,PLACEMENT$1=LabelPoint.PLACEMENT,pre_angles_normalize=128/Math.PI,angles_normalize=16384/Math.PI,offsets_normalize=64,texcoord_normalize=65535,Points=Object.create(Style),TANGRAM_POINT_TYPE_TEXTURE=1,TANGRAM_POINT_TYPE_LABEL=2,TANGRAM_POINT_TYPE_SHADER=3,DEFAULT_POINT_SIZE=16;Object.assign(Points,TextLabels),Object.assign(Points,{name:"points",built_in:!0,vertex_shader_src:shaderSrc_pointsVertex,fragment_shader_src:shaderSrc_pointsFragment,selection:!0,collision:!0,blend:"overlay",init:function(e){var o=0<arguments.length&&e!==void 0?e:{};Style.init.call(this,o),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!0,this.defines.TANGRAM_POINT_TYPE_TEXTURE=TANGRAM_POINT_TYPE_TEXTURE,this.defines.TANGRAM_POINT_TYPE_LABEL=TANGRAM_POINT_TYPE_LABEL,this.defines.TANGRAM_POINT_TYPE_SHADER=TANGRAM_POINT_TYPE_SHADER,this.defines.TANGRAM_POINT_DRAW_STICK=!!this.stick,this.collision_group_points=this.name+"-points",this.collision_group_text=this.name+"-text",this.reset()},setupDefines:function(){this.blend!=="overlay"&&(this.defines.TANGRAM_LAYER_ORDER=!0),this.defines.TANGRAM_FADE_ON_ZOOM_OUT=!0,this.defines.TANGRAM_FADE_ON_ZOOM_OUT_RATE=2,debugSettings$1.suppress_label_fade_in||this.suppress_fade?(this.fade_in_time=0,this.defines.TANGRAM_FADE_IN_RATE=null):(this.fade_in_time=.15,this.defines.TANGRAM_FADE_IN_RATE=1/this.fade_in_time),debugSettings$1.suppress_snap_animation||(this.defines.TANGRAM_VIEW_PAN_SNAP_RATE=1/VIEW_PAN_SNAP_TIME),debugSettings$1.show_hidden_labels&&(this.defines.TANGRAM_SHOW_HIDDEN_LABELS=!0)},reset:function(){this.queues={},this.resetText(),this.texture_missing_sprites={}},addFeature:function(e,o,s){var h,d,g,_=s.tile,j={};if(j.color=this.parseColor(o.color,s),j.texture=o.texture,j.label_texture=null,j.color||j.texture){if(this.hasSprites(j)){if(!(h=this.parseSprite(j,o,s)))return;j.texcoords=h.texcoords}if(j.size=o.size,j.size){if(j.size=StyleParser.evalCachedPointSizeProperty(o.size,h,s),j.size==null)return void log({level:"warn",once:!0},"Layer '".concat(o.layers[o.layers.length-1],"': ")+"'size' includes % and/or ratio-based scaling (".concat(JSON.stringify(o.size.value),"); ")+"these can only applied to sprites, but no sprite was specified, skipping features in layer");typeof j.size=="number"&&(j.size=[j.size,j.size])}else j.size=h&&h.css_size||[DEFAULT_POINT_SIZE,DEFAULT_POINT_SIZE];o.outline&&(j.outline_width=StyleParser.evalCachedProperty(o.outline.width,s)||StyleParser.defaults.outline.width,j.outline_color=this.parseColor(o.outline.color,s)),j.outline_edge_pct=0,j.outline_width&&j.outline_color&&(d=j.outline_width,j.size[0]+=d,j.size[1]+=d,j.outline_edge_pct=d/Math.min(j.size[0],j.size[1])*2),j.size[0]=Math.min(j.size[0],256),j.size[1]=Math.min(j.size[1],256),j.placement=o.placement,j.placement_min_length_ratio=StyleParser.evalCachedProperty(o.placement_min_length_ratio,s),j.placement===PLACEMENT$1.SPACED&&o.placement_spacing&&(j.placement_spacing=StyleParser.evalCachedProperty(o.placement_spacing,s)),j.angle=StyleParser.evalProperty(o.angle,s)||0,j.elevate_by_altitude=!!o.elevate_by_altitude,j.z=o.z?MathUtils$1.clamp(StyleParser.evalCachedDistanceProperty(o.z,s),0,32767):StyleParser.defaults.z,j.flat=o.flat,j.tile_edges=o.tile_edges,this.computeLayout(j,e,o,s,_),o.stick&&!j.flat&&(g=StyleParser.parseNumber(StyleParser.evalProperty(o.stick.height,s)),j.stick={color:this.parseColor(o.stick.color,s)||StyleParser.defaults.color,height:g?Math.max(g,0):0});var $=o.text&&StyleParser.evalProperty(o.text.visible,s)!==!1&&this.parseTextFeature(e,o.text,s,_);Array.isArray($)&&log({level:"warn",once:!($=null)},"Layer '".concat(o.layers[o.layers.length-1],"': ")+"cannot use boundary labels (e.g. 'text_source: { left: ..., right: ... }') for 'text' labels attached to 'points'; "+"provided 'text_source' value was ".concat(JSON.stringify(o.text.text_source))),$&&($.layout.parent=j,$.layout.priority=o.text.priority?Math.max($.layout.priority,j.priority+.5):j.priority+.5,$.layout.move_into_tile=!1,Collision.addStyle(this.collision_group_text,_.id)),this.queueFeature({feature:e,draw:o,context:s,style:j,text_feature:$},_),Collision.addStyle(this.collision_group_points,_.id)}},hasSprites:function(e){return e.texture&&this.textureManager.textures[e.texture]&&this.textureManager.textures[e.texture].sprites},getSpriteInfo:function(e,o){var s=this.textureManager.textures[e.texture].sprites[o]&&this.textureManager.getSpriteInfo(e.texture,o);return o&&!s?(this.texture_missing_sprites[e.texture]=this.texture_missing_sprites[e.texture]||{},this.texture_missing_sprites[e.texture][o]||(log("debug","Style: in style '".concat(this.name,"', could not find sprite '").concat(o,"' for texture '").concat(e.texture,"'")),this.texture_missing_sprites[e.texture][o]=!0)):s&&(s.sprite=o),s},parseSprite:function(e,o,s){var h=StyleParser.evalProperty(o.sprite,s);return this.getSpriteInfo(e,h)||this.getSpriteInfo(e,o.sprite_default)},queueFeature:function(e,o){this.tile_data[o.id]&&this.queues[o.id]||this.startData(o),this.queues[o.id]=this.queues[o.id]||[],this.queues[o.id].push(e)},endData:function(e){var o=this;if(e.canceled)return log("trace","Style ".concat(this.name,": stop tile build because tile was canceled: ").concat(e.key)),Promise.resolve();var s=this.queues[e.id];delete this.queues[e.id];var h=[],d=[];return s.forEach(function(g){for(var _=g.style,j=g.feature,$=j.geometry,_t=o.buildLabels(_.size,$,_),_e=0;_e<_t.length;_e++){var _r,_n=_t[_e],_o={feature:j,draw:g.draw,context:g.context,style:_,label:_n};d.push(_o),g.text_feature&&(_r={feature:j,draw:g.text_feature.draw,context:g.context,text:g.text_feature.text,text_settings_key:g.text_feature.text_settings_key,layout:g.text_feature.layout,point_label:_n,linked:_o},h.push(_r),g.draw.text.optional||(_o.linked=_r))}}),Promise.all([Collision.collide(d,this.collision_group_points,e.id).then(function(g){g.forEach(function(_){o.feature_style=_.style,o.feature_style.label=_.label,o.feature_style.linked=_.linked,Style.addFeature.call(o,_.feature,_.draw,_.context)})}),this.collideAndRenderTextLabels(e,this.collision_group_text,h)]).then(function(g){var _=_slicedToArray(g,2)[1],j=_.labels,$=_.texts;return j&&$&&j.forEach(function(_t){var _e=_t.text_settings_key,_r=$[_e]&&$[_e][_t.text],_n=o.feature_style;_n.label=_t.label,_n.linked=_t.linked,_n.size=_r.size.logical_size,_n.angle=0,_t.label.text_data={text_info:_r,text_settings_key:_e,text:_t.text},_n.label_texture=o.textureManager.default,Style.addFeature.call(o,_t.feature,_t.draw,_t.context)}),o.freeText(e),Style.endData.call(o,e)})},_preprocess:function(e){e.color=StyleParser.createColorPropertyCache(e.color),e.texture=e.texture!==void 0?e.texture:this.texture,e.outline&&(e.outline.color=StyleParser.createColorPropertyCache(e.outline.color),e.outline.width=StyleParser.createPropertyCache(e.outline.width,StyleParser.parsePositiveNumber)),e.z=StyleParser.createPropertyCache(e.z,StyleParser.parseUnits);try{e.size=StyleParser.createPointSizePropertyCache(e.size)}catch(o){return log({level:"warn",once:!0},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"".concat(o," (").concat(JSON.stringify(e.size),"), skipping features in layer")),null}return e.offset=StyleParser.createPropertyCache(e.offset,function(o){return Array.isArray(o)&&o.map(StyleParser.parseNumber)}),e.buffer=StyleParser.createPropertyCache(e.buffer,function(o){return(Array.isArray(o)?o:[o,o]).map(StyleParser.parsePositiveNumber)}),e.repeat_distance=StyleParser.createPropertyCache(e.repeat_distance,StyleParser.parseNumber),e.repeat_group==null&&(e.repeat_group=e.layers.join("-")),e.placement=PLACEMENT$1[e.placement&&e.placement.toUpperCase()],e.placement==null&&(e.placement=PLACEMENT$1.VERTEX),e.placement_spacing=e.placement_spacing!=null?e.placement_spacing:80,e.placement_spacing=StyleParser.createPropertyCache(e.placement_spacing,StyleParser.parsePositiveNumber),e.placement_min_length_ratio=e.placement_min_length_ratio!=null?e.placement_min_length_ratio:1,e.placement_min_length_ratio=StyleParser.createPropertyCache(e.placement_min_length_ratio,StyleParser.parsePositiveNumber),typeof e.angle=="number"?e.angle=e.angle*Math.PI/180:e.angle=e.angle||0,e.text=this.preprocessText(e.text),e.text&&(e.text.variantKey=e.variantKey,e.text.group=e.group,e.text.layers=e.layers,e.text.order=e.order,e.text.repeat_group=e.text.repeat_group||e.repeat_group,e.text.anchor=e.text.anchor||this.default_anchor,e.text.optional=typeof e.text.optional=="boolean"&&e.text.optional,e.text.interactive=e.text.interactive||e.interactive),e.stick&&(e.stick.color=StyleParser.createColorPropertyCache(e.stick.color)),e},default_anchor:["bottom","top","right","left"],computeLayout:function(e,o,s,h,d){var g=e||{};g.id=o,g.units_per_pixel=d.units_per_pixel||1,g.collide=s.collide!==!1,g.anchor=s.anchor,g.offset=StyleParser.evalCachedProperty(s.offset,h)||StyleParser.zeroPair,g.buffer=StyleParser.evalCachedProperty(s.buffer,h)||StyleParser.zeroPair,g.repeat_distance=StyleParser.evalCachedProperty(s.repeat_distance,h),g.repeat_distance&&(g.repeat_distance*=g.units_per_pixel,g.repeat_scale=1,typeof s.repeat_group=="function"?g.repeat_group=s.repeat_group(h):g.repeat_group=s.repeat_group);var _=s.priority;return _!=null?typeof _=="function"&&(_=_(h)):_=4294967295,g.priority=_,g},buildTextLabels:function(e,o){for(var s=[],h=0;h<o.length;h++){var d=o[h],g=this.texts[e.id][d.text_settings_key][d.text].size.collision_size;d.label=new LabelPoint(d.point_label.position,g,d.point_label.isFlat(),d.layout),s.push(d)}return s},buildLabels:function(e,o,s){var h=!!s.flat,d=[];if(o.type==="Point")d.push(new LabelPoint(o.coordinates,e,h,s));else if(o.type==="MultiPoint")for(var g=o.coordinates,_=0;_<g.length;++_){var j=g[_];d.push(new LabelPoint(j,e,h,s))}else if(o.type==="LineString")for(var $=placePointsOnLine(o.coordinates,e,h,s),_t=0;_t<$.length;++_t)d.push($[_t]);else if(o.type==="MultiLineString")for(var _e=o.coordinates,_r=0;_r<_e.length;_r++)for(var _n=placePointsOnLine(_e[_r],e,h,s),_o=0;_o<_n.length;++_o)d.push(_n[_o]);else if(o.type==="Polygon")if(s.placement===PLACEMENT$1.CENTROID){var ga=Geo$1.centroid(o.coordinates);d.push(new LabelPoint(ga,e,h,s))}else for(var _l=o.coordinates,_f=0;_f<_l.length;_f++)for(var _c=placePointsOnLine(_l[_f],e,h,s),_p=0;_p<_c.length;++_p)d.push(_c[_p]);else if(o.type==="MultiPolygon")if(s.placement===PLACEMENT$1.CENTROID){var _g=Geo$1.multiCentroid(o.coordinates);d.push(new LabelPoint(_g,e,h,s))}else for(var ty=o.coordinates,oy=0;oy<ty.length;oy++)for(var ry=ty[oy],ly=0;ly<ry.length;ly++)for(var py=placePointsOnLine(ry[ly],e,h,s),gy=0;gy<py.length;++gy)d.push(py[gy]);return d},makeVertexTemplate:function(e,o){var s,h=e.color||StyleParser.defaults.color,d=o.vertex_data.vertex_layout;return this.fillVertexTemplate(d,"a_position",0,{size:2}),this.fillVertexTemplate(d,"a_position",e.z||0,{size:1,offset:2}),this.fillVertexTemplate(d,"a_position",this.scaleOrder(e.order),{size:1,offset:3}),this.fillVertexTemplate(d,"a_shape",0,{size:4}),this.fillVertexTemplate(d,"a_shape",e.label.layout.collide?0:1,{size:1,offset:3}),this.fillVertexTemplate(d,"a_texcoord",0,{size:2}),this.fillVertexTemplate(d,"a_offset",0,{size:2}),this.fillVertexTemplate(d,"a_color",Vector$1.mult(h,255),{size:4}),this.defines.TANGRAM_HAS_SHADER_POINTS&&o.variant.shader_point&&(s=e.outline_color||StyleParser.defaults.outline.color,this.fillVertexTemplate(d,"a_outline_color",Vector$1.mult(s,255),{size:4}),this.fillVertexTemplate(d,"a_outline_edge",e.outline_edge_pct||StyleParser.defaults.outline.width,{size:1})),this.selection&&this.fillVertexTemplate(d,"a_selection_color",Vector$1.mult(e.selection_color,255),{size:4}),this.fillVertexTemplate(d,"a_is_flat",0,{size:1}),this.defines.TANGRAM_POINT_DRAW_STICK&&e.stick&&(this.fillVertexTemplate(d,"a_is_stick",0,{size:1}),this.fillVertexTemplate(d,"a_stick_height",e.stick.height,{size:1})),this.vertex_template},buildQuad:function(e,o,s,h,d,g,_,j,$,_t,_e,_r,_n,_o,ga,_l,_f,_c,_p){return o[0]<=0||o[1]<=0?0:buildQuadsForPoints(e,ga,_l,{quad:o,quad_normalize:256,offset:j,offsets:$,offsets_alt:_t,pre_angles:g,pre_angles_alt:_,angle:4096*s,angles:h,angles_alt:d,is_flat:_n,elevate_by_altitude:_o,build_stick_points:_f,stick_color:_f&&Vector$1.mult(_c,255),color:Vector$1.mult(_p||StyleParser.defaults.color,255),curve:_r,texcoord_scale:_e,texcoord_normalize,pre_angles_normalize,angles_normalize,offsets_normalize})},build:function(e,o,s){var h=e.label;return h.type==="curved"?this.buildCurvedLabel(h,e,o,s):this.buildStraightLabel(h,e,o,s)},buildStraightLabel:function(e,o,s,h){var d,g=this.makeVertexTemplate(o,s),_=e.angle||o.angle,j=e.type!=="point"?(d=o.size[e.type],default_uvs):(d=o.size,o.texcoords||default_uvs);s.uniforms=s.uniforms||{},o.label_texture?(s.uniforms.u_texture=o.label_texture,s.uniforms.u_point_type=TANGRAM_POINT_TYPE_LABEL,s.uniforms.u_apply_color_blocks=!1):(o.texture?(s.uniforms.u_texture=o.texture,s.uniforms.u_point_type=TANGRAM_POINT_TYPE_TEXTURE):(s.uniforms.u_texture=this.textureManager.default,s.uniforms.u_point_type=TANGRAM_POINT_TYPE_SHADER),s.uniforms.u_apply_color_blocks=!0);var $=e.offset,_t=this.defines.TANGRAM_POINT_DRAW_STICK&&!o.label_texture&&o.stick&&0<o.stick.height,_e=this.buildQuad([e.position],d,_,null,null,null,null,$,null,null,j,!1,e.isFlat(),o.elevate_by_altitude,s.vertex_data,g,_t,_t&&o.stick.color,o.color),_r=o.linked&&o.linked.label.id;return this.trackLabel(e,_r,s,_e,h,_t),_e},buildCurvedLabel:function(e,o,s,h){for(var d=this.makeVertexTemplate(o,s),g=e.angle,_=0,j=0;j<2;j++)for(var $=0;$<e.num_segments;$++){var _t=o.size[e.type][$],_e=default_uvs,_r=this.getTileMesh(h.tile,this.getMeshVariantTypeForDraw(o));_r.uniforms=_r.uniforms||{},_r.uniforms.u_texture=o.label_texture,_r.uniforms.u_point_type=TANGRAM_POINT_TYPE_LABEL,_r.uniforms.u_apply_color_blocks=!1;var _n=e.offset||[0,0],_o=e.position,ga=e.angles[$],_l=e.offsets[$],_f=e.pre_angles[$],_c=e.num_segments-$-1,_p=e.alt_angles[_c],_g=e.alt_pre_angles[_c],ty=e.alt_offsets[_c],oy=this.buildQuad([_o],_t,g,ga,_p,_f,_g,_n,_l,ty,_e,!0,e.isFlat(),o.elevate_by_altitude,_r.vertex_data,d,!1,!1,o.color);_+=oy;var ry=o.linked&&o.linked.label.id;this.trackLabel(e,ry,s,oy,h,!1)}return _},trackLabel:function(e,o,s,h,d,g){var _=5<arguments.length&&g!==void 0&&g;s.labels=s.labels||{},s.labels.collision=s.labels.collision||{},s.labels["non-collision"]=s.labels["non-collision"]||{};var j=e.layout.collide?s.labels.collision:s.labels["non-collision"];j[e.id]=j[e.id]||{container:{label:e.text_data?Object.assign(e.toJSON(),{text_data:e.text_data}):e.toJSON(),linked:o},ranges:[]};var $=2*h,_t=s.vertex_data.offset-s.vertex_data.stride*$;j[e.id].ranges.push([_t,$,_])},buildLines:function(e,o,s,h){return this.build(o,s,h)},buildPoints:function(e,o,s,h){return this.build(o,s,h)},buildPolygons:function(e,o,s,h){return this.build(o,s,h)},vertexLayoutForMeshVariant:function(e){var o;return this.vertex_layout||(o=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_shape",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_outline_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0,static:[0,0,0,0]},{name:"a_outline_edge",size:1,type:gl$1.FLOAT,normalized:!1,static:0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0}],this.defines&&this.defines.TANGRAM_POINT_DRAW_STICK&&o.push({name:"a_is_stick",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_stick_height",size:1,type:gl$1.FLOAT,normalized:!1}),this.vertex_layout=new VertexLayout(o),(o=o.map(function(s){return Object.assign({},s)})).forEach(function(s){s.name!=="a_outline_color"&&s.name!=="a_outline_edge"||(s.static=null)}),this.vertex_layout_shader_point=new VertexLayout(o)),e.shader_point?this.vertex_layout_shader_point:this.vertex_layout},computeVariantForDraw:function(e){var o=e.label_texture||e.texture||this.default_mesh_variant.key;return{key:o,shader_point:o===this.default_mesh_variant.key,order:e.label_texture?1:0}},makeMesh:function(e,o,s){var h=2<arguments.length&&s!==void 0?s:{},h=Object.assign({},h,{fade_in_time:this.fade_in_time});return Style.makeMesh.call(this,e,o,h)}});var STOPS=[0,.33,.66,.99],LINE_EXCEED_STRAIGHT=1.5,LINE_EXCEED_STRAIGHT_NO_CURVE=1.8,LINE_EXCEED_STAIGHT_LOOSE=2.3,STRAIGHT_ANGLE_TOLERANCE=.1,CURVE_MIN_TOTAL_COST=1.3,CURVE_MIN_AVG_COST=.4,CURVE_MAX_ANGLE=1,ORIENTED_LABEL_OFFSET_FACTOR=1.2,VERTICAL_ANGLE_TOLERANCE=.01,LabelLine={create:function(e,o,s,h,d){for(var g=[{type:"straight",tolerance:d.no_curving?LINE_EXCEED_STRAIGHT_NO_CURVE:LINE_EXCEED_STRAIGHT},{type:"curved"},{type:"straight",tolerance:LINE_EXCEED_STAIGHT_LOOSE}],_=0;_<g.length;_++){var j=g[_],$=void 0;if(j.type==="straight"?$=new LabelLineStraight(o,s,h,d,j.tolerance):j.type==="curved"&&!d.no_curving&&2<s.length&&($=new LabelLineCurved(e,s,h,d)),$&&!$.throw_away)return $}return!1}},LabelLineBase=function(){function e(o,s){_classCallCheck(this,e),this.id=Label.nextLabelId(),this.layout=s,this.position=[],this.angle=0,this.offset=s.offset.slice(),this.unit_scale=this.layout.units_per_pixel,this.type="",this.throw_away=!1,this._is_flat=o,this._circles=void 0,this.placed=null}return _createClass(e,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,angle:this.angle,breach:this.breach,layout:textLayoutToJSON(this.layout),circles:this.getBoundingCircles()}}},{key:"inTileBounds",value:function(){var o=this.getAABB(),s=o.left,h=o.top,d=o.right,g=o.bottom;return Utils$1.pointInTile([s,h])&&Utils$1.pointInTile([d,g])}},{key:"getAABBForSegment",value:function(o,s,h,d){var g,_=this.unit_scale,j=s/2,$=h/2,_t=_slicedToArray(o,2),_e=_t[0],_r=_t[1];this.offset[0]===0&&this.offset[1]===0||(_e+=(g=Vector$1.rot(this.offset,this.angle))[0]*_,_r-=g[1]*_);var _n=[[Math.cos(d),-Math.sin(d)],[Math.sin(d),Math.cos(d)]],_o=Vector$1.multMatrix(_n,[-j,-$]),ga=Vector$1.multMatrix(_n,[j,-$]),_l=Vector$1.multMatrix(_n,[j,$]),_f=Vector$1.multMatrix(_n,[-j,$]);return{left:_e+Math.min(_o[0],ga[0],_l[0],_f[0]),top:_r+Math.max(_o[1],ga[1],_l[1],_f[1]),right:_e+Math.max(_o[0],ga[0],_l[0],_f[0]),bottom:_r+Math.min(_o[1],ga[1],_l[1],_f[1])}}},{key:"isFlat",value:function(){return this._is_flat}},{key:"getBoundingCircles",value:function(){}},{key:"getAABB",value:function(){}}],[{key:"splitLineByOrientation",value:function(o){for(var s=[o[0]],h=0,d=0,g=0,_=s,j=!1,$=1;$<o.length;$++){var _t=o[$],_e=o[$-1],_r=Vector$1.length(Vector$1.sub(_t,_e));_t[0]>_e[0]?g===1?(s.push(_t),d<(h+=_r)&&(_=s,d=h,j=!1)):(s=[_e,_t],d<(h=_r)&&(_=s,d=h,j=!1),g=1):_t[0]<_e[0]?g===-1?(s.unshift(_t),d<(h+=_r)&&(_=s,d=h,j=!0)):(s=[_t,_e],d<(h=_r)&&(_=s,d=h,j=!0),g=-1):(g===-1?s.unshift(_t):(s.push(_t),g=1),d<(h+=_r)&&(_=s,d=h,j=g===-1))}return[_,j]}}]),e}(),LabelLineStraight=function(){_inherits(o,LabelLineBase);var e=_createSuper(o);function o(s,h,d,g,_){var j;return _classCallCheck(this,o),(j=e.call(this,d,g)).type="straight",j.size=s,j.throw_away=!j.fit(s,h,g,_),j}return _createClass(o,[{key:"fit",value:function(s,h,d,g){var _,j=this.unit_scale,$=_slicedToArray(LabelLineBase.splitLineByOrientation(h),2);h=$[0],_=$[1],typeof d.orientation=="number"&&(this.offset[1]+=ORIENTED_LABEL_OFFSET_FACTOR*(s[1]-d.vertical_buffer),_&&(this.offset[1]*=-1),d.orientation===-1&&(this.offset[1]*=-1));for(var _t=getLineLengths(h),_e=s[0]*j,_r=0;_r<h.length-1;_r++)for(var _n=h[_r],_o=0,ga=0,_l=_r+1,_f=void 0;_l<h.length;){var _c=h[_l-1],_p=h[_l],_g=getAngleForSegment(_c,_p);if(_l!==_r+1&&(_o+=getAbsAngleDiff(_g,_f)),Math.abs(_o)>STRAIGHT_ANGLE_TOLERANCE)break;if(calcFitness(ga+=_t[_l-1],_e)<g){var ty=Vector$1.mult(Vector$1.add(_n,_p),.5);return this.angle=-_g,Math.abs(this.angle-Math.PI/2)<VERTICAL_ANGLE_TOLERANCE&&(this.angle=-Math.PI/2,typeof d.orientation=="number"&&(this.offset[1]*=-1)),this.position=ty,this.breach=!this.inTileBounds(),!0}_f=_g,_l++}return!1}},{key:"getBoundingCircles",value:function(){var s,h,d,g,_,j,$,_t,_e,_r,_n,_o,ga,_l;return this._circles||(s=this.unit_scale,_=-(d=(h=this.size[0]/2*s)*Math.cos(this.angle)),j=-(g=h*Math.sin(this.angle)),$=this.offset[0]*s,_t=this.offset[1]*s,_r=(_e=_slicedToArray(this.position,2))[0],_n=_e[1],_n*=-1,$&&(_o=[d,g],Vector$1.normalize(_o),_o[0]*=$,_o[1]*=$,_r+=_o[0],_n+=_o[1]),_t&&(ga=[g,-d],Vector$1.normalize(ga),ga[0]*=_t,ga[1]*=_t,_r-=ga[0],_n-=ga[1]),d+=_r,g+=_n,_+=_r,j+=_n,_l=this.size[1]/2*s,this._circles=encircleLine(d,g,_,j,_l)),this._circles}},{key:"getAABB",value:function(){var s,h,d,g,_;return this._aabb||(s=this.unit_scale,h=this.size,d=this.layout.buffer,g=(h[0]+2*d[0])*s,_=(h[1]+2*d[1])*s,this._aabb=this.getAABBForSegment(this.position,g,_,this.angle)),this._aabb}}]),o}(),LabelLineCurved=function(){_inherits(o,LabelLineBase);var e=_createSuper(o);function o(s,h,d,g){var _;return _classCallCheck(this,o),(_=e.call(this,d,g)).type="curved",_.positions=[],_.angles=[],_._aabbs=[],_.pre_angles=[],_.offsets=[],_.num_segments=s.length,_.sizes=s,_.alt_angles=[],_.alt_pre_angles=[],_.alt_offsets=[],_.throw_away=!_.fit(_.sizes,h,g),_}return _createClass(o,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,breach:this.breach,layout:textLayoutToJSON(this.layout),circles:this.getBoundingCircles()}}},{key:"fit",value:function(s,h,d){var g,_=this.unit_scale,j=Math.max.apply(Math,_toConsumableArray(s.map(function(J0){return J0[1]}))),$=j*_,_t=_slicedToArray(LabelLineBase.splitLineByOrientation(h),2);h=_t[0],g=_t[1],typeof d.orientation=="number"&&(this.offset[1]+=ORIENTED_LABEL_OFFSET_FACTOR*(j-d.vertical_buffer),g&&(this.offset[1]*=-1),d.orientation===-1&&(this.offset[1]*=-1));var _e=getLineLengths(h),_r=s.map(function(J0){return J0[0]*_}),_n=_e.reduce(function(J0,C0){return J0+C0},0),_o=_r.reduce(function(J0,C0){return J0+C0},0);if(_n<_o)return!1;var ga=h.length-1;if(ga<2)return!1;var _l=o.curvaturePlacement(h,_n,_e,_o,0,ga),_f=h[_l];if(_l===-1||ga-_l<2)return!1;this.position=_f;for(var _c=0;_c<_r.length;_c++){this.positions[_c]=[],this.offsets[_c]=[],this.angles[_c]=[],this.pre_angles[_c]=[];for(var _p=0;_p<STOPS.length;_p++){var _g=STOPS[_p],ty=_slicedToArray(o.scaleLine(_g,h),2),oy=ty[0],ry=ty[1],_f=oy[_l],ly=o.placeAtIndex(_l,oy,ry,_r),py=ly.positions,gy=ly.offsets,by=ly.angles,wy=ly.pre_angles,Cy=gy.map(function(C0){return Math.sqrt(C0[0]*C0[0]+C0[1]*C0[1])/_});if(_g===0){this.angle=1/by.length*by.reduce(function(C0,H0){return C0+H0});for(var Gy=0;Gy<py.length;Gy++){var Ly=py[Gy],d0=wy[Gy],s0=_r[Gy],t0=d0+by[Gy];this._aabbs.push(this.getAABBForSegment(Ly,s0,$,t0))}}this.positions[_c].push(py[_c]),this.offsets[_c].push(Cy[_c]),this.angles[_c].push(by[_c]),this.pre_angles[_c].push(wy[_c])}}for(var _r=s.slice().reverse().map(function(C0){return C0[0]*_}),Ay=0;Ay<_r.length;Ay++){this.alt_offsets[Ay]=[],this.alt_angles[Ay]=[],this.alt_pre_angles[Ay]=[];for(var Ny=0;Ny<STOPS.length;Ny++){var Hy=STOPS[Ny],n0=_slicedToArray(o.scaleLine(Hy,h),2),v0=n0[0],f0=n0[1];_f=v0[_l];var A0=o.placeAtIndex(_l,v0,f0,_r),q0=A0.offsets,D0=A0.angles,K0=A0.pre_angles,a1=q0.map(function(C0){return Math.sqrt(C0[0]*C0[0]+C0[1]*C0[1])/_});Hy===0&&(this.alt_angle=1/D0.length*D0.reduce(function(C0,H0){return C0+H0})),this.alt_offsets[Ay].push(a1[Ay]),this.alt_angles[Ay].push(D0[Ay]),this.alt_pre_angles[Ay].push(K0[Ay])}}return!0}},{key:"getBoundingCircles",value:function(){if(!this._circles){for(var s=[],h=this.unit_scale,d=0;d<this.positions.length;d++){var g=this.sizes[d],_=this.angles[d][0],j=this.positions[d][0],$=g[0]/2*h,_t=$*Math.cos(_),_e=$*Math.sin(_),_r=-_t,_n=-_e,_o=_slicedToArray(j,2),ga=_o[0],_l=_o[1],_f=encircleLine(_t+=ga,_e+=_l*=-1,_r+=ga,_n+=_l,g[1]/2*h);Array.prototype.push.apply(s,_f)}this._circles=s}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){for(var d=1/0,g=-1/0,_=-1/0,j=1/0,s=0;s<this._aabbs.length;s++)var h=this._aabbs[s],d=Math.min(d,h.left),g=Math.max(g,h.top),_=Math.max(_,h.right),j=Math.min(j,h.bottom);this._aabb={left:d,top:g,right:_,bottom:j}}return this._aabb}}],[{key:"curvaturePlacement",value:function(s,h,d,g,_,j){_=_||0,j=j||s.length-1;for(var $=[],_t=_+1;_t<j;_t++){var _e=s[_t-1],_r=s[_t],_n=s[_t+1],_o=Vector$1.perp(_r,_e),ga=Vector$1.perp(_n,_r),_l=Vector$1.angleBetween(_o,ga);CURVE_MAX_ANGLE<_l&&(_l=1/0),$.push(_l)}$.push(1/0);for(var _f=[],_c=[],_p=_,_g=0,ty=0;ty<_;ty++)_g+=d[ty];for(;_g+g<h;){for(var oy=_g+g,ry=_g,ly=_p,py=0;ly<j&&ry+d[ly]<oy&&(py+=$[ly])!==1/0;)ry+=d[ly],ly++;if(py===0)return _p;var gy=py/(ly-_p);_f.push(py),_c.push(gy),_g+=d[_p],_p++}if(_f.length===0)return-1;var by=Math.min.apply(null,_f),wy=_c[_f.indexOf(by)];return by<CURVE_MIN_TOTAL_COST&&wy<CURVE_MIN_AVG_COST?_f.indexOf(by):-1}},{key:"scaleLine",value:function(s,h){var d=[h[0]],g=[];return h.forEach(function(_,j){var $,_t;j!==h.length-1&&($=Vector$1.sub(h[j+1],h[j]),_t=Vector$1.mult($,1+s),d.push(Vector$1.add(d[j],_t)),g.push(Vector$1.length(_t)))}),[d,g]}},{key:"placeAtIndex",value:function(s,h,d,g){var _=h[s],j=_slicedToArray(o.getIndicesAndOffsets(s,d,g),2),$=j[0],_t=j[1],_e=o.getPositionsFromIndicesAndOffsets(h,$,_t),_r=_slicedToArray(o.getAnglesFromIndicesAndOffsets(_,$,h,_e),3);return{positions:_e,offsets:_r[0],angles:_r[1],pre_angles:_r[2]}}},{key:"getIndicesAndOffsets",value:function(s,h,d){for(var g=d.length,_=[],j=[],$=0,_t=0,_e=0;$<g;){for(var _r=d[$];$<g&&_t+.5*_r<=_e+h[s];){var _n=_t-_e+.5*_r;j.push(_n),_.push(s),_t+=_r,_r=d[++$]}_e+=h[s],s++}return[_,j]}},{key:"getPositionsFromIndicesAndOffsets",value:function(s,h,d){for(var g=[],_=0;_<h.length;_++){var j=h[_],$=d[_],_t=getAngleForSegment(s[j],s[j+1]),_e=Vector$1.rot([$,0],_t),_r=Vector$1.add(s[j],_e);g.push(_r)}return g}},{key:"getAnglesFromIndicesAndOffsets",value:function(s,h,d,g){for(var _=[],j=[],$=[],_t=0;_t<g.length;_t++){var _e,_r,_n=g[_t],_o=h[_t],ga=Vector$1.sub(_n,s),_l=-Vector$1.angle(ga),_f=getTextAngleForSegment(d[_o],d[_o+1])-_l;0<_t&&(_e=_[_t-1],_r=j[_t-1],Math.abs(_l-_e)>Math.PI&&(_l+=_e<_l?-2*Math.PI:2*Math.PI),Math.abs(_r-_f)>Math.PI&&(_f+=_r<_f?-2*Math.PI:2*Math.PI)),_.push(_l),j.push(_f),$.push(ga)}return[$,_,j]}}]),o}();function calcFitness(e,o){return o/e}function getAngleForSegment(e,o){var s=Vector$1.sub(o,e);return Vector$1.angle(s)}function getTextAngleForSegment(e,o){return-getAngleForSegment(e,o)}function getLineLengths(e){for(var o=[],s=0;s<e.length-1;s++){var h=e[s],d=e[s+1],g=Math.hypot(h[0]-d[0],h[1]-d[1]);o.push(g)}return o}function getAbsAngleDiff(e,o){for(var s,h=o<e?(s=o,e):(s=e,o);h-s>Math.PI;)s+=2*Math.PI;return Math.abs(h-s)}var TextStyle=Object.create(Points);Object.assign(TextStyle,{name:"text",super:Points,built_in:!0,init:function(e){var o=0<arguments.length&&e!==void 0?e:{};Style.init.call(this,o),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!1,this.defines.TANGRAM_IS_TEXT_STYLE=!0,this.reset()},makeVertexTemplate:function(e,o){this.super.makeVertexTemplate.apply(this,arguments);var s=o.vertex_data.vertex_layout;return this.fillVertexTemplate(s,"a_pre_angles",0,{size:4}),this.fillVertexTemplate(s,"a_offsets",0,{size:4}),this.fillVertexTemplate(s,"a_angles",0,{size:4}),this.fillVertexTemplate(s,"a_offsets_alt",0,{size:4}),this.fillVertexTemplate(s,"a_pre_angles_alt",0,{size:4}),this.fillVertexTemplate(s,"a_angles_alt",0,{size:4}),this.vertex_template},reset:function(){this.queues={},this.resetText()},addFeature:function(e,o,s){var h=this,d=s.tile,g=e.geometry.type;o.can_articulate=g==="LineString"||g==="MultiLineString",o.supersample_text=g==="LineString"||g==="MultiLineString";var _=this.parseTextFeature(e,o,s,d);_&&(_ instanceof Array?_.forEach(function(j){j.feature=e,j.context=s,j.layout.vertex=!1,h.queueFeature(j,d)}):(_.feature=e,_.context=s,_.layout.vertex=!1,this.queueFeature(_,d)),Collision.addStyle(this.name,d.id))},endData:function(e){var o=this,s=this.queues[e.id];return delete this.queues[e.id],this.collideAndRenderTextLabels(e,this.name,s).then(function(h){var d=h.labels,g=h.texts;return d&&g&&(o.texts[e.id]=g,d.forEach(function(_){var j=_.text_settings_key,$=o.texts[e.id][j]&&o.texts[e.id][j][_.text],_t=o.feature_style;_t.label=_.label,_.label.text_data={text_info:$,text_settings_key:j,text:_.text},_t.label_texture=o.textureManager.default,$.text_settings.can_articulate?(_t.size={},_.label.type==="straight"?_t.size.straight=$.size.logical_size:_t.size.curved=$.segment_sizes.map(function(_e){return _e.logical_size})):_t.size=$.size.logical_size,Style.addFeature.call(o,_.feature,_.draw,_.context)})),o.freeText(e),Style.endData.call(o,e).then(function(_){if(_){for(var j in _.meshes)_.meshes[j].uniforms.u_apply_color_blocks=!0;e.mesh_data[o.name]=_}return _})})},_preprocess:function(e){return this.preprocessText(e)},buildTextLabels:function(e,o){for(var s=[],h=0;h<o.length;h++){var d,g=o[h],_=this.texts[e.id][g.text_settings_key][g.text],j=void 0;g.layout.vertical_buffer=_.vertical_buffer,j=_.text_settings.can_articulate?(d=_.segment_sizes.map(function(_e){return _e.collision_size}),g.layout.no_curving=_.no_curving,this.buildLabels(d,g.feature.geometry,g.layout,_.size.collision_size)):this.buildLabels(_.size.collision_size,g.feature.geometry,g.layout);for(var $=0;$<j.length;$++){var _t=Object.create(g);_t.label=j[$],s.push(_t)}}return s},buildLabels:function(e,o,s,h){var d,g,_=o.type!=="Point",j=[];if(o.type==="LineString")Array.prototype.push.apply(j,this.buildLineLabels(o.coordinates,e,_,s,h));else if(o.type==="MultiLineString")for(var $=o.coordinates,_t=0;_t<$.length;++_t)Array.prototype.push.apply(j,this.buildLineLabels($[_t],e,_,s,h));else if(o.type==="Point")j.push(new LabelPoint(o.coordinates,e,_,s));else if(o.type==="MultiPoint")for(var _e=o.coordinates,_r=0;_r<_e.length;++_r)j.push(new LabelPoint(_e[_r],e,_,s));else o.type==="Polygon"?(d=Geo$1.centroid(o.coordinates),j.push(new LabelPoint(d,e,_,s))):o.type==="MultiPolygon"&&(g=Geo$1.multiCentroid(o.coordinates),j.push(new LabelPoint(g,e,_,s)));return j},buildLineLabels:function(e,o,s,h,d){var g,_=[],j=Math.min(h.subdiv,e.length-1);if(1<j)for(var $=(e.length-1)/j,_t=0;_t<j;_t++){var _e=Math.floor(_t*$),_r=Math.floor((_t+1)*$)+1,_n=e.slice(_e,_r),_o=LabelLine.create(o,d,_n,s,h);_o&&_.push(_o)}return _.length<j&&(g=LabelLine.create(o,d,e,s,h))&&_.push(g),_},vertexLayoutForMeshVariant:function(){var e;return this.vertex_layout||(e=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_shape",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_angles",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_offsets",size:4,type:gl$1.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles",size:4,type:gl$1.BYTE,normalized:!1},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_offsets_alt",size:4,type:gl$1.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles_alt",size:4,type:gl$1.BYTE,normalized:!1},{name:"a_angles_alt",size:4,type:gl$1.SHORT,normalized:!1}],this.vertex_layout=new VertexLayout(e)),this.vertex_layout},getMeshVariantTypeForDraw:Points.getMeshVariantTypeForDraw}),TextStyle.texture_id=0;var RasterStyle=Object.create(Polygons);Object.assign(RasterStyle,{name:"raster",super:Polygons,built_in:!0,init:function(){this.raster=this.raster||"color",this.super.init.apply(this,arguments),this.selection=!1,this.defines.SNAP_TO_PIXEL_GRID=!0},_preprocess:function(e){return e.color=e.color||StyleParser.defaults.color,this.super._preprocess.apply(this,arguments)}});var CustomIcons=Object.create(Points);Object.assign(CustomIcons,{name:"custom_icons",collision:!1,init:function(e){var o=0<arguments.length&&e!==void 0?e:{};Points.init.call(this,o)},loadTexture:function(e,o,s){var h,d=e.width,g=e.height,_=e.items,j=document.createElement("canvas"),$=Utils$1.device_pixel_ratio,_t=this.sources[o],_e={sprites:{}};if(j.width=d*$,j.height=g*$,_t){var _r,_n=_.length,_o=j.getContext("2d");for(_o.scale($,$);_r=_[--_n];){var ga,_l=_t.getIconBitmapByObjectId(_r.meta.objectId,_r.meta.id);_l&&((ga=isTainting(_l))?log("error",ga):(_o.drawImage(_l,_r.x,_r.y,_r.width,_r.height),_e.sprites[_r.meta.id]=[_r.x,_r.y,_r.width,_r.height]))}}return _e.element=j,(h=this.textureManager.create(this.gl,s,_e)).retain(),h.loading.then(function(_f){return _f.name})},buildRasterTextures:function(e,o){return WorkerBroker.postMessage(this.main_thread_target+".loadTexture",e.rasters,e.source,e.texture_name).then(function(s){return o.textures.push(s),o})},addFeature:function(e,o,s){var h=s.tile.rasters,d={};h.items.forEach(function(j){d[j.meta.id]=[j.x,j.y,j.width,j.height]});var g="".concat(s.tile.source,"_dyn_").concat(s.tile.coords.key,"_").concat(this.generation,"_").concat(s.tile.id);o.texture=s.tile.texture_name=g;var _=Object.assign({},DEFAULT_TEXTURE_INFO,{name:g,width:h.width,height:h.height,sprites:d,manager:this.textureManager});Texture.prototype.calculateSprites.apply(_),this.textureManager.textures[g]=_,Points.addFeature.apply(this,arguments),delete this.textureManager.textures[g]}});var DEFAULT_TEXTURE_INFO={filtering:"linear",density:1,valid:!0,power_of_2:!1,texcoords:{},sizes:{},css_sizes:{},aspects:{}},OverlayStyle=Object.create(Polygons);Object.assign(OverlayStyle,{name:"overlays",super:Polygons,init:function(e){var o=0<arguments.length&&e!==void 0?e:{};this.selection=o.selection||!0,this.raster=this.raster||"color",this.super.init.apply(this,arguments)},setupRasters:function(){if(!Thread.is_main)return!1;if(this.super.setupRasters.call(this))return!0;var e=!1;for(var o in this.sources)if(this.sources[o]instanceof ObjectSource){e=!0;break}return!!e&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",shaderSrc_rasters,"Raster"),!0)},loadTextures:function(e,o){var s,h,d,g=this.sources[o],_=e.name;if(e.overlays_config.forEach(function(_t){var _e,_r=_t.texcoords,_n=_t.id,_o=g.getMapObjectById(_n),ga=_o.getBitmap();ga&&((_e=isTainting(ga=bitmapToCanvas(ga,ga.width,ga.height)))?log("error",_e):(s||((s=document.createElement("canvas")).width=e.width,s.height=e.height,h=s.getContext("2d")),h.save(),h.globalAlpha=_o.getOpacity(),_r.forEach(function(_l){return h.drawImage(ga,_l[0],_l[1],_l[2],_l[3])}),h.restore(),d=!0))}),d){e.element=s;var j={};return j[_]=e,this.super.loadTextures.call(this,j)}var $=this.textureManager.textures[this.textureManager.default];return Promise.resolve([{name:$.name,width:$.width,height:$.height,loaded:$.loaded}])},buildRasterTextures:function(e,o){var s=this.sources[e.source].tileTexture(e);return s?WorkerBroker.postMessage(this.main_thread_target+".loadTextures",s,e.source).then(function(h){if(!h||h.length<1)return o;if(h.some(function(g){return!g.loaded}))return null;var d=h[0].name;return o.uniforms=o.uniforms||{},o.textures=o.textures||[],o.uniforms.u_raster=d,o.uniforms.u_raster_offset=[0,0,1],o.textures.push(d),o}):Promise.resolve(o)}});var shaderSrc_Vertex="uniform float u_horizon;uniform float u_tilt;uniform float u_zoom;attribute vec2 a_position;attribute float a_is_sky;attribute float a_is_top;attribute vec4 a_color;varying vec4 v_color;const float SIN_THRESHOLD_ANGLE=0.96126069082;void main(){v_color=a_color;float sin_tilt=sin(u_tilt);float sky_bottom_alpha=1.-max(sin_tilt-SIN_THRESHOLD_ANGLE,0.)*3.;if((a_position.y==1.&&a_is_sky==0.)||(a_position.y==0.&&a_is_sky==1.)){v_color.w=sky_bottom_alpha;}float fog_height=max((22.-u_zoom)*0.04,0.)*(sin_tilt-.7);float position_z=u_zoom<17. ? .942 : .9418;gl_Position=vec4(a_position.x,a_is_sky*(a_position.y+a_is_top)+1.0-u_horizon-(1.0-a_is_sky)*(1.0-a_position.y)*fog_height,position_z,1.0);}",shaderSrc_Fragment="varying vec4 v_color;void main(void){gl_FragColor=v_color;}",STYLE_NAME="skybox",SkyBox=Object.create(Style),positions=[-1,0,1,0,-1,1,-1,1,1,0,1,1,-1,0,1,0,-1,1,-1,1,1,0,1,1];Object.assign(SkyBox,{name:STYLE_NAME,built_in:!0,vertex_shader_src:shaderSrc_Vertex,fragment_shader_src:shaderSrc_Fragment,selection:!1,blend:"inlay",blend_order:1,init:function(){Style.init.apply(this,arguments),this.selection=!1},_preprocess:function(e){return e.color={top:StyleParser.createColorPropertyCache(e.color.zenith),bottom:StyleParser.createColorPropertyCache(e.color.horizon),fog:StyleParser.createColorPropertyCache(e.color.fog)},e},vertexLayoutForMeshVariant:function(){var e;return this.vertex_layout||(e=[{name:"a_position",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_is_sky",size:1,type:gl$1.FLOAT,normalized:!0},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_top",size:1,type:gl$1.FLOAT,normalized:!0}],this.vertex_layout=new VertexLayout(e)),this.vertex_layout},makeVertexTemplate:function(){var e=0;return this.vertex_template[e++]=0,this.vertex_template[1]=0,this.vertex_template},parseFeature:function(e,o,s){var h=this.feature_style;return o.color&&o.color.top&&o.color.bottom&&(h.color_top=this.parseColor(o.color.top,s),h.color_bottom=this.parseColor(o.color.bottom,s),h.color_fog=this.parseColor(o.color.fog||"white",s),Array.isArray(h.color_fog)&&(h.color_fog=h.color_fog.slice(),h.color_fog[3]=0)),h},buildGeometry:function(e,o,s){for(var h=this.makeVertexTemplate(o),d=s.vertex_data,g=s.vertex_data.vertex_layout,_=d.vertex_layout.index.a_position,j={top:o.color_top,bottom:o.color_bottom},$={top:o.color_bottom,bottom:o.color_fog},_t=0,_e=positions.length-1;_t<_e;_t+=2){h[_+0]=positions[_t],h[_+1]=positions[_t+1];var _r=_t<12,_n=0<positions[_t+1],_o=_r?j:$;this.fillVertexTemplate(g,"a_is_sky",_r?1:0,{size:1}),this.fillVertexTemplate(g,"a_is_top",_n?1:0,{size:1}),this.fillVertexTemplate(g,"a_color",Vector$1.mult(_n?_o.top:_o.bottom,255),{size:4}),d.addVertex(h)}return 4}});var shaderSrc_accessors=`#ifdef TANGRAM_VERTEX_SHADER
vec4 modelPosition(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE*exp2(u_tile_origin.z-u_tile_origin.w),1.)+vec4(0.,1.,0.,0.);}vec4 modelPositionBaseZoom(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE,1.)+vec4(0.,1.,0.,0.);}
#endif
vec4 worldPosition(){return v_world_position;}
#ifdef TANGRAM_VERTEX_SHADER
vec4 wrapWorldPosition(vec4 world_position){
#if defined(TANGRAM_WORLD_POSITION_WRAP)
vec2 anchor=u_tile_origin.xy-mod(u_tile_origin.xy,TANGRAM_WORLD_POSITION_WRAP);world_position.xy-=anchor;
#endif
return world_position;}
#endif
#if defined(TANGRAM_VERTEX_SHADER)
vec3 worldNormal(){return TANGRAM_NORMAL;}
#elif defined(TANGRAM_FRAGMENT_SHADER)
vec3 worldNormal(){return u_inverseNormalMatrix*TANGRAM_NORMAL;}
#endif
`,shaderSrc_layerOrder="void applyLayerOrder(float layer,inout vec4 position){position.z-=layer*TANGRAM_LAYER_DELTA*position.w;}",shaderSrc_selectionGlobals=`
#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)
attribute vec4 a_selection_color;varying vec4 v_selection_color;uniform vec4 u_selection_discard0;uniform vec4 u_selection_discard1;uniform vec4 u_selection_discard2;uniform vec4 u_selection_discard3;uniform vec4 u_selection_discard4;uniform vec4 u_selection_discard5;uniform vec4 u_selection_discard6;uniform vec4 u_selection_discard7;uniform vec4 u_selection_discard8;uniform vec4 u_selection_discard9;
#endif
`,shaderSrc_selectionVertex=`
#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)
if(a_selection_color.rgb==vec3(0.)||a_selection_color==u_selection_discard0||a_selection_color==u_selection_discard1||a_selection_color==u_selection_discard2||a_selection_color==u_selection_discard3||a_selection_color==u_selection_discard4||a_selection_color==u_selection_discard5||a_selection_color==u_selection_discard6||a_selection_color==u_selection_discard7||a_selection_color==u_selection_discard8||a_selection_color==u_selection_discard9){gl_Position=vec4(0.,0.,0.,1.);return;}v_selection_color=a_selection_color;
#endif
`,shaderSrc_utils=`#ifndef UTILS
#define UTILS
bool isLocalSpacePixelOutsideTile(vec4 pixel_local_space_position,float tile_scale){return pixel_local_space_position.x<0.||pixel_local_space_position.x>=tile_scale||pixel_local_space_position.y>0.||pixel_local_space_position.y<=-tile_scale;}
#endif
`,shaderSrc_snapToPixelGrid=`uniform float u_view_pan_snap_timer;void snapToPixelGrid(inout vec4 position){vec2 position_fract=fract((((position.xy/position.w)+1.)*.5)*u_resolution);vec2 position_snap=position.xy+((step(0.5,position_fract)-position_fract)*position.w*2./u_resolution);
#ifdef TANGRAM_VIEW_PAN_SNAP_RATE
position.xy=mix(position.xy,position_snap,clamp(u_view_pan_snap_timer*TANGRAM_VIEW_PAN_SNAP_RATE,0.,1.));
#else
position.xy=position_snap;
#endif
}`,StyleManager=function(){function e(){_classCallCheck(this,e),this.styles={},this.base_styles={},this.register(Object.create(Polygons)),this.register(Object.create(Lines)),this.register(Object.create(PatternLines)),this.register(Object.create(Points)),this.register(Object.create(TextStyle)),this.register(Object.create(RasterStyle)),this.register(Object.create(CustomIcons)),this.register(Object.create(OverlayStyle)),this.register(Object.create(SkyBox))}return _createClass(e,[{key:"init",value:function(){ShaderProgram.removeBlock("global"),ShaderProgram.removeBlock("setup"),ShaderProgram.addBlock("global",shaderSrc_accessors),ShaderProgram.addBlock("global",shaderSrc_layerOrder),ShaderProgram.addBlock("global",shaderSrc_selectionGlobals),ShaderProgram.addBlock("global",shaderSrc_snapToPixelGrid),ShaderProgram.replaceBlock("utils",shaderSrc_utils),ShaderProgram.replaceBlock("setup",shaderSrc_selectionVertex),ShaderProgram.defines.TANGRAM_EPSILON=1e-5,ShaderProgram.defines.TANGRAM_LAYER_DELTA=1/16384,ShaderProgram.defines.TANGRAM_TILE_SCALE="vec3(".concat(Geo$1.tile_scale,"., ").concat(Geo$1.tile_scale,"., u_meters_per_pixel * ").concat(Geo$1.tile_size,".)"),ShaderProgram.defines.TANGRAM_HEIGHT_SCALE=Geo$1.height_scale,ShaderProgram.defines.TANGRAM_ALPHA_TEST=.1,Lines.dash_textures={}}},{key:"destroy",value:function(o){var s=this;Object.keys(this.styles).forEach(function(h){var d=s.styles[h];d.gl===o&&(log("trace","StyleManager.destroy: destroying render style ".concat(d.name)),d.base&&s.remove(d.name),d.destroy())})}},{key:"register",value:function(o){this.styles[o.name]=o,this.base_styles[o.name]=o}},{key:"remove",value:function(o){delete this.styles[o]}},{key:"mix",value:function(o,s){if(o.mixed)return o;o.mixed={};var h=[];o.mix&&(Array.isArray(o.mix)?h.push.apply(h,_toConsumableArray(o.mix)):h.push(o.mix),(h=h.map(function(g){return s[g]}).filter(function(g){return g&&g!==o})).forEach(function(g){return o.mixed[g.name]=!0})),h.push(o),o.animated=h.some(function(g){return g&&g.animated}),o.texcoords=h.some(function(g){return g&&g.texcoords}),o.base=h.map(function(g){return g.base}).filter(function(g){return g}).pop(),o.lighting=h.map(function(g){return g.lighting}).filter(function(g){return g!=null}).pop(),o.texture=h.map(function(g){return g.texture}).filter(function(g){return g}).pop(),o.raster=h.map(function(g){return g.raster}).filter(function(g){return g!=null}).pop(),o.dash=h.map(function(g){return g.dash}).filter(function(g){return g!=null}).pop(),o.dash_background_color=h.map(function(g){return g.dash_background_color}).filter(function(g){return g!=null}).pop(),h.some(function(g){return g.hasOwnProperty("blend")&&g.blend})&&(o.blend=h.map(function(g){return g.hasOwnProperty("blend")&&g.blend}).filter(function(g){return g}).pop()),o.blend_order=h.map(function(g){return g.blend_order}).filter(function(g){return g!=null}).pop(),o.defines=Object.assign.apply(Object,[{}].concat(_toConsumableArray(h.map(function(g){return g.defines}).filter(function(g){return g})))),o.material=Object.assign.apply(Object,[{}].concat(_toConsumableArray(h.map(function(g){return g.material}).filter(function(g){return g}))));var d=h.map(function(g){return g.draw}).filter(function(g){return g});return 0<d.length&&(o.draw=mergeObjects.apply(void 0,[{}].concat(_toConsumableArray(d)))),this.mixShaders(o,s,h),o}},{key:"mixShaders",value:function(o,s,h){var d={},g=h.map(function(_e){return _e.shaders}).filter(function(_e){return _e});if(d.defines=Object.assign.apply(Object,[{}].concat(_toConsumableArray(g.map(function(_e){return _e.defines}).filter(function(_e){return _e})))),d.uniforms={},d._uniforms=o.shaders&&o.shaders.uniforms||{},d._uniform_scopes={},h.filter(function(_e){return _e.shaders&&_e.shaders.uniforms}).forEach(function(_e){for(var _r in _e.shaders.uniforms)(function(_n){d._uniform_scopes[_n]=_e.name,Object.defineProperty(d.uniforms,_n,{enumerable:!0,configurable:!0,get:function(){return d._uniforms[_n]!==void 0?d._uniforms[_n]:s[d._uniform_scopes[_n]].shaders.uniforms!==d.uniforms?s[d._uniform_scopes[_n]].shaders.uniforms[_n]:void 0},set:function(_o){d._uniforms[_n]=_o}})})(_r)}),d.extensions=Object.keys(g.map(function(_e){return _e.extensions}).filter(function(_e){return _e}).reduce(function(_e,_r){return typeof _r=="string"?_e[_r]=!0:_r.forEach(function(_n){return _e[_n]=!0}),_e},{})||{}),o.shaders&&o.shaders.blocks)for(var _ in o.shaders.block_scopes=o.shaders.block_scopes||{},o.shaders.blocks){var j,$=o.shaders.blocks[_];o.shaders.block_scopes[_]=o.shaders.block_scopes[_]||[],Array.isArray($)?(j=o.shaders.block_scopes[_]).push.apply(j,_toConsumableArray($.map(function(){return o.name}))):o.shaders.block_scopes[_].push(o.name)}var _t={};return g.forEach(function(_e){if(_e.blocks){d.blocks=d.blocks||{},d.block_scopes=d.block_scopes||{};var _r={};for(var _n in _e.blocks){var _o=_e.blocks[_n],ga=_e.block_scopes[_n];d.blocks[_n]=d.blocks[_n]||[],d.block_scopes[_n]=d.block_scopes[_n]||[],_o=Array.isArray(_o)?_o:[_o],ga=Array.isArray(ga)?ga:[ga];for(var _l=0;_l<_o.length;_l++)_t[ga[_l]]||(_r[ga[_l]]=!0,d.blocks[_n].push(_o[_l]),d.block_scopes[_n].push(ga[_l]))}Object.assign(_t,_r)}}),Object.assign(o.mixed,_t),o.shaders=d,o}},{key:"create",value:function(o,s,h){var d=2<arguments.length&&h!==void 0?h:{},g=mergeObjects({},s);return g.name=o,(g=this.mix(g,d)).base&&this.base_styles[g.base]?this.styles[o]=g=Object.assign(Object.create(this.base_styles[g.base]),g):g.base=null,g}},{key:"build",value:function(o){var s=this,h=Object.keys(o).sort(function(_,j){return s.inheritanceDepth(_,o)-s.inheritanceDepth(j,o)});for(var d in this.styles)this.base_styles[d]?this.styles[d].reset():delete this.styles[d];var g={};return h.forEach(function(_){g[_]=s.create(_,o[_],g)}),this.styles}},{key:"initStyles",value:function(o){var s=0<arguments.length&&o!==void 0?o:{};for(var h in this.styles)this.styles[h].init(s)}},{key:"inheritanceDepth",value:function(o,s){for(var h=this,d=0;;){var g=s[o];if(!g||!g.mix)break;if(d++,Array.isArray(g.mix)){d+=Math.max.apply(Math,_toConsumableArray(g.mix.map(function(_){if(o!==_)return h.inheritanceDepth(_,s)})));break}if(o===g.mix)break;o=g.mix}return d}}]),e}();function isNothing(e){return e==null}function isObject$2(e){return typeof e=="object"&&e!==null}function toArray(e){return Array.isArray(e)?e:isNothing(e)?[]:[e]}function extend$1(e,o){var s,h,d,g;if(o)for(s=0,h=(g=Object.keys(o)).length;s<h;s+=1)e[d=g[s]]=o[d];return e}function repeat(e,o){for(var s="",h=0;h<o;h+=1)s+=e;return s}function isNegativeZero(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var isNothing_1=isNothing,isObject_1=isObject$2,toArray_1=toArray,repeat_1=repeat,isNegativeZero_1=isNegativeZero,extend_1=extend$1,common={isNothing:isNothing_1,isObject:isObject_1,toArray:toArray_1,repeat:repeat_1,isNegativeZero:isNegativeZero_1,extend:extend_1};function YAMLException(e,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name="YAMLException",this.reason=e,this.mark=o,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():"")}YAMLException.prototype=Object.create(Error.prototype),YAMLException.prototype.constructor=YAMLException,YAMLException.prototype.toString=function(e){var o=this.name+": ";return o+=this.reason||"(unknown reason)",!e&&this.mark&&(o+=" "+this.mark.toString()),o};var exception=YAMLException;function Mark(e,o,s,h,d){this.name=e,this.buffer=o,this.position=s,this.line=h,this.column=d}Mark.prototype.getSnippet=function(e,o){var s,h,d,g,_;if(!this.buffer)return null;for(e=e||4,o=o||75,s="",h=this.position;0<h&&`\0\r
\u2028\u2029`.indexOf(this.buffer.charAt(h-1))===-1;)if(--h,this.position-h>o/2-1){s=" ... ",h+=5;break}for(d="",g=this.position;g<this.buffer.length&&`\0\r
\u2028\u2029`.indexOf(this.buffer.charAt(g))===-1;)if((g+=1)-this.position>o/2-1){d=" ... ",g-=5;break}return _=this.buffer.slice(h,g),common.repeat(" ",e)+s+_+d+`
`+common.repeat(" ",e+this.position-h+s.length)+"^"},Mark.prototype.toString=function(e){var o,s="";return this.name&&(s+='in "'+this.name+'" '),s+="at line "+(this.line+1)+", column "+(this.column+1),e||(o=this.getSnippet())&&(s+=`:
`+o),s};var mark=Mark,TYPE_CONSTRUCTOR_OPTIONS=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(e){var o={};return e!==null&&Object.keys(e).forEach(function(s){e[s].forEach(function(h){o[String(h)]=s})}),o}function Type(e,o){if(o=o||{},Object.keys(o).forEach(function(s){if(TYPE_CONSTRUCTOR_OPTIONS.indexOf(s)===-1)throw new exception('Unknown option "'+s+'" is met in definition of "'+e+'" YAML type.')}),this.tag=e,this.kind=o.kind||null,this.resolve=o.resolve||function(){return!0},this.construct=o.construct||function(s){return s},this.instanceOf=o.instanceOf||null,this.predicate=o.predicate||null,this.represent=o.represent||null,this.defaultStyle=o.defaultStyle||null,this.styleAliases=compileStyleAliases(o.styleAliases||null),YAML_NODE_KINDS.indexOf(this.kind)===-1)throw new exception('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var type=Type;function compileList(e,o,s){var h=[];return e.include.forEach(function(d){s=compileList(d,o,s)}),e[o].forEach(function(d){s.forEach(function(g,_){g.tag===d.tag&&h.push(_)}),s.push(d)}),s.filter(function(d,g){return h.indexOf(g)===-1})}function compileMap(){var e,o,s={};function h(d){s[d.tag]=d}for(e=0,o=arguments.length;e<o;e+=1)arguments[e].forEach(h);return s}function Schema(e){this.include=e.include||[],this.implicit=e.implicit||[],this.explicit=e.explicit||[],this.implicit.forEach(function(o){if(o.loadKind&&o.loadKind!=="scalar")throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}),this.compiledImplicit=compileList(this,"implicit",[]),this.compiledExplicit=compileList(this,"explicit",[]),this.compiledTypeMap=compileMap(this.compiledImplicit,this.compiledExplicit)}Schema.DEFAULT=null,Schema.create=function(e,o){var s,h;switch(arguments.length){case 1:s=Schema.DEFAULT,h=e;break;case 2:s=e,h=o;break;default:throw new exception("Wrong number of arguments for Schema.create function")}if(s=common.toArray(s),h=common.toArray(h),!s.every(function(d){return d instanceof Schema}))throw new exception("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!h.every(function(d){return d instanceof type}))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new Schema({include:s,explicit:h})};var schema=Schema,str=new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),seq=new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),map=new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),failsafe=new schema({explicit:[str,seq,map]});function resolveYamlNull(e){if(e===null)return!0;var o=e.length;return o===1&&e==="~"||o===4&&(e==="null"||e==="Null"||e==="NULL")}function constructYamlNull(){return null}function isNull$1(e){return e===null}var _null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull$1,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"});function resolveYamlBoolean(e){if(e===null)return!1;var o=e.length;return o===4&&(e==="true"||e==="True"||e==="TRUE")||o===5&&(e==="false"||e==="False"||e==="FALSE")}function constructYamlBoolean(e){return e==="true"||e==="True"||e==="TRUE"}function isBoolean$1(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean$1,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function isHexCode(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function isOctCode(e){return 48<=e&&e<=55}function isDecCode(e){return 48<=e&&e<=57}function resolveYamlInteger(e){if(e===null)return!1;var o,s=e.length,h=0,d=!1;if(!s)return!1;if((o=e[h])!=="-"&&o!=="+"||(o=e[++h]),o==="0"){if(h+1===s)return!0;if((o=e[++h])==="b"){for(h++;h<s;h++)if((o=e[h])!=="_"){if(o!=="0"&&o!=="1")return!1;d=!0}return d}if(o==="x"){for(h++;h<s;h++)if((o=e[h])!=="_"){if(!isHexCode(e.charCodeAt(h)))return!1;d=!0}return d}for(;h<s;h++)if((o=e[h])!=="_"){if(!isOctCode(e.charCodeAt(h)))return!1;d=!0}return d}for(;h<s;h++)if((o=e[h])!=="_"){if(o===":")break;if(!isDecCode(e.charCodeAt(h)))return!1;d=!0}return!!d&&(o!==":"||/^(:[0-5]?[0-9])+$/.test(e.slice(h)))}function constructYamlInteger(e){var o,s,h=e,d=1,g=[];return h.indexOf("_")!==-1&&(h=h.replace(/_/g,"")),(o=h[0])!=="-"&&o!=="+"||(o==="-"&&(d=-1),o=(h=h.slice(1))[0]),h==="0"?0:o==="0"?h[1]==="b"?d*parseInt(h.slice(2),2):h[1]==="x"?d*parseInt(h,16):d*parseInt(h,8):h.indexOf(":")!==-1?(h.split(":").forEach(function(_){g.unshift(parseInt(_,10))}),h=0,s=1,g.forEach(function(_){h+=_*s,s*=60}),d*h):d*parseInt(h,10)}function isInteger(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1==0&&!common.isNegativeZero(e)}var int_1=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(e){return"0b"+e.toString(2)},octal:function(e){return"0"+e.toString(8)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return"0x"+e.toString(16).toUpperCase()}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)\\.[0-9_]*(?:[eE][-+][0-9]+)?|\\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(e){return e!==null&&!!YAML_FLOAT_PATTERN.test(e)}function constructYamlFloat(e){var o,s=e.replace(/_/g,"").toLowerCase(),h=s[0]==="-"?-1:1,d=[];return 0<="+-".indexOf(s[0])&&(s=s.slice(1)),s===".inf"?h==1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:s===".nan"?NaN:0<=s.indexOf(":")?(s.split(":").forEach(function(g){d.unshift(parseFloat(g,10))}),s=0,o=1,d.forEach(function(g){s+=g*o,o*=60}),h*s):h*parseFloat(s,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(e,o){var s;if(isNaN(e))switch(o){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(o){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(o){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common.isNegativeZero(e))return"-0.0";return s=e.toString(10),SCIENTIFIC_WITHOUT_DOT.test(s)?s.replace("e",".e"):s}function isFloat(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!=0||common.isNegativeZero(e))}var float_1$1=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"}),json=new schema({include:[failsafe],implicit:[_null,bool,int_1,float_1$1]}),core=new schema({include:[json]}),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$");function resolveYamlTimestamp(e){return e!==null&&YAML_TIMESTAMP_REGEXP.exec(e)!==null}function constructYamlTimestamp(e){var o,s,h,d,g,_,j,$=0,_t=null,_e=YAML_TIMESTAMP_REGEXP.exec(e);if(_e===null)throw new Error("Date resolve error");if(o=+_e[1],s=_e[2]-1,h=+_e[3],!_e[4])return new Date(Date.UTC(o,s,h));if(d=+_e[4],g=+_e[5],_=+_e[6],_e[7]){for($=_e[7].slice(0,3);$.length<3;)$+="0";$=+$}return _e[9]&&(_t=6e4*(60*+_e[10]+ +(_e[11]||0)),_e[9]==="-"&&(_t=-_t)),j=new Date(Date.UTC(o,s,h,d,g,_,$)),_t&&j.setTime(j.getTime()-_t),j}function representYamlTimestamp(e){return e.toISOString()}var timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp});function resolveYamlMerge(e){return e==="<<"||e===null}var merge=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge}),NodeBuffer=bufferEs6.Buffer,BASE64_MAP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function resolveYamlBinary(e){if(e===null)return!1;for(var o,s=0,h=e.length,d=BASE64_MAP,g=0;g<h;g++)if(!(64<(o=d.indexOf(e.charAt(g))))){if(o<0)return!1;s+=6}return s%8==0}function constructYamlBinary(e){for(var o,s=e.replace(/[\r\n=]/g,""),h=s.length,d=BASE64_MAP,g=0,_=[],j=0;j<h;j++)j%4==0&&j&&(_.push(g>>16&255),_.push(g>>8&255),_.push(255&g)),g=g<<6|d.indexOf(s.charAt(j));return(o=h%4*6)==0?(_.push(g>>16&255),_.push(g>>8&255),_.push(255&g)):o==18?(_.push(g>>10&255),_.push(g>>2&255)):o==12&&_.push(g>>4&255),NodeBuffer?new NodeBuffer(_):_}function representYamlBinary(e){for(var o,s="",h=0,d=e.length,g=BASE64_MAP,_=0;_<d;_++)_%3==0&&_&&(s+=g[h>>18&63],s+=g[h>>12&63],s+=g[h>>6&63],s+=g[63&h]),h=(h<<8)+e[_];return(o=d%3)==0?(s+=g[h>>18&63],s+=g[h>>12&63],s+=g[h>>6&63],s+=g[63&h]):o==2?(s+=g[h>>10&63],s+=g[h>>4&63],s+=g[h<<2&63],s+=g[64]):o==1&&(s+=g[h>>2&63],s+=g[h<<4&63],s+=g[64],s+=g[64]),s}function isBinary(e){return NodeBuffer&&NodeBuffer.isBuffer(e)}var binary=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary}),_hasOwnProperty=Object.prototype.hasOwnProperty,_toString=Object.prototype.toString;function resolveYamlOmap(e){if(e===null)return!0;for(var o,s,h,d=[],g=e,_=0,j=g.length;_<j;_+=1){if(o=g[_],h=!1,_toString.call(o)!=="[object Object]")return!1;for(s in o)if(_hasOwnProperty.call(o,s)){if(h)return!1;h=!0}if(!h||d.indexOf(s)!==-1)return!1;d.push(s)}return!0}function constructYamlOmap(e){return e!==null?e:[]}var omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap}),_toString$1=Object.prototype.toString;function resolveYamlPairs(e){if(e===null)return!0;for(var o,s,h=e,d=new Array(h.length),g=0,_=h.length;g<_;g+=1){if(o=h[g],_toString$1.call(o)!=="[object Object]"||(s=Object.keys(o)).length!==1)return!1;d[g]=[s[0],o[s[0]]]}return!0}function constructYamlPairs(e){if(e===null)return[];for(var o,s,h=e,d=new Array(h.length),g=0,_=h.length;g<_;g+=1)o=h[g],s=Object.keys(o),d[g]=[s[0],o[s[0]]];return d}var pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs}),_hasOwnProperty$1=Object.prototype.hasOwnProperty;function resolveYamlSet(e){if(e===null)return!0;var o,s=e;for(o in s)if(_hasOwnProperty$1.call(s,o)&&s[o]!==null)return!1;return!0}function constructYamlSet(e){return e!==null?e:{}}var set$2=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet}),default_safe=new schema({include:[core],implicit:[timestamp,merge],explicit:[binary,omap,pairs,set$2]});function resolveJavascriptUndefined(){return!0}function constructJavascriptUndefined(){}function representJavascriptUndefined(){return""}function isUndefined$1(e){return e===void 0}var _undefined=new type("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:resolveJavascriptUndefined,construct:constructJavascriptUndefined,predicate:isUndefined$1,represent:representJavascriptUndefined});function resolveJavascriptRegExp(e){if(e===null||e.length===0)return!1;var o=e,s=/\/([gim]*)$/.exec(e),h="";return!(o[0]==="/"&&(s&&(h=s[1]),3<h.length||o[o.length-h.length-1]!=="/"))}function constructJavascriptRegExp(e){var o=e,s=/\/([gim]*)$/.exec(e),h="";return o[0]==="/"&&(s&&(h=s[1]),o=o.slice(1,o.length-h.length-1)),new RegExp(o,h)}function representJavascriptRegExp(e){var o="/"+e.source+"/";return e.global&&(o+="g"),e.multiline&&(o+="m"),e.ignoreCase&&(o+="i"),o}function isRegExp$1(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var regexp=new type("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:resolveJavascriptRegExp,construct:constructJavascriptRegExp,predicate:isRegExp$1,represent:representJavascriptRegExp}),esprima;try{var _require=commonjsRequire,esprima=_require("esprima")}catch(e){typeof window<"u"&&(esprima=window.esprima)}function resolveJavascriptFunction(e){if(e===null)return!1;try{var o="("+e+")",s=esprima.parse(o,{range:!0});return!(s.type!=="Program"||s.body.length!==1||s.body[0].type!=="ExpressionStatement"||s.body[0].expression.type!=="FunctionExpression")}catch{return!1}}function constructJavascriptFunction(e){var o,s="("+e+")",h=esprima.parse(s,{range:!0}),d=[];if(h.type!=="Program"||h.body.length!==1||h.body[0].type!=="ExpressionStatement"||h.body[0].expression.type!=="FunctionExpression")throw new Error("Failed to resolve function");return h.body[0].expression.params.forEach(function(g){d.push(g.name)}),o=h.body[0].expression.body.range,new Function(d,s.slice(o[0]+1,o[1]-1))}function representJavascriptFunction(e){return e.toString()}function isFunction$1(e){return Object.prototype.toString.call(e)==="[object Function]"}var _function=new type("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:resolveJavascriptFunction,construct:constructJavascriptFunction,predicate:isFunction$1,represent:representJavascriptFunction}),default_full=schema.DEFAULT=new schema({include:[default_safe],explicit:[_undefined,regexp,_function]}),_hasOwnProperty$2=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function is_EOL(e){return e===10||e===13}function is_WHITE_SPACE(e){return e===9||e===32}function is_WS_OR_EOL(e){return e===9||e===32||e===10||e===13}function is_FLOW_INDICATOR(e){return e===44||e===91||e===93||e===123||e===125}function fromHexCode(e){var o;return 48<=e&&e<=57?e-48:97<=(o=32|e)&&o<=102?o-97+10:-1}function escapedHexLen(e){return e===120?2:e===117?4:e===85?8:0}function fromDecimalCode(e){return 48<=e&&e<=57?e-48:-1}function simpleEscapeSequence(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}function charFromCodepoint(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256),i=0;i<256;i++)simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0,simpleEscapeMap[i]=simpleEscapeSequence(i);function State$1(e,o){this.input=e,this.filename=o.filename||null,this.schema=o.schema||default_full,this.onWarning=o.onWarning||null,this.legacy=o.legacy||!1,this.json=o.json||!1,this.listener=o.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function generateError(e,o){return new exception(o,new mark(e.filename,e.input,e.position,e.line,e.position-e.lineStart))}function throwError(e,o){throw generateError(e,o)}function throwWarning(e,o){e.onWarning&&e.onWarning.call(null,generateError(e,o))}var directiveHandlers={YAML:function(e,o,s){var h,d,g;e.version!==null&&throwError(e,"duplication of %YAML directive"),s.length!==1&&throwError(e,"YAML directive accepts exactly one argument"),(h=/^([0-9]+)\.([0-9]+)$/.exec(s[0]))===null&&throwError(e,"ill-formed argument of the YAML directive"),d=parseInt(h[1],10),g=parseInt(h[2],10),d!==1&&throwError(e,"unacceptable YAML version of the document"),e.version=s[0],e.checkLineBreaks=g<2,g!==1&&g!==2&&throwWarning(e,"unsupported YAML version of the document")},TAG:function(e,o,s){var h,d;s.length!==2&&throwError(e,"TAG directive accepts exactly two arguments"),h=s[0],d=s[1],PATTERN_TAG_HANDLE.test(h)||throwError(e,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$2.call(e.tagMap,h)&&throwError(e,'there is a previously declared suffix for "'+h+'" tag handle'),PATTERN_TAG_URI.test(d)||throwError(e,"ill-formed tag prefix (second argument) of the TAG directive"),e.tagMap[h]=d}};function captureSegment(e,o,s,h){var d,g,_,j;if(o<s){if(j=e.input.slice(o,s),h)for(d=0,g=j.length;d<g;d+=1)(_=j.charCodeAt(d))===9||32<=_&&_<=1114111||throwError(e,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(j)&&throwError(e,"the stream contains non-printable characters");e.result+=j}}function mergeMappings(e,o,s,h){var d,g,_,j;for(common.isObject(s)||throwError(e,"cannot merge mappings; the provided source object is unacceptable"),_=0,j=(d=Object.keys(s)).length;_<j;_+=1)g=d[_],_hasOwnProperty$2.call(o,g)||(o[g]=s[g],h[g]=!0)}function storeMappingPair(e,o,s,h,d,g){var _,j;if(d=String(d),o===null&&(o={}),h==="tag:yaml.org,2002:merge")if(Array.isArray(g))for(_=0,j=g.length;_<j;_+=1)mergeMappings(e,o,g[_],s);else mergeMappings(e,o,g,s);else e.json||_hasOwnProperty$2.call(s,d)||!_hasOwnProperty$2.call(o,d)||throwError(e,"duplicated mapping key"),o[d]=g,delete s[d];return o}function readLineBreak(e){var o=e.input.charCodeAt(e.position);o===10?e.position++:o===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):throwError(e,"a line break is expected"),e.line+=1,e.lineStart=e.position}function skipSeparationSpace(e,o,s){for(var h=0,d=e.input.charCodeAt(e.position);d!==0;){for(;is_WHITE_SPACE(d);)d=e.input.charCodeAt(++e.position);if(o&&d===35)for(;(d=e.input.charCodeAt(++e.position))!==10&&d!==13&&d!==0;);if(!is_EOL(d))break;for(readLineBreak(e),d=e.input.charCodeAt(e.position),h++,e.lineIndent=0;d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position)}return s!==-1&&h!==0&&e.lineIndent<s&&throwWarning(e,"deficient indentation"),h}function testDocumentSeparator(e){var o=e.position,s=e.input.charCodeAt(o);return s!==45&&s!==46||s!==e.input.charCodeAt(o+1)||s!==e.input.charCodeAt(o+2)||(o+=3,(s=e.input.charCodeAt(o))!==0&&!is_WS_OR_EOL(s))?void 0:1}function writeFoldedLines(e,o){o===1?e.result+=" ":1<o&&(e.result+=common.repeat(`
`,o-1))}function readPlainScalar(e,o,s){var h,d,g,_,j,$,_t,_e=e.kind,_r=e.result,_n=e.input.charCodeAt(e.position);if(!is_WS_OR_EOL(_n)&&!is_FLOW_INDICATOR(_n)&&_n!==35&&_n!==38&&_n!==42&&_n!==33&&_n!==124&&_n!==62&&_n!==39&&_n!==34&&_n!==37&&_n!==64&&_n!==96&&(_n!==63&&_n!==45||!(is_WS_OR_EOL(h=e.input.charCodeAt(e.position+1))||s&&is_FLOW_INDICATOR(h)))){for(e.kind="scalar",e.result="",d=g=e.position,_=!1;_n!==0;){if(_n===58){if(is_WS_OR_EOL(h=e.input.charCodeAt(e.position+1))||s&&is_FLOW_INDICATOR(h))break}else if(_n===35){if(is_WS_OR_EOL(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&testDocumentSeparator(e)||s&&is_FLOW_INDICATOR(_n))break;if(is_EOL(_n)){if(j=e.line,$=e.lineStart,_t=e.lineIndent,skipSeparationSpace(e,!1,-1),e.lineIndent>=o){_=!0,_n=e.input.charCodeAt(e.position);continue}e.position=g,e.line=j,e.lineStart=$,e.lineIndent=_t;break}}_&&(captureSegment(e,d,g,!1),writeFoldedLines(e,e.line-j),d=g=e.position,_=!1),is_WHITE_SPACE(_n)||(g=e.position+1),_n=e.input.charCodeAt(++e.position)}if(captureSegment(e,d,g,!1),e.result)return 1;e.kind=_e,e.result=_r}}function readSingleQuotedScalar(e,o){var s,h,d=e.input.charCodeAt(e.position);if(d===39){for(e.kind="scalar",e.result="",e.position++,s=h=e.position;(d=e.input.charCodeAt(e.position))!==0;)if(d===39){if(captureSegment(e,s,e.position,!0),(d=e.input.charCodeAt(++e.position))!==39)return 1;s=h=e.position,e.position++}else is_EOL(d)?(captureSegment(e,s,h,!0),writeFoldedLines(e,skipSeparationSpace(e,!1,o)),s=h=e.position):e.position===e.lineStart&&testDocumentSeparator(e)?throwError(e,"unexpected end of the document within a single quoted scalar"):(e.position++,h=e.position);throwError(e,"unexpected end of the stream within a single quoted scalar")}}function readDoubleQuotedScalar(e,o){var s,h,d,g,_,j=e.input.charCodeAt(e.position);if(j===34){for(e.kind="scalar",e.result="",e.position++,s=h=e.position;(j=e.input.charCodeAt(e.position))!==0;){if(j===34)return captureSegment(e,s,e.position,!0),e.position++,1;if(j===92){if(captureSegment(e,s,e.position,!0),is_EOL(j=e.input.charCodeAt(++e.position)))skipSeparationSpace(e,!1,o);else if(j<256&&simpleEscapeCheck[j])e.result+=simpleEscapeMap[j],e.position++;else if(0<(_=escapedHexLen(j))){for(d=_,g=0;0<d;d--)0<=(_=fromHexCode(j=e.input.charCodeAt(++e.position)))?g=(g<<4)+_:throwError(e,"expected hexadecimal character");e.result+=charFromCodepoint(g),e.position++}else throwError(e,"unknown escape sequence");s=h=e.position}else is_EOL(j)?(captureSegment(e,s,h,!0),writeFoldedLines(e,skipSeparationSpace(e,!1,o)),s=h=e.position):e.position===e.lineStart&&testDocumentSeparator(e)?throwError(e,"unexpected end of the document within a double quoted scalar"):(e.position++,h=e.position)}throwError(e,"unexpected end of the stream within a double quoted scalar")}}function readFlowCollection(e,o){var s,h,d,g,_,j,$,_t,_e,_r=!0,_n=e.tag,_o=e.anchor,ga={},_l=e.input.charCodeAt(e.position);if(_l===91)j=!(d=93),h=[];else{if(_l!==123)return;d=125,j=!0,h={}}for(e.anchor!==null&&(e.anchorMap[e.anchor]=h),_l=e.input.charCodeAt(++e.position);_l!==0;){if(skipSeparationSpace(e,!0,o),(_l=e.input.charCodeAt(e.position))===d)return e.position++,e.tag=_n,e.anchor=_o,e.kind=j?"mapping":"sequence",e.result=h,1;_r||throwError(e,"missed comma between flow collection entries"),_e=null,g=_=!1,_l===63&&is_WS_OR_EOL(e.input.charCodeAt(e.position+1))&&(g=_=!0,e.position++,skipSeparationSpace(e,!0,o)),s=e.line,composeNode(e,o,CONTEXT_FLOW_IN,!1,!0),_t=e.tag,$=e.result,skipSeparationSpace(e,!0,o),_l=e.input.charCodeAt(e.position),!_&&e.line!==s||_l!==58||(g=!0,_l=e.input.charCodeAt(++e.position),skipSeparationSpace(e,!0,o),composeNode(e,o,CONTEXT_FLOW_IN,!1,!0),_e=e.result),j?storeMappingPair(e,h,ga,_t,$,_e):g?h.push(storeMappingPair(e,null,ga,_t,$,_e)):h.push($),skipSeparationSpace(e,!0,o),(_l=e.input.charCodeAt(e.position))===44?(_r=!0,_l=e.input.charCodeAt(++e.position)):_r=!1}throwError(e,"unexpected end of the stream within a flow collection")}function readBlockScalar(e,o){var s,h,d,g=CHOMPING_CLIP,_=!1,j=o,$=0,_t=!1,_e=e.input.charCodeAt(e.position);if(_e===124)h=!1;else{if(_e!==62)return;h=!0}for(e.kind="scalar",e.result="";_e!==0;)if((_e=e.input.charCodeAt(++e.position))===43||_e===45)CHOMPING_CLIP===g?g=_e===43?CHOMPING_KEEP:CHOMPING_STRIP:throwError(e,"repeat of a chomping mode identifier");else{if(!(0<=(d=fromDecimalCode(_e))))break;d===0?throwError(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):_?throwError(e,"repeat of an indentation width identifier"):(j=o+d-1,_=!0)}if(is_WHITE_SPACE(_e)){for(;is_WHITE_SPACE(_e=e.input.charCodeAt(++e.position)););if(_e===35)for(;!is_EOL(_e=e.input.charCodeAt(++e.position))&&_e!==0;);}for(;_e!==0;){for(readLineBreak(e),e.lineIndent=0,_e=e.input.charCodeAt(e.position);(!_||e.lineIndent<j)&&_e===32;)e.lineIndent++,_e=e.input.charCodeAt(++e.position);if(!_&&e.lineIndent>j&&(j=e.lineIndent),is_EOL(_e))$++;else{if(e.lineIndent<j){g===CHOMPING_KEEP?e.result+=common.repeat(`
`,$):g===CHOMPING_CLIP&&_&&(e.result+=`
`);break}for(h?is_WHITE_SPACE(_e)?(_t=!0,e.result+=common.repeat(`
`,$+1)):_t?(_t=!1,e.result+=common.repeat(`
`,$+1)):$===0?_&&(e.result+=" "):e.result+=common.repeat(`
`,$):e.result+=_?common.repeat(`
`,$+1):common.repeat(`
`,$),_=!0,$=0,s=e.position;!is_EOL(_e)&&_e!==0;)_e=e.input.charCodeAt(++e.position);captureSegment(e,s,e.position,!1)}}return 1}function readBlockSequence(e,o){var s,h,d=e.tag,g=e.anchor,_=[],j=!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=_),h=e.input.charCodeAt(e.position);h!==0&&h===45&&is_WS_OR_EOL(e.input.charCodeAt(e.position+1));)if(j=!0,e.position++,skipSeparationSpace(e,!0,-1)&&e.lineIndent<=o)_.push(null),h=e.input.charCodeAt(e.position);else if(s=e.line,composeNode(e,o,CONTEXT_BLOCK_IN,!1,!0),_.push(e.result),skipSeparationSpace(e,!0,-1),h=e.input.charCodeAt(e.position),(e.line===s||e.lineIndent>o)&&h!==0)throwError(e,"bad indentation of a sequence entry");else if(e.lineIndent<o)break;return!!j&&(e.tag=d,e.anchor=g,e.kind="sequence",e.result=_,!0)}function readBlockMapping(e,o,s){var h,d,g,_,j=e.tag,$=e.anchor,_t={},_e={},_r=null,_n=null,_o=null,ga=!1,_l=!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=_t),_=e.input.charCodeAt(e.position);_!==0;){if(h=e.input.charCodeAt(e.position+1),g=e.line,_!==63&&_!==58||!is_WS_OR_EOL(h)){if(!composeNode(e,s,CONTEXT_FLOW_OUT,!1,!0))break;if(e.line===g){for(_=e.input.charCodeAt(e.position);is_WHITE_SPACE(_);)_=e.input.charCodeAt(++e.position);if(_===58)is_WS_OR_EOL(_=e.input.charCodeAt(++e.position))||throwError(e,"a whitespace character is expected after the key-value separator within a block mapping"),ga&&(storeMappingPair(e,_t,_e,_r,_n,null),_r=_n=_o=null),d=ga=!(_l=!0),_r=e.tag,_n=e.result;else{if(!_l)return e.tag=j,e.anchor=$,1;throwError(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!_l)return e.tag=j,e.anchor=$,1;throwError(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else _===63?(ga&&(storeMappingPair(e,_t,_e,_r,_n,null),_r=_n=_o=null),d=ga=_l=!0):ga?d=!(ga=!1):throwError(e,"incomplete explicit mapping pair; a key node is missed"),e.position+=1,_=h;if((e.line===g||e.lineIndent>o)&&(composeNode(e,o,CONTEXT_BLOCK_OUT,!0,d)&&(ga?_n=e.result:_o=e.result),ga||(storeMappingPair(e,_t,_e,_r,_n,_o),_r=_n=_o=null),skipSeparationSpace(e,!0,-1),_=e.input.charCodeAt(e.position)),e.lineIndent>o&&_!==0)throwError(e,"bad indentation of a mapping entry");else if(e.lineIndent<o)break}return ga&&storeMappingPair(e,_t,_e,_r,_n,null),_l&&(e.tag=j,e.anchor=$,e.kind="mapping",e.result=_t),_l}function readTagProperty(e){var o,s,h,d=!1,g=!1,_=e.input.charCodeAt(e.position);if(_===33){if(e.tag!==null&&throwError(e,"duplication of a tag property"),(_=e.input.charCodeAt(++e.position))===60?(d=!0,_=e.input.charCodeAt(++e.position)):_===33?(g=!0,s="!!",_=e.input.charCodeAt(++e.position)):s="!",o=e.position,d){for(;(_=e.input.charCodeAt(++e.position))!==0&&_!==62;);e.position<e.length?(h=e.input.slice(o,e.position),_=e.input.charCodeAt(++e.position)):throwError(e,"unexpected end of the stream within a verbatim tag")}else{for(;_!==0&&!is_WS_OR_EOL(_);)_===33&&(g?throwError(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(o-1,e.position+1),PATTERN_TAG_HANDLE.test(s)||throwError(e,"named tag handle cannot contain such characters"),g=!0,o=e.position+1)),_=e.input.charCodeAt(++e.position);h=e.input.slice(o,e.position),PATTERN_FLOW_INDICATORS.test(h)&&throwError(e,"tag suffix cannot contain flow indicator characters")}return h&&!PATTERN_TAG_URI.test(h)&&throwError(e,"tag name cannot contain such characters: "+h),d?e.tag=h:_hasOwnProperty$2.call(e.tagMap,s)?e.tag=e.tagMap[s]+h:s==="!"?e.tag="!"+h:s==="!!"?e.tag="tag:yaml.org,2002:"+h:throwError(e,'undeclared tag handle "'+s+'"'),1}}function readAnchorProperty(e){var o,s=e.input.charCodeAt(e.position);if(s===38){for(e.anchor!==null&&throwError(e,"duplication of an anchor property"),s=e.input.charCodeAt(++e.position),o=e.position;s!==0&&!is_WS_OR_EOL(s)&&!is_FLOW_INDICATOR(s);)s=e.input.charCodeAt(++e.position);return e.position===o&&throwError(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(o,e.position),1}}function readAlias(e){var o,s,h=e.input.charCodeAt(e.position);if(h===42){for(h=e.input.charCodeAt(++e.position),o=e.position;h!==0&&!is_WS_OR_EOL(h)&&!is_FLOW_INDICATOR(h);)h=e.input.charCodeAt(++e.position);return e.position===o&&throwError(e,"name of an alias node must contain at least one character"),s=e.input.slice(o,e.position),e.anchorMap.hasOwnProperty(s)||throwError(e,'unidentified alias "'+s+'"'),e.result=e.anchorMap[s],skipSeparationSpace(e,!0,-1),1}}function composeNode(e,o,s,h,d){var g,_,j,$,_t,_e,_r,_n,_o=1,ga=!1,_l=!1;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,g=_=j=CONTEXT_BLOCK_OUT===s||CONTEXT_BLOCK_IN===s,h&&skipSeparationSpace(e,!0,-1)&&(ga=!0,e.lineIndent>o?_o=1:e.lineIndent===o?_o=0:e.lineIndent<o&&(_o=-1)),_o===1)for(;readTagProperty(e)||readAnchorProperty(e);)skipSeparationSpace(e,!0,-1)?(ga=!0,j=g,e.lineIndent>o?_o=1:e.lineIndent===o?_o=0:e.lineIndent<o&&(_o=-1)):j=!1;if(j=j&&(ga||d),_o!==1&&CONTEXT_BLOCK_OUT!==s||(_r=CONTEXT_FLOW_IN===s||CONTEXT_FLOW_OUT===s?o:o+1,_n=e.position-e.lineStart,_o===1?j&&(readBlockSequence(e,_n)||readBlockMapping(e,_n,_r))||readFlowCollection(e,_r)?_l=!0:(_&&readBlockScalar(e,_r)||readSingleQuotedScalar(e,_r)||readDoubleQuotedScalar(e,_r)?_l=!0:readAlias(e)?(_l=!0,e.tag===null&&e.anchor===null||throwError(e,"alias node should not have any properties")):readPlainScalar(e,_r,CONTEXT_FLOW_IN===s)&&(_l=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):_o===0&&(_l=j&&readBlockSequence(e,_n))),e.tag!==null&&e.tag!=="!")if(e.tag==="?"){for($=0,_t=e.implicitTypes.length;$<_t;$+=1)if((_e=e.implicitTypes[$]).resolve(e.result)){e.result=_e.construct(e.result),e.tag=_e.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else _hasOwnProperty$2.call(e.typeMap,e.tag)?(_e=e.typeMap[e.tag],e.result!==null&&_e.kind!==e.kind&&throwError(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+_e.kind+'", not "'+e.kind+'"'),_e.resolve(e.result)?(e.result=_e.construct(e.result),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):throwError(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")):throwError(e,"unknown tag !<"+e.tag+">");return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||_l}function readDocument(e){var o,s,h,d,g=e.position,_=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap={},e.anchorMap={};(d=e.input.charCodeAt(e.position))!==0&&(skipSeparationSpace(e,!0,-1),d=e.input.charCodeAt(e.position),!(0<e.lineIndent||d!==37));){for(_=!0,d=e.input.charCodeAt(++e.position),o=e.position;d!==0&&!is_WS_OR_EOL(d);)d=e.input.charCodeAt(++e.position);for(h=[],(s=e.input.slice(o,e.position)).length<1&&throwError(e,"directive name must not be less than one character in length");d!==0;){for(;is_WHITE_SPACE(d);)d=e.input.charCodeAt(++e.position);if(d===35){for(;(d=e.input.charCodeAt(++e.position))!==0&&!is_EOL(d););break}if(is_EOL(d))break;for(o=e.position;d!==0&&!is_WS_OR_EOL(d);)d=e.input.charCodeAt(++e.position);h.push(e.input.slice(o,e.position))}d!==0&&readLineBreak(e),_hasOwnProperty$2.call(directiveHandlers,s)?directiveHandlers[s](e,s,h):throwWarning(e,'unknown document directive "'+s+'"')}skipSeparationSpace(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,skipSeparationSpace(e,!0,-1)):_&&throwError(e,"directives end mark is expected"),composeNode(e,e.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(e,!0,-1),e.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(e.input.slice(g,e.position))&&throwWarning(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&testDocumentSeparator(e)?e.input.charCodeAt(e.position)===46&&(e.position+=3,skipSeparationSpace(e,!0,-1)):e.position<e.length-1&&throwError(e,"end of the stream or a document separator is expected")}function loadDocuments(e,o){o=o||{},(e=String(e)).length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var s=new State$1(e,o);for(s.input+="\0";s.input.charCodeAt(s.position)===32;)s.lineIndent+=1,s.position+=1;for(;s.position<s.length-1;)readDocument(s);return s.documents}function loadAll(e,o,s){for(var h=loadDocuments(e,s),d=0,g=h.length;d<g;d+=1)o(h[d])}function load(e,o){var s=loadDocuments(e,o);if(s.length!==0){if(s.length===1)return s[0];throw new exception("expected a single document in the stream, but found more")}}function safeLoadAll(e,o,s){loadAll(e,o,common.extend({schema:default_safe},s))}function safeLoad(e,o){return load(e,common.extend({schema:default_safe},o))}var loadAll_1=loadAll,load_1=load,safeLoadAll_1=safeLoadAll,safeLoad_1=safeLoad,loader={loadAll:loadAll_1,load:load_1,safeLoadAll:safeLoadAll_1,safeLoad:safeLoad_1},_toString$2=Object.prototype.toString,_hasOwnProperty$3=Object.prototype.hasOwnProperty,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function compileStyleMap(e,o){var s,h,d,g,_,j,$;if(o===null)return{};for(s={},d=0,g=(h=Object.keys(o)).length;d<g;d+=1)_=h[d],j=String(o[_]),_.slice(0,2)==="!!"&&(_="tag:yaml.org,2002:"+_.slice(2)),($=e.compiledTypeMap[_])&&_hasOwnProperty$3.call($.styleAliases,j)&&(j=$.styleAliases[j]),s[_]=j;return s}function encodeHex(e){var o,s,h=e.toString(16).toUpperCase();if(e<=255)o="x",s=2;else if(e<=65535)o="u",s=4;else{if(!(e<=4294967295))throw new exception("code point within a string may not be greater than 0xFFFFFFFF");o="U",s=8}return"\\"+o+common.repeat("0",s-h.length)+h}function State$2(e){this.schema=e.schema||default_full,this.indent=Math.max(1,e.indent||2),this.skipInvalid=e.skipInvalid||!1,this.flowLevel=common.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=compileStyleMap(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(e,o){for(var s,h=common.repeat(" ",o),d=0,g=-1,_="",j=e.length;d<j;)d=(g=e.indexOf(`
`,d))===-1?(s=e.slice(d),j):(s=e.slice(d,g+1),g+1),s.length&&s!==`
`&&(_+=h),_+=s;return _}function generateNextLine(e,o){return`
`+common.repeat(" ",e.indent*o)}function testImplicitResolving(e,o){for(var s=0,h=e.implicitTypes.length;s<h;s+=1)if(e.implicitTypes[s].resolve(o))return 1}function StringBuilder(e){this.source=e,this.result="",this.checkpoint=0}function writeScalar(e,o,s,h){var d,g,_,j,$,_t,_e,_r,_n,_o,ga,_l,_f,_c,_p,_g,ty,oy,ry,ly;if(o.length!==0)if(DEPRECATED_BOOLEANS_SYNTAX.indexOf(o)===-1){for(d=!0,g=o.length?o.charCodeAt(0):0,_=CHAR_SPACE===g||CHAR_SPACE===o.charCodeAt(o.length-1),CHAR_MINUS!==g&&CHAR_QUESTION!==g&&CHAR_COMMERCIAL_AT!==g&&CHAR_GRAVE_ACCENT!==g||(d=!1),$=j=_||-1<e.flowLevel&&e.flowLevel<=s?(_&&(d=!1),!1):!h,_t=!0,_e=new StringBuilder(o),_r=!1,_o=_n=0,ga=e.indent*s,(_l=e.lineWidth)===-1&&(_l=9007199254740991),ga<40?_l-=ga:_l=40,_c=0;_c<o.length;_c++){if(_f=o.charCodeAt(_c),d){if(simpleChar(_f))continue;d=!1}_t&&_f===CHAR_SINGLE_QUOTE&&(_t=!1),_p=ESCAPE_SEQUENCES[_f],_g=needsHexEscape(_f),(_p||_g)&&(_f!==CHAR_LINE_FEED&&_f!==CHAR_DOUBLE_QUOTE&&_f!==CHAR_SINGLE_QUOTE?$=j=!1:_f===CHAR_LINE_FEED&&(_t=!(_r=!0),0<_c&&o.charCodeAt(_c-1)===CHAR_SPACE&&(j=$=!1),j&&(ty=_c-_n,_n=_c,_o<ty&&(_o=ty))),_f!==CHAR_DOUBLE_QUOTE&&(_t=!1),_e.takeUpTo(_c),_e.escapeChar())}if(d&&testImplicitResolving(e,o)&&(d=!1),oy="",(j||$)&&(ry=0,o.charCodeAt(o.length-1)===CHAR_LINE_FEED&&(ry+=1,o.charCodeAt(o.length-2)===CHAR_LINE_FEED&&(ry+=1)),ry===0?oy="-":ry===2&&(oy="+")),($&&_o<_l||e.tag!==null)&&(j=!1),_r||($=!1),d)e.dump=o;else if(_t)e.dump="'"+o+"'";else if(j)ly=fold(o,_l),e.dump=">"+oy+`
`+indentString(ly,ga);else if($)oy||(o=o.replace(/\n$/,"")),e.dump="|"+oy+`
`+indentString(o,ga);else{if(!_e)throw new Error("Failed to dump scalar value");_e.finish(),e.dump='"'+_e.result+'"'}}else e.dump="'"+o+"'";else e.dump="''"}function fold(e,o){var s,h="",d=0,g=e.length,_=/\n+$/.exec(e);for(_&&(g=_.index+1);d<g;)d=g<(s=e.indexOf(`
`,d))||s===-1?(h&&(h+=`

`),h+=foldLine(e.slice(d,g),o),g):(h&&(h+=`

`),h+=foldLine(e.slice(d,s),o),s+1);return _&&_[0]!==`
`&&(h+=_[0]),h}function foldLine(e,o){if(e==="")return e;for(var s,h,d=/[^\s] [^\s]/g,g="",_=0,j=0,$=d.exec(e);$;)o<(s=$.index)-j&&(h=_!==j?_:s,g&&(g+=`
`),g+=e.slice(j,h),j=h+1),_=s+1,$=d.exec(e);return g&&(g+=`
`),j!==_&&e.length-j>o?g+=e.slice(j,_)+`
`+e.slice(_+1):g+=e.slice(j),g}function simpleChar(e){return CHAR_TAB!==e&&CHAR_LINE_FEED!==e&&CHAR_CARRIAGE_RETURN!==e&&CHAR_COMMA!==e&&CHAR_LEFT_SQUARE_BRACKET!==e&&CHAR_RIGHT_SQUARE_BRACKET!==e&&CHAR_LEFT_CURLY_BRACKET!==e&&CHAR_RIGHT_CURLY_BRACKET!==e&&CHAR_SHARP!==e&&CHAR_AMPERSAND!==e&&CHAR_ASTERISK!==e&&CHAR_EXCLAMATION!==e&&CHAR_VERTICAL_LINE!==e&&CHAR_GREATER_THAN!==e&&CHAR_SINGLE_QUOTE!==e&&CHAR_DOUBLE_QUOTE!==e&&CHAR_PERCENT!==e&&CHAR_COLON!==e&&!ESCAPE_SEQUENCES[e]&&!needsHexEscape(e)}function needsHexEscape(e){return!(32<=e&&e<=126||e===133||160<=e&&e<=55295||57344<=e&&e<=65533||65536<=e&&e<=1114111)}function writeFlowSequence(e,o,s){for(var h="",d=e.tag,g=0,_=s.length;g<_;g+=1)writeNode(e,o,s[g],!1,!1)&&(g!==0&&(h+=", "),h+=e.dump);e.tag=d,e.dump="["+h+"]"}function writeBlockSequence(e,o,s,h){for(var d="",g=e.tag,_=0,j=s.length;_<j;_+=1)writeNode(e,o+1,s[_],!0,!0)&&(h&&_===0||(d+=generateNextLine(e,o)),d+="- "+e.dump);e.tag=g,e.dump=d||"[]"}function writeFlowMapping(e,o,s){for(var h,d,g,_="",j=e.tag,$=Object.keys(s),_t=0,_e=$.length;_t<_e;_t+=1)g="",_t!==0&&(g+=", "),d=s[h=$[_t]],writeNode(e,o,h,!1,!1)&&(1024<e.dump.length&&(g+="? "),g+=e.dump+": ",writeNode(e,o,d,!1,!1)&&(_+=g+=e.dump));e.tag=j,e.dump="{"+_+"}"}function writeBlockMapping(e,o,s,h){var d,g,_,j,$,_t,_e="",_r=e.tag,_n=Object.keys(s);if(e.sortKeys===!0)_n.sort();else if(typeof e.sortKeys=="function")_n.sort(e.sortKeys);else if(e.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(d=0,g=_n.length;d<g;d+=1)_t="",h&&d===0||(_t+=generateNextLine(e,o)),j=s[_=_n[d]],writeNode(e,o+1,_,!0,!0,!0)&&(($=e.tag!==null&&e.tag!=="?"||e.dump&&1024<e.dump.length)&&(e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?_t+="?":_t+="? "),_t+=e.dump,$&&(_t+=generateNextLine(e,o)),writeNode(e,o+1,j,!0,$)&&(e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?_t+=":":_t+=": ",_e+=_t+=e.dump));e.tag=_r,e.dump=_e||"{}"}function detectType(e,o,s){for(var h,d,g,_=s?e.explicitTypes:e.implicitTypes,j=0,$=_.length;j<$;j+=1)if(((d=_[j]).instanceOf||d.predicate)&&(!d.instanceOf||typeof o=="object"&&o instanceof d.instanceOf)&&(!d.predicate||d.predicate(o))){if(e.tag=s?d.tag:"?",d.represent){if(g=e.styleMap[d.tag]||d.defaultStyle,_toString$2.call(d.represent)==="[object Function]")h=d.represent(o,g);else{if(!_hasOwnProperty$3.call(d.represent,g))throw new exception("!<"+d.tag+'> tag resolver accepts not "'+g+'" style');h=d.represent[g](o,g)}e.dump=h}return 1}}function writeNode(e,o,s,h,d,g){e.tag=null,e.dump=s,detectType(e,s,!1)||detectType(e,s,!0);var _=_toString$2.call(e.dump);h=h&&(e.flowLevel<0||e.flowLevel>o);var j,$,_t=_==="[object Object]"||_==="[object Array]";if(_t&&($=(j=e.duplicates.indexOf(s))!==-1),(e.tag!==null&&e.tag!=="?"||$||e.indent!==2&&0<o)&&(d=!1),$&&e.usedDuplicates[j])e.dump="*ref_"+j;else{if(_t&&$&&!e.usedDuplicates[j]&&(e.usedDuplicates[j]=!0),_==="[object Object]")h&&Object.keys(e.dump).length!==0?(writeBlockMapping(e,o,e.dump,d),$&&(e.dump="&ref_"+j+e.dump)):(writeFlowMapping(e,o,e.dump),$&&(e.dump="&ref_"+j+" "+e.dump));else if(_==="[object Array]")h&&e.dump.length!==0?(writeBlockSequence(e,o,e.dump,d),$&&(e.dump="&ref_"+j+e.dump)):(writeFlowSequence(e,o,e.dump),$&&(e.dump="&ref_"+j+" "+e.dump));else{if(_!=="[object String]"){if(e.skipInvalid)return;throw new exception("unacceptable kind of an object to dump "+_)}e.tag!=="?"&&writeScalar(e,e.dump,o,g)}e.tag!==null&&e.tag!=="?"&&(e.dump="!<"+e.tag+"> "+e.dump)}return 1}function getDuplicateReferences(e,o){var s,h,d=[],g=[];for(inspectNode(e,d,g),s=0,h=g.length;s<h;s+=1)o.duplicates.push(d[g[s]]);o.usedDuplicates=new Array(h)}function inspectNode(e,o,s){var h,d,g;if(e!==null&&typeof e=="object")if((d=o.indexOf(e))!==-1)s.indexOf(d)===-1&&s.push(d);else if(o.push(e),Array.isArray(e))for(d=0,g=e.length;d<g;d+=1)inspectNode(e[d],o,s);else for(d=0,g=(h=Object.keys(e)).length;d<g;d+=1)inspectNode(e[h[d]],o,s)}function dump(e,o){var s=new State$2(o=o||{});return s.noRefs||getDuplicateReferences(e,s),writeNode(s,0,e,!0,!0)?s.dump+`
`:""}function safeDump(e,o){return dump(e,common.extend({schema:default_safe},o))}StringBuilder.prototype.takeUpTo=function(e){var o;if(e<this.checkpoint)throw(o=new Error("position should be > checkpoint")).position=e,o.checkpoint=this.checkpoint,o;return this.result+=this.source.slice(this.checkpoint,e),this.checkpoint=e,this},StringBuilder.prototype.escapeChar=function(){var e=this.source.charCodeAt(this.checkpoint),o=ESCAPE_SEQUENCES[e]||encodeHex(e);return this.result+=o,this.checkpoint+=1,this},StringBuilder.prototype.finish=function(){this.source.length>this.checkpoint&&this.takeUpTo(this.source.length)};var dump_1=dump,safeDump_1=safeDump,dumper={dump:dump_1,safeDump:safeDump_1};function deprecated(e){return function(){throw new Error("Function "+e+" is deprecated and cannot be used.")}}var Type$1=type,Schema$1=schema,FAILSAFE_SCHEMA=failsafe,JSON_SCHEMA=json,CORE_SCHEMA=core,DEFAULT_SAFE_SCHEMA=default_safe,DEFAULT_FULL_SCHEMA=default_full,load$1=loader.load,loadAll$1=loader.loadAll,safeLoad$1=loader.safeLoad,safeLoadAll$1=loader.safeLoadAll,dump$1=dumper.dump,safeDump$1=dumper.safeDump,YAMLException$1=exception,MINIMAL_SCHEMA=failsafe,SAFE_SCHEMA=default_safe,DEFAULT_SCHEMA=default_full,scan=deprecated("scan"),parse=deprecated("parse"),compose=deprecated("compose"),addConstructor=deprecated("addConstructor"),jsYaml={Type:Type$1,Schema:Schema$1,FAILSAFE_SCHEMA,JSON_SCHEMA,CORE_SCHEMA,DEFAULT_SAFE_SCHEMA,DEFAULT_FULL_SCHEMA,load:load$1,loadAll:loadAll$1,safeLoad:safeLoad$1,safeLoadAll:safeLoadAll$1,dump:dump$1,safeDump:safeDump$1,YAMLException:YAMLException$1,MINIMAL_SCHEMA,SAFE_SCHEMA,DEFAULT_SCHEMA,scan,parse,compose,addConstructor},jsYaml$1=jsYaml,SceneBundle=function(){function e(o,s){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;_classCallCheck(this,e),this.url=o,!s||isRelativeURL(s)&&!isRelativeURL(this.url)?this.path=pathForURL(this.url):this.path=s,this.path_for_parent=s||this.path,this.parent=h,this.container=null,this.parent&&(this.parent.container?this.container=this.parent.container:this.parent.isContainer()&&(this.container=this.parent))}return _createClass(e,[{key:"load",value:function(){return loadResource(this.url)}},{key:"resourceFor",value:function(o){return{url:this.urlFor(o),path:this.pathFor(o),type:this.typeFor(o)}}},{key:"urlFor",value:function(o){return isGlobal(o)?o:isRelativeURL(o)&&this.container?this.parent.urlFor(this.path_for_parent+o):addBaseURL(o,this.path)}},{key:"pathFor",value:function(o){return pathForURL(o)}},{key:"typeFor",value:function(o){return extensionForURL(o)}},{key:"isContainer",value:function(){return!1}}]),e}();function createSceneBundle(e,o,s){return new SceneBundle(e,o,s)}function isGlobal(e){return!(!e||e.slice(0,7)!=="global.")}function parseResource(e){var o;try{o=jsYaml$1.safeLoad(e,{json:!0})}catch(s){throw s}return o}function loadResource(e){return new Promise(function(o,s){typeof e=="string"?Utils$1.io(e).then(function(h){try{var d=parseResource(h);o(d)}catch(g){s(g)}},s):(e=Object.assign({},e),o(e))})}function notNull(e){return e!=null}function wrap$1(e){return"("+e+")"}function maybeQuote(e){return typeof e=="string"?'"'+e+'"':e}function lookUp(e){return e[0]==="$"?"context['"+e.substring(1)+"']":"context.feature.properties['"+e+"']"}function nullValue(e,o){return" true "}function propertyEqual(e,o){return wrap$1(maybeQuote(o)+" === "+lookUp(e))}function propertyOr(e,o){return wrap$1(o.map(function(s){return propertyEqual(e,s)}).join(" || "))}function printNested(e,o){return wrap$1(e.filter(notNull).map(function(s){return wrap$1(s.join(" && "))}).join(" "+o+" "))}function any(e,o,s){return o&&0<o.length?printNested(o.map(function(h){return parseFilter(h,s)}),"||"):"true"}function all(e,o,s){return o&&0<o.length?printNested(o.map(function(h){return parseFilter(h,s)}),"&&"):"true"}function not(e,o,s){return"!"+wrap$1(parseFilter(o,s).join(" && "))}function none(e,o,s){return"!"+wrap$1(any(null,o,s))}function propertyMatchesBoolean(e,o){return wrap$1(lookUp(e)+(o?" != ":" == ")+"null")}function rangeMatch(e,o,s){var h,d,g=[],_=s&&typeof s.rangeTransform=="function"&&s.rangeTransform;return o.max&&(h=_?_(o.max):o.max,g.push(lookUp(e)+" < "+h)),o.min&&(d=_?d=_(o.min):o.min,g.push(lookUp(e)+" >= "+d)),wrap$1(g.join(" && "))}function parseFilter(e,o){var s=[];if(typeof e=="function")return[wrap$1(e.toString()+"(context)")];if(Array.isArray(e))return[any(null,e,o)];if(e==null)return["true"];for(var h=Object.keys(e),d=0;d<h.length;d++){var g=h[d],_=e[g],j=_typeof(_);if(j==="string"||j==="number")s.push(propertyEqual(g,_));else if(j==="boolean")s.push(propertyMatchesBoolean(g,_));else if(g==="not")s.push(not(g,_,o));else if(g==="any")s.push(any(g,_,o));else if(g==="all")s.push(all(g,_,o));else if(g==="none")s.push(none(g,_,o));else if(Array.isArray(_))s.push(propertyOr(g,_));else if(j==="object"&&_!=null)(_.max||_.min)&&s.push(rangeMatch(g,_,o));else{if(_!=null)throw new Error("Unknown Query syntax: "+_);s.push(nullValue())}}return h.length===0?["true"]:s}function filterToString(e){return wrap$1(e.join(" && "))}function buildFilter(e,o){return e==null?function(){return!0}:new Function("context","return "+filterToString(parseFilter(e,o))+";")}var reserved=["filter","draw","visible","enabled","data"],layer_cache={};function cacheKey(e){if(1<e.length){for(var o=e[0],s=1;s<e.length;s++)o+="/"+e[s];return o}return e[0]}function mergeTrees(e,o){for(var s,h=0,d=0;d<e.length;d++)e[d].length>h&&(h=e[d].length);if(h===0)return null;for(var g={visible:!0},_=0;_<h;_++)(function(j){s=[],e.forEach(function($){$[j]&&$[j][o]&&s.indexOf($[j][o])===-1&&s.push($[j][o])}),s.length!==0&&(s.sort(function($,_t){return($&&$.layer_name)>(_t&&_t.layer_name)?1:-1}),mergeObjects.apply(void 0,[g].concat(_toConsumableArray(s))),delete g.layer_name)})(_);return g.visible===!1?null:g}var blacklist=["any","all","not","none"],Layer=function(){function e(o){var s,h=o.layer,d=o.name,g=o.parent,_=o.draw,j=o.visible,$=o.enabled,_t=o.filter,_e=o.styles;if(_classCallCheck(this,e),this.id=e.id++,this.config_data=h.data,this.parent=g,this.name=d,this.full_name=this.parent?this.parent.full_name+":"+this.name:this.name,this.draw=_,this.filter=_t,this.styles=_e,this.is_built=!1,$=$===void 0?j:$,this.parent&&this.parent.visible===!1?this.enabled=!1:this.enabled=$!==!1,this.draw)for(var _r in this.draw)this.draw[_r]=this.draw[_r]==null?{}:this.draw[_r],_typeof(this.draw[_r])!=="object"?(s="Draw group '".concat(_r,"' for layer ").concat(this.full_name," is invalid, must be an object, "),log("warn",s+="but was set to `".concat(_r,": ").concat(this.draw[_r],"` instead")),delete this.draw[_r]):this.draw[_r].layer_name=this.full_name}return _createClass(e,[{key:"build",value:function(){log("trace","Building layer '".concat(this.full_name,"'")),this.buildFilter(),this.buildDraw(),this.is_built=!0}},{key:"buildDraw",value:function(){this.draw=Utils$1.stringsToFunctions(this.draw,StyleParser.wrapFunction),this.calculatedDraw=calculateDraw(this)}},{key:"buildFilter",value:function(){this.filter_original=this.filter,this.filter=Utils$1.stringsToFunctions(this.filter,StyleParser.wrapFunction);var o=_typeof(this.filter);if(this.filter==null||o==="object"||o==="function")try{this.buildZooms(),this.buildPropMatches(),this.filter!=null&&(typeof this.filter=="function"||0<Object.keys(this.filter).length)?this.filter=buildFilter(this.filter,FilterOptions):this.filter=null}catch(d){var s="Filter for layer ".concat(this.full_name," is invalid, `filter: ").concat(JSON.stringify(this.filter),"` ");log("warn",s+="failed with error '".concat(d.message,"', stack trace: ").concat(d.stack))}else{var h="Filter for layer ".concat(this.full_name," is invalid, filter value must be an object or function, ");log("warn",h+="but was set to `filter: ".concat(this.filter,"` instead"))}}},{key:"buildZooms",value:function(){var o=this.filter&&this.filter.$zoom,s=_typeof(o);if(o!=null&&s!=="function"){if(this.zooms={},s==="number")this.zooms[o]=!0;else if(Array.isArray(o))for(var h=0;h<o.length;h++)this.zooms[o[h]]=!0;else if(s==="object"&&(o.min!=null||o.max!=null))for(var d=o.min||0,g=o.max||25,_=d;_<g;_++)this.zooms[_]=!0;delete this.filter.$zoom}}},{key:"buildPropMatches",value:function(){var o=this;this.filter&&!Array.isArray(this.filter)&&typeof this.filter!="function"&&Object.keys(this.filter).forEach(function(s){if(blacklist.indexOf(s)===-1){var h=o.filter[s],d=_typeof(h),g=Array.isArray(h);if(!g&&d!=="string"&&d!=="number")return;s[0]==="$"?(o.context_prop_matches=o.context_prop_matches||[],o.context_prop_matches.push([s.substring(1),g?h:[h]])):(o.feature_prop_matches=o.feature_prop_matches||[],o.feature_prop_matches.push([s,g?h:[h]])),delete o.filter[s]}})}},{key:"doPropMatches",value:function(o){if(this.feature_prop_matches)for(var s=0;s<this.feature_prop_matches.length;s++){var h=this.feature_prop_matches[s],d=o.feature.properties[h[0]];if(d==null||h[1].indexOf(d)===-1)return!1}if(this.context_prop_matches)for(var g=0;g<this.context_prop_matches.length;g++){var _=this.context_prop_matches[g],j=o[_[0]];if(j==null||_[1].indexOf(j)===-1)return!1}return!0}},{key:"doesMatch",value:function(o){if(!this.enabled||(this.is_built||this.build(),this.zooms!=null&&!this.zooms[o.zoom])||!this.doPropMatches(o))return!1;var s;if(this.filter instanceof Function)try{s=this.filter(o)}catch(d){var h="Filter for this ".concat(this.full_name,": `filter: ").concat(this.filter_original,"` ");log("error",h+="failed with error '".concat(d.message,"', stack trace: ").concat(d.stack),o.feature)}else s=this.filter==null;return!!s&&(this.children_to_parse&&(parseLayerChildren(this,this.children_to_parse,this.styles),delete this.children_to_parse),!0)}}]),e}();Layer.id=0;var LayerLeaf=function(){_inherits(o,Layer);var e=_createSuper(o);function o(s){var h;return _classCallCheck(this,o),(h=e.call(this,s)).is_leaf=!0,h}return o}(),LayerTree=function(){_inherits(o,Layer);var e=_createSuper(o);function o(s){var h;return _classCallCheck(this,o),(h=e.call(this,s)).is_tree=!0,h.layers=s.layers||[],h}return _createClass(o,[{key:"addLayer",value:function(s){this.layers.push(s)}},{key:"buildDrawGroups",value:function(s){var h=[],d=[];if(matchFeature(s,[this],h,d),0<h.length){var g=cacheKey(d);if(layer_cache[g]===void 0){for(var _=h.map(function(ga){return ga&&ga.visible!==!1&&ga.calculatedDraw}),j={},$=0;$<_.length;$++){var _t=_[$];if(_t)for(var _e=0;_e<_t.length;_e++){var _r=_t[_e];for(var _n in _r)j[_n]=!0}}for(var _o in j)layer_cache[g]=layer_cache[g]||{},layer_cache[g][_o]=mergeTrees(_,_o),layer_cache[g][_o]?(layer_cache[g][_o].key=g+"/"+_o,layer_cache[g][_o].layers=h.map(function(ga){return ga&&ga.full_name}),layer_cache[g][_o].group=_o):delete layer_cache[g][_o];layer_cache[g]&&Object.keys(layer_cache[g]).length===0&&(layer_cache[g]=null)}return layer_cache[g]}}}]),o}(),FilterOptions={rangeTransform:function(e){return typeof e=="string"&&e.trim().slice(-3)==="px2"?"".concat(parseFloat(e)," * context.meters_per_pixel_sq"):e}},SceneLoader;function isReserved(e){return-1<reserved.indexOf(e)}function isEmpty(e){return Object.keys(e).length===0}function groupProps(e){var o={},s={};for(var h in e)isReserved(h)?o[h]=e[h]:s[h]=e[h];return[o,s]}function calculateDraw(e){var o,s=[];return e.parent&&(o=e.parent.calculatedDraw||[],s.push.apply(s,_toConsumableArray(o))),s.push(e.draw),s}function parseLayerNode(e,o,s,h){var d={name:e,layer:o=o??{},parent:s,styles:h},g=_slicedToArray(groupProps(o),2),_=g[0],j=g[1],$=isEmpty(j),_t=$&&s!=null?LayerLeaf:LayerTree,_e=new _t(Object.assign(d,_));return _e.enabled&&(s&&s.addLayer(_e),_e.children_to_parse=$?null:j),_e}function parseLayerChildren(e,o,s){for(var h in o){var d,g=o[h];_typeof(g)!=="object"||Array.isArray(g)?(d="Layer value must be an object: cannot create layer '".concat(h,": ").concat(JSON.stringify(g),"'"),d+=", under parent layer '".concat(e.full_name,"'."),s[e.name]&&(d+=" The parent name '".concat(e.name,"' is also the name of a style, did you mean to create a 'draw' group"),e.parent&&(d+=" under '".concat(e.parent.name,"'")),d+=" instead?"),log("warn",d)):parseLayerNode(h,g,e,s)}}function parseLayers(e,o){layer_cache={};var s={};for(var h in e){var d=e[h];d&&(s[h]=parseLayerNode(h,d,null,o))}return s}function matchFeature(e,o,s,h){var d=!1;if(o.length!==0){for(var g=0;g<o.length;g++){var _=o[g];_.is_leaf?_.doesMatch(e)&&(d=!0,s.push(_),h.push(_.id)):_.is_tree&&_.doesMatch(e)&&(d=!0,matchFeature(e,_.layers,s,h)||(s.push(_),h.push(_.id)))}return d}}var GLOBAL_PROP_RGX=/^global\.(.+)$/,SceneLoader$1=SceneLoader={loadScene:function(e,o){var s=this,h=1<arguments.length&&o!==void 0?o:{},d=h.path,g=h.type,_=[];return this.loadSceneRecursive({url:e,path:d,type:g},null,_).then(function(j){return s.finalize(j)}).then(function(j){var $=j.config,_t=j.bundle;return $?(0<_.length&&_.forEach(function(_e){var _r="Failed to import scene: ".concat(_e.url);log("error",_r,_e),s.trigger("error",{type:"scene_import",message:_r,error:_e,url:_e.url})}),{config:$,bundle:_t}):Promise.reject(_[0])})},loadSceneRecursive:function(e,o,s){var h=this,d=e.url,g=e.path;e.type;var _=2<arguments.length&&s!==void 0?s:[];if(!d)return Promise.resolve({});var j=createSceneBundle(d,g,o);return j.load().then(function($){if($.import==null)return h.normalize($,j),{config:$,bundle:j};Array.isArray($.import)||($.import=[$.import]);var _t=[];return $.import.forEach(function(_e){_typeof(_e)==="object"&&(_e=createObjectURL(new Blob([JSON.stringify(_e)]))),_t.push(j.resourceFor(_e))}),delete $.import,Promise.all(_t.map(function(_e){return h.loadSceneRecursive(_e,j,_)})).then(function(_e){_e.forEach(function(_n){return h.normalize(_n.config,_n.bundle)});var _r=_e.map(function(_n){return _n.config});return $=mergeObjects.apply(void 0,_toConsumableArray(_r).concat([$])),h.normalize($,j),{config:$,bundle:j}})}).catch(function($){return $.url=d,_.push($),{}})},normalize:function(e,o){return this.normalizeDataSources(e,o),this.normalizeFonts(e,o),this.normalizeTextures(e,o),this.hoistTextures(e,o),{config:e,bundle:o}},normalizeDataSources:function(e,o){for(var s in e.sources=e.sources||{},e.sources)this.normalizeDataSource(e.sources[s],o);return e},normalizeDataSource:function(e,o){if(e.url&&(e.url=o.urlFor(e.url)),e.scripts)for(var s in Array.isArray(e.scripts)&&(e.scripts=e.scripts.reduce(function(h,d){return h[d]=d,h},{})),e.scripts)e.scripts[s]=o.urlFor(e.scripts[s]);return e},normalizeFonts:function(e,o){for(var s in e.fonts=e.fonts||{},e.fonts){var h;Array.isArray(e.fonts[s])?e.fonts[s].forEach(function(d){d.url=d.url&&o.urlFor(d.url)}):(h=e.fonts[s]).url=h.url&&o.urlFor(h.url)}return e},normalizeTextures:function(e,o){if(e.textures=e.textures||{},e.textures)for(var s in e.textures){var h=e.textures[s];h.url&&(h.url=o.urlFor(h.url))}},hoistTextures:function(e,o){var s=this;if(e.styles)for(var h in e.styles)(function(_r){var _n=e.styles[_r],_o=_n.texture;typeof _o!="string"||e.textures[_o]||(_n.texture=s.hoistTexture(_o,e,o)),_n.material&&["emission","ambient","diffuse","specular","normal"].forEach(function(ga){var _l=_n.material[ga]!=null&&_n.material[ga].texture;typeof _l!="string"||e.textures[_l]||(_n.material[ga].texture=s.hoistTexture(_l,e,o))})})(h);if(this.hoistStyleShaderUniformTextures(e,o,{include_globals:!1}),e.layers)for(var d=[e.layers];0<d.length;){var g=d.pop();if(_typeof(g)==="object"&&!Array.isArray(g))for(var _ in g)if(_==="draw"){var j,$,_t=g[_];for(var _e in _t)_t[_e].texture&&(typeof(j=_t[_e].texture)!="string"||e.textures[j]||(_t[_e].texture=this.hoistTexture(j,e,o))),_t[_e].outline&&_t[_e].outline.texture&&(typeof($=_t[_e].outline.texture)!="string"||e.textures[$]||(_t[_e].outline.texture=this.hoistTexture($,e,o)))}else{if(isReserved(_))continue;d.push(g[_])}}},hoistStyleShaderUniformTextures:function(e,o,s){var h=this,d=s.include_globals;if(e.styles)for(var g in e.styles){var _=e.styles[g];_.shaders&&_.shaders.uniforms&&GLSL.parseUniforms(_.shaders.uniforms).forEach(function(j){var $=j.type,_t=j.value,_e=j.key,_r=j.uniforms;$!=="sampler2D"||typeof _t!="string"||e.textures[_t]||!d&&isGlobal(_t)||(_r[_e]=h.hoistTexture(_t,e,o))})}},hoistTexture:function(e,o,s){var h=isGlobal(e),d=h?e:s.urlFor(e),g=h?"texture-".concat(d):d;return o.textures[g]={url:d},g},applyGlobalProperties:function(e){if(!e.global||Object.keys(e.global).length===0)return e;var o=flattenProperties(e.global);return function s(h){if(typeof h=="string"){var d=function j($,_t,_e){var _r=2<arguments.length&&_e!==void 0?_e:[];if(-1<_r.indexOf($))log({level:"warn",once:!0},"Global properties: cyclical reference detected",_r);else{_r.push($);var _n=GLOBAL_PROP_RGX.exec($);if(_n){var _o=_n[1];if(_o){var ga=_t[_o];if(ga!==void 0)return typeof ga=="string"&&GLOBAL_PROP_RGX.exec(ga)?j(ga,_t,_r):ga;log({level:"warn",once:!0},"Global property not found: "+$)}else log({level:"warn",once:!0},"Invalid global property reference: "+$)}}}(h,o);d!==void 0&&(h=d)}else if(Array.isArray(h))for(var g=0;g<h.length;g++)h[g]=s(h[g]);else if(_typeof(h)==="object")for(var _ in h)h[_]=s(h[_]);return h}(e)},finalize:function(e){var o=e.config,s=e.bundle;return o?(o.global=o.global||{},o.scene=o.scene||{},o.cameras=o.cameras||{},o.lights=o.lights||{},o.styles=o.styles||{},o.layers=o.layers||{},o.camera&&(o.cameras.default=o.camera),Object.keys(o.cameras).length===0&&(o.cameras.default={}),Object.keys(o.lights).length!==0&&!Object.keys(o.lights).every(function(h){return o.lights[h].visible===!1})||(o.lights.default_light={type:"directional"}),{config:o,bundle:s}):{}}};function flattenProperties(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:".",s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{},h=(h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)?h+o:"";for(var d in e){var g=h+d,_=e[d];_typeof(s[g]=_)!=="object"||Array.isArray(_)||flattenProperties(_,o,g,s)}return s}subscribeMixin(SceneLoader);var TilePyramid=function(){function e(){_classCallCheck(this,e),this.coords={},this.max_proxy_descendant_depth=6,this.max_proxy_ancestor_depth=10}return _createClass(e,[{key:"sourceTiles",value:function(o,s){return this.coords[o.key]&&this.coords[o.key].sources&&this.coords[o.key].sources[s.name]}},{key:"addTile",value:function(o){var s=o.coords.key,h=this.coords[s];(h=h||(this.coords[s]={descendants:0})).sources||(h.sources={}),h.sources[o.source.name]||(h.sources[o.source.name]={});for(var d=(h.sources[o.source.name][o.style_zoom]=o).coords.z-1;0<=d;d--){var g=Tile.coordinateAtZoom(o.coords,d);this.coords[g.key]||(this.coords[g.key]={descendants:0}),this.coords[g.key].descendants++}}},{key:"removeTile",value:function(o){var s=this.sourceTiles(o.coords,o.source),h=o.coords.key;s&&(delete s[o.style_zoom],Object.keys(s).length===0&&(delete this.coords[h].sources[o.source.name],Object.keys(this.coords[h].sources).length===0&&(delete this.coords[h].sources,this.coords[h].descendants===0&&delete this.coords[h])));for(var d=o.coords.z-1;0<=d;d--){var g=Tile.coordinateAtZoom(o.coords,d);this.coords[g.key]&&0<this.coords[g.key].descendants&&(this.coords[g.key].descendants--,this.coords[g.key].descendants!==0||this.coords[g.key].sources||delete this.coords[g.key])}}},{key:"getAncestor",value:function(o,s){var h=o.coords,d=o.style_zoom,g=o.source,_=1<arguments.length&&s!==void 0?s:1;if(!(_>this.max_proxy_ancestor_depth)){if(d>g.max_coord_zoom){var j=this.sourceTiles(h,g);if(j){for(var $=d-1;$>=g.max_coord_zoom;$--)if(j[$]&&j[$].loaded)return j[$]}d=g.max_coord_zoom}d--;var _t=Tile.coordinateAtZoom(h,h.z-1),_e=this.sourceTiles(_t,g);return _e&&_e[d]&&_e[d].loaded?_e[d]:0<_t.z?this.getAncestor({coords:_t,style_zoom:d,source:g},_+1):void 0}}},{key:"getDescendants",value:function(o,s){var h=o.coords,d=o.style_zoom,g=o.source,_=1<arguments.length&&s!==void 0?s:1,j=[];if(d>=g.max_coord_zoom){var $=this.sourceTiles(h,g);if($){for(var _t=Math.max(Geo$1.default_view_max_zoom,d+this.max_proxy_descendant_depth),_e=d+1;_e<=_t;_e++)if($[_e]&&$[_e].loaded)return j.push($[_e]),j}return j}if(this.coords[h.key]&&0<this.coords[h.key].descendants){d++;for(var _r=Tile.childrenForCoordinate(h),_n=0;_n<_r.length;_n++){var _o=_r[_n],ga=this.sourceTiles(_o,g);ga&&ga[d]&&ga[d].loaded?j.push(ga[d]):_<=this.max_proxy_descendant_depth&&_o.z<=g.max_coord_zoom&&j.push.apply(j,_toConsumableArray(this.getDescendants({coords:_o,source:g,style_zoom:d},_+1)))}}return j}}]),e}(),LabelMainPass=function(){function e(o,s,h,d){_classCallCheck(this,e),Object.assign(this,o),this.placed=null,this._tile=d;var g=Geo$1.unitsPerMeter(d.coords.z)*Math.pow(2,h-d.style_zoom);this.layout=Object.assign({},o.layout),this.layout.repeat_scale=.75,this.layout.repeat_distance=this.layout.repeat_distance||0,this.layout.repeat_distance/=g,this.position=Geo$1.tileSpaceToMeters(this.position,d.coords.z,d.min),this._worldToScreen=s,this._screenSpaceBoundingBox=void 0,this._boundingCircles=void 0}return _createClass(e,[{key:"getTile",value:function(){return this._tile}},{key:"isFlat",value:function(){return this.is_flat}},{key:"getScreenSpaceBoundingBox",value:function(){var o,s,h,d,g,_,j;return this._screenSpaceBoundingBox||((o=this._worldToScreen(this.position,!0))[0]+=this.offset[0],o[1]+=this.offset[1],s=this.size[0]/2+this.layout.buffer[0],h=this.size[1]/2+this.layout.buffer[1],d=o[0]-s,g=o[0]+s,_=o[1]-h,j=o[1]+h,this._screenSpaceBoundingBox={left:d,bottom:j,right:g,top:_}),this._screenSpaceBoundingBox}},{key:"getBoundingCircles",value:function(){return this._boundingCircles||(this._boundingCircles=this.type==="point"?this._convertSidesToScreenSpaceCircles():this._convertCirclesToScreenSpace()),this._boundingCircles}},{key:"_convertSidesToScreenSpaceCircles",value:function(){var o=this._tile.coords.z,s=this._tile.min,h=Geo$1.tileSpaceToMeters([this.sides[0],this.sides[1]],o,s),d=Geo$1.tileSpaceToMeters([this.sides[2],this.sides[3]],o,s),g=_slicedToArray(this._worldToScreen(h,!0),2),_=g[0],j=g[1],$=_slicedToArray(this._worldToScreen(d,!0),2);return encircleLine(_,j,$[0],$[1],this.size[1]/2+this.layout.buffer[1])}},{key:"_convertCirclesToScreenSpace",value:function(){for(var o=[],s=this.circles,h=this._tile.coords.z,d=this._tile.min,g=0;g<s.length-2;g+=3){var _=Geo$1.tileSpaceToMeters([s[g],-s[g+1]],h,d),j=s[g+2]/Geo$1.unitsPerMeter(h),$=[_[0]+j,_[1]],_t=this._worldToScreen(_,!0),_e=this._worldToScreen($,!0),_r=MathUtils$1.getLineLength(_t[0],_t[1],_e[0],_e[1]);o.push(_t[0],_t[1],_r)}return o}}]),e}(),labelsMainPass={mainThreadLabelCollisionPass},visible={},prev_visible={},IS_LITTLE_ENDIAN=new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120;function _createContainer(e,o,s,h,d){var g=e.container,_=g.label,j=g.linked,$=e.ranges;return{label:new LabelMainPass(_,s,h,d),linked:j,ranges:$,mesh:o}}function mainThreadLabelCollisionPass(e,o,s,h,d,g){prev_visible=visible,visible={};var _={},j={},$=[],_t=s.worldToScreen.bind(s),_e=new TextMeshHelper(g);for(var _r in e.forEach(function(_f){for(var _c in _f.meshes)_f.meshes[_c].forEach(function(_p){if(_p.labels){for(var _g in _e.trackMesh(_p),_p.labels["non-collision"]){var ty=_createContainer(_p.labels["non-collision"][_g],_p,_t,o,_f);ty.label.text_data&&_e.insertLabel(ty,_f)}for(var oy in _p.labels.collision){var ry;_[oy]||(ry=_createContainer(_p.labels.collision[oy],_p,_t,o,_f),_[oy]=ry.label,j[oy]=ry)}}})}),j){var _n=j[_r];_n.linked&&(_n.linked=j[_n.linked]),$.push(_n)}var _o=s.getViewport(),ga=_o.width,_l=_o.height;return Collision.startTile("main",{apply_repeat_groups:!0,return_hidden:!0,grid_index:new GridIndex(ga,_l,30)}),Collision.addStyle("main","main"),Collision.collide($,"main","main").then(function(_f){return _f.forEach(function(_c){var _p,_g,ty,oy,ry,ly,py=_c.mesh,gy=_c.label.getTile();py.valid&&(!(_p=0)!==_c.show||h&&_c.label.breach&&!prev_visible[_c.label.id]||(_p=1),_p&&(visible[_c.label.id]=!0),_c.label.text_data&&_e.insertLabel(_c,gy),_g=py.vertex_layout.offset.a_shape,ty=py.vertex_layout.stride,ry=(oy=py.vertex_layout.attribs.find(function(by){return by.name==="a_shape"})).byte_size/oy.size,_g+=3*ry,ly=!0,_c.ranges.forEach(function(by){if(ly){for(var wy=0;wy<by[1];wy++){if(py.vertex_data[by[0]+wy*ty+_g]===_p)return void(ly=!1);py.vertex_data[by[0]+wy*ty+_g]=_p}_e.trackMesh(py)}}))}),_e.createTextures(d).then(function(){return _e.updateMeshes()})}).then(function(_f){_f.forEach(function(_c){return _c.valid&&_c.upload()}),e.forEach(function(_c){_c.labeled=!0}),$=[],j={},_={}})}var TextMeshHelper=function(){function e(o){_classCallCheck(this,e),this.textureManager=getTextureManager(o),this.tiles={},this.meshes=[],this.containers=[]}return _createClass(e,[{key:"insertLabel",value:function(o,s){var h=o.label.text_data,d=h.text_settings_key,g=h.text,_=h.text_info;this.containers.push(o);var j=this._ensureTextSection(s,d);j[g]?o.label.text_data.text_info=j[g]:j[g]=_}},{key:"trackMesh",value:function(o){this.meshes.indexOf(o)===-1&&this.meshes.push(o)}},{key:"updateMeshes",value:function(){var o=this;return this.containers.forEach(function(s){var h,d,g,_,j,$,_t,_e,_r,_n;s.label.text_data&&(h=s.label.getTile(),(d=s.mesh).valid?(g=s.label.type,_=s.label.text_data.text_info,o.tiles[h.id]&&o.tiles[h.id].textures&&(j=o.tiles[h.id].textures[0],d.uniforms.u_texture=j,d.textures.indexOf(j)===-1&&d.textures.push(j),g==="point"||g==="straight"?($=g==="point"?_.align[s.label.align].texcoords:_.texcoords[g].texcoord,o.setTexCoords(d,s,$)):g==="curved"&&(_t=_.segments.length,_e=_.texcoords_stroke,_r=_.texcoords.curved,o.setTexCoords(d,s,function(_o){return _o<_t?_e[_o]:_r[_o-_t].texcoord})))):o.tiles[h.id]&&o.tiles[h.id].textures&&(_n=o.tiles[h.id].textures[0],o.textureManager.release(_n)))}),this.meshes}},{key:"setTexCoords",value:function(o,s,h){var d,g,_,j,$,_t,_e=h instanceof Function;_e||(g=(d=_slicedToArray(h,4))[0],_=d[1],j=d[2],$=d[3],_t=[[g,_],[j,_],[j,$],[g,$]]);var _r=o.vertex_layout.stride,_n=new DataView(o.vertex_data.buffer),_o=o.vertex_layout.offset.a_texcoord;s.ranges.forEach(function(ga,_l){var _f,_c,_p,_g,ty,oy=_slicedToArray(ga,3),ry=oy[0],ly=oy[1],py=oy[2];_e&&(_c=(_f=_slicedToArray(h(_l),4))[0],_p=_f[1],_g=_f[2],ty=_f[3],_t=[[_c,_p],[_g,_p],[_g,ty],[_c,ty]]);for(var gy=py?ly/2:0;gy<ly;gy++){var by=_t[gy%4],wy=ry+gy*_r;_n.setUint16(wy+_o,by[0]*texcoord_normalize,IS_LITTLE_ENDIAN),_n.setUint16(wy+_o+2,by[1]*texcoord_normalize,IS_LITTLE_ENDIAN)}})}},{key:"createTextures",value:function(o){var s=this;return Promise.all(Object.values(this.tiles).map(function(h){var d=h.id,g=h.key,_=h.texts;return s._createTexturesForTile(o,_,"labels-".concat(g,"-").concat(d),d,s.textureManager).then(function(j){j.length&&(j.forEach(function($){s.textureManager.retain($),1<s.textureManager.getRetainCount($)&&s.textureManager.release($)}),s.tiles[d].textures=j)})}))}},{key:"_createTexturesForTile",value:function(o,s,h,d,g){var _=new CanvasText,j=_.setTextureTextPositions(s);return _.rasterize(s,j,d,h,o,g)}},{key:"_ensureTile",value:function(o){var s=o.id,h=o.key;return this.tiles[s]||(this.tiles[s]={id:s,key:h,texts:{}}),this.tiles[s]}},{key:"_ensureTextSection",value:function(o,s){var h=this._ensureTile(o).texts;return h[s]||(h[s]={}),h[s]}}]),e}(),TILE_VISIBILITY_COUNTER_THRESHOLD=30,TileManager=function(){function e(o){var s=this,h=o.scene,d=o.view;_classCallCheck(this,e),this._scene=h,this._view=d,this._visible_tiles={},this._pyramid=new TilePyramid,this._visible_coords={},this._building_tiles=null,this._renderable_tiles=[],this._active_styles=[],this._tile_visibility_counters={},this._update_labels_on_queue_check=!1,this._all_visible_tiles_are_cached=!1,this._debouncedUpdateLabels=debounce(this._updateLabels.bind(this),100,200),this._main_thread_target=["TileManager",this._scene.id].join("_"),WorkerBroker.addTarget(this._main_thread_target,this),this._keepCoordinate=this._keepCoordinate.bind(this),this._removeTilesFilter=this._removeTilesFilter.bind(this),this._removeCachedTilesFilter=this._removeCachedTilesFilter.bind(this),this._is_labeled=!1,this._tile_cache=new H.util.Cache(getMaxTileCacheSize(),function(g,_,j){s._visible_tiles[g]&&s._visible_tiles[g]===_||_.destroy()})}return _createClass(e,[{key:"destroy",value:function(){this._tile_cache.removeAll(),this.forEachVisibleTile(function(o){return o.destroy()}),this._visible_tiles={},this._pyramid=null,this._visible_coords={},this._scene=null,this._view=null}},{key:"keepTile",value:function(o){this._visible_tiles[o.key]=o,this._pyramid.addTile(o)}},{key:"hasTile",value:function(o){return this._visible_tiles[o]!==void 0}},{key:"_forgetTile",value:function(o){var s,h;this.hasTile(o)&&(s=this._visible_tiles[o],this._pyramid.removeTile(s),delete this._visible_tiles[o],s.loaded?this._tile_cache.add(s.key,s,getTileByteLength(s)):(h=this._tile_cache.get(s.key))?this._tile_cache.drop(h.key):s.destroy(),this._tileBuildStop(s))}},{key:"removeTile",value:function(o){this._forgetTile(o),this._scene.requestRedraw()}},{key:"forEachVisibleTile",value:function(o){for(var s in this._visible_tiles)o(this._visible_tiles[s])}},{key:"removeTiles",value:function(o){for(var s in this._visible_tiles)o(this._visible_tiles[s])&&this.removeTile(s)}},{key:"removeCachedTiles",value:function(o){var s=this;this._tile_cache.forEach(function(h,d){o(d)&&s._tile_cache.drop(h)})}},{key:"updateTilesForView",value:function(o){var s=0<arguments.length&&o!==void 0&&o;this._visible_coords={};for(var h=this._view.findVisibleTileCoordinates(),d=0;d<h.length;d++){var g=h[d];this._visible_coords[g.key]=g}this.updateTileStates(s)}},{key:"updateTileStates",value:function(o){var s=0<arguments.length&&o!==void 0&&o;for(var h in this._all_visible_tiles_are_cached=!0,this._visible_coords)this._keepCoordinate(h,s);this._all_visible_tiles_are_cached&&(this._is_labeled=!1,this._debouncedUpdateLabels()),this._tile_cache.removeAll(this._removeCachedTilesFilter),this._updateProxyTiles(),this.removeTiles(this._removeTilesFilter),this._updateRenderableTiles(),this._updateActiveStyles()}},{key:"_removeTilesFilter",value:function(o){if(o.style_zoom===this._view.lookAtManipulator.getLookAtData().tile_level){if(this._visible_coords[o.coords.key])return!1;for(var s in this._visible_coords)if(Tile.isDescendant(o.coords,this._visible_coords[s]))return!1}return!o.isProxy()}},{key:"_updateLabels",value:function(){var o,s=this;this._building_tiles&&Object.keys(this._building_tiles).length!==0||(CanvasText.pruneTextCache(),o=this._renderable_tiles.sort(compareTileCoords),labelsMainPass.mainThreadLabelCollisionPass(o,roundPrecision(this._view.lookAtManipulator.getLookAtData().zoom,2),this._view.lookAtManipulator,this.isLoadingVisibleTiles(),this._scene.gl,this._scene.id).then(function(){s._is_labeled=!Task.hasPendingTasks(),s._scene&&s._scene.immediateRedraw(),s._update_labels_on_queue_check=!1}))}},{key:"_updateProxyTiles",value:function(){var o,s=this,h=this._view.lookAtManipulator.getZoomDirection();h!==0&&(o=!1,this.forEachVisibleTile(function(d){var g;if(d.setProxyFor(null),h===1)d.built||(g=s._pyramid.getAncestor(d))&&(g.setProxyFor(d),o=!0);else if(h===-1&&!d.built)for(var _=s._pyramid.getDescendants(d),j=0;j<_.length;j++)_[j].setProxyFor(d),o=!0}),o||this._view.lookAtManipulator.resetZoomDirection())}},{key:"getRenderableTiles",value:function(){return this._renderable_tiles}},{key:"_updateRenderableTiles",value:function(){for(var o in this._renderable_tiles=[],this._visible_tiles){var s=this._visible_tiles[o],h=this._tile_cache.get(o);s.loaded?(this._renderable_tiles.push(s),h&&h!==s&&this._tile_cache.drop(o)):h&&(h.generation===this._scene.generation?this._renderable_tiles.push(h):this._tile_cache.drop(o))}return this._renderable_tiles}},{key:"getWorkerForTile",value:function(o,s){var h=s.has_volatile_data?this._scene.getWorkers(WorkerType.FAKE)[0]:s.tiled?this._scene.getWorkers(WorkerType.NATIVE)[Math.abs(o.x+o.y+o.z)%this._scene.num_workers]:this._scene.getWorkers(WorkerType.NATIVE)[s.id%this._scene.num_workers];return h}},{key:"getActiveStyles",value:function(){return this._active_styles}},{key:"_updateActiveStyles",value:function(){for(var o=this._renderable_tiles,s={},h=0;h<o.length;h++){var d=o[h];Object.keys(d.meshes).forEach(function(g){return s[g]=!0})}return this._active_styles=Object.keys(s),this._active_styles}},{key:"isLoadingVisibleTiles",value:function(){var o=!1;for(var s in this._visible_tiles)if(!this._visible_tiles[s].built){o=!0;break}return o}},{key:"updateTilesVisibilityCounters",value:function(){var o=this;Object.keys(this._visible_coords).forEach(function(d){d in o._tile_visibility_counters||(o._tile_visibility_counters[d]=0)});var s=Object.keys(this._tile_visibility_counters),h=[];s.forEach(function(d){d in o._visible_coords?(o._tile_visibility_counters[d]++,o._tile_visibility_counters[d]>=TILE_VISIBILITY_COUNTER_THRESHOLD&&h.push(o._visible_coords[d])):(o._tile_visibility_counters[d]--,o._tile_visibility_counters[d]<=0&&delete o._tile_visibility_counters[d])}),h.length&&this.loadCoordinates(h)}},{key:"loadCoordinates",value:function(o){var s=this;o.sort(function(h,d){var g=s._view.lookAtManipulator.getLookAtData().position,_=Geo$1.metersPerTile(h.z)/2,j=Geo$1.metersForTile(h);j.x+=_,j.y-=_;var $=Geo$1.metersForTile(d);$.x+=_,$.y-=_;var _t=Math.abs(g[0]-j.x)+Math.abs(g[1]-j.y),_e=Math.abs(g[0]-$.x)+Math.abs(g[1]-$.y);return(h.center_dist=_t)<(d.center_dist=_e)?-1:_e===_t?0:1}),o.forEach(function(h){return s.loadCoordinate(h)})}},{key:"_keepCoordinate",value:function(o,s){var h=1<arguments.length&&s!==void 0&&s,d=this._visible_coords[o];if(d.z===this._view.center_tile.z)for(var g in this._scene.sources){var _,j,$,_t=this._scene.sources[g];_t.builds_geometry_tiles&&_t.includesTile(d,this._view.lookAtManipulator.getLookAtData().tile_level)&&(_=Tile.normalizedKey(d,_t,this._view.lookAtManipulator.getLookAtData().tile_level))&&!this.hasTile(_)&&((j=h&&this._tile_cache.get(_))||(this._all_visible_tiles_are_cached=!1),$=j||new Tile({source:_t,coords:d,worker:this.getWorkerForTile(d,_t),style_zoom:Utils$1.zoomToTileLevel(d.z),view:this._view,sceneId:this._scene.id}),_t.config.type==="ObjectSource"&&($.syncedAt=_t.getSyncedAt()),this.keepTile($))}}},{key:"loadCoordinate",value:function(o){if(o.z===this._view.center_tile.z)for(var s in this._scene.sources){var h,d=this._scene.sources[s];d.builds_geometry_tiles&&d.includesTile(o,this._view.lookAtManipulator.getLookAtData().tile_level)&&(h=Tile.normalizedKey(o,d,this._view.lookAtManipulator.getLookAtData().tile_level),this.hasTile(h)&&this.buildTile(this._visible_tiles[h]))}}},{key:"buildTile",value:function(o,s){this._building_tiles&&this._building_tiles[o.key]||o.built&&o.generation===this._scene.generation||(this._tileBuildStart(o.key),o.build(this._scene.generation,s))}},{key:"buildTileStylesCompleted",value:function(o){var s=o.tile,h=o.progress;if(this._visible_tiles[s.key]==null)Tile.abortBuild(s,this._scene.id);else if(s.generation!==this._scene.generation)Tile.abortBuild(s,this._scene.id);else{if(s.id<this._visible_tiles[s.key].id)return void Tile.abortBuild(s,this._scene.id);s=this._visible_tiles[s.key].merge(s),h.done&&(s.built=!0),s.buildMeshes(this._scene.styles,h),this.updateTileStates(),this._scene.requestRedraw()}h.done&&this._tileBuildStop(s)}},{key:"buildTileError",value:function(o){this._forgetTile(o.key),Tile.abortBuild(o,this._scene.id)}},{key:"_tileBuildStart",value:function(o){this._is_labeled=!1,this._building_tiles=this._building_tiles||{},this._building_tiles[o]=!0}},{key:"_tileBuildStop",value:function(o){this._building_tiles&&(o.source&&o.source.hasLabeledData()&&(this._update_labels_on_queue_check=!0),delete this._building_tiles[o.key],Task.removeForTile(o.id),this.checkBuildQueue())}},{key:"isReady",value:function(){return this._is_labeled&&!this.isLoadingVisibleTiles()}},{key:"checkBuildQueue",value:function(){this._building_tiles&&Object.keys(this._building_tiles).length!==0||(this._building_tiles=null,this._update_labels_on_queue_check?this._updateLabels():(this._is_labeled=!Task.hasPendingTasks(),this._scene.immediateRedraw()))}},{key:"_removeCachedTilesFilter",value:function(o,s){var h=s.source;return!this._visible_tiles[o]&&(s.generation!==this._scene.generation||h.config.type==="ObjectSource"&&h.getSyncedAt()>s.syncedAt)}}]),e}();function compareTileCoords(e,o){var s=e.coords,h=o.coords;return s.z-h.z||s.x-h.x||s.y-h.y}function roundPrecision(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:2,h=Math.pow(10,s);return Math.round(Math.floor(e*o)/o*h)/h}function getTileByteLength(e){var o=0;for(var s in e.meshes)for(var h=e.meshes[s],d=0;d<h.length;d++){var g=h[d];o+=g.buffer_size;for(var _=0;_<g.textures.length;_++)o+=e.textureManager.getByteLength(g.textures[_])}return o}function getMaxTileCacheSize(){var e=.1;return navigator&&navigator.deviceMemory?e=5*navigator.deviceMemory/100:window&&window.screen&&(e=window.screen.width/512*window.screen.height/512*.03*3,e=Math.min(e,1)),1024*e*1024*1024}var RenderState=function(){function e(o,s){_classCallCheck(this,e),s(o),this.value=o,this.setup=s}return _createClass(e,[{key:"get",value:function(){return this.value}},{key:"set",value:function(o){JSON.stringify(this.value)!==JSON.stringify(o)&&(this.setup(o),this.value=o)}}]),e}(),RenderStateManager=function e(o){_classCallCheck(this,e),this.defaults={},this.defaults.culling=!0,this.defaults.culling_face=o.BACK,this.defaults.blending=!1,this.defaults.blending_src=o.ONE_MINUS_SRC_ALPHA,this.defaults.blending_dst=o.ONE_MINUS_SRC_ALPHA,this.defaults.blending_src_alpha=o.ONE,this.defaults.blending_dst_alpha=o.ONE_MINUS_SRC_ALPHA,this.defaults.depth_write=!0,this.defaults.depth_test=!0,o.depthFunc(o.LESS),this.culling=new RenderState({cull:this.defaults.culling,face:this.defaults.culling_face},function(s){s.cull?(o.enable(o.CULL_FACE),o.cullFace(s.face)):o.disable(o.CULL_FACE)}),this.blending=new RenderState({blend:this.defaults.blending,src:this.defaults.blending_src,dst:this.defaults.blending_dst,src_alpha:this.defaults.blending_src_alpha,dst_alpha:this.defaults.blending_dst_alpha},function(s){s.blend?(o.enable(o.BLEND),s.src_alpha&&s.dst_alpha?o.blendFuncSeparate(s.src,s.dst,s.src_alpha,s.dst_alpha):o.blendFunc(s.src,s.dst)):o.disable(o.BLEND)}),this.depth_write=new RenderState({depth_write:this.defaults.depth_write},function(s){o.depthMask(s.depth_write)}),this.depth_test=new RenderState({depth_test:this.defaults.depth_test},function(s){s.depth_test?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST)})},MediaCapture=function(){function e(){_classCallCheck(this,e),this.canvas=null,this.gl=null,this.screenshot_canvas=null,this.screenshot_context=null,this.queue_screenshot=null,this.video_capture=null}return _createClass(e,[{key:"setCanvas",value:function(o,s){this.canvas=o,this.gl=s}},{key:"screenshot",value:function(o){var s=this,h=(0<arguments.length&&o!==void 0?o:{}).background;return this.queue_screenshot!=null||(this.queue_screenshot={background:h},this.queue_screenshot.promise=new Promise(function(d,g){s.queue_screenshot.resolve=d,s.queue_screenshot.reject=g})),this.queue_screenshot.promise}},{key:"completeScreenshot",value:function(){if(this.queue_screenshot!=null){var o=this.canvas.width,s=this.canvas.height,h=new Uint8Array(o*s*4);this.gl.readPixels(0,0,o,s,this.gl.RGBA,this.gl.UNSIGNED_BYTE,h);for(var d=(d=this.queue_screenshot.background)&&d!=="transparent"?StyleParser.parseColor(d).slice(0,3).map(function(_g){return 255*_g}):null,g=new Uint8ClampedArray(o*s*4),_=0;_<s;_++)for(var j=0;j<o;j++){var $=4*((s-_-1)*o+j),_t=4*(_*o+j),_e=h[3+$];g[0+_t]=255*h[0+$]/_e,g[1+_t]=255*h[1+$]/_e,g[2+_t]=255*h[2+$]/_e,g[3+_t]=_e,d&&(_e/=255,g[0+_t]=g[0+_t]*_e+d[0]*(1-_e),g[1+_t]=g[1+_t]*_e+d[1]*(1-_e),g[2+_t]=g[2+_t]*_e+d[2]*(1-_e),g[3+_t]=255)}this.screenshot_canvas=this.screenshot_canvas||document.createElement("canvas");var _r=this.screenshot_canvas;_r.width=o,_r.height=s,this.screenshot_context=this.screenshot_context||_r.getContext("2d");var _n=this.screenshot_context,_o=new ImageData(g,o,s);_n.putImageData(_o,0,0);for(var ga=_r.toDataURL("image/png"),_l=atob(ga.slice(22)),_f=new Uint8Array(_l.length),_c=0;_c<_l.length;++_c)_f[_c]=_l.charCodeAt(_c);var _p=new Blob([_f],{type:"image/png"});this.queue_screenshot.resolve({url:ga,blob:_p,type:"png"}),this.queue_screenshot=null}}},{key:"startVideoCapture",value:function(){var o=this;if(typeof window.MediaRecorder!="function"||!this.canvas||typeof this.canvas.captureStream!="function")return log("warn","Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser"),!1;if(this.video_capture)return log("warn","Video capture already in progress, call Scene.stopVideoCapture() first"),!1;try{var s=this.video_capture={};s.chunks=[],s.stream=this.canvas.captureStream(),s.options={mimeType:"video/webm"},s.media_recorder=new MediaRecorder(s.stream,s.options),s.media_recorder.ondataavailable=function(h){var d,g;0<h.data.size&&s.chunks.push(h.data),s.resolve&&(g=createObjectURL(d=new Blob(s.chunks,{type:s.options.mimeType})),s.stream&&(s.stream.getTracks()||[]).forEach(function(_){_.stop(),s.stream.removeTrack(_)}),s.stream=null,s.media_recorder=null,o.video_capture=null,s.resolve({url:g,blob:d,type:"webm"}))},s.media_recorder.start()}catch(h){return this.video_capture=null,log("error","Scene video capture failed",h),!1}return!0}},{key:"stopVideoCapture",value:function(){var o=this;return this.video_capture?(this.video_capture.promise=new Promise(function(s,h){o.video_capture.resolve=s,o.video_capture.reject=h}),this.video_capture.media_recorder.stop(),this.video_capture.promise):(log("warn","No scene video capture in progress, call Scene.startVideoCapture() first"),Promise.resolve({}))}}]),e}(),SceneWorker=function(){function e(){_classCallCheck(this,e),this.sources={},this.styles={},this.layers={},this.tiles={},this._isConfigured=!1}return _createClass(e,[{key:"init",value:function(o,s,h,d,g,_,j){return this.setMeshVariantMaxLife(j),this.scene_id=o,this.textureManager=getTextureManager(o),this._worker_id=s,log.setLevel(h),Utils$1.device_pixel_ratio=d,VertexElements.setElementIndexUint(g),FeatureSelection.setPrefix(this._worker_id),this._style_manager=new StyleManager,this._importExternalScripts(_),Label.id_prefix=s,this._isConfigured=!1,s}},{key:"dispose",value:function(){this._last_config_sources=null,this._config_sources=null,this.sources=null,this._style_manager=null,this.styles=null,this.layers=null,this.tiles=null}},{key:"_importExternalScripts",value:function(o){var s;o.length!==0&&(log("debug","loading custom data source scripts in worker:",o),s=Object.getOwnPropertyNames(window),importScripts.apply(void 0,_toConsumableArray(o)),Object.getOwnPropertyNames(window).forEach(function(h){s.indexOf(h)===-1&&(self[h]=window[h])}))}},{key:"updateConfig",value:function(o,s){var g=o.config,h=o.generation,d=o.introspection,g=JSON.parse(g);for(var _ in mergeDebugSettings(s),this._generation=h,this._isConfigured=!1,g.layers)g.layers[_]&&(g.layers[_].data=Utils$1.stringsToFunctions(g.layers[_].data));this.global=Utils$1.stringsToFunctions(g.global),this._createDataSources(g),g.styles=Utils$1.stringsToFunctions(g.styles,StyleParser.wrapFunction),this.styles=this._style_manager.build(g.styles),self.is_fake_worker=Thread.is_main,this._style_manager.initStyles({generation:this._generation,styles:this.styles,sources:this.sources,introspection:d,id:this.scene_id}),delete self.is_fake_worker,this.layers=parseLayers(g.layers,this._style_manager.styles),this._configuring=this._syncTextures(g.textures)}},{key:"setMeshVariantMaxLife",value:function(o){this.meshVariantMaxLife=o}},{key:"_createDataSources",value:function(o){var s=this;this._last_config_sources=this._config_sources||{},this._config_sources=o.sources;var h=this.sources,d=[];for(var g in o.sources=Utils$1.stringsToFunctions(o.sources),this.sources={},self.is_fake_worker=Thread.is_main,o.sources)if(JSON.stringify(this._last_config_sources[g])!==JSON.stringify(o.sources[g])){var _=void 0;try{_=DataSource.create(Object.assign({},o.sources[g],{name:g}),this.sources)}catch(j){log("error","Error creating source.",j.message,o.sources[g]);continue}_&&(this.sources[g]=_,d.push(g))}else this.sources[g]=h[g];delete self.is_fake_worker,d.forEach(function(j){for(var $ in s.tiles)s.tiles[$].source===j&&delete s.tiles[$]})}},{key:"awaitConfiguration",value:function(){return this._configuring}},{key:"_onConfig",value:function(o){var s=this;if((this._isConfigured=!0)!==o.loaded)o.loading=!0,o.loaded=!1,o.error=null,this._loadTileSourceData(o).then(function(){if(s.getTile(o.id)){o.loading=!1,o.loaded=!0;try{Tile.buildGeometry(o,s)}catch(h){o.error=h.toString(),WorkerBroker.postMessage("TileManager_".concat(s.scene_id,".buildTileError"),Tile.slice(o))}}else log("trace","stop tile build after data source load because tile was removed. Key: ".concat(o.key,", id: ").concat(o.id))},function(h){o.loading=!1,o.loaded=!1,o.error=h.stack,log("error","tile load error for tile with key ".concat(o.key," and id ").concat(o.id,": ").concat(o.error)),WorkerBroker.postMessage("TileManager_".concat(s.scene_id,".buildTileError"),Tile.slice(o))});else{log("trace","used worker cache for tile with key ".concat(o.key," and id ").concat(o.id));try{Tile.buildGeometry(o,this)}catch(h){o.error=h.toString(),WorkerBroker.postMessage("TileManager_".concat(this.scene_id,".buildTileError"),Tile.slice(o))}}}},{key:"buildTile",value:function(o){var s,h=o.tile,d=this.getTile(h.id);d&&d.loading||(h=this.tiles[h.id]=Object.assign(d||{},h),this._isConfigured?this._onConfig(h):(s=this).awaitConfiguration().then(function(){return s._onConfig(h)}))}},{key:"_loadTileSourceData",value:function(o){return this.sources[o.source]?this.sources[o.source].load(o):(o.source_data={},Promise.resolve(o))}},{key:"getTile",value:function(o){return this.tiles[o]}},{key:"removeTile",value:function(o){var s=this.tiles[o];s!=null&&(s.loading===!0&&(log("trace","cancel tile load for tile id ".concat(o)),s.loading=!1,Tile.cancel(s)),delete this.tiles[o],log("trace","remove tile from cache, tile id: ".concat(o)))}},{key:"queryFeatures",value:function(o){var s=this,h=o.filter,d=o.visible,g=o.geometry,_=o.tile_ids,j=[],$=_.map(function(_t){return s.tiles[_t]}).filter(function(_t){return _t});return h!=null&&(h=-1<["{","["].indexOf(h[0])?JSON.parse(h):h,h=Utils$1.stringsToFunctions(h,StyleParser.wrapFunction)),h=buildFilter(h,FilterOptions),$.forEach(function(_t){for(var _e in _t.source_data.layers)(function(_r){_t.source_data.layers[_r].features.forEach(function(_n){var _o,ga;d===!0&&_n.generation!==s._generation||d===!1&&_n.generation===s._generation||((_o=StyleParser.getFeatureParseContext(_n,_t,s.global)).source=_t.source,_o.layer=_r,h(_o)&&(ga={type:_n.type,properties:_n.properties},g===!0&&(ga.geometry=Geo$1.copyGeometry(_n.geometry),Geo$1.tileSpaceToLatlng(ga.geometry,_t.coords.z,_t.min)),j.push(ga)))})})(_e)}),j}},{key:"resetFeatureSelection",value:function(){FeatureSelection.reset()}},{key:"_syncTextures",value:function(o){var s=[];return o&&s.push.apply(s,_toConsumableArray(Object.keys(o))),log("trace","sync textures to worker:",s),0<s.length?this.textureManager.syncTexturesToWorker(s):Promise.resolve()}},{key:"profile",value:function(o){console.profile("worker ".concat(this._worker_id,": ").concat(o))}},{key:"profileEnd",value:function(o){console.profileEnd("worker ".concat(this._worker_id,": ").concat(o))}},{key:"terminate",value:function(){this.dispose()}}]),e}();(Thread.is_worker||self.H&&self.H.DEBUG)&&WorkerBroker.addTarget("self",new SceneWorker);var Scene=function(){function e(o,s){_classCallCheck(this,e),s=s||{},subscribeMixin(this),this.id=e.id++,this.textureManager=getTextureManager(this.id),this.initialized=!1,this.initializing=null,this.sources={},this.view=new View(this,s),this.tile_manager=new TileManager({scene:this,view:this.view}),this.num_workers=s.numWorkers||2,s.disableVertexArrayObjects===!0&&(VertexArrayObject.disabled=!0),Utils$1.device_pixel_ratio=s.devicePixelRatio,this.config=null,this.config_source=o,this.config_bundle=null,this.last_valid_config_source=null,this.styles=null,this.style_manager=new StyleManager,this.building=null,this.dirty=!0,s.preUpdate&&this.subscribe({pre_update:s.preUpdate}),s.postUpdate&&this.subscribe({post_update:s.postUpdate}),this.render_loop=!s.disableRenderLoop,this.render_loop_active=!1,this.render_loop_stop=!1,this.render_count=0,this.last_render_count=0,this.render_count_changed=!1,this.frame=0,this.last_main_render=-1,this.last_selection_render=-1,this.media_capture=new MediaCapture,this.selection=null,this.introspection=s.introspection===!0,this.viewport=s.viewport,this.adjustMeshVariantMaxLife(),this.container=s.container,this.canvas=null,this.contextOptions=s.webGLContextOptions,this.lights=null,this.background=null,this.createListeners(),this.updating=0,this.generation=e.generation,this.last_complete_generation=e.generation,this.log_level=s.logLevel||"warn",log.setLevel(this.log_level),log.reset()}return _createClass(e,[{key:"load",value:function(o,s){var h=this,d=0<arguments.length&&o!==void 0?o:null,g=1<arguments.length&&s!==void 0?s:{};return this.initializing||(log.reset(),this.updating++,this.initialized=!1,this.initial_build_time=null,(g=typeof g=="string"?{base_path:g}:g).blocking=g.blocking===void 0||g.blocking,this.render_loop!==!1&&this.setupRenderLoop(),this.createCanvas(),this.textureManager.destroy(this.gl),this.initializing=this.loadScene(d,g).then(function(){return h.createWorkers()}).then(function(){h.resetFeatureSelection();var _=_typeof(h.config_source)==="object"||h.hasSubscribersFor("load"),j=h.updateConfig({serialize_funcs:_,normalize:!1,load_event:!0,fade_in:!0});if(g.blocking===!0)return j}).then(function(){h.updating--,h.initializing=null,h.initialized=!0,h.last_valid_config_source=h.config_source,h.last_valid_options={base_path:g.base_path,file_type:g.file_type},h.requestRedraw()}).catch(function(_){var j,$;if(h.initializing=null,h.updating=0,$=_.name==="YAMLException"?(j="yaml","Error parsing scene YAML"):"Error initializing scene",h.trigger("error",{type:j,message:$,error:_,url:h.config_source}),$="Scene.load() failed to load ".concat(h.config_source,": ").concat(_.message),h.last_valid_config_source)return log("warn",$,_),log("info","Scene.load() reverting to last valid configuration"),h.load(h.last_valid_config_source,h.last_valid_base_path);throw log("error",$,_),_})),this.initializing}},{key:"destroy",value:function(){var o;this.initialized=!1,this.render_loop_stop=!0,this.destroyListeners(),this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.container=null,this.selection&&this.selection.destroy(),this.gl&&(this.textureManager.destroy(this.gl),this.style_manager.destroy(this.gl),this.styles={},ShaderProgram.reset(),(o=this.gl.getExtension("WEBGL_lose_context"))&&o.loseContext(),this.gl=null),this.sources={},this.tile_manager.destroy(),this.tile_manager=null,this.destroyWorkers(),log.reset()}},{key:"createCanvas",value:function(){if(!this.canvas){this.container=this.container||document.body,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top=0,this.canvas.style.left=0,this.container.style.backgroundColor="transparent",this.container.appendChild(this.canvas);try{this.gl=Context$1.getContext(this.canvas,Object.assign({alpha:!0,premultipliedAlpha:!1,stencil:!0,device_pixel_ratio:Utils$1.device_pixel_ratio},this.contextOptions))}catch{throw new Error("Couldn't create WebGL context. Your browser may not support WebGL, or it's turned off? Visit http://webglreport.com/ for more info.")}this.handleViewportUpdate(),VertexArrayObject.init(this.gl),this.render_states=new RenderStateManager(this.gl),this.media_capture.setCanvas(this.canvas,this.gl)}}},{key:"getWorkerUrl",value:function(){var o,s;if(__worker_src__!==void 0&&(s="("+__worker_src__+")()",__worker_src_origin__&&__worker_src_map__!==""&&(s+=`
//# sourceMappingURL=`+__worker_src_origin__.slice(0,__worker_src_origin__.lastIndexOf("/")+1)+__worker_src_map__),o=createObjectURL(new Blob([s],{type:"application/javascript"}))),!o)throw new Error("Couldn't find internal Tangram source variable (may indicate the library did not build correctly)");return o}},{key:"updateExternalScripts",value:function(){var o=_toConsumableArray(this.external_scripts||[]),s=[];if(this.config.scene.scripts)for(var h in this.config.scene.scripts)s.indexOf(this.config.scene.scripts[h])===-1&&s.push(this.config.scene.scripts[h]);for(var d in this.config.sources){var g=this.config.sources[d];if(g.scripts)for(var _ in g.scripts)s.indexOf(g.scripts[_])===-1&&s.push(g.scripts[_])}return this.external_scripts=s,!(this.external_scripts.length===o.length&&this.external_scripts.every(function(j,$){return j===o[$]}))}},{key:"createWorkers",value:function(){return this.updateExternalScripts()&&this.destroyWorkers(),this._workers?Promise.resolve():this.makeWorkers(this.getWorkerUrl())}},{key:"makeWorkers",value:function(o){var s=this,h=!!this.gl.getExtension("OES_element_index_uint"),d=[];this._workers=[];for(var g=0;g<this.num_workers;g++)(function(){var j=new Worker(o);s._workers[g]=j,WorkerBroker.addWorker(j),log("debug","Scene.makeWorkers: initializing worker ".concat(g));var $=g;d.push(WorkerBroker.postMessage(j,"self.init",s.id,g,s.log_level,Utils$1.device_pixel_ratio,h,s.external_scripts,s.meshVariantMaxLife).then(function(_t){return log("debug","Scene.makeWorkers: initialized worker ".concat(_t)),_t},function(_t){return log("error","Scene.makeWorkers: failed to initialize worker ".concat($,":"),_t),Promise.reject(_t)}))})();var _=new SceneWorker;return this._workers.push(_),d.push(_.init(this.id,g,this.log_level,Utils$1.device_pixel_ratio,h,[],this.meshVariantMaxLife)),this.next_worker=0,Promise.all(d).then(function(){log.setWorkers(s._workers.slice(0,s.num_workers)),revokeObjectURL(o)})}},{key:"getWorkers",value:function(o){return this._workers.filter(function(s){switch(o){case WorkerType.NATIVE:return s instanceof Worker;case WorkerType.FAKE:return s instanceof SceneWorker;default:return!0}})}},{key:"destroyWorkers",value:function(){this.selection=null,Array.isArray(this._workers)&&(log.setWorkers(null),this._workers.forEach(function(o){o.terminate()}),this._workers=null)}},{key:"ready",value:function(){return!(!this.view.ready()||Object.keys(this.sources).length===0)}},{key:"handleViewportUpdate",value:function(){var o=this.viewport,s=o.width,h=o.height;0<s&&0<h&&(this.dirty=!0,this.view.handleViewportUpdate(),this.gl&&Context$1.resize(this.gl,s,h,Utils$1.device_pixel_ratio)),this.adjustMeshVariantMaxLife()&&this.syncMeshVariantMaxLife()}},{key:"adjustMeshVariantMaxLife",value:function(){var o=this.viewport,s=o.width,h=o.height,d=Utils$1.device_pixel_ratio,g=s/d/256*(h/d/256),_=Math.max(Math.ceil(2*g),8);if(this.meshVariantMaxLife!==_)return this.meshVariantMaxLife=_,!0}},{key:"syncMeshVariantMaxLife",value:function(){this._workers&&WorkerBroker.postMessage(this._workers,"self.setMeshVariantMaxLife",this.meshVariantMaxLife)}},{key:"requestRedraw",value:function(){this.dirty=!0}},{key:"immediateRedraw",value:function(){this.dirty=!0,this.update()}},{key:"renderLoop",value:function(){this.render_loop_active=!0,this.initialized&&this.update(),Task.setState({user_moving_view:this.view.user_input_active}),Task.processAll(),this.render_loop_stop?(this.render_loop_stop=!1,this.render_loop_active=!1):window.requestAnimationFrame(this.renderLoop.bind(this))}},{key:"setupRenderLoop",value:function(){var o=this;this.render_loop_active||setTimeout(function(){o.renderLoop()},0)}},{key:"update",value:function(){var o=this.dirty,s=!!this.selection&&this.selection.hasPendingRequests(),h=!(o===!1&&s===!1||this.initialized===!1||0<this.updating||this.ready()===!1);return this.trigger("pre_update",h),this.view.update(),h&&(this.dirty=!1,this.render({main:o,selection:s}),this.updateViewComplete(),this.media_capture.completeScreenshot(),this.trigger("post_update",h),this.animated!==!0&&!this.view.isAnimating()||(this.dirty=!0),this.frame++,log("trace","Scene.render()"),!0)}},{key:"render",value:function(o){var s=this,h=o.main,d=o.selection,g=this.gl;if(Object.keys(this.lights).forEach(function(_){return s.lights[_].update()}),h&&(this.render_count=this.renderPass(),this.last_main_render=this.frame),d){if(this.view.panning||this.view.user_input_active)return void this.selection.clearPendingRequests();(this.last_selection_render<this.last_main_render||this.selection.has_dirty_buffer)&&(this.selection.bind(),this.renderPass("selection_program",{allow_blend:!1}),g.bindFramebuffer(g.FRAMEBUFFER,null),g.viewport(0,0,this.canvas.width,this.canvas.height),g.clearColor.apply(g,_toConsumableArray(this.background.color)),this.last_selection_render=this.frame,this.selection.has_dirty_buffer=!1),this.selection.read(this.tile_manager.getRenderableTiles()),this.selection.has_dirty_buffer&&this.render({main:!1,selection:d})}return this.render_count_changed=!1,this.render_count!==this.last_render_count&&(this.render_count_changed=!0),this.last_render_count=this.render_count,!0}},{key:"renderPass",value:function(o,s){var h=this,d=0<arguments.length&&o!==void 0?o:"program",_=(1<arguments.length&&s!==void 0?s:{}).allow_blend,g=this.gl,_=_==null||_;this.clearFrame();for(var j,$=Style.sortByBlendOrderWithinLayers(this.tile_manager.getActiveStyles().map(function(_c){return h.styles[_c]}).filter(function(_c){return _c})),_t=0,_e=0,_r=0;_r<$.length;_r++){var _n,_o,ga=$[_r],_l=_e-(_n=parseInt(ga.name));(ga.clean_depth||_l)&&(this.render_states.depth_write.value.depth_write?g.clear(g.DEPTH_BUFFER_BIT):(g.depthMask(!0),g.clear(g.DEPTH_BUFFER_BIT),g.depthMask(!1)),_l&&(_e=_n)),ga.blend!==j&&(_o=Object.assign({},Style.render_states[ga.blend],{blend:_&&ga.blend}),this.setRenderState(_o));var _f=ga.blend==="translucent"&&d==="program";_f&&(this.gl.colorMask(!1,!1,!1,!1),this.renderStyle(ga.name,d),this.gl.colorMask(!0,!0,!0,!0),this.gl.depthFunc(this.gl.EQUAL),this.gl.enable(this.gl.STENCIL_TEST),this.gl.clear(this.gl.STENCIL_BUFFER_BIT),this.gl.stencilFunc(this.gl.EQUAL,this.gl.ZERO,255),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.INCR)),_t+=this.renderStyle(ga.name,d),_f&&(this.gl.disable(this.gl.STENCIL_TEST),this.gl.depthFunc(this.gl.LESS)),j=ga.blend}return _t}},{key:"renderStyle",value:function(o,s){for(var h,d=this,g=this.styles[o],_=!0,j=0,$=this.tile_manager.getRenderableTiles(),_t=Math.max.apply(Math,_toConsumableArray($.map(function(_n){return _n.meshes[o]?Math.max.apply(Math,_toConsumableArray(_n.meshes[o].map(function(_o){return _o.variant.order}))):-1}))),_e=0;_e<_t+1;_e++){var _r=function(_n){for(var _o=0;_o<$.length;_o++){var ga=$[_o];if(ga.meshes[o]!=null&&ga.shouldProxyForStyle(o))for(var _l=ga.meshes[o].filter(function(_g){return _g.variant.order===_n}),_f=0,_c=_l.length;_f<_c;_f+=1){var _p=_l[_f];if(_===!0&&(_=!1,!(h=d.setupStyle(g,s))))return{v:0};d.view.setupTile(ga,h),d.selection.setupDiscards(h),g.render(_p)&&d.requestRedraw(),j+=_p.geometry_count}}}(_e);if(_typeof(_r)==="object")return _r.v}return j}},{key:"setupStyle",value:function(o,s){var h;try{if(!(h=o.getProgram(s)))return}catch{return void this.trigger("warning",{type:"styles",message:"Error compiling style ".concat(o.name),style:o,shader_errors:o.program&&o.program.shader_errors})}for(var d in h.use(),o.setup(),this.view.setupProgram(h),this.lights)this.lights[d].setupProgram(h);return h}},{key:"clearFrame",value:function(){this.initialized&&(this.render_states.depth_write.set({depth_write:!0}),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT))}},{key:"setRenderState",value:function(o){var s,h,d=0<arguments.length&&o!==void 0?o:{},g=d.depth_test,_=d.depth_write,j=d.cull_face,$=d.blend;this.initialized&&(s=this.render_states,g=g!==!1&&s.defaults.depth_test,_=_!==!1&&s.defaults.depth_write,j=j!==!1&&s.defaults.culling,$=$??s.defaults.blending,h=this.gl,s.depth_test.set({depth_test:g}),s.depth_write.set({depth_write:_}),s.culling.set({cull:j,face:s.defaults.culling_face}),!$||$==="opaque"?s.blending.set({blend:!1}):$==="overlay"||$==="inlay"||$==="translucent"?s.blending.set({blend:!0,src:h.SRC_ALPHA,dst:h.ONE_MINUS_SRC_ALPHA,src_alpha:h.ONE,dst_alpha:h.ONE_MINUS_SRC_ALPHA}):$==="add"?s.blending.set({blend:!0,src:h.ONE,dst:h.ONE}):$==="multiply"&&s.blending.set({blend:!0,src:h.ZERO,dst:h.SRC_COLOR}))}},{key:"getFeatureAt",value:function(o,s,h){var d,g=s.radius,_=s.top_most_only;this.initialized?(d={x:o.x/this.view.size.css.width,y:o.y/this.view.size.css.height},g=0<g?{x:g/this.view.size.css.width,y:g/this.view.size.css.height}:null,this.selection.getFeatureAt(d,{radius:g,top_most_only:_},h)):log("debug","Scene.getFeatureAt() called before scene was initialized")}},{key:"queryFeatures",value:function(o){var s=0<arguments.length&&o!==void 0?o:{},_r=s.filter,h=s.unique,d=h===void 0||h,g=s.group_by,_=g===void 0?null:g,j=s.visible,$=j===void 0?null:j,_t=s.geometry,_e=_t!==void 0&&_t,_r=Utils$1.serializeWithFunctions(_r),_n=this.tile_manager.getRenderableTiles().map(function(_o){return _o.id});return WorkerBroker.postMessage(this._workers,"self.queryFeatures",{filter:_r,visible:$,geometry:_e,tile_ids:_n}).then(function(_o){var ga=[],_l={},_f={},_c=(d=typeof d=="string"?[d]:d)&&function(_g){return JSON.stringify(Array.isArray(d)?sliceObject(_g,d):_g)},_p=(_=(typeof _=="string"||Array.isArray(_))&&_)&&function(_g){return Array.isArray(_)?JSON.stringify(sliceObject(_g,_)):_g[_]};return _o.forEach(function(_g){return _g.forEach(function(ty){if(_c){var oy=_c(ty);if(_l[oy])return;_l[oy]=!0}var ry;_p?(ry=_p(ty.properties),_f[ry]=_f[ry]||[],_f[ry].push(ty)):ga.push(ty)})}),_p?_f:ga})}},{key:"loadScene",value:function(o,s){var h=this,d=0<arguments.length&&o!==void 0?o:null,g=1<arguments.length&&s!==void 0?s:{},_=g.base_path,j=g.file_type;return this.config_source=d||this.config_source,typeof this.config_source=="string"?this.base_path=pathForURL(_||this.config_source):this.base_path=pathForURL(_),this.config_path=this.base_path,SceneLoader$1.loadScene(this.config_source,{path:this.base_path,type:j}).then(function($){var _t=$.config,_e=$.bundle;return h.config=_t,h.config_bundle=_e,h.config})}},{key:"createDataSources",value:function(){var o=this,s=[],h=Object.keys(this.sources),d=0;for(var g in this.config.sources){var _=this.config.sources[g],j=this.sources[g];try{var $=Object.assign({},_,{name:g,id:d++});if(this.sources[g]=DataSource.create($,this.sources),!this.sources[g])throw{}}catch(_n){delete this.sources[g];var _t="Could not create data source: ".concat(_n.message);log("warn","Scene: ".concat(_t),_),this.trigger("warning",{type:"sources",source:_,message:_t})}DataSource.sameConfig(this.sources[g],j)||s.push(g)}for(var _e in h.forEach(function(_n){o.config.sources[_n]||(delete o.sources[_n],s.push(_n))}),0<s.length&&this.tile_manager.removeTiles(function(_n){return-1<s.indexOf(_n.source.name)}),this.config.layers){var _r=this.config.layers[_e];_r.enabled!==!1&&_r.data&&this.sources[_r.data.source]&&(this.sources[_r.data.source].builds_geometry_tiles=!0)}}},{key:"loadTextures",value:function(){var o=this;return this.textureManager.createFromObject(this.gl,this.config.textures).then(function(){return o.textureManager.createDefault(o.gl)})}},{key:"updateStyles",value:function(){if(!this.initialized&&!this.initializing)throw new Error("Scene.updateStyles() called before scene was initialized");for(var o in this.styles=this.style_manager.build(this.config.styles),this.style_manager.initStyles(this),this.styles)this.styles[o].setGL(this.gl);this.dirty=!0}},{key:"createLights",value:function(){for(var o in this.lights={},this.config.lights){var s;this.config.lights[o]&&_typeof(this.config.lights[o])==="object"&&((s=this.config.lights[o]).name=o.replace("-","_"),s.visible=s.visible!==!1,s.visible&&(this.lights[s.name]=Light.create(this.view,s)))}Light.inject(this.lights)}},{key:"setBackground",value:function(){var o,s=this.config.scene.background;this.background={},s&&s.color&&(this.background.color=StyleParser.parseColor(s.color)),this.background.color||(this.background.color=[0,0,0,0]),this.background.color[3]===1?this.canvas.style.backgroundColor="rgba(".concat(this.background.color.map(function(h){return Math.floor(255*h)}).join(", "),")"):this.canvas.style.backgroundColor="transparent",(o=this.gl).clearColor.apply(o,_toConsumableArray(this.background.color))}},{key:"setIntrospection",value:function(o){var s=this;return o!==this.introspection?(this.introspection=o||!1,this.updating++,this.updateConfig({normalize:!1}).then(function(){return s.updating--})):Promise.resolve()}},{key:"updateConfig",value:function(o){var s=0<arguments.length&&o!==void 0?o:{},h=s.load_event,d=h!==void 0&&h,g=s.serialize_funcs,_=s.normalize,j=_===void 0||_;s.fade_in,this.generation=++e.generation,this.updating++,this.config=SceneLoader$1.applyGlobalProperties(this.config),j?SceneLoader$1.normalize(this.config,this.config_bundle):(SceneLoader$1.hoistStyleShaderUniformTextures(this.config,this.config_bundle,{include_globals:!0}),SceneLoader$1.normalizeTextures(this.config,this.config_bundle)),this.trigger(d?"load":"update",{config:this.config}),this.style_manager.init(),this.createLights(),this.createDataSources(),this.loadTextures(),this.setBackground(),FontManager.loadFonts(this.config.fonts),this.updateStyles();var $=this.syncConfigToWorker({serialize_funcs:g});return this.updating--,this.view.updateBounds(),this.requestRedraw(),$}},{key:"syncConfigToWorker",value:function(o){var s=(0<arguments.length&&o!==void 0?o:{}).serialize_funcs,h=s===void 0||s?Utils$1.serializeWithFunctions(this.config):JSON.stringify(this.config);return WorkerBroker.postMessage(this._workers,"self.updateConfig",{config:h,generation:this.generation,introspection:this.introspection},debugSettings$1)}},{key:"createListeners",value:function(){var o=this;this.listeners={},this.listeners.view={move:function(){return o.trigger("move")}},this.view.subscribe(this.listeners.view),this.listeners.texture={update:function(){return o.dirty=!0},warning:function(s){return o.trigger("warning",Object.assign({type:"textures"},s))}},this.textureManager.subscribe(this.listeners.texture),this.listeners.scene_loader={error:function(s){return o.trigger("error",Object.assign({type:"scene"},s))}},SceneLoader$1.subscribe(this.listeners.scene_loader)}},{key:"destroyListeners",value:function(){this.unsubscribeAll(),this.view.unsubscribe(this.listeners.view),this.textureManager.unsubscribe(this.listeners.texture),SceneLoader$1.unsubscribe(this.listeners.scene_loader),this.listeners=null}},{key:"resetFeatureSelection",value:function(){this.selection?this._workers&&WorkerBroker.postMessage(this._workers,"self.resetFeatureSelection"):this.selection=new FeatureSelection(this.gl,this.id)}},{key:"updateViewComplete",value:function(){(this.render_count_changed||this.generation!==this.last_complete_generation)&&this.tile_manager.isReady()&&(this.last_complete_generation=this.generation,this.trigger("view_complete"))}},{key:"resetViewComplete",value:function(){this.last_complete_generation=null}},{key:"screenshot",value:function(o){var s=(0<arguments.length&&o!==void 0?o:{}).background,h=s===void 0?"white":s;return this.requestRedraw(),this.media_capture.screenshot({background:h})}},{key:"pixelRatio",value:function(){return Utils$1.device_pixel_ratio}},{key:"startVideoCapture",value:function(){return this.requestRedraw(),this.media_capture.startVideoCapture()}},{key:"stopVideoCapture",value:function(){return this.media_capture.stopVideoCapture()}},{key:"_profile",value:function(o){console.profile("main thread: ".concat(o)),WorkerBroker.postMessage(this._workers,"self.profile",o)}},{key:"_profileEnd",value:function(o){console.profileEnd("main thread: ".concat(o)),WorkerBroker.postMessage(this._workers,"self.profileEnd",o)}},{key:"getCameraMatrix",value:function(){return this.view.lookAtManipulator.getCameraMatrix()}},{key:"animated",get:function(){var o=this;return this.config.scene.animated!==void 0?this.config.scene.animated:this.tile_manager.getActiveStyles().some(function(s){return o.styles[s]&&o.styles[s].animated})}}],[{key:"create",value:function(o,s){return new e(o,1<arguments.length&&s!==void 0?s:{})}}]),e}();Scene.id=0,Scene.generation=0;var RemoteTexture=function(){_inherits(o,Texture);var e=_createSuper(o);function o(s,h,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};_classCallCheck(this,o);var _=Math.pow(2,g.coords.z),j=Math.abs(Math.floor(g.coords.x/_)),$=Math.abs(_*j-Math.abs(g.coords.x)),_t=g.coords;return g.coords={x:$,y:_t.y,z:_t.z},e.call(this,s,h,d,g)}return _createClass(o,[{key:"load",value:function(s){var h=this;if(!s||!s.uid)return _get(_getPrototypeOf(o.prototype),"load",this).call(this,s);var d=s.coords,g=new Uint8Array([0,0,0,0]);return this.loading=new Promise(function(_,j){var $=H.map.DataModel.invoke(s.uid,"requestTileAsPromise",[d.x,d.y,d.z])||null;$?$.then(function(_t){var _e=_t.data;h.loaded=!0,_e&&!(_e instanceof ArrayBuffer)&&(_e.tagName.toUpperCase()==="IMG"||_e.tagName.toUpperCase()==="CANVAS")?h.setElement(_e,s):h.setData(1,1,g,{filtering:"nearest"})},function(){h.loaded=!1}).then(_,function(_t){return j(_t)}):j(new Error("Unable to invoke on target "+s.uid))}),this.loading}}]),o}();TextureManager.register(RemoteTexture,function(e){return e&&e.uid}),self.H=self.H||{},self.H.gl={DataSource,Geo:Geo$1,MathUtils:MathUtils$1,Scene,Task,Tile,WorkerBroker,log,SceneLoader:SceneLoader$1,yaml:jsYaml$1}}()};f()}(),this.H=this.H||{},this.H.venues=function(e){function o(ey,_u){var _s,_a,_u=(_u=_u===void 0?{}:_u).insertAt;ey&&typeof document<"u"&&(_s=document.head||document.getElementsByTagName("head")[0],(_a=document.createElement("style")).type="text/css",_u==="top"&&_s.firstChild?_s.insertBefore(_a,_s.firstChild):_s.appendChild(_a),_a.styleSheet?_a.styleSheet.cssText=ey:_a.appendChild(document.createTextNode(ey)))}function s(ey,_i){var _s,_a=Object.keys(ey);return Object.getOwnPropertySymbols&&(_s=Object.getOwnPropertySymbols(ey),_i&&(_s=_s.filter(function(_u){return Object.getOwnPropertyDescriptor(ey,_u).enumerable})),_a.push.apply(_a,_s)),_a}function h(ey){for(var _i=1;_i<arguments.length;_i++){var _s=arguments[_i]!=null?arguments[_i]:{};_i%2?s(Object(_s),!0).forEach(function(_a){_e(ey,_a,_s[_a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ey,Object.getOwnPropertyDescriptors(_s)):s(Object(_s)).forEach(function(_a){Object.defineProperty(ey,_a,Object.getOwnPropertyDescriptor(_s,_a))})}return ey}function d(){d=function(){return ey};var ey={},_i=Object.prototype,_s=_i.hasOwnProperty,Fy=typeof Symbol=="function"?Symbol:{},_a=Fy.iterator||"@@iterator",_u=Fy.asyncIterator||"@@asyncIterator",_d=Fy.toStringTag||"@@toStringTag";function ny(Sy,jy,Yy){return Object.defineProperty(Sy,jy,{value:Yy,enumerable:!0,configurable:!0,writable:!0}),Sy[jy]}try{ny({},"")}catch{ny=function(jy,Yy,Uy){return jy[Yy]=Uy}}function sy(Sy,E0,Yy,N0){var Xy,u0,e0,M0,E0=E0&&E0.prototype instanceof dy?E0:dy,E0=Object.create(E0.prototype),N0=new Ry(N0||[]);return E0._invoke=(Xy=Sy,u0=Yy,e0=N0,M0="suspendedStart",function(j0,G0){if(M0==="executing")throw new Error("Generator is already running");if(M0==="completed"){if(j0==="throw")throw G0;return Jy()}for(e0.method=j0,e0.arg=G0;;){var b0=e0.delegate;if(b0&&(b0=function _0(Y0,x0){var o1=Y0.iterator[x0.method];if(o1===void 0){if(x0.delegate=null,x0.method==="throw"){if(Y0.iterator.return&&(x0.method="return",x0.arg=void 0,_0(Y0,x0),x0.method==="throw"))return uy;x0.method="throw",x0.arg=new TypeError("The iterator does not provide a 'throw' method")}return uy}return o1=ay(o1,Y0.iterator,x0.arg),o1.type==="throw"?(x0.method="throw",x0.arg=o1.arg,x0.delegate=null,uy):(o1=o1.arg,o1?o1.done?(x0[Y0.resultName]=o1.value,x0.next=Y0.nextLoc,x0.method!=="return"&&(x0.method="next",x0.arg=void 0),x0.delegate=null,uy):o1:(x0.method="throw",x0.arg=new TypeError("iterator result is not an object"),x0.delegate=null,uy))}(b0,e0),b0)){if(b0===uy)continue;return b0}if(e0.method==="next")e0.sent=e0._sent=e0.arg;else if(e0.method==="throw"){if(M0==="suspendedStart")throw M0="completed",e0.arg;e0.dispatchException(e0.arg)}else e0.method==="return"&&e0.abrupt("return",e0.arg);if(M0="executing",b0=ay(Xy,u0,e0),b0.type==="normal"){if(M0=e0.done?"completed":"suspendedYield",b0.arg===uy)continue;return{value:b0.arg,done:e0.done}}b0.type==="throw"&&(M0="completed",e0.method="throw",e0.arg=b0.arg)}}),E0}function ay(Sy,jy,Yy){try{return{type:"normal",arg:Sy.call(jy,Yy)}}catch(Uy){return{type:"throw",arg:Uy}}}ey.wrap=sy;var uy={};function dy(){}function my(){}function _y(){}var Fy={},Vy=(ny(Fy,_a,function(){return this}),Object.getPrototypeOf),Vy=Vy&&Vy(Vy(Dy([]))),Iy=(Vy&&Vy!==_i&&_s.call(Vy,_a)&&(Fy=Vy),_y.prototype=dy.prototype=Object.create(Fy));function Ky(Sy){["next","throw","return"].forEach(function(jy){ny(Sy,jy,function(Yy){return this._invoke(jy,Yy)})})}function zy(Sy,jy){var Yy;this._invoke=function(Uy,Xy){function u0(){return new jy(function(e0,M0){(function E0(Y0,j0,G0,b0){var _0,Y0=ay(Sy[Y0],Sy,j0);if(Y0.type!=="throw")return(j0=(_0=Y0.arg).value)&&typeof j0=="object"&&_s.call(j0,"__await")?jy.resolve(j0.__await).then(function(x0){E0("next",x0,G0,b0)},function(x0){E0("throw",x0,G0,b0)}):jy.resolve(j0).then(function(x0){_0.value=x0,G0(_0)},function(x0){return E0("throw",x0,G0,b0)});b0(Y0.arg)})(Uy,Xy,e0,M0)})}return Yy=Yy?Yy.then(u0,u0):u0()}}function Oy(Sy){var jy={tryLoc:Sy[0]};1 in Sy&&(jy.catchLoc=Sy[1]),2 in Sy&&(jy.finallyLoc=Sy[2],jy.afterLoc=Sy[3]),this.tryEntries.push(jy)}function ky(Sy){var jy=Sy.completion||{};jy.type="normal",delete jy.arg,Sy.completion=jy}function Ry(Sy){this.tryEntries=[{tryLoc:"root"}],Sy.forEach(Oy,this),this.reset(!0)}function Dy(Sy){if(Sy){var jy,Yy=Sy[_a];if(Yy)return Yy.call(Sy);if(typeof Sy.next=="function")return Sy;if(!isNaN(Sy.length))return jy=-1,(Yy=function Uy(){for(;++jy<Sy.length;)if(_s.call(Sy,jy))return Uy.value=Sy[jy],Uy.done=!1,Uy;return Uy.value=void 0,Uy.done=!0,Uy}).next=Yy}return{next:Jy}}function Jy(){return{value:void 0,done:!0}}return ny(Iy,"constructor",my.prototype=_y),ny(_y,"constructor",my),my.displayName=ny(_y,_d,"GeneratorFunction"),ey.isGeneratorFunction=function(Sy){return Sy=typeof Sy=="function"&&Sy.constructor,!!Sy&&(Sy===my||(Sy.displayName||Sy.name)==="GeneratorFunction")},ey.mark=function(Sy){return Object.setPrototypeOf?Object.setPrototypeOf(Sy,_y):(Sy.__proto__=_y,ny(Sy,_d,"GeneratorFunction")),Sy.prototype=Object.create(Iy),Sy},ey.awrap=function(Sy){return{__await:Sy}},Ky(zy.prototype),ny(zy.prototype,_u,function(){return this}),ey.AsyncIterator=zy,ey.async=function(Sy,jy,Yy,Uy,Xy){Xy===void 0&&(Xy=Promise);var u0=new zy(sy(Sy,jy,Yy,Uy),Xy);return ey.isGeneratorFunction(jy)?u0:u0.next().then(function(e0){return e0.done?e0.value:u0.next()})},Ky(Iy),ny(Iy,_d,"Generator"),ny(Iy,_a,function(){return this}),ny(Iy,"toString",function(){return"[object Generator]"}),ey.keys=function(Sy){var jy,Yy=[];for(jy in Sy)Yy.push(jy);return Yy.reverse(),function Uy(){for(;Yy.length;){var Xy=Yy.pop();if(Xy in Sy)return Uy.value=Xy,Uy.done=!1,Uy}return Uy.done=!0,Uy}},ey.values=Dy,Ry.prototype={constructor:Ry,reset:function(Sy){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(ky),!Sy)for(var jy in this)jy.charAt(0)==="t"&&_s.call(this,jy)&&!isNaN(+jy.slice(1))&&(this[jy]=void 0)},stop:function(){this.done=!0;var Sy=this.tryEntries[0].completion;if(Sy.type==="throw")throw Sy.arg;return this.rval},dispatchException:function(Sy){if(this.done)throw Sy;var jy=this;function Yy(E0,N0){return u0.type="throw",u0.arg=Sy,jy.next=E0,N0&&(jy.method="next",jy.arg=void 0),!!N0}for(var Uy=this.tryEntries.length-1;0<=Uy;--Uy){var Xy=this.tryEntries[Uy],u0=Xy.completion;if(Xy.tryLoc==="root")return Yy("end");if(Xy.tryLoc<=this.prev){var e0=_s.call(Xy,"catchLoc"),M0=_s.call(Xy,"finallyLoc");if(e0&&M0){if(this.prev<Xy.catchLoc)return Yy(Xy.catchLoc,!0);if(this.prev<Xy.finallyLoc)return Yy(Xy.finallyLoc)}else if(e0){if(this.prev<Xy.catchLoc)return Yy(Xy.catchLoc,!0)}else{if(!M0)throw new Error("try statement without catch or finally");if(this.prev<Xy.finallyLoc)return Yy(Xy.finallyLoc)}}}},abrupt:function(Sy,jy){for(var Yy=this.tryEntries.length-1;0<=Yy;--Yy){var Uy=this.tryEntries[Yy];if(Uy.tryLoc<=this.prev&&_s.call(Uy,"finallyLoc")&&this.prev<Uy.finallyLoc){var Xy=Uy;break}}var u0=(Xy=Xy&&(Sy==="break"||Sy==="continue")&&Xy.tryLoc<=jy&&jy<=Xy.finallyLoc?null:Xy)?Xy.completion:{};return u0.type=Sy,u0.arg=jy,Xy?(this.method="next",this.next=Xy.finallyLoc,uy):this.complete(u0)},complete:function(Sy,jy){if(Sy.type==="throw")throw Sy.arg;return Sy.type==="break"||Sy.type==="continue"?this.next=Sy.arg:Sy.type==="return"?(this.rval=this.arg=Sy.arg,this.method="return",this.next="end"):Sy.type==="normal"&&jy&&(this.next=jy),uy},finish:function(Sy){for(var jy=this.tryEntries.length-1;0<=jy;--jy){var Yy=this.tryEntries[jy];if(Yy.finallyLoc===Sy)return this.complete(Yy.completion,Yy.afterLoc),ky(Yy),uy}},catch:function(Sy){for(var jy=this.tryEntries.length-1;0<=jy;--jy){var Yy,Uy,Xy=this.tryEntries[jy];if(Xy.tryLoc===Sy)return(Yy=Xy.completion).type==="throw"&&(Uy=Yy.arg,ky(Xy)),Uy}throw new Error("illegal catch attempt")},delegateYield:function(Sy,jy,Yy){return this.delegate={iterator:Dy(Sy),resultName:jy,nextLoc:Yy},this.method==="next"&&(this.arg=void 0),uy}},ey}function g(ey){return(g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_i){return typeof _i}:function(_i){return _i&&typeof Symbol=="function"&&_i.constructor===Symbol&&_i!==Symbol.prototype?"symbol":typeof _i})(ey)}function _(ey,_i,_s,_a,_u,_d,ny){try{var sy=ey[_d](ny),ay=sy.value}catch(uy){return void _s(uy)}sy.done?_i(ay):Promise.resolve(ay).then(_a,_u)}function j(ey,_i){if(!(ey instanceof _i))throw new TypeError("Cannot call a class as a function")}function $(ey,_i){for(var _s=0;_s<_i.length;_s++){var _a=_i[_s];_a.enumerable=_a.enumerable||!1,_a.configurable=!0,"value"in _a&&(_a.writable=!0),Object.defineProperty(ey,_a.key,_a)}}function _t(ey,_i,_s){return _i&&$(ey.prototype,_i),_s&&$(ey,_s),Object.defineProperty(ey,"prototype",{writable:!1}),ey}function _e(ey,_i,_s){return _i in ey?Object.defineProperty(ey,_i,{value:_s,enumerable:!0,configurable:!0,writable:!0}):ey[_i]=_s,ey}function _r(ey,_i){if(typeof _i!="function"&&_i!==null)throw new TypeError("Super expression must either be null or a function");ey.prototype=Object.create(_i&&_i.prototype,{constructor:{value:ey,writable:!0,configurable:!0}}),Object.defineProperty(ey,"prototype",{writable:!1}),_i&&_o(ey,_i)}function _n(ey){return(_n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_i){return _i.__proto__||Object.getPrototypeOf(_i)})(ey)}function _o(ey,_i){return(_o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_s,_a){return _s.__proto__=_a,_s})(ey,_i)}function ga(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _l(ey,_i,_s){return(_l=ga()?Reflect.construct.bind():function(_a,_u,_d){var ny=[null];return ny.push.apply(ny,_u),_u=new(Function.bind.apply(_a,ny)),_d&&_o(_u,_d.prototype),_u}).apply(null,arguments)}function _f(ey,_i){if(ey==null)return{};var _s,_a=function(ny,sy){if(ny==null)return{};for(var ay,uy={},dy=Object.keys(ny),my=0;my<dy.length;my++)ay=dy[my],0<=sy.indexOf(ay)||(uy[ay]=ny[ay]);return uy}(ey,_i);if(Object.getOwnPropertySymbols)for(var _u=Object.getOwnPropertySymbols(ey),_d=0;_d<_u.length;_d++)_s=_u[_d],0<=_i.indexOf(_s)||Object.prototype.propertyIsEnumerable.call(ey,_s)&&(_a[_s]=ey[_s]);return _a}function _c(ey){if(ey===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ey}function _p(ey){var _i=ga();return function(){var _s,_a=_n(ey),_a=(_s=_i?(_s=_n(this).constructor,Reflect.construct(_a,arguments,_s)):_a.apply(this,arguments),this);if(_s&&(typeof _s=="object"||typeof _s=="function"))return _s;if(_s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _c(_a)}}function _g(){return(_g=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(ey,_i,_s){var _a=function(_u,_d){for(;!Object.prototype.hasOwnProperty.call(_u,_d)&&(_u=_n(_u))!==null;);return _u}(ey,_i);if(_a)return _a=Object.getOwnPropertyDescriptor(_a,_i),_a.get?_a.get.call(arguments.length<3?ey:_s):_a.value}).apply(this,arguments)}function ty(ey,_i){return function(_s){if(Array.isArray(_s))return _s}(ey)||function(_s,_a){var _u=_s==null?null:typeof Symbol<"u"&&_s[Symbol.iterator]||_s["@@iterator"];if(_u!=null){var _d,ny,sy=[],ay=!0,uy=!1;try{for(_u=_u.call(_s);!(ay=(_d=_u.next()).done)&&(sy.push(_d.value),!_a||sy.length!==_a);ay=!0);}catch(dy){uy=!0,ny=dy}finally{try{ay||_u.return==null||_u.return()}finally{if(uy)throw ny}}return sy}}(ey,_i)||ry(ey,_i)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function oy(ey){return function(_i){if(Array.isArray(_i))return ly(_i)}(ey)||function(_i){if(typeof Symbol<"u"&&_i[Symbol.iterator]!=null||_i["@@iterator"]!=null)return Array.from(_i)}(ey)||ry(ey)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ry(ey,_i){if(ey){if(typeof ey=="string")return ly(ey,_i);var _s=Object.prototype.toString.call(ey).slice(8,-1);return(_s=_s==="Object"&&ey.constructor?ey.constructor.name:_s)==="Map"||_s==="Set"?Array.from(ey):_s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_s)?ly(ey,_i):void 0}}function ly(ey,_i){(_i==null||_i>ey.length)&&(_i=ey.length);for(var _s=0,_a=new Array(_i);_s<_i;_s++)_a[_s]=ey[_s];return _a}o(`.H_l_right .venues-ui__drawings .trigger.button--active .arrow {
  transform: rotate(90deg);
}
.H_l_right .venues-ui__drawings .drawings {
  right: 45px;
  left: initial;
}`);var py=function(){_r(_i,H.map.Feature);var ey=_p(_i);function _i(_s){var _a;return j(this,_i),(_a=ey.call(this)).id=_s.id,_a.model=_s,_a}return _t(_i,[{key:"getData",value:function(){return this.model}},{key:"getAddress",value:function(){return this.model.getInternalAddress()}},{key:"getCenter",value:function(){var _a=ty(this.model.getCenter(),2),_s=_a[0],_a=_a[1];return new H.geo.Point(_a,_s)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"toGeoJSON",value:function(){return this.model.toJSON()}},{key:"getLevel",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getLevel().getDrawing().getParentEventTarget()}}]),_i}(),gy=function(){_r(_i,H.map.Feature);var ey=_p(_i);function _i(_s){var _a;return j(this,_i),(_a=ey.call(this)).id=_s.id,_a.model=_s,_a}return _t(_i,[{key:"getData",value:function(){return this.model}},{key:"getBoundingBox",value:function(){return _l(H.geo.Rect,oy(this.model.getBoundingBox()))}},{key:"getCenter",value:function(){var _a=ty(this.model.getCenter(),2),_s=_a[0],_a=_a[1];return new H.geo.Point(_a,_s)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getLevel",value:function(_s){return this.getLevels().find(function(_a){return _a.getIdentifier()===_s})}},{key:"getLevels",value:function(){var _s=this.getData().getLevels().map(function(_a){return _a.getIdentifier()});return this.getVenue().getLevels().filter(function(_a){return _s.indexOf(_a.id)!==-1})}},{key:"getMainLevel",value:function(){return this.getLevel(this.model.getMainLevel().getIdentifier())}},{key:"getVenue",value:function(){return this.getParentEventTarget()}}]),_i}(),by=function(){_r(_i,H.map.Feature);var ey=_p(_i);function _i(_s){var _a;return j(this,_i),(_a=ey.call(this)).id=_s.id,_a.model=_s,_a}return _t(_i,[{key:"getGeometry",value:function(_s){return this.getGeometries().find(function(_a){return _a.getIdentifier()===_s})}},{key:"getGeometries",value:function(){var _s=this.getData().getGeometries().map(function(_a){return _a.getIdentifier()});return this.getDrawing().getVenue().getGeometries().filter(function(_a){return _s.indexOf(_a.id)!==-1})}},{key:"getData",value:function(){return this.model}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getShortName",value:function(){return this.model.getShortName()}},{key:"getZIndex",value:function(){return this.model.getZIndex()}},{key:"isMain",value:function(){return this.model.isMain()}},{key:"getDrawing",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getDrawing().getParentEventTarget()}}]),_i}();function wy(ey,_i,_s,_a){for(var _u,_d=_a,ny=_s-_i>>1,sy=_s-_i,ay=ey[_i],uy=ey[_i+1],dy=ey[_s],my=ey[_s+1],_y=_i+3;_y<_s;_y+=3){var Fy=function(Vy,Iy,Ky,zy,Oy,ky){var Ry=Oy-Ky,Dy=ky-zy;{var Jy;Ry===0&&Dy===0||(1<(Jy=((Vy-Ky)*Ry+(Iy-zy)*Dy)/(Ry*Ry+Dy*Dy))?(Ky=Oy,zy=ky):0<Jy&&(Ky+=Ry*Jy,zy+=Dy*Jy))}return(Ry=Vy-Ky)*Ry+(Dy=Iy-zy)*Dy}(ey[_y],ey[_y+1],ay,uy,dy,my);_d<Fy?(_u=_y,_d=Fy):Fy===_d&&(Fy=Math.abs(_y-ny))<sy&&(_u=_y,sy=Fy)}_a<_d&&(3<_u-_i&&wy(ey,_i,_u,_a),ey[_u+2]=_d,3<_s-_u&&wy(ey,_u,_s,_a))}function Cy(_u,sy,_s,_a){var _u={id:_u===void 0?null:_u,type:sy,geometry:_s,tags:_a,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},_d=_u,ny=_d.geometry,sy=_d.type;if(sy==="Point"||sy==="MultiPoint"||sy==="LineString")Gy(_d,ny);else if(sy==="Polygon"||sy==="MultiLineString")for(var ay=0;ay<ny.length;ay++)Gy(_d,ny[ay]);else if(sy==="MultiPolygon")for(ay=0;ay<ny.length;ay++)for(var uy=0;uy<ny[ay].length;uy++)Gy(_d,ny[ay][uy]);return _u}function Gy(ey,_i){for(var _s=0;_s<_i.length;_s+=3)ey.minX=Math.min(ey.minX,_i[_s]),ey.minY=Math.min(ey.minY,_i[_s+1]),ey.maxX=Math.max(ey.maxX,_i[_s]),ey.maxY=Math.max(ey.maxY,_i[_s+1])}function Ly(ey,_i,_s,_a){if(_i.geometry){var _u=_i.geometry.coordinates,_d=_i.geometry.type,ny=Math.pow(_s.tolerance/((1<<_s.maxZoom)*_s.extent),2),sy=[],ay=_i.id;if(_s.promoteId?ay=_i.properties[_s.promoteId]:_s.generateId&&(ay=_a||0),_d==="Point")d0(_u,sy);else if(_d==="MultiPoint")for(var uy=0;uy<_u.length;uy++)d0(_u[uy],sy);else if(_d==="LineString")s0(_u,sy,ny,!1);else if(_d==="MultiLineString"){if(_s.lineMetrics){for(uy=0;uy<_u.length;uy++)s0(_u[uy],sy=[],ny,!1),ey.push(Cy(ay,"LineString",sy,_i.properties));return}t0(_u,sy,ny,!1)}else if(_d==="Polygon")t0(_u,sy,ny,!0);else{if(_d!=="MultiPolygon"){if(_d!=="GeometryCollection")throw new Error("Input data is not a valid GeoJSON object.");for(uy=0;uy<_i.geometry.geometries.length;uy++)Ly(ey,{id:ay,geometry:_i.geometry.geometries[uy],properties:_i.properties},_s,_a);return}for(uy=0;uy<_u.length;uy++){var dy=[];t0(_u[uy],dy,ny,!0),sy.push(dy)}}ey.push(Cy(ay,_d,sy,_i.properties))}}function d0(ey,_i){_i.push(Ay(ey[0])),_i.push(Ny(ey[1])),_i.push(0)}function s0(ey,_i,_s,_a){for(var _u,_d,ny=0,sy=0;sy<ey.length;sy++){var ay=Ay(ey[sy][0]),uy=Ny(ey[sy][1]);_i.push(ay),_i.push(uy),_i.push(0),0<sy&&(ny+=_a?(_u*uy-ay*_d)/2:Math.sqrt(Math.pow(ay-_u,2)+Math.pow(uy-_d,2))),_u=ay,_d=uy}var dy=_i.length-3;_i[2]=1,wy(_i,0,dy,_s),_i[2+dy]=1,_i.size=Math.abs(ny),_i.start=0,_i.end=_i.size}function t0(ey,_i,_s,_a){for(var _u=0;_u<ey.length;_u++){var _d=[];s0(ey[_u],_d,_s,_a),_i.push(_d)}}function Ay(ey){return ey/360+.5}function Ny(ey){return ey=Math.sin(ey*Math.PI/180),ey=.5-.25*Math.log((1+ey)/(1-ey))/Math.PI,ey<0?0:1<ey?1:ey}function Hy(ey,_i,_s,_a,_u,_d,ny,sy){if(_a/=_i,(_s/=_i)<=_d&&ny<_a)return ey;if(ny<_s||_a<=_d)return null;for(var ay=[],uy=0;uy<ey.length;uy++){var dy=ey[uy],my=dy.geometry,_y=dy.type,Fy=_u===0?dy.minX:dy.minY,Vy=_u===0?dy.maxX:dy.maxY;if(_s<=Fy&&Vy<_a)ay.push(dy);else if(!(Vy<_s||_a<=Fy)){var Iy=[];if(_y==="Point"||_y==="MultiPoint"){Jy=Dy=Ry=ky=Oy=zy=Ky=void 0;for(var Ky=my,zy=Iy,Oy=_s,ky=_a,Ry=_u,Dy=0;Dy<Ky.length;Dy+=3){var Jy=Ky[Dy+Ry];Oy<=Jy&&Jy<=ky&&(zy.push(Ky[Dy]),zy.push(Ky[Dy+1]),zy.push(Ky[Dy+2]))}}else if(_y==="LineString")n0(my,Iy,_s,_a,_u,!1,sy.lineMetrics);else if(_y==="MultiLineString")f0(my,Iy,_s,_a,_u,!1);else if(_y==="Polygon")f0(my,Iy,_s,_a,_u,!0);else if(_y==="MultiPolygon")for(var Sy=0;Sy<my.length;Sy++){var jy=[];f0(my[Sy],jy,_s,_a,_u,!0),jy.length&&Iy.push(jy)}if(Iy.length)if(sy.lineMetrics&&_y==="LineString")for(Sy=0;Sy<Iy.length;Sy++)ay.push(Cy(dy.id,_y,Iy[Sy],dy.tags));else _y!=="LineString"&&_y!=="MultiLineString"||(Iy.length===1?(_y="LineString",Iy=Iy[0]):_y="MultiLineString"),_y!=="Point"&&_y!=="MultiPoint"||(_y=Iy.length===3?"Point":"MultiPoint"),ay.push(Cy(dy.id,_y,Iy,dy.tags))}}return ay.length?ay:null}function n0(ey,_i,_s,_a,_u,_d,ny){for(var sy,ay,uy=v0(ey),dy=_u===0?q0:D0,my=ey.start,_y=0;_y<ey.length-3;_y+=3){var ky=ey[_y],Ry=ey[_y+1],Dy=ey[_y+2],Fy=ey[_y+3],Vy=ey[_y+4],Iy=_u===0?ky:Ry,Ky=_u===0?Fy:Vy,zy=!1;ny&&(sy=Math.sqrt(Math.pow(ky-Fy,2)+Math.pow(Ry-Vy,2))),Iy<_s?_s<Ky&&(ay=dy(uy,ky,Ry,Fy,Vy,_s),ny&&(uy.start=my+sy*ay)):_a<Iy?Ky<_a&&(ay=dy(uy,ky,Ry,Fy,Vy,_a),ny&&(uy.start=my+sy*ay)):A0(uy,ky,Ry,Dy),Ky<_s&&_s<=Iy&&(ay=dy(uy,ky,Ry,Fy,Vy,_s),zy=!0),_a<Ky&&Iy<=_a&&(ay=dy(uy,ky,Ry,Fy,Vy,_a),zy=!0),!_d&&zy&&(ny&&(uy.end=my+sy*ay),_i.push(uy),uy=v0(ey)),ny&&(my+=sy)}var Oy=ey.length-3,ky=ey[Oy],Ry=ey[1+Oy],Dy=ey[2+Oy];_s<=(Iy=_u===0?ky:Ry)&&Iy<=_a&&A0(uy,ky,Ry,Dy),Oy=uy.length-3,_d&&3<=Oy&&(uy[Oy]!==uy[0]||uy[1+Oy]!==uy[1])&&A0(uy,uy[0],uy[1],uy[2]),uy.length&&_i.push(uy)}function v0(ey){var _i=[];return _i.size=ey.size,_i.start=ey.start,_i.end=ey.end,_i}function f0(ey,_i,_s,_a,_u,_d){for(var ny=0;ny<ey.length;ny++)n0(ey[ny],_i,_s,_a,_u,_d,!1)}function A0(ey,_i,_s,_a){ey.push(_i),ey.push(_s),ey.push(_a)}function q0(ey,_i,_s,_a,_u,_d){return _a=(_d-_i)/(_a-_i),ey.push(_d),ey.push(_s+(_u-_s)*_a),ey.push(1),_a}function D0(ey,_i,_s,_a,_u,_d){return _u=(_d-_s)/(_u-_s),ey.push(_i+(_a-_i)*_u),ey.push(_d),ey.push(1),_u}function K0(ey,_i){for(var _s=[],_a=0;_a<ey.length;_a++){var _u=ey[_a],_d=_u.type;if(_d==="Point"||_d==="MultiPoint"||_d==="LineString")ny=a1(_u.geometry,_i);else if(_d==="MultiLineString"||_d==="Polygon")for(var ny=[],sy=0;sy<_u.geometry.length;sy++)ny.push(a1(_u.geometry[sy],_i));else if(_d==="MultiPolygon")for(ny=[],sy=0;sy<_u.geometry.length;sy++){for(var ay=[],uy=0;uy<_u.geometry[sy].length;uy++)ay.push(a1(_u.geometry[sy][uy],_i));ny.push(ay)}_s.push(Cy(_u.id,_d,ny,_u.tags))}return _s}function a1(ey,_i){var _s=[];_s.size=ey.size,ey.start!==void 0&&(_s.start=ey.start,_s.end=ey.end);for(var _a=0;_a<ey.length;_a+=3)_s.push(ey[_a]+_i,ey[_a+1],ey[_a+2]);return _s}function J0(ey,_i){if(!ey.transformed){for(var _s,_a=1<<ey.z,_u=ey.x,_d=ey.y,ny=0;ny<ey.features.length;ny++){var sy=ey.features[ny],ay=sy.geometry,uy=sy.type;if(sy.geometry=[],uy===1)for(_s=0;_s<ay.length;_s+=2)sy.geometry.push(C0(ay[_s],ay[_s+1],_i,_a,_u,_d));else for(_s=0;_s<ay.length;_s++){for(var dy=[],my=0;my<ay[_s].length;my+=2)dy.push(C0(ay[_s][my],ay[_s][my+1],_i,_a,_u,_d));sy.geometry.push(dy)}}ey.transformed=!0}return ey}function C0(ey,_i,_s,_a,_u,_d){return[Math.round(_s*(ey*_a-_u)),Math.round(_s*(_i*_a-_d))]}function H0(ey,_i,_s,_a,_u){for(var _d=_i===_u.maxZoom?0:_u.tolerance/((1<<_i)*_u.extent),ny={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:_s,y:_a,z:_i,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},sy=0;sy<ey.length;sy++){ny.numFeatures++,ky=Oy=zy=Ky=Iy=Vy=Fy=_y=my=ky=dy=uy=ay=void 0;var ay=ny,uy=ey[sy],dy=_d,ky=_u,my=uy.geometry,_y=uy.type,Fy=[];if(_y==="Point"||_y==="MultiPoint")for(var Vy=0;Vy<my.length;Vy+=3)Fy.push(my[Vy]),Fy.push(my[Vy+1]),ay.numPoints++,ay.numSimplified++;else if(_y==="LineString")u1(Fy,my,ay,dy,!1,!1);else if(_y==="MultiLineString"||_y==="Polygon")for(Vy=0;Vy<my.length;Vy++)u1(Fy,my[Vy],ay,dy,_y==="Polygon",Vy===0);else if(_y==="MultiPolygon")for(var Iy=0;Iy<my.length;Iy++){var Ky=my[Iy];for(Vy=0;Vy<Ky.length;Vy++)u1(Fy,Ky[Vy],ay,dy,!0,Vy===0)}if(Fy.length){var zy=uy.tags||null;if(_y==="LineString"&&ky.lineMetrics){for(var Oy in zy={},uy.tags)zy[Oy]=uy.tags[Oy];zy.mapbox_clip_start=my.start/my.size,zy.mapbox_clip_end=my.end/my.size}ky={geometry:Fy,type:_y==="Polygon"||_y==="MultiPolygon"?3:_y==="LineString"||_y==="MultiLineString"?2:1,tags:zy},uy.id!==null&&(ky.id=uy.id),ay.features.push(ky)}var ky=ey[sy].minX,Ry=ey[sy].minY,Dy=ey[sy].maxX,Jy=ey[sy].maxY;ky<ny.minX&&(ny.minX=ky),Ry<ny.minY&&(ny.minY=Ry),Dy>ny.maxX&&(ny.maxX=Dy),Jy>ny.maxY&&(ny.maxY=Jy)}return ny}function u1(ey,_i,_s,_a,_u,_d){var ny=_a*_a;if(0<_a&&_i.size<(_u?ny:_a))_s.numPoints+=_i.length/3;else{for(var sy=[],ay=0;ay<_i.length;ay+=3)(_a===0||_i[ay+2]>ny)&&(_s.numSimplified++,sy.push(_i[ay]),sy.push(_i[ay+1])),_s.numPoints++;if(_u){for(var uy=sy,_u=_d,dy=0,my=0,_y=uy.length,Fy=_y-2;my<_y;Fy=my,my+=2)dy+=(uy[my]-uy[Fy])*(uy[my+1]+uy[Fy+1]);if(0<dy===_u)for(my=0,_y=uy.length;my<_y/2;my+=2){var Vy=uy[my],Iy=uy[my+1];uy[my]=uy[_y-2-my],uy[my+1]=uy[_y-1-my],uy[_y-2-my]=Vy,uy[_y-1-my]=Iy}}ey.push(sy)}}function t1(ay,_i){var _s=(_i=this.options=function(uy,dy){for(var my in dy)uy[my]=dy[my];return uy}(Object.create(this.options),_i)).debug;if(_s&&console.time("preprocess data"),_i.maxZoom<0||24<_i.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(_i.promoteId&&_i.generateId)throw new Error("promoteId and generateId cannot be used together.");var _a,_u,_d,ny,sy,ay=function(uy,dy){var my=[];if(uy.type==="FeatureCollection")for(var _y=0;_y<uy.features.length;_y++)Ly(my,uy.features[_y],dy,_y);else uy.type==="Feature"?Ly(my,uy,dy):Ly(my,{geometry:uy},dy);return my}(ay,_i);this.tiles={},this.tileCoords=[],_s&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",_i.indexMaxZoom,_i.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),_a=ay,_u=(_i=_i).buffer/_i.extent,ny=Hy(_d=_a,1,-1-_u,_u,0,-1,2,_i),sy=Hy(_a,1,1-_u,2+_u,0,-1,2,_i),(ny||sy)&&(_d=Hy(_a,1,-_u,1+_u,0,-1,2,_i)||[],ny&&(_d=K0(ny,1).concat(_d)),sy&&(_d=_d.concat(K0(sy,-1)))),(ay=_d).length&&this.splitTile(ay,0,0,0),_s&&(ay.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function n1(ey,_i,_s){return 32*((1<<ey)*_s+_i)+ey}t1.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},t1.prototype.splitTile=function(ey,_i,_s,_a,_u,_d,ny){for(var sy=[ey,_i,_s,_a],ay=this.options,uy=ay.debug;sy.length;){_a=sy.pop(),_s=sy.pop(),_i=sy.pop(),ey=sy.pop();var dy,my,_y,Fy,Vy,Iy,Ky,zy,Oy,ky=1<<_i,Ry=n1(_i,_s,_a),Dy=this.tiles[Ry];if(Dy||(1<uy&&console.time("creation"),Dy=this.tiles[Ry]=H0(ey,_i,_s,_a,ay),this.tileCoords.push({z:_i,x:_s,y:_a}),uy&&(1<uy&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",_i,_s,_a,Dy.numFeatures,Dy.numPoints,Dy.numSimplified),console.timeEnd("creation")),this.stats[Ry="z"+_i]=(this.stats[Ry]||0)+1,this.total++)),Dy.source=ey,_u){if(_i===ay.maxZoom||_i===_u)continue;var Ry=1<<_u-_i;if(_s!==Math.floor(_d/Ry)||_a!==Math.floor(ny/Ry))continue}else if(_i===ay.indexMaxZoom||Dy.numPoints<=ay.indexMaxPoints)continue;Dy.source=null,ey.length!==0&&(1<uy&&console.time("clipping"),dy=.5-(Ry=.5*ay.buffer/ay.extent),_y=1+Ry,Ky=Fy=Vy=Iy=null,zy=Hy(ey,ky,_s-Ry,_s+(my=.5+Ry),0,Dy.minX,Dy.maxX,ay),Oy=Hy(ey,ky,_s+dy,_s+_y,0,Dy.minX,Dy.maxX,ay),ey=null,zy&&(Ky=Hy(zy,ky,_a-Ry,_a+my,1,Dy.minY,Dy.maxY,ay),Fy=Hy(zy,ky,_a+dy,_a+_y,1,Dy.minY,Dy.maxY,ay),zy=null),Oy&&(Vy=Hy(Oy,ky,_a-Ry,_a+my,1,Dy.minY,Dy.maxY,ay),Iy=Hy(Oy,ky,_a+dy,_a+_y,1,Dy.minY,Dy.maxY,ay),Oy=null),1<uy&&console.timeEnd("clipping"),sy.push(Ky||[],_i+1,2*_s,2*_a),sy.push(Fy||[],_i+1,2*_s,2*_a+1),sy.push(Vy||[],_i+1,2*_s+1,2*_a),sy.push(Iy||[],_i+1,2*_s+1,2*_a+1))}},t1.prototype.getTile=function(ey,_i,_s){var _u=this.options,_a=_u.extent,_u=_u.debug;if(ey<0||24<ey)return null;var _d=1<<ey,_d=n1(ey,_i=(_i%_d+_d)%_d,_s);if(this.tiles[_d])return J0(this.tiles[_d],_a);1<_u&&console.log("drilling down to z%d-%d-%d",ey,_i,_s);for(var ny,sy=ey,ay=_i,uy=_s;!ny&&0<sy;)sy--,ay=Math.floor(ay/2),uy=Math.floor(uy/2),ny=this.tiles[n1(sy,ay,uy)];return ny&&ny.source?(1<_u&&console.log("found parent tile z%d-%d-%d",sy,ay,uy),1<_u&&console.time("drilling down"),this.splitTile(ny.source,sy,ay,uy,ey,_i,_s),1<_u&&console.timeEnd("drilling down"),this.tiles[_d]?J0(this.tiles[_d],_a):null):null};function h1(ey){var _i=[],_s=ey&&ey.features;if(_s)for(var _a=0,_u=_s.length;_a<_u;_a+=1){var _d=_s[_a],ny=_d.type,sy=void 0,ay=!1;switch(ny){case M1:sy={type:W0.MULTI_POINT,coordinates:_d.geometry.map(function(uy){return uy.slice()})};break;case B0:case p1:sy={type:W0.MULTI_LINESTRING,coordinates:_d.geometry.map(function(uy){return uy.map(function(dy){return dy.slice()})})},ny===p1&&(sy=function(uy){for(var dy,my=[],_y=[],Fy=0,Vy=uy.coordinates.length;Fy<Vy;Fy+=1){var Iy=uy.coordinates[Fy],Ky=Q0(Iy);Ky!==null&&(Ky===(dy=dy||Ky)&&_y.length&&(my.push(_y),_y=[]),_y.push(Iy))}return 0<_y.length&&my.push(_y),my.length===1?(uy.type=W0.POLYGON,uy.coordinates=my[0]):1<my.length?(uy.type=W0.MULTI_POLYGON,uy.coordinates=my):uy=null,uy}(sy))==null&&(ay=!0);break;default:ay=!0}ay||_i.push({geometry:sy,id:_d.id,properties:_d.tags,type:"Feature"})}return{type:"FeatureCollection",features:_i}}function s1(ey,_i,ny,_a,_u){_a=_a,_u=_u,_i=1<<(_i=_i),(_d=[])[0]=((ey=ey)[0]/_u+ny)/_i,_d[1]=(ey[1]/_u+_a)/_i;var _d,ny={x:_d[0],y:_d[1]};return _u=(ey=ny).x,ey=ey.y,_u=360*(_u-.5),_a=Math.exp(Math.PI*(.5-ey)/.25)-1,ey=Math.exp(Math.PI*(.5-ey)/.25)+1,[_u,180*Math.asin(_a/ey)/Math.PI]}var W0={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINESTRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection"},i1={fillColor:"#e0e0e0",outlineColor:"#829DB4",outlineWidth:1},w1={fill:"#333333",size:13},k1={fillColor:"#F2F285",outlineColor:"#0088BF",outlineWidth:1.2},X0=16,l1=18,P1=24,T0={FOOTPRINT:"FOOTPRINT",ICON:"ICON",TEXT:"TEXT",VECTOR:"VECTOR"},E1=Object.freeze({v1:1,v2:2}),M1=1,B0=2,p1=3,e1="CW",C1="CCW",Q0=function(ey){return ey=function(_i){for(var _s=0,_a=_i.length,_u=0;_u<_a-1;_u+=1){var _d=_i[_u],ny=_i[_u+1];_s+=_d[0]*ny[1]-ny[0]*_d[1]}return _s+=_i[_a-1][0]*_i[0][1]-_i[0][0]*_i[_a-1][1]}(ey),0<ey?e1:ey<0?C1:void 0};(function(ey){function _i(_u){if(_a[_u])return _a[_u].exports;var _d=_a[_u]={i:_u,l:!1,exports:{}};return _s[_u].call(_d.exports,_d,_d.exports,_i),_d.l=!0,_d.exports}var _s,_a;ey.exports=(_s=[function(_u,_d,my){function sy(_y){return(sy=typeof Symbol=="function"&&g(Symbol.iterator)=="symbol"?function(Fy){return g(Fy)}:function(Fy){return Fy&&typeof Symbol=="function"&&Fy.constructor===Symbol&&Fy!==Symbol.prototype?"symbol":g(Fy)})(_y)}var ay=my(1),my=my(7),uy=my.get,dy=(my.deepValue,my.isArray),my=function(){function _y(zy,_0){var ky=_0.location,ky=ky===void 0?0:ky,Ry=_0.distance,Ry=Ry===void 0?100:Ry,Dy=_0.threshold,Dy=Dy===void 0?.6:Dy,Jy=_0.maxPatternLength,Jy=Jy===void 0?32:Jy,Sy=_0.caseSensitive,Sy=Sy!==void 0&&Sy,jy=_0.tokenSeparator,jy=jy===void 0?/ +/g:jy,Yy=_0.findAllMatches,Yy=Yy!==void 0&&Yy,Uy=_0.minMatchCharLength,Uy=Uy===void 0?1:Uy,Xy=_0.id,Xy=Xy===void 0?null:Xy,u0=_0.keys,u0=u0===void 0?[]:u0,e0=_0.shouldSort,e0=e0===void 0||e0,M0=_0.getFn,M0=M0===void 0?uy:M0,E0=_0.sortFn,E0=E0===void 0?function(Y0,x0){return Y0.score-x0.score}:E0,N0=_0.tokenize,N0=N0!==void 0&&N0,j0=_0.matchAllTokens,j0=j0!==void 0&&j0,G0=_0.includeMatches,G0=G0!==void 0&&G0,b0=_0.includeScore,b0=b0!==void 0&&b0,_0=_0.verbose,_0=_0!==void 0&&_0;if(!(this instanceof _y))throw new TypeError("Cannot call a class as a function");this.options={location:ky,distance:Ry,threshold:Dy,maxPatternLength:Jy,isCaseSensitive:Sy,tokenSeparator:jy,findAllMatches:Yy,minMatchCharLength:Uy,id:Xy,keys:u0,includeMatches:G0,includeScore:b0,shouldSort:e0,getFn:M0,sortFn:E0,verbose:_0,tokenize:N0,matchAllTokens:j0},this.setCollection(zy),this._processKeys(u0)}for(var Fy=_y.prototype,Vy=[{key:"setCollection",value:function(zy){return this.list=zy}},{key:"_processKeys",value:function(zy){if(this._keyWeights={},this._keyNames=[],zy.length&&typeof zy[0]=="string")for(var Oy=0,ky=zy.length;Oy<ky;Oy+=1){var Ry=zy[Oy];this._keyWeights[Ry]=1,this._keyNames.push(Ry)}else{for(var Dy=null,Jy=null,Sy=0,jy=0,Yy=zy.length;jy<Yy;jy+=1){var Uy=zy[jy];if(!Uy.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var Xy=Uy.name;if(this._keyNames.push(Xy),!Uy.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');if(Uy=Uy.weight,Uy<0||1<Uy)throw new Error('"weight" property in key must bein the range of [0, 1)');Jy=Jy==null?Uy:Math.max(Jy,Uy),Dy=Dy==null?Uy:Math.min(Dy,Uy),Sy+=this._keyWeights[Xy]=Uy}if(1<Sy)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(ky){var Oy=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{limit:!1},ky=(this._log(`---------
Search pattern: "`.concat(ky,'"')),this._prepareSearchers(ky)),Ry=ky.tokenSearchers,ky=ky.fullSearcher,Ry=this._search(Ry,ky);return this._computeScore(Ry),this.options.shouldSort&&this._sort(Ry),Oy.limit&&typeof Oy.limit=="number"&&(Ry=Ry.slice(0,Oy.limit)),this._format(Ry)}},{key:"_prepareSearchers",value:function(){var zy=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",Oy=[];if(this.options.tokenize)for(var ky=zy.split(this.options.tokenSeparator),Ry=0,Dy=ky.length;Ry<Dy;Ry+=1)Oy.push(new ay(ky[Ry],this.options));return{tokenSearchers:Oy,fullSearcher:new ay(zy,this.options)}}},{key:"_search",value:function(){var zy=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],Oy=1<arguments.length?arguments[1]:void 0,ky=this.list,Ry={},Dy=[];if(typeof ky[0]=="string")for(var Jy=0,Sy=ky.length;Jy<Sy;Jy+=1)this._analyze({key:"",value:ky[Jy],record:Jy,index:Jy},{resultMap:Ry,results:Dy,tokenSearchers:zy,fullSearcher:Oy});else for(var jy=0,Yy=ky.length;jy<Yy;jy+=1)for(var Uy=ky[jy],Xy=0,u0=this._keyNames.length;Xy<u0;Xy+=1){var e0=this._keyNames[Xy];this._analyze({key:e0,value:this.options.getFn(Uy,e0),record:Uy,index:jy},{resultMap:Ry,results:Dy,tokenSearchers:zy,fullSearcher:Oy})}return Dy}},{key:"_analyze",value:function(jy,Oy){var ky=this,Ry=jy.key,Dy=jy.arrayIndex,Jy=jy.value,Sy=jy.record,jy=jy.index,u0=Oy.tokenSearchers,Yy=u0===void 0?[]:u0,Uy=Oy.fullSearcher,u0=Oy.resultMap,Xy=u0===void 0?{}:u0,u0=Oy.results,e0=u0===void 0?[]:u0;(function M0(E0,N0,j0,G0){if(N0!=null){if(typeof N0=="string"){var b0=!1,_0=-1,Y0=0,x0=(ky._log(`
Key: `.concat(Ry===""?"--":Ry)),Uy.search(N0));if(ky._log('Full text: "'.concat(N0,'", score: ').concat(x0.score)),ky.options.tokenize){for(var o1=N0.split(ky.options.tokenSeparator),Y1=o1.length,R1=[],K1=0,b_=Yy.length;K1<b_;K1+=1){var n_=Yy[K1];ky._log(`
Pattern: "`.concat(n_.pattern,'"'));for(var i_=!1,X1=0;X1<Y1;X1+=1){var z1=o1[X1],Z1=n_.search(z1),J1={};Z1.isMatch?(J1[z1]=Z1.score,i_=b0=!0,R1.push(Z1.score)):(J1[z1]=1,ky.options.matchAllTokens||R1.push(1)),ky._log('Token: "'.concat(z1,'", score: ').concat(J1[z1]))}i_&&(Y0+=1)}for(var _0=R1[0],o_=R1.length,Q1=1;Q1<o_;Q1+=1)_0+=R1[Q1];ky._log("Token score average:",_0/=o_)}var G1=x0.score,N1=(ky._log("Score average:",G1=-1<_0?(G1+_0)/2:G1),!ky.options.tokenize||!ky.options.matchAllTokens||Y0>=Yy.length);ky._log(`
Check Matches: `.concat(N1)),(b0||x0.isMatch)&&N1&&(N1={key:Ry,arrayIndex:E0,value:N0,score:G1},ky.options.includeMatches&&(N1.matchedIndices=x0.matchedIndices),(E0=Xy[G0])?E0.output.push(N1):(Xy[G0]={item:j0,output:[N1]},e0.push(Xy[G0])))}else if(dy(N0))for(var H1=0,x_=N0.length;H1<x_;H1+=1)M0(H1,N0[H1],j0,G0)}})(Dy===void 0?-1:Dy,Jy,Sy,jy)}},{key:"_computeScore",value:function(zy){this._log(`

Computing score:
`);for(var Oy=this._keyWeights,ky=!!Object.keys(Oy).length,Ry=0,Dy=zy.length;Ry<Dy;Ry+=1){for(var Jy=zy[Ry],Sy=Jy.output,jy=Sy.length,Yy=1,Uy=0;Uy<jy;Uy+=1){var Xy=Sy[Uy],e0=Xy.key,u0=ky?Oy[e0]:1,e0=Xy.score===0&&Oy&&0<Oy[e0]?Number.EPSILON:Xy.score;Yy*=Math.pow(e0,u0)}Jy.score=Yy,this._log(Jy)}}},{key:"_sort",value:function(zy){this._log(`

Sorting....`),zy.sort(this.options.sortFn)}},{key:"_format",value:function(zy){var Oy,ky=[],Ry=(this.options.verbose&&(Oy=[],this._log(`

Output:

`,JSON.stringify(zy,function(Xy,u0){if(sy(u0)==="object"&&u0!==null){if(Oy.indexOf(u0)!==-1)return;Oy.push(u0)}return u0},2)),Oy=null),[]);this.options.includeMatches&&Ry.push(function(Xy,u0){var e0=Xy.output;u0.matches=[];for(var M0=0,E0=e0.length;M0<E0;M0+=1){var N0,j0=e0[M0];j0.matchedIndices.length!==0&&(N0={indices:j0.matchedIndices,value:j0.value},j0.key&&(N0.key=j0.key),j0.hasOwnProperty("arrayIndex")&&-1<j0.arrayIndex&&(N0.arrayIndex=j0.arrayIndex),u0.matches.push(N0))}}),this.options.includeScore&&Ry.push(function(Xy,u0){u0.score=Xy.score});for(var Dy=0,Jy=zy.length;Dy<Jy;Dy+=1){var Sy=zy[Dy];if(this.options.id&&(Sy.item=this.options.getFn(Sy.item,this.options.id)[0]),Ry.length){for(var jy={item:Sy.item},Yy=0,Uy=Ry.length;Yy<Uy;Yy+=1)Ry[Yy](Sy,jy);ky.push(jy)}else ky.push(Sy.item)}return ky}},{key:"_log",value:function(){var zy;this.options.verbose&&(zy=console).log.apply(zy,arguments)}}],Iy=0;Iy<Vy.length;Iy++){var Ky=Vy[Iy];Ky.enumerable=Ky.enumerable||!1,Ky.configurable=!0,"value"in Ky&&(Ky.writable=!0),Object.defineProperty(Fy,Ky.key,Ky)}return _y}();_u.exports=my},function(_u,_d,dy){var sy=dy(2),ay=dy(3),uy=dy(6),dy=function(){function my(Ky,Uy){var Oy=Uy.location,Oy=Oy===void 0?0:Oy,ky=Uy.distance,ky=ky===void 0?100:ky,Ry=Uy.threshold,Ry=Ry===void 0?.6:Ry,Dy=Uy.maxPatternLength,Dy=Dy===void 0?32:Dy,Jy=Uy.isCaseSensitive,Jy=Jy!==void 0&&Jy,Sy=Uy.tokenSeparator,Sy=Sy===void 0?/ +/g:Sy,jy=Uy.findAllMatches,jy=jy!==void 0&&jy,Yy=Uy.minMatchCharLength,Yy=Yy===void 0?1:Yy,Uy=Uy.includeMatches,Uy=Uy!==void 0&&Uy;if(!(this instanceof my))throw new TypeError("Cannot call a class as a function");this.options={location:Oy,distance:ky,threshold:Ry,maxPatternLength:Dy,isCaseSensitive:Jy,tokenSeparator:Sy,findAllMatches:jy,includeMatches:Uy,minMatchCharLength:Yy},this.pattern=Jy?Ky:Ky.toLowerCase(),this.pattern.length<=Dy&&(this.patternAlphabet=uy(this.pattern))}for(var _y=my.prototype,Fy=[{key:"search",value:function(Ky){var zy=this.options,Oy=zy.isCaseSensitive,zy=zy.includeMatches;if(Oy||(Ky=Ky.toLowerCase()),this.pattern===Ky)return Oy={isMatch:!0,score:0},zy&&(Oy.matchedIndices=[[0,Ky.length-1]]),Oy;var Oy=this.options,Jy=Oy.maxPatternLength,Oy=Oy.tokenSeparator;if(this.pattern.length>Jy)return sy(Ky,this.pattern,Oy);var Jy=this.options,Oy=Jy.location,ky=Jy.distance,Ry=Jy.threshold,Dy=Jy.findAllMatches,Jy=Jy.minMatchCharLength;return ay(Ky,this.pattern,this.patternAlphabet,{location:Oy,distance:ky,threshold:Ry,findAllMatches:Dy,minMatchCharLength:Jy,includeMatches:zy})}}],Vy=0;Vy<Fy.length;Vy++){var Iy=Fy[Vy];Iy.enumerable=Iy.enumerable||!1,Iy.configurable=!0,"value"in Iy&&(Iy.writable=!0),Object.defineProperty(_y,Iy.key,Iy)}return my}();_u.exports=dy},function(_u,_d){var ny=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;_u.exports=function(sy,uy){var my=2<arguments.length&&arguments[2]!==void 0?arguments[2]:/ +/g,uy=new RegExp(uy.replace(ny,"\\$&").replace(my,"|")),dy=sy.match(uy),my=!!dy,_y=[];if(my)for(var Fy=0,Vy=dy.length;Fy<Vy;Fy+=1){var Iy=dy[Fy];_y.push([sy.indexOf(Iy),Iy.length-1])}return{score:my?.5:1,isMatch:my,matchedIndices:_y}}},function(_u,_d,ny){var sy=ny(4),ay=ny(5);_u.exports=function(uy,dy,my,_y){for(var Fy=_y.location,Iy=_y.distance,Vy=Iy===void 0?100:Iy,Iy=_y.threshold,zy=_y.findAllMatches,Ky=zy!==void 0&&zy,zy=_y.minMatchCharLength,zy=zy===void 0?1:zy,_y=_y.includeMatches,_y=_y!==void 0&&_y,Oy=Fy===void 0?0:Fy,ky=uy.length,Ry=Iy===void 0?.6:Iy,Dy=uy.indexOf(dy,Oy),Jy=dy.length,Sy=[],jy=0;jy<ky;jy+=1)Sy[jy]=0;Dy!==-1&&(Fy=sy(dy,{errors:0,currentLocation:Dy,expectedLocation:Oy,distance:Vy}),Ry=Math.min(Fy,Ry),(Dy=uy.lastIndexOf(dy,Oy+Jy))!==-1&&(Iy=sy(dy,{errors:0,currentLocation:Dy,expectedLocation:Oy,distance:Vy}),Ry=Math.min(Iy,Ry)));for(var Dy=-1,Yy=[],Uy=1,Xy=Jy+ky,u0=1<<(Jy<=31?Jy-1:30),e0=0;e0<Jy;e0+=1){for(var M0=0,E0=Xy;M0<E0;)sy(dy,{errors:e0,currentLocation:Oy+E0,expectedLocation:Oy,distance:Vy})<=Ry?M0=E0:Xy=E0,E0=Math.floor((Xy-M0)/2+M0);var Xy=E0,N0=Math.max(1,Oy-E0+1),j0=Ky?ky:Math.min(Oy+E0,ky)+Jy,G0=Array(j0+2);G0[j0+1]=(1<<e0)-1;for(var b0=j0;N0<=b0;--b0){var _0=b0-1,Y0=my[uy.charAt(_0)];if(Y0&&(Sy[_0]=1),G0[b0]=(G0[b0+1]<<1|1)&Y0,e0!==0&&(G0[b0]|=(Yy[b0+1]|Yy[b0])<<1|1|Yy[b0+1]),G0[b0]&u0&&(Uy=sy(dy,{errors:e0,currentLocation:_0,expectedLocation:Oy,distance:Vy}))<=Ry){if(Ry=Uy,(Dy=_0)<=Oy)break;N0=Math.max(1,2*Oy-Dy)}}if(sy(dy,{errors:e0+1,currentLocation:Oy,expectedLocation:Oy,distance:Vy})>Ry)break;Yy=G0}return Fy={isMatch:0<=Dy,score:Uy===0?.001:Uy},_y&&(Fy.matchedIndices=ay(Sy,zy)),Fy}},function(_u,_d){_u.exports=function(_y,dy){var my=dy.errors,ay=dy.currentLocation,uy=dy.expectedLocation,dy=dy.distance,dy=dy===void 0?100:dy,my=(my===void 0?0:my)/_y.length,_y=Math.abs((uy===void 0?0:uy)-(ay===void 0?0:ay));return dy?my+_y/dy:_y?1:my}},function(_u,_d){_u.exports=function(){for(var ny=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],sy=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1,ay=[],uy=-1,dy=0,my=ny.length;dy<my;dy+=1){var _y=ny[dy];_y&&uy===-1?uy=dy:_y||uy===-1||((_y=dy-1)-uy+1>=sy&&ay.push([uy,_y]),uy=-1)}return ny[dy-1]&&sy<=dy-uy&&ay.push([uy,dy-1]),ay}},function(_u,_d){_u.exports=function(ny){for(var sy={},ay=ny.length,uy=0;uy<ay;uy+=1)sy[ny.charAt(uy)]=0;for(var dy=0;dy<ay;dy+=1)sy[ny.charAt(dy)]|=1<<ay-dy-1;return sy}},function(_u,_d){function ny(dy){return Array.isArray?Array.isArray(dy):Object.prototype.toString.call(dy)==="[object Array]"}function sy(dy){if(dy==null)return"";if(typeof dy=="string")return dy;var my=dy+"";return my=="0"&&1/dy==-1/0?"-0":my}function ay(dy){return typeof dy=="string"}function uy(dy){return typeof dy=="number"}_u.exports={get:function(dy,my){var _y=[];return function Fy(Vy,Iy){if(Iy){var Ky=Iy.indexOf("."),zy=Iy,Oy=null,ky=(Ky!==-1&&(zy=Iy.slice(0,Ky),Oy=Iy.slice(Ky+1)),Vy[zy]);if(ky!=null)if(Oy||!ay(ky)&&!uy(ky))if(ny(ky))for(var Ry=0,Dy=ky.length;Ry<Dy;Ry+=1)Fy(ky[Ry],Oy);else Oy&&Fy(ky,Oy);else _y.push(sy(ky))}else _y.push(Vy)}(dy,my),_y},isArray:ny,isString:ay,isNum:uy,toString:sy}}],_a={},_i.m=_s,_i.c=_a,_i.d=function(_u,_d,ny){_i.o(_u,_d)||Object.defineProperty(_u,_d,{enumerable:!0,get:ny})},_i.r=function(_u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_u,"__esModule",{value:!0})},_i.t=function(_u,_d){if(1&_d&&(_u=_i(_u)),8&_d||4&_d&&g(_u)=="object"&&_u&&_u.__esModule)return _u;var ny=Object.create(null);if(_i.r(ny),Object.defineProperty(ny,"default",{enumerable:!0,value:_u}),2&_d&&typeof _u!="string")for(var sy in _u)_i.d(ny,sy,(function(ay){return _u[ay]}).bind(null,sy));return ny},_i.n=function(_u){var _d=_u&&_u.__esModule?function(){return _u.default}:function(){return _u};return _i.d(_d,"a",_d),_d},_i.o=function(_u,_d){return Object.prototype.hasOwnProperty.call(_u,_d)},_i.p="",_i(_i.s=0))})(h0={exports:{}});var h0=h0.exports,O0=(l0=h0)&&l0.__esModule&&Object.prototype.hasOwnProperty.call(l0,"default")?l0.default:l0,y1=(h0.Fuse,_t(function ey(ny){var _s=ny.addressList,_s=_s===void 0?[]:_s,_a=ny.geometries,_a=_a===void 0?[]:_a,_u=ny.entity,_u=_u===void 0?null:_u,_d=ny.name,_d=_d===void 0?"":_d,ny=ny.icon,ny=ny===void 0?"":ny;j(this,ey),this.addressList=_s,this.geometries=_a,this.icon=ny,this.entity=_u,this.name=_d})),qy={keys:[{name:"name",weight:.6},{name:"addressList",weight:.4}],threshold:.2},T1=function(){function ey(_i){j(this,ey),this.fuseSearch=null,this.levels_=null,this.searchListEntities_=[],this.searchListIcons_=[],this.searchList_=[],this.venueModel=_i,this.init()}return _t(ey,[{key:"init",value:function(){var _i=this.venueModel.getGeometries().reduce(function(_s,_a){return _s[_a.getId()]=_a,_s},{}),_i=(this.initEntityList(this.venueModel.getOccupant()),this.initIconList(_i),this.levels_=this.venueModel.getLevels().map(function(_s){return{levelId:_s.getId(),levelName:_s.getName(),drawingId:_s.getDrawing().getId(),drawingName:_s.getDrawing().getName()}}),[].concat(oy(this.searchListEntities_),oy(this.searchListIcons_)));this.searchList_=_i.sort(function(_s,_a){return _s.name.localeCompare(_a.name)}),this.fuseSearch_=new O0(this.searchList_,qy)}},{key:"initEntityList",value:function(){var _i=(0<arguments.length&&arguments[0]!==void 0?arguments[0]:[]).map(function(_s){return _s.spaceIds?new y1({geometries:_s.space,addressList:_s.spaceIds||[],name:_s.properties.name||"",entity:_s}):null}).filter(function(_s){return _s!==null});this.searchListEntities_=_i}},{key:"initIconList",value:function(){this.searchListIcons_=Object.values(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{}).filter(function(_i){return _i.isIcon()}).map(function(_i){var _s=_i.getIcon();return new y1({geometries:[_i],icon:_s,name:_i.properties.name||""})})}},{key:"all",value:function(){return this.searchList_}},{key:"allIconTypes",value:function(){var _i=this.searchListIcons_.reduce(function(_s,_a){return _s[_a.name]=_a.name,_s},{});return Object.keys(_i)}},{key:"find",value:function(){var _i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"";return _i===""?this.searchList_:this.fuseSearch_.search(_i)}}]),ey}(),c1=Object.freeze({SITE:"SITE",IMAGES:"IMAGES",THEME:"THEME"}),v1="indoor.Site",L1="indoor.Structure",S1="indoor.Occupant",A1="indoor.Space",O1="indoor.SpaceGroups",I1="Address",yy="indoor.Level",xy="indoor.Entrance",Ty="OCCUPANT_NAMES",Wy="SPACE_NAME",_v="INTERNAL_ADDRESS_SHORT",p0="INTERNAL_ADDRESS",c0="INTERNAL_ADDRESS_LONG",o0="SPACE_TYPE_NAME",_m="SPACE_CATEGORY_NAME",g0="Point",k0="LineString",Qy="Polygon",P0="MultiPoint",$0="MultiLineString",r1="MultiPolygon",F0=Object.freeze({STANDARD:"STANDARD",FLATTEN:"FLATTEN",OUTDOOR_MAIN:"OUTDOOR_MAIN",INDOOR_MAIN:"INDOOR_MAIN",NO_OUTDOORS:"NO_OUTDOORS",FLATTEN_INDOOR_MAIN:"FLATTEN_INDOOR_MAIN",FLATTEN_OUTDOOR_COPY:"FLATTEN_OUTDOOR_COPY"}),d1="9999999999999",_h="icons",iy="config",cy="https://interactive.data.api.platform.here.com/interactive/v1/catalogs",l0=Object.freeze({THEME:"THEME",THEME_MAP:"THEME_MAP",PRESETS:"PRESETS",SDK_STRINGS:"SDK_STRINGS",ICON_FILE:"ICON_FILE",INPUT_COLORS:"INPUT_COLORS",BASE_MAP_INFO:"BASE_MAP_INFO",CONFIG_PROFILE:"CONFIG_PROFILE",NAV_THEME:"NAV_THEME",NAV_NAME_THEME:"NAV_NAME_THEME",NAV_PROP_MAP:"NAV_PROP_MAP",NAV_STRINGS:"NAV_STRINGS",NAV_THEME_MAP:"NAV_THEME_MAP",NAV_NAME_THEME_MAP:"NAV_NAME_THEME_MAP",V4_THEME_FAMILY:"V4_THEME_FAMILY",V4_MAPTYPE_THEME:"V4_MAPTYPE_THEME",ICON:"ICON",MARKER:"MARKER",PERMISSIONS:"PERMISSIONS",NAICS_ARRAY:"NAICS_ARRAY",NAICS_MAP:"NAICS_MAP"}),l0=(Object.freeze((_e(h0={},l0.THEME,"themeUrls"),_e(h0,l0.THEME_MAP,"themeMapUrl"),_e(h0,l0.PRESETS,"presetsUrl"),_e(h0,l0.SDK_STRINGS,"stringsUrl"),h0)),Object.freeze((_e(h0={},l0.THEME,"themeOverrides"),_e(h0,l0.THEME_MAP,"themeMapOverrides"),_e(h0,l0.PRESETS,"presetOverrides"),_e(h0,l0.SDK_STRINGS,"stringsOverrides"),_e(h0,l0.INPUT_COLORS,"inputColorOverrides"),h0)),Object.freeze((_e(h0={},l0.THEME,["Modern","Standard","Factory","Navteq","TheBase","Westfield_noLabels","Westfield","TDM_noLabel"]),_e(h0,l0.SDK_STRINGS,["Standard","SDK","sdk/standard"]),_e(h0,l0.V4_THEME_FAMILY,["modern","standard"]),_e(h0,l0.V4_MAPTYPE_THEME,["Airport Terminal","Airport","Casino","College Building","College Campus","Convention","General","Hospital","Outdoor","Retail","School Building","School Campus","Shopping Mall","Traffic","Train Station"]),_e(h0,l0.NAV_THEME,["Factory","MapEditor"]),_e(h0,l0.ICON,["Multicolor","Standard","TheBase","Factory"]),h0)),Object.freeze((_e(h0={},l0.THEME,"Modern"),_e(h0,l0.THEME_MAP,"Standard"),_e(h0,l0.PRESETS,"Standard"),_e(h0,l0.SDK_STRINGS,"Standard"),_e(h0,l0.ICON_FILE,"Standard"),_e(h0,l0.INPUT_COLORS,"Standard"),_e(h0,l0.BASE_MAP_INFO,"Standard"),_e(h0,l0.CONFIG_PROFILE,"factory"),_e(h0,l0.NAV_THEME,"Factory"),_e(h0,l0.NAV_NAME_THEME,"FactoryName"),_e(h0,l0.NAV_PROP_MAP,"Standard"),_e(h0,l0.NAV_STRINGS,"Standard"),_e(h0,l0.NAV_THEME_MAP,"Standard"),_e(h0,l0.NAV_NAME_THEME_MAP,"StandardName"),_e(h0,l0.V4_THEME_FAMILY,"Standard"),_e(h0,l0.V4_MAPTYPE_THEME,"Standard"),_e(h0,l0.ICON,"Multicolor"),_e(h0,l0.MARKER,"Standard"),h0)),Object.freeze({GEO_JSON:"GEO_JSON",V5_MAP:"V5_MAP",V5_NAV:"V5_NAV",V5_INFO:"V5_INFO",KML:"KML",SVG:"SVG",PNG:"PNG"})),hy=(Object.freeze(_e({},l0.GEO_JSON,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_ENTITY:"COMMUNITY_ENTITY",PATH_LEVEL_GEOMETRY:"PATH_LEVEL_GEOMETRY",GEOJSON_LEVEL_GEOMETRY:"GEOJSON_LEVEL_GEOMETRY"})),Object.freeze({ACCOUNT_API:"ACCOUNT_API",DEFAULT_COLLECTION:"DEFAULT_COLLECTION",CATALOG_LAYER:"CATALOG_LAYER"})),fy=Object.freeze((_e(h0={},hy.ACCOUNT_API,{BASE_URL:"https://account.api.here.com/authorization/v1.1/projects/me"}),_e(h0,hy.DEFAULT_COLLECTION,{BASE_URL:"https://config.data.api.platform.here.com/config/v1/catalogs",PARAMS:{CREATED_BY:"created",COLLECTION:"-collection"}}),_e(h0,hy.CATALOG_LAYER,{BASE_URL:"https://interactive.data.api.platform.here.com/interactive/v1/catalogs",MOMDATA_LAYER:"9999999999999",ICON_LAYER:"icons",THEMERULE_LAYER:"config",COLLECTION_LAYER:"layers/9999999999999/search",PARAMS:{FEATURE_TYPE:{KEY:"p.featureType",VALUE:"indoor.Site"}}}),h0)),vy=Object.freeze({isIconsEnabled:!0,isMetaEnabled:!0,metaOptions:{},iconOptions:{}}),Py=Object.freeze({GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE",PATCH:"PATCH",OPTIONS:"OPTIONS",HEAD:"HEAD"});function Ey(){}function My(){My.init.call(this)}function By(ey){return ey._maxListeners===void 0?My.defaultMaxListeners:ey._maxListeners}function $y(ey,_i,_s,_a){var _u,_d;if(typeof _s!="function")throw new TypeError('"listener" argument must be a function');return(_u=ey._events)?(_u.newListener&&(ey.emit("newListener",_i,_s.listener||_s),_u=ey._events),_d=_u[_i]):(_u=ey._events=new Ey,ey._eventsCount=0),_d?(typeof _d=="function"?_d=_u[_i]=_a?[_s,_d]:[_d,_s]:_a?_d.unshift(_s):_d.push(_s),_d.warned||(_a=By(ey))&&0<_a&&_d.length>_a&&(_d.warned=!0,(_a=new Error("Possible EventEmitter memory leak detected. "+_d.length+" "+_i+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",_a.emitter=ey,_a.type=_i,_a.count=_d.length,_a=_a,typeof console.warn=="function"?console.warn(_a):console.log(_a))):(_d=_u[_i]=_s,++ey._eventsCount),ey}function Zy(ey,_i,_s){var _a=!1;function _u(){ey.removeListener(_i,_u),_a||(_a=!0,_s.apply(ey,arguments))}return _u.listener=_s,_u}function y0(ey){var _i=this._events;if(_i){if(_i=_i[ey],typeof _i=="function")return 1;if(_i)return _i.length}return 0}function S0(ey,_i){for(var _s=new Array(_i);_i--;)_s[_i]=ey[_i];return _s}Ey.prototype=Object.create(null),(My.EventEmitter=My).usingDomains=!1,My.prototype.domain=void 0,My.prototype._events=void 0,My.prototype._maxListeners=void 0,My.defaultMaxListeners=10,My.init=function(){this.domain=null,My.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Ey,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},My.prototype.setMaxListeners=function(ey){if(typeof ey!="number"||ey<0||isNaN(ey))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=ey,this},My.prototype.getMaxListeners=function(){return By(this)},My.prototype.emit=function(ey){var _i,_s,_a,_u=ey==="error",_d=this._events;if(_d)_u=_u&&_d.error==null;else if(!_u)return!1;if(ny=this.domain,_u){var ny,_u=arguments[1];if(ny)return(_u=_u||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,_u.domain=ny,_u.domainThrown=!1,ny.emit("error",_u),!1;throw _u instanceof Error?_u:((ny=new Error('Uncaught, unspecified "error" event. ('+_u+")")).context=_u,ny)}if(!(_i=_d[ey]))return!1;var sy,ay=typeof _i=="function";switch(sy=arguments.length){case 1:var Vy=_i,Fy=ay,uy=this;if(Fy)Vy.call(uy);else for(var dy=Vy.length,my=S0(Vy,dy),_y=0;_y<dy;++_y)my[_y].call(uy);break;case 2:var Fy=_i,Vy=ay,Iy=this,Ky=arguments[1];if(Vy)Fy.call(Iy,Ky);else for(var zy=Fy.length,Oy=S0(Fy,zy),ky=0;ky<zy;++ky)Oy[ky].call(Iy,Ky);break;case 3:var Xy=_i,Uy=ay,Ry=this,Dy=arguments[1],Jy=arguments[2];if(Uy)Xy.call(Ry,Dy,Jy);else for(var Sy=Xy.length,jy=S0(Xy,Sy),Yy=0;Yy<Sy;++Yy)jy[Yy].call(Ry,Dy,Jy);break;case 4:var Uy=_i,Xy=ay,u0=this,e0=arguments[1],M0=arguments[2],E0=arguments[3];if(Xy)Uy.call(u0,e0,M0,E0);else for(var N0=Uy.length,j0=S0(Uy,N0),G0=0;G0<N0;++G0)j0[G0].call(u0,e0,M0,E0);break;default:for(_s=new Array(sy-1),_a=1;_a<sy;_a++)_s[_a-1]=arguments[_a];var b0=_i,_0=ay,Y0=this,x0=_s;if(_0)b0.apply(Y0,x0);else for(var o1=b0.length,Y1=S0(b0,o1),R1=0;R1<o1;++R1)Y1[R1].apply(Y0,x0)}return!0},My.prototype.on=My.prototype.addListener=function(ey,_i){return $y(this,ey,_i,!1)},My.prototype.prependListener=function(ey,_i){return $y(this,ey,_i,!0)},My.prototype.once=function(ey,_i){if(typeof _i!="function")throw new TypeError('"listener" argument must be a function');return this.on(ey,Zy(this,ey,_i)),this},My.prototype.prependOnceListener=function(ey,_i){if(typeof _i!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(ey,Zy(this,ey,_i)),this},My.prototype.removeListener=function(ey,_i){var _s,_a,_u,_d,ny;if(typeof _i!="function")throw new TypeError('"listener" argument must be a function');if((_a=this._events)&&(_s=_a[ey])){if(_s===_i||_s.listener&&_s.listener===_i)--this._eventsCount==0?this._events=new Ey:(delete _a[ey],_a.removeListener&&this.emit("removeListener",ey,_s.listener||_i));else if(typeof _s!="function"){for(_u=-1,_d=_s.length;0<_d--;)if(_s[_d]===_i||_s[_d].listener&&_s[_d].listener===_i){ny=_s[_d].listener,_u=_d;break}if(_u<0)return this;if(_s.length===1){if(_s[0]=void 0,--this._eventsCount==0)return this._events=new Ey,this;delete _a[ey]}else{for(var sy=_s,ay=_u,uy=ay+1,dy=sy.length;uy<dy;ay+=1,uy+=1)sy[ay]=sy[uy];sy.pop()}_a.removeListener&&this.emit("removeListener",ey,ny||_i)}}return this},My.prototype.removeAllListeners=function(ey){var _i,_s=this._events;if(_s){if(!_s.removeListener)return arguments.length===0?(this._events=new Ey,this._eventsCount=0):_s[ey]&&(--this._eventsCount==0?this._events=new Ey:delete _s[ey]),this;if(arguments.length===0){for(var _a,_u=Object.keys(_s),_d=0;_d<_u.length;++_d)(_a=_u[_d])!=="removeListener"&&this.removeAllListeners(_a);return this.removeAllListeners("removeListener"),this._events=new Ey,this._eventsCount=0,this}if(typeof(_i=_s[ey])=="function")this.removeListener(ey,_i);else if(_i)for(;this.removeListener(ey,_i[_i.length-1]),_i[0];);}return this},My.prototype.listeners=function(_s){var _i=this._events,_s=_i&&(_i=_i[_s])?typeof _i=="function"?[_i.listener||_i]:function(_a){for(var _u=new Array(_a.length),_d=0;_d<_u.length;++_d)_u[_d]=_a[_d].listener||_a[_d];return _u}(_i):[];return _s},My.listenerCount=function(ey,_i){return typeof ey.listenerCount=="function"?ey.listenerCount(_i):y0.call(ey,_i)},My.prototype.listenerCount=y0,My.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};function V0(ey,_i,_s){return _s===F1.ObjectType.SEGMENT_START_MARKER?ey===0?m_:null:_s===F1.ObjectType.SEGMENT_FINISH_MARKER?_i.length===1||ey===_i.length-1?__:null:_i[ey].departure.place.type==="indoor"?y_:v_}var i0="venues-ui-button--active",a0="venues-ui-button",r0="venues-ui__drawings",m0="data-drawing",R0=function(){function ey(_i,_s,ny){var _u=this,_d=(j(this,ey),this.clickHandler=ny,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("class",r0),document.createElement("div")),ny=(_d.setAttribute("class","trigger ".concat(a0)),document.createElement("div"));ny.setAttribute("class","arrow arrow--down"),_d.appendChild(ny),_d.addEventListener("click",function(){_d.classList.toggle(i0),_u.containerButtons.classList.toggle("drawings--open")}),this.containerDiv.appendChild(_d),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","drawings"),this.containerDiv.appendChild(this.containerButtons),_s&&this.update(_s),_i.appendChild(this.containerDiv)}return _t(ey,[{key:"drawButton",value:function(_i,_s,ny){var _u=this,_d=document.createElement("div"),ny=Number(ny)===Number(_i);_d.setAttribute("class",ny?"".concat(a0," ").concat(i0):a0),_d.innerHTML=_s,_d.setAttribute(m0,_i),_d.addEventListener("click",function(){_u.switch(_i),_u.clickHandler(_i)}),this.containerButtons.appendChild(_d)}},{key:"switch",value:function(_i){this.containerButtons.querySelectorAll(".".concat(r0," .").concat(i0)).forEach(function(_s){return _s.setAttribute("class",a0)}),_i=this.containerButtons.querySelector("[".concat(m0,"='").concat(_i,"']")),_i&&_i.setAttribute("class","".concat(a0," ").concat(i0))}},{key:"update",value:function(_i){var _s=this,_a=(this.containerButtons.innerHTML="",function(_u){return _u=_u.getDrawings(),new Map(_u.map(function(_d){var ny=_d.getDisplayName()||_d.getName();return[_d.getId(),ny]}))}(_i));0<_a.size&&_a.forEach(function(_u,_d){return _s.drawButton(_d,_u,_i.getRootDrawing().getId())})}}]),ey}(),z0="venues-ui-button--active",L0="venues-ui-button",I0="data-level",w0="venues-ui__levels",g1=function(){function ey(_i,_s,_a,_u){var _d=4<arguments.length&&arguments[4]!==void 0?arguments[4]:4;j(this,ey),this.clickHandler=_u,this.levelButtonCount=_d,this.currentScrollIndex=0,this.containerUI=document.createElement("div"),this.containerUI.setAttribute("class","".concat(w0)),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","levels"),this.containerUI.appendChild(this.containerButtons),_s&&this.update(_s,_a),_i.appendChild(this.containerUI)}return _t(ey,[{key:"clear",value:function(){this.containerButtons.innerHTML="",this.buttonScrollUp&&(this.containerUI.removeChild(this.buttonScrollUp),this.buttonScrollUp=null),this.buttonScrollDown&&(this.containerUI.removeChild(this.buttonScrollDown),this.buttonScrollDown=null)}},{key:"drawLevelButton",value:function(_i,_s){var _a=this,_u=document.createElement("div");_u.innerHTML=_s,_u.style.fontSize="".concat(Math.max(Math.min(28.8/_s.length,11.52),10),"px"),_u.style.display="block",_u.setAttribute("class",L0),_u.setAttribute(I0,_i),_u.addEventListener("click",function(){_a.switch(_i),_a.clickHandler(_i)}),this.containerButtons.appendChild(_u)}},{key:"drawScrollButtons",value:function(){var _i=this,_s=(this.buttonScrollUp=document.createElement("div"),this.buttonScrollUp.setAttribute("class","".concat(L0," ").concat(L0,"--up")),document.createElement("div")),_s=(_s.setAttribute("class","arrow arrow--up"),this.buttonScrollUp.appendChild(_s),this.buttonScrollUp.addEventListener("click",function(){return _i.scroll(1)}),this.containerUI.insertBefore(this.buttonScrollUp,this.containerButtons),this.buttonScrollDown=document.createElement("div"),this.buttonScrollDown.setAttribute("class","".concat(L0," ").concat(L0,"--down")),document.createElement("div"));_s.setAttribute("class","arrow arrow--down"),this.buttonScrollDown.appendChild(_s),this.buttonScrollDown.addEventListener("click",function(){return _i.scroll(-1)}),this.containerUI.appendChild(this.buttonScrollDown)}},{key:"scroll",value:function(){var _i,_s,_a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,_u=Array.from(this.containerButtons.querySelectorAll(".".concat(L0))).reverse(),_d=[];0<=_a?(this.currentScrollIndex=Math.min(this.currentScrollIndex+_a,_u.length-this.levelButtonCount),_i=Math.min(this.currentScrollIndex,_u.length-this.levelButtonCount),_s=Math.min(this.currentScrollIndex+this.levelButtonCount,_u.length),_d=_u.slice(_i,_s)):_a<0&&(this.currentScrollIndex=Math.max(this.currentScrollIndex+_a,0),_i=Math.max(0,this.currentScrollIndex),_s=Math.min(_u.length,this.currentScrollIndex+this.levelButtonCount),_d=_u.slice(_i,_s)),_u.forEach(function(ny){_d.indexOf(ny)!==-1?ny.style.display="block":ny.style.display="none"}),this.buttonScrollDown&&(this.currentScrollIndex===0?this.buttonScrollDown.setAttribute("disabled","disabled"):this.buttonScrollDown.removeAttribute("disabled")),this.buttonScrollUp&&(this.currentScrollIndex===_u.length-this.levelButtonCount?this.buttonScrollUp.setAttribute("disabled","disabled"):this.buttonScrollUp.removeAttribute("disabled"))}},{key:"switch",value:function(_a){this.containerButtons.querySelectorAll(".".concat(z0)).forEach(function(_u){return _u.setAttribute("class",L0)});var _s,_a=this.containerButtons.querySelector(".".concat(w0," [").concat(I0,"='").concat(_a,"']"));_a&&(_s=Array.from(this.containerButtons.querySelectorAll(".".concat(L0))).reverse(),_a.setAttribute("class","".concat(L0," ").concat(z0)),((_s=_s.indexOf(_a))<this.currentScrollIndex||_s>=this.currentScrollIndex+4)&&this.scroll(_s-this.currentScrollIndex))}},{key:"update",value:function(_i,_d){var _a,_u=this,_d=function(){return new Map((0<arguments.length&&arguments[0]!==void 0?arguments[0]:[]).map(function(sy){return[sy.getZIndex(),sy.getShortName()||sy.getDisplayName()||sy.getName()]}))}((_a=_i,((_d=_d)===F0.FLATTEN?(_d=_a.getVenueModel().getLevelMapFlattenedByZIndex_(),Object.values(_d).map(function(sy){return sy[0]})):_a.getLevels()).sort(function(sy,ay){return ay.getZIndex()-sy.getZIndex()}))),ny=_i.getMainLevel().getZIndex();this.clear(),_d.forEach(function(sy,ay){return _u.drawLevelButton(ay,sy)}),_d.size>this.levelButtonCount&&(_d.size>this.levelButtonCount+1?this.currentScrollIndex=Math.min(Array.from(_d).reverse().findIndex(function(sy){return sy[0]===ny}),_d.size-this.levelButtonCount):this.currentScrollIndex=0,this.drawScrollButtons(),this.scroll(0)),this.switch(ny)}}]),ey}(),Z0=function(){function ey(_i,_s){j(this,ey),this.baseTheme=_i,this.metaInformation=_s,this.labelStyleMap={},this.styleMap={},this.setStyleMap()}return _t(ey,[{key:"setStyleMap",value:function(){this.styleMap.ENTRANCE=this.baseTheme.entranceRules.default.styleProperties,this.labelStyleMap.ENTRANCE=this.baseTheme.entranceRules.default.textLabelStyleProperties;for(var _i=0,_s=Object.entries(this.baseTheme.spaceRules);_i<_s.length;_i++){var _u=ty(_s[_i],2),_a=_u[0],_u=_u[1],_d=_u.properties.behavioralAppearance.default.styleProperties,ny=_u.properties.behavioralAppearance.default.textLabelStyleProperties;if(this.styleMap[_a]=_d,this.labelStyleMap[_a]=ny,_u.spaceTypes)for(var sy=0,ay=Object.entries(_u.spaceTypes);sy<ay.length;sy++){var my=ty(ay[sy],2),uy=my[0],my=my[1],dy=my.behavioralAppearance.default.styleProperties,my=my.behavioralAppearance.default.textLabelStyleProperties;this.styleMap["".concat(_a,"_").concat(uy)]=dy&&Object.keys(dy)!==0?dy:_d,this.labelStyleMap["".concat(_a,"_").concat(uy)]=my&&Object.keys(my)!==0?my:ny}}}},{key:"getBaseTheme",value:function(){return this.baseTheme}},{key:"getStyleMap",value:function(){return this.styleMap}},{key:"getGeometryStyle",value:function(_i){return this.styleMap&&Object.getOwnPropertyNames(this.styleMap)?this.styleMap[_i]:null}},{key:"getLabelStyle",value:function(_i){return this.labelStyleMap&&Object.getOwnPropertyNames(this.labelStyleMap)?this.labelStyleMap[_i]:null}}],[{key:"getGeometryDefaultStyle",value:function(){return{fill:"#e5e5e5",fillOpacity:1,stroke:"#6c7a89",strokeOpacity:1,strokeWidth:2}}},{key:"getLabelDefaultStyle",value:function(){return{stroke:"#6c7a89",zmin:15}}}]),ey}(),m1=function(){function ey(){j(this,ey),this.config=Object.seal({emitEventOnOverrideUpdate:!0}),this.imageCache={},this.releaseSettings_={displayOptions:{},mom:[]},this.theme={}}return _t(ey,[{key:"getMomData",value:function(){return this.releaseSettings_.mom}},{key:"getTheme",value:function(){return this.theme||{}}},{key:"getStyle",value:function(ny){var _s=1<arguments.length&&arguments[1]!==void 0&&arguments[1],_a=this.getTheme(),_u=Z0.getGeometryDefaultStyle(),_d=ny.properties.spaceType,ny=ny.properties.spaceCategory,sy=ny;return _d&&(sy="".concat(ny,"_").concat(_d)),{m:(ny=(ny=_a.getGeometryStyle(sy))&&!_s?ny:_u).fill&&ny.fill.toLowerCase()||"#fff",w:ny.strokeWidth/10||.1,o:ny.stroke&&ny.stroke.toLowerCase()||"#fff",l:"Dark"}}},{key:"getLabelStyle",value:function(_i){this.getTheme();var _s=Z0.getLabelDefaultStyle();return{fill:_s.stroke,zmin:_s.zmin}}}]),ey}(),_1=Math.PI/180,V1=180/Math.PI,b1=function(){function ey(){j(this,ey)}return _t(ey,null,[{key:"toRadians",value:function(_i){return _i*_1}},{key:"toDegrees",value:function(_i){return _i*V1}},{key:"getBoundingBox",value:function(_i,_s){var _a=[];switch(_i){case g0:_a=[_s,_s];break;case P0:case k0:_a=_s;break;case $0:case Qy:_a=_s.reduce(function(_u,_d){return _u.concat(_d)},[]);break;case r1:_a=_s.reduce(function(_u,_d){return _u.concat(_d)},[]).reduce(function(_u,_d){return _u.concat(_d)},[])}return ey.getBoundingBoxVertices(_a)}},{key:"getInverseTransform",value:function(_i){var _s=_i[0]*_i[3]-_i[1]*_i[2],_s=[_i[3]/_s,-_i[1]/_s,-_i[2]/_s,_i[0]/_s,0,0];return _s[4]=-(_s[0]*_i[4]+_s[2]*_i[5]),_s[5]=-(_s[1]*_i[4]+_s[3]*_i[5]),_s}},{key:"applyTransformToPoint",value:function(_i,_s){return[_s[0]*_i[0]+_s[1]*_i[2]+_i[4],_s[0]*_i[1]+_s[1]*_i[3]+_i[5]]}},{key:"transformProduct",value:function(_i,_s){var _a=[0,0,0,0,0,0];return _a[0]=_s[0]*_i[0]+_s[2]*_i[1],_a[1]=_s[1]*_i[0]+_s[3]*_i[1],_a[2]=_s[0]*_i[2]+_s[2]*_i[3],_a[3]=_s[1]*_i[2]+_s[3]*_i[3],_a[4]=_s[0]*_i[4]+_s[2]*_i[5]+_s[4],_a[5]=_s[1]*_i[4]+_s[3]*_i[5]+_s[5],_a}},{key:"convertLonLatToMerc",value:function(_a){var _s=_a[0]*_1,_a=_a[1]*_1,_a=Math.sin(_a);return[.5+_s/(2*Math.PI),.5-Math.log((1+_a)/(1-_a))/(4*Math.PI)]}},{key:"convertMercToLatLon",value:function(_a){var _s=2*Math.PI*(_a[0]-.5),_a=Math.atan(Math.sinh(2*Math.PI*(.5-_a[1])));return[_s/_1,_a/_1]}},{key:"getTransformScale",value:function(_i){return Math.sqrt(_i[0]*_i[3]-_i[1]*_i[2])}},{key:"getLonLatToMercTransform",value:function(_u){var _s=[.002777777777777778,0,0,-1/(360*Math.cos(_u[1]*_1)),0,0],_a=ey.applyTransformToPoint(_s,_u),_u=ey.convertLonLatToMerc(_u);return _s[4]=_u[0]-_a[0],_s[5]=_u[1]-_a[1],_s}},{key:"getNatToMercTransform",value:function(_i){var _s=[_i[4],_i[5]],_s=ey.getLonLatToMercTransform(_s);return ey.transformProduct(_i,_s)}},{key:"convertMxMy2LonLat",value:function(_i,_s){return _i.length&&_s.length?ey.applyTransformToPoint(_i,_s):[]}},{key:"convertLonLat2MxMy",value:function(_i,_s){return!_i.length||!_s.length?[]:(_i=ey.getInverseTransform(_i),ey.applyTransformToPoint(_i,_s))}},{key:"getFlattenedQuadraticBezierCurve",value:function(_i,_s,_a){var _u=[],_d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:10;_d<1&&(_d=6);for(var ny=0;ny<=_d;ny+=1){var ay=ny/_d,dy=(1-ay)*(1-ay),sy=2*ay*(1-ay),ay=ay*ay,uy=dy*_i[0]+sy*_s[0]+ay*_a[0],dy=dy*_i[1]+sy*_s[1]+ay*_a[1];_u.push([uy,dy])}return _u}},{key:"getFlattenedCubicBezierCurve",value:function(_i,_s,_a,_u){var _d=[],ny=4<arguments.length&&arguments[4]!==void 0?arguments[4]:10;ny<1&&(ny=6);for(var sy=0;sy<=ny;sy+=1){var dy=sy/ny,_y=(1-dy)*(1-dy)*(1-dy),ay=3*dy*(1-dy)*(1-dy),uy=3*dy*dy*(1-dy),dy=dy*dy*dy,my=_y*_i[0]+ay*_s[0]+uy*_a[0]+dy*_u[0],_y=_y*_i[1]+ay*_s[1]+uy*_a[1]+dy*_u[1];_d.push([my,_y])}return _d}},{key:"getRectangularCoordinatesOfLabelArea",value:function(dy,_s){var _a=!(2<arguments.length&&arguments[2]!==void 0)||arguments[2],ay=ty(dy,6),_u=ay[0],_d=ay[1],ny=ay[2],sy=ay[3],ay=ay[5],uy=ey.getDeltaLonLatForMeterAtGivenLonLat(_u,_d),dy=dy[4];return _a?(ay&&(dy*=-1),_s!=null&&(dy=(dy+=_s<0?2*Math.PI+_s:_s)<0?2*Math.PI+dy:dy)):dy=0,ey.getRectVerticesFromSignatureRectRepresentation([_u,_d],{xLength:ny,yLength:sy},dy,uy)}},{key:"getRotatedPoint",value:function(ay,ny){var _a=!(2<arguments.length&&arguments[2]!==void 0)||arguments[2],_u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:[0,0],_d=Math.cos(ny),ny=Math.sin(ny),sy=ay[0]-_u[0],ay=ay[1]-_u[1],uy=[];return[(uy=_a?[sy*_d+ay*ny,ay*_d-sy*ny]:[sy*_d-ay*ny,ay*_d+sy*ny])[0]+_u[0],uy[1]+_u[1]]}},{key:"getRectVerticesFromSignatureRectRepresentation",value:function(_y,ny,_a,_u){var _d=ny.xLength,ny=ny.yLength,sy=!(4<arguments.length&&arguments[4]!==void 0)||arguments[4],_y=ty(_y,2),ay=_y[0],uy=_y[1],dy=_d/2,my=ny/2,_y=ty(_u,2),Fy=_y[0],Vy=_y[1];return[[1,1],[-1,1],[-1,-1],[1,-1]].map(function(Iy){return[Iy[0]*dy,Iy[1]*my]}).map(function(Iy){return ey.getRotatedPoint(Iy,_a,sy)}).map(function(Iy){return[Iy[0]*Fy,Iy[1]*Vy]}).map(function(Iy){return[Iy[0]+ay,Iy[1]+uy]})}},{key:"getScaleFactorForRectInSpace",value:function(_i,_s,_a,_u){return _i/=_a,_a=_s/_u,_a<_i?_a:_i}},{key:"getDeltaLonLatForMeterAtGivenLonLat",value:function(_i,_s){return[1/6371e3*(180/Math.PI)/Math.cos(_s*Math.PI/180),1/6371e3*(180/Math.PI)]}},{key:"getBoundingBoxVertices",value:function(){var _i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],_s=[[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]];return _i.reduce(function(_a,_u){return[[Math.min(_u[0],_a[0][0]),Math.min(_u[1],_a[0][1])],[Math.max(_u[0],_a[1][0]),Math.max(_u[1],_a[1][1])]]},_s)}},{key:"isPointInBoundingBox",value:function(_i,_s){var _a,_u,_d,ny;if(_i&&_s)return _i=ty(_i,2),_a=_i[0],_i=_i[1],_s=ty(_s,2),_d=ty(_s[0],2),_u=_d[0],_d=_d[1],_s=ty(_s[1],2),ny=_s[0],_s=_s[1],_a<=ny&&_u<=_a&&_i<=_s&&_d<=_i}},{key:"isPointOnLineSegment",value:function(_d,sy,uy){var _d=ty(_d,2),_u=_d[0],_d=_d[1],sy=ty(sy,2),ny=sy[0],sy=sy[1],uy=ty(uy,2),ay=uy[0],uy=uy[1],dy=(sy-_d)*(uy-_d)<=0;return ny===ay?ny===_u&&dy:_d-uy==(uy-sy)/(ay-ny)*(_u-ay)&&dy}},{key:"rayIntersectLineSegment",value:function(_d,sy,uy){var _d=ty(_d,2),_u=_d[0],_d=_d[1],sy=ty(sy,2),ny=sy[0],sy=sy[1],uy=ty(uy,2),ay=uy[0],uy=uy[1];return ny===ay?!1:(_u=(_u-ny)/(ay-ny),0<=_u&&_u<1&&_d<(uy-sy)*_u+sy)}},{key:"isPointInPolygon",value:function(_d,_s){var _d=ty(_d,2),_a=_d[0],_u=_d[1],_d=_s.length;if(_d<3)return!1;var ny=0,sy=_s[_d-1];return _s.forEach(function(ay){ey.rayIntersectLineSegment([_a,_u],sy,ay)&&(ny+=1),sy=ay}),ny%2!=0}},{key:"isPointOnLineString",value:function(_a,_s){var _a=ty(_a,2),_u=_a[0],_d=_a[1],ny=_s.length;if(!(ny<2))for(var sy=_s[ny-1],ay=0;ay<ny;ay+=1){var uy=_s[ay];if(ey.isPointOnLineSegment([_u,_d],sy,uy))return!0;sy=_s[ay]}return!1}},{key:"getAreaOfPolygon",value:function(_i){var _s=_i.length;if(_s<3)return null;var _a=0,_u=_i[_s-1];return _i.forEach(function(_d){var ny,sy,ay,uy;_a+=.5*(sy=_d,ny=ty(ny=_u,2),ay=ny[0],ny=ny[1],sy=ty(sy,2),uy=sy[0],ay*sy[1]-ny*uy),_u=_d}),_a}},{key:"getDistanceBetweenPoints",value:function(_d,_a){var _d=ty(_d,2),_u=_d[0],_d=_d[1],_a=ty(_a,2),_u=_u-_a[0],_d=_d-_a[1];return Math.sqrt(_u*_u+_d*_d)}}]),ey}(),t_=function(){function ey(){j(this,ey),this.spaceRules={}}return _t(ey,null,[{key:"getDataEntriesOne",value:function(_u,_s){var _a,_u=[_u,""];return _s!==null&&Array.isArray(_s)?_u[1]=_s.toString():_s!==null&&g(_s)==="object"?0<(_a=Object.entries(_s)).length&&(_a=this.getDataEntriesOne(_a[0][0],_a[0][1]),_u[0]="".concat(_u[0],".").concat(_a[0]),_u[1]=_a[1]):_u[1]=_s,_u}},{key:"getDataEntriesAll",value:function(_i){for(var _s=[],_a=0,_u=Object.entries(_i);_a<_u.length;_a++){var _d=ty(_u[_a],2),ny=_d[0],_d=_d[1],ny=this.getDataEntriesOne(ny,_d);_s.push(ny)}return _s}},{key:"doFindComboMatch",value:function(_i,_s){var _a="";if(_i&&_i.configuration&&_i.configuration.combinations)for(var _u=this.getDataEntriesAll(_s),_s=Object.entries(_i.configuration.combinations),_d=0,ny=0,sy=_s;ny<sy.length;ny++)(function(){var uy=sy[ny],dy=Object.keys(uy[1]).filter(function(my){return _u.some(function(_y){return my===_y[0]&&uy[1][my]===_y[1]})});dy.length===Object.keys(uy[1]).length&&dy.length>_d&&(_a=uy[0],_d=dy.length)})();return _a}},{key:"getIconFromCombinations",value:function(_i,_s){if(_i&&_i.configuration.combinations&&_s&&0<Object.keys(_s).length&&_i.behavioralAppearance.combinations&&0<Object.keys(_i.behavioralAppearance.combinations).length){if(_s=this.doFindComboMatch(_i,_s),_s===""||!_i.behavioralAppearance.combinations[_s].labelIcon)return"";if(_i.behavioralAppearance.combinations&&_i.behavioralAppearance.combinations[_s]&&_i.behavioralAppearance.combinations[_s].labelIcon)return _i.behavioralAppearance.combinations[_s].labelIcon.referenceUri}return""}},{key:"findSpace",value:function(_i,_s){if(_s.spaceTypes&&_s.spaceTypes[_i])return _s.spaceTypes[_i]}},{key:"findCategory",value:function(_i){if(this.spaceRules[_i])return this.spaceRules[_i]}},{key:"setSpaceRules",value:function(_i){this.spaceRules=_i}},{key:"getSpaceIcon",value:function(_i,ny,_a){var _u,_d="",ny=this.findCategory(ny);return ny&&(_i=this.findSpace(_i,ny))&&(_u="",(_u=_a?this.getIconFromCombinations(_i,_a):_u)&&_u!==""?_d=_u:_i.behavioralAppearance.default.labelIcon?_d=_i.behavioralAppearance.default.labelIcon.referenceUri:ny.properties.behavioralAppearance.default.labelIcon&&(_d=ny.properties.behavioralAppearance.default.labelIcon.referenceUri)),_d}}]),ey}(),f1=function(){function ey(){j(this,ey),this.themeRule={},this.svgList={},this.defaultLang="ENG"}return _t(ey,null,[{key:"getNumberFromAlphaNumeric",value:function(_i){try{var _s=_i.split("").reverse().join("").replace(/[^0-9]/g,"").substr(0,6);return parseInt(_s,10)}catch{return null}}},{key:"extractNumFromSting",value:function(_i){try{var _s=_i.replace(/[^0-9]/g,"");return parseInt(_s,10)}catch{return console.warn("Exception in converting string to Id"),this.getNumberFromAlphaNumeric(_i)}}},{key:"getVenueId",value:function(_i){var _s;return typeof _i!="number"?(_s=_i.substr(_i.length-6),parseInt(_s,10)):_i}},{key:"getStringFormatIdentifier",value:function(_i){return typeof _i=="number"||_i.length<13?"indoormap-00000000-0000-4000-a000-".concat(_i.toString().padStart(12,"0")):_i}},{key:"setSite",value:function(_u,_s){var _a=this.getName(_u),_u={id:this.getStringFormatIdentifier(_s),location:_u.referencePoint,properties:_u.properties,geometry:_u.geometry,map_version:_u.properties.indoorSiteMetadata.legacyVersion.mapVersion,identifier:this.getVenueId(_s),obj_type:"CommunityMap"};return _u.properties.name=_a,_u.properties.display_name=_a,_u}},{key:"setEntrance",value:function(_i){var _s=this.themeRule.entranceRules.default.labelIcon.referenceUri,_a=this.extractNumFromSting(_i.id),_u=this.getName(_i),_d=_i.properties;return _d.icon=!0,_d.svg=this.svgList[_s.toLowerCase()],_d.name=_u||"entrance",_d.display_name=_u||"entrance",_d.level={id:_i.properties.level.id},{id:_i.id,levelId:_i.properties.level.id,momType:xy,geometry:_i.geometry,location:_i.geometry,properties:_d,identifier:_a,label_area:[_i.referencePoint.coordinates[0],_i.referencePoint.coordinates[1],50,50,180]}}},{key:"setStructure",value:function(_i){var _s=this.extractNumFromSting(_i.id),_a=this.getName(_i),_u=_i.properties;return _u.is_root=_i.properties.drawOrder===0,_u.display_name=_a,_u.map_type=_i.properties.structureType,_u.name=_a,{id:_i.id,obj_type:"Drawing",identifier:_s,properties:_u}}},{key:"getNameByPriority",value:function(_i,_s){for(var _a,_u=this,_d="",ny=0;ny<_i.length;ny++){var sy=_i[ny];if(((_a=sy).nameType==="OFFICIAL"&&_a.languageCode&&_a.languageCode===_u.defaultLang||_a.nameType==="OFFICIAL")&&(_s&&_s===sy.nameType||!_s)){_d=sy.name;break}if(sy.nameType==="ABBREVIATION"&&(_s&&_s===sy.nameType||!_s)){_d=sy.name;break}if(sy.nameType==="UNCLASSIFIED"&&(_s&&_s===sy.nameType||!_s)){_d=sy.name;break}if(!sy.nameType&&sy.name){_d=sy.name;break}}return _d}},{key:"getName",value:function(_i,_s){return _i.properties&&_i.properties.names?this.getNameByPriority(_i.properties.names,_s):_i.properties.placeProperties&&_i.properties.placeProperties&&_i.properties.placeProperties.names?this.getNameByPriority(_i.properties.placeProperties.names,_s):_i.properties.locationDetails&&_i.properties.locationDetails[0]&&_i.properties.locationDetails[0].names?this.getNameByPriority(_i.properties.locationDetails[0].names,_s):""}},{key:"setLevel",value:function(_i){var _s=this.extractNumFromSting(_i.id),_a=_i.properties.names,_u=_i.properties;return _u["short name"]=this.getNameByPriority(_a,_a&&_a.length!==1?"ABBREVIATION":""),_u.name=this.getNameByPriority(_a,_a&&_a.length!==1?"ABBREVIATION":""),{id:_i.id,obj_type:"Level",identifier:_s,properties:_u}}},{key:"setLevelConnector",value:function(_i){var _s=this.extractNumFromSting(_i.id);return{id:_i.id,obj_type:"LevelConnector",properties:_i.properties,geometry:_i.geometry,identifier:_s,location:_i.geometry}}},{key:"setOccupant",value:function(_i){var _s=this.getName(_i),_a=this.extractNumFromSting(_i.id),_u=_i.properties;return _u.occupantName=_s,_u.email=_i.properties.placeProperties&&_i.properties.placeProperties.contacts&&_i.properties.placeProperties.contacts.find(function(_d){return _d.contactType==="EMAIL"})&&_i.properties.placeProperties.contacts.find(function(_d){return _d.contactType==="EMAIL"}).value,_u.name=_s,_u.tags=_i.properties.attributes&&_i.properties.attributes.tags,{geometry:_i.geometry,id:_i.id,obj_type:"Geometry",properties:_u,identifier:_a,spaceIds:_i.properties.spaces||[],type:"Feature",momType:S1}}},{key:"getIcon",value:function(_i){var _s=!1,_a="";return this.svgList[_i]&&(_s=!0,_a=this.svgList[_i]),{icon:_s,svg:_a}}},{key:"setSpace",value:function(_i){var _a=t_.getSpaceIcon(_i.properties.spaceType,_i.properties.spaceCategory,_i.properties.spaceTypeProperties),sy=this.getName(_i),_a=this.getIcon(_a),_s=_a.icon,_a=_a.svg,_u=this.extractNumFromSting(_i.id),_d=(_i.properties.level.id.includes("out"),_i.properties.level.id),ny=_i.properties,sy=(ny.spaceName=sy,ny[_i.properties.spaceCategory]=_i.properties.spaceType,ny.spaceType=_i.properties.spaceType,ny.spaceCategory=_i.properties.spaceCategory,ny.icon=_s,ny.svg=_a,{geometry:_i.geometry,id:_i.id,levelId:_d,label_area:[_i.referencePoint.coordinates[0],_i.referencePoint.coordinates[1],50,50,180],location:_i.referencePoint,obj_type:"Geometry",identifier:_u,properties:ny,momType:A1,type:"Feature"});return _i.properties.spaceAddress&&_i.properties.spaceAddress.id&&(sy.addressId=_i.properties.spaceAddress.id),sy}},{key:"setSpaceGroups",value:function(_i){var _s=this.extractNumFromSting(_i.id);return{id:_i.id,obj_type:"SpaceGroups",properties:_i.properties,geometry:_i.geometry,location:_i.referencePoint,identifier:_s}}},{key:"setTopology",value:function(_i){var _s=this.extractNumFromSting(_i.id);return{id:_i.id,obj_type:"Topology",properties:_i.properties,geometry:_i.geometry,identifier:_s}}},{key:"setAddress",value:function(_i){var _s=this.extractNumFromSting(_i.id),_a=this.getName(_i),_u=_i.properties;return _u.addressName=_a,_u.name=_a,{id:_i.id,properties:_u,obj_type:"Address",identifier:_s}}},{key:"manageSvgDimensions",value:function(_i){for(var _s={},_a=0,_u=Object.entries(_i);_a<_u.length;_a++){var _d,ny,ay=ty(_u[_a],2),sy=ay[0],ay=ay[1];typeof ay=="string"&&(_d=ay.indexOf("<g")!==-1&&ay.indexOf("<g")||ay.indexOf("<p"),ny=ay.indexOf("</s"),_d&&ny&&(ay=ay.substring(_d-1,ny-1),_s[sy]="<svg width='64' height='64' viewBox='0 0 24 32' fill='none' xmlns='http://www.w3.org/2000/svg'>".concat(ay,"</svg>")))}return _s}},{key:"getSiteBoundingBox",value:function(_i){if(_i){var _i=ty(b1.getBoundingBox(_i.geometry.type,_i.geometry.coordinates),2),_s=_i[0],_i=_i[1];if(_s)return"".concat(_s[0],",").concat(_s[1],",").concat(_i[0],",").concat(_i[1])}return"null, null, null, null"}}]),ey}(),j1=function(){function ey(){j(this,ey)}return _t(ey,null,[{key:"get",value:function(_i){return fetch(_i,1<arguments.length&&arguments[1]!==void 0?arguments[1]:{method:"GET"}).then(function(_s){return _s.ok?_s.json():Promise.reject(new Error("Call failed for ".concat(_i," : ").concat(_s.status," ").concat(_s.statusText)))})}},{key:"getFormattedIndoorMapId",value:function(_i){return typeof _i=="number"?"indoormap-00000000-0000-4000-a000-".concat(_i.toString().padStart(12,"0")):_i.includes("indoormap")?_i:"indoormap-00000000-0000-4000-a000-".concat(_i.padStart(12,"0"))}},{key:"getConfigUrl",value:function(_i,_s,ay){var _u=ay.apiKey,sy=ay.url,_d=ay.token,ay=ay.hrn,ny={method:"GET",mode:"cors",cache:"default"},sy="".concat(sy||cy,"/").concat(ay),ay="";return _s===c1.SITE&&(ay="".concat(sy,"/layers/").concat(d1,"/search?p.featureType=indoor.Site&p.indoorMapId='").concat(this.getFormattedIndoorMapId(_i),"'")),_s===c1.IMAGES&&(ay="".concat(sy,"/layers/").concat(_h,"/features/svg")),_s===c1.Theme&&(ay="".concat(sy,"/layers/").concat(iy,"/features/indoorMapRules")),_d?ny.headers={Authorization:"Bearer ".concat(_d)}:ay=ay.concat("".concat(_s===c1.SITE?"&":"?","apiKey=").concat(_u)),this.get(ay,ny)}},{key:"getMomData",value:function(sy,ny){var _a=ny.apiKey,ay=ny.url,_u=ny.token,ny=ny.hrn,_d={method:"GET",mode:"cors",cache:"default"},ay="".concat(ay||cy,"/").concat(ny),ny=sy&&sy.features&&sy.features.find(function(uy){return uy.momType===v1}),sy=f1.getSiteBoundingBox(ny),ay="".concat(ay,"/layers/").concat(d1,"/bbox?bbox=").concat(sy,"&f.momType=indoor.Level,indoor.Space,indoor.Site,indoor.Structure,indoor.Occupant,indoor.SpaceGroups,Address,indoor.Entrance");return _u?_d.headers={Authorization:"Bearer ".concat(_u)}:ay=ay.concat("&apiKey=".concat(_a)),{mom:this.get(ay,_d),site:ny}}},{key:"getDefaultCollection",value:function(_s){var _s=_s.token,_u=fy[hy.DEFAULT_COLLECTION],_a=_u.PARAMS,_u=_u.BASE_URL,_u=encodeURI("".concat(_u,"?sortBy=").concat(_a.CREATED_BY,"&q=").concat(_a.COLLECTION));return _s?(_a={method:"GET",headers:{Authorization:"Bearer ".concat(_s)}},this.get(_u,_a)):Promise.reject(new Error("Please provide valid token"))}},{key:"getProjectAccountDetails",value:function(_s){var _s=_s.token,_a=fy[hy.ACCOUNT_API].BASE_URL;return _s?(_s={method:"GET",mode:"cors",headers:{Authorization:"Bearer ".concat(_s)}},this.get(_a,_s)):Promise.reject(new Error("Please provide valid token"))}},{key:"fetchIndoorMapList",value:function(){var _i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},_s=_i.hrn,_d=_i.url,_u=fy[hy.CATALOG_LAYER],_a=_u.PARAMS,_u=_u.COLLECTION_LAYER,_d=_d||cy;return _s?(_d=encodeURI("".concat(_d,"/").concat(_s,"/").concat(_u,"?").concat(_a.FEATURE_TYPE.KEY,"=").concat(_a.FEATURE_TYPE.VALUE)),_u=(_s=this.createBaseUrl(_d,Py.GET,{},_i)).URL,_a=_s.options,this.get(_u,_a)):Promise.reject(new Error("Please provide valid hrn"))}},{key:"createBaseUrl",value:function(){var _i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",ny=1<arguments.length&&arguments[1]!==void 0?arguments[1]:Py.GET,_s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},_u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{},_a=_u.token,_u=_u.apiKey,_d=_i,ny={method:ny,mode:"cors"};return _a?ny.headers=h({Authorization:"Bearer ".concat(_a)},_s):_d=_i.concat("&apiKey=".concat(_u)),{URL:_d,options:ny}}}]),ey}(),D1=function(){function ey(){j(this,ey)}return _t(ey,null,[{key:"isPointOnGeoJSONLineString",value:function(_i,_s){var _a=!1;if(_s&&1<_s.length){for(var _u,_d,ny=1;ny<_s.length;ny+=1)if(_u=_s[ny-1],_d=_s[ny],b1.isPointOnLineSegment(_i,_u,_d)){_a=!0;break}}return _a}},{key:"isPointOnGeoJSONMultiLineString",value:function(_i,_s){for(var _a=!1,_u=0;_u<_s.length;_u+=1)if(ey.isPointOnGeoJSONLineString(_i,_s[_u])){_a=!0;break}return _a}},{key:"isPointInsideGeoJSONPolygon",value:function(_i,_s){var _a=!1;if(_a=b1.isPointInPolygon(_i,_s[0])?!0:_a){for(var _u=1;_u<_s.length;_u+=1)if(b1.isPointInPolygon(_i,_s[_u])){_a=!1;break}}return _a}},{key:"isPointInsideGeoJSONMultiPolygon",value:function(_i,_s){for(var _a=_s.length,_u=0;_u<_a;_u+=1)if(ey.isPointInsideGeoJSONPolygon(_i,_s[_u]))return!0;return!1}},{key:"getGeometriesByLonLat",value:function(_i,_s){for(var _a=2<arguments.length&&arguments[2]!==void 0&&arguments[2],_u=[],_d=_s.filter(function(ay){return b1.isPointInBoundingBox(_i,ay.getBoundingBox())}),ny=0;ny<_d.length;ny+=1){var sy=_d[ny];if(sy.isPointInsideGeometry(_i,!0)&&(_u.push(sy),!_a))break}return _u.sort(function(ay,uy){return uy.getZIndex()-ay.getZIndex()})}}]),ey}(),s_=function(){function ey(){var _i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},_s=1<arguments.length?arguments[1]:void 0,_a=2<arguments.length?arguments[2]:void 0;j(this,ey),this.id=_i.id,this.properties=_i.properties||{},this.labelArea=_i.label_area||[],this.geometry=_i.geometry||{},this.location=_i.location||{},this.address=_i.address||{},this.level=_s,this.zIndex=_a,this.spaceId=_i.spaceId,this.state_={isHighlighted:!1,highlightedStyle:{}},this.geometryData=_i}return _t(ey,[{key:"getId",value:function(){return this.geometryData&&this.geometryData.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getInternalAddress",value:function(){return this.address?this.address.properties&&this.address.properties.name:null}},{key:"getCenter",value:function(){return this.location.coordinates||[]}},{key:"getCoordinates",value:function(){return this.geometry.coordinates||[]}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getStyle",value:function(){return this.getMetaInformation_().getStyle(this)}},{key:"getIcon",value:function(){return this.properties.svg}},{key:"getLabelArea",value:function(){return this.labelArea||[]}},{key:"getLabelStyle",value:function(){return this.getMetaInformation_().getLabelStyle(this)||null}},{key:"getLevel",value:function(){return this.level}},{key:"getType",value:function(){return this.geometry.type}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"getBoundingBox",value:function(){var _i=this.getType(),_s=this.getCoordinates(),_a=[];switch(_i){case g0:_a=[_s,_s];break;case P0:case k0:_a=_s;break;case $0:case Qy:_a=_s.reduce(function(_u,_d){return _u.concat(_d)},[]);break;case r1:_a=_s.reduce(function(_u,_d){return _u.concat(_d)},[]).reduce(function(_u,_d){return _u.concat(_d)},[])}return b1.getBoundingBoxVertices(_a)}},{key:"isIcon",value:function(){return!!this.properties.icon}},{key:"isPointInsideGeometry",value:function(_i){var _s,_a=1<arguments.length&&arguments[1]!==void 0&&arguments[1],_u=!1;switch(this.getType()){case g0:_s=this.getLabelArea()&&b1.getRectangularCoordinatesOfLabelArea(this.getLabelArea()),_u=b1.isPointInPolygon(_i,_s);break;case P0:break;case k0:_u=_a&&D1.isPointOnGeoJSONLineString(_i,this.getCoordinates());break;case $0:_u=_a&&D1.isPointOnGeoJSONMultiLineString(_i,this.getCoordinates());break;case Qy:_u=D1.isPointInsideGeoJSONPolygon(_i,this.getCoordinates());break;case r1:_u=D1.isPointInsideGeoJSONMultiPolygon(_i,this.getCoordinates())}return _u}},{key:"highlight",value:function(){var _i=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],_s=1<arguments.length?arguments[1]:void 0;this.state_.isHighlighted=_i,this.state_.highlightedStyle=_i?_s:{}}},{key:"isHighlighted",value:function(){return!!this.state_.isHighlighted}},{key:"getHighlightedStyle",value:function(){return this.state_.highlightedStyle||{}}},{key:"toJSON",value:function(){return h({},this.geometry)}},{key:"getMetaInformation_",value:function(){return this.getLevel()?this.getLevel().getDrawing().getVenueModel().metaInformation_:null}}]),ey}(),a_=function(){function ey(_i,_s){var _a=this;j(this,ey),this.id=_i&&_i.id,this.properties=_i&&_i.properties,this.zIndexCount=0,this.geometries=_i&&_i.features&&Object.values(_i.features).reduce(function(_u,_d){return _u[[_d.id]]=new s_(_d,_a,_d.properties.drawOrder),_u},{}),this.drawing=_s,this.levelData=_i}return _t(ey,[{key:"getId",value:function(){return this.levelData&&this.levelData.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getName",value:function(){return this.properties&&this.properties.name||""}},{key:"getDisplayName",value:function(){return this.properties&&this.properties.display_name||""}},{key:"getDrawing",value:function(){return this.drawing}},{key:"getShortName",value:function(){return this.properties&&this.properties["short name"]||""}},{key:"getZIndex",value:function(){return this.properties&&this.properties.zLevel}},{key:"getFeatureCollectionArray",value:function(){return this.getGeometries().map(function(_i){return _i.toJSON()})}},{key:"getGeometryById",value:function(_i){return this.geometries[_i]}},{key:"getGeometries",value:function(){return 0<arguments.length&&arguments[0]!==void 0&&arguments[0]?this.geometries&&Object.values(this.geometries).sort(function(_i,_s){return _s.getZIndex()-_i.getZIndex()}):this.geometries&&Object.values(this.geometries).sort(function(_i,_s){return _i.getZIndex()-_s.getZIndex()})}},{key:"getGeometriesByAddress",value:function(_i){return Object.values(this.geometries).filter(function(_s){return _s.address&&_s.address.properties&&_s.address.properties.name&&_s.address.properties.name===_i})}},{key:"isMain",value:function(){return!!this.properties.isMain}}]),ey}(),l_=function(){function ey(_i){var _s=this,_a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},_u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[],_d=3<arguments.length?arguments[3]:void 0;j(this,ey),this.venueModel=_d,this.levels=_u.map(function(ny){return new a_(ny,_s)}),this.structure=_i,this.id=_i&&_i.id,this.properties=_a}return _t(ey,[{key:"getId",value:function(){return this.structure&&this.structure&&this.structure.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"isRoot",value:function(){return!!this.properties.is_root}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getBoundingBox",value:function(){if(this.structure&&this.structure.geometry){var _s=ty(b1.getBoundingBox(this.structure.geometry.type,this.structure.geometry.coordinates),2),_i=_s[0],_s=_s[1];if(_i)return[_s[1],_i[0],_i[1],_s[0]]}return[null,null,null,null]}},{key:"getCenter",value:function(){return this.structure&&this.structure.location&&this.structure.location.coordinates}},{key:"getGeometryById",value:function(_i){return this.getGeometries().find(function(_s){return _s.getId()===_i||_s.getIdentifier()===_i})}},{key:"getGeometries",value:function(){return this.levels.flatMap(function(_i){return _i.getGeometries()})}},{key:"getLevelById",value:function(_i){return this.levels.find(function(_s){return _s.getId()===_i||_s.getIdentifier()===_i})}},{key:"getLevelByZIndex",value:function(_i){return this.levels.find(function(_s){return _s.getZIndex()===_i})}},{key:"getLevels",value:function(){return this.levels}},{key:"getMainLevel",value:function(){return this.levels.find(function(_i){return _i.isMain()})}},{key:"getVenueModel",value:function(){return this.venueModel}}]),ey}(),u_=F0.STANDARD,e_=function(){function ey(_i){var _s=this,_a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:new m1;j(this,ey),this.metaInformation_=_a,this.momStructure=_i,this.id=_i&&_i.site&&_i.site.id,this.location=_i&&_i.site&&_i.site.location||{},this.properties=_i&&_i.site&&h({},_i.site.properties),this.drawings=_i&&_i.structure&&Object.values(_i.structure).map(function(_u){var _d=_i.getStructureWiseGeometry(_u.id);return new l_(_u,_u.properties,Object.values(_d),_s)})}return _t(ey,[{key:"getDisplaySettings",value:function(){return(this.metaInformation_.releaseSettings_?this.metaInformation_.releaseSettings_.displayOptions:"").display||u_}},{key:"getId",value:function(){return this.momStructure&&this.momStructure.site&&this.momStructure.site.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getName",value:function(){return this.properties.name}},{key:"getBoundingBox",value:function(){if(this.momStructure){var _s=ty(b1.getBoundingBox(this.momStructure.site.geometry.type,this.momStructure.site.geometry.coordinates),2),_i=_s[0],_s=_s[1];if(_i)return[_s[1],_i[0],_i[1],_s[0]]}return[null,null,null,null]}},{key:"getCenter",value:function(){return this.location.coordinates}},{key:"getGeometryById",value:function(_i){return this.getGeometries().find(function(_s){return _s.getId()===_i||_s.getIdentifier()===_i})}},{key:"getGeometries",value:function(){return this.getLevels().sort(function(_i,_s){return _i.getZIndex()-_s.getZIndex()}).flatMap(function(_i){return _i.getGeometries()})}},{key:"getGeometriesByLonLat",value:function(_i){var _s=this,_u=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[],_a=!(2<arguments.length&&arguments[2]!==void 0)||arguments[2],_u=_u.map(function(_d){return _s.getLevelById(_d)});return _u.length===0&&(_u=this.drawings.filter(function(_d){return _d=_d.getBoundingBox(),b1.isPointInBoundingBox(_i,_d)}).flatMap(function(_d){return _d.getLevels()})),D1.getGeometriesByLonLat(_i,_u.flatMap(function(_d){return _d.getGeometries(!0)}),_a)}},{key:"getDrawingById",value:function(_i){return this.drawings.find(function(_s){return _s.getId()===_i||_s.getIdentifier()===_i})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getRootDrawing",value:function(){return this.drawings.find(function(_i){return _i.isRoot()})}},{key:"getLevelById",value:function(_i){return this.getLevels().find(function(_s){return _s.getId()===_i||_s.getIdentifier()===_i})}},{key:"getLevelsByZIndex",value:function(){var _i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0;return this.getLevels().filter(function(_s){return Number(_s.getZIndex())===Number(_i)})}},{key:"getLevels",value:function(){return this.drawings.flatMap(function(_i){return _i.getLevels()})}},{key:"getMomStructure",value:function(){return this.momStructure}},{key:"getLevelMapFlattenedByZIndex_",value:function(){return this.getLevels().reduce(function(_i,_s){var _a=_s.getZIndex();return _i[_a]||(_i[_a]=[]),_i[_a].push(_s),_i},{})}},{key:"getOccupant",value:function(){var _i=this.momStructure.occupant;return Object.values(_i)}}]),ey}(),c_=function(){function ey(_i){j(this,ey),this.theme=_i&&_i.theme,this.level=_i&&_i.level,this.site=_i&&_i.site,this.spaces=_i&&_i.spaces,this.address=_i&&_i.address,this.levelConnector=_i&&_i.levelConnector,this.topology=_i&&_i.topology,this.entrance=_i&&_i.entrance,this.occupant=_i&&_i.occupant,this.structure=_i&&_i.structure,this.spaceGroups=_i&&_i.spaceGroups,this.levelWiseGeometry={},this.levelStructureMapping=_i&&_i.levelStructureMapping,this.outdoorLevelMapping=_i&&_i.outdoorLevelMapping||{},this.labelTextPreference=_i&&_i.labelTextPreference||null}return _t(ey,[{key:"setSpaceWithLevel",value:function(){var _i=this;this.spaces&&Object.values(this.spaces).forEach(function(_s){var _a="",_u=(_s.addressId&&(_a=_i.address&&_i.address[_s.addressId]&&_i.address[_s.addressId].properties.addressName),_s.properties),_a=(_u.addressName=_a,_i.getLabelAsPerPreference(h(h({},_s),{},{properties:_u}))),_u=_s.properties,_a=(_u.name=_a,_u.display_name=_a,_s.properties.icon&&(_u.name=_s.id,_u.display_name=_s.id),_s),_u=(_a.properties=_u,_a.address=_i.address[_s.addressId],(_i.spaces[_s.id]=_s).levelId);_i.outdoorLevelMapping[_u]&&(_u=_i.outdoorLevelMapping[_u]),_i.levelWiseGeometry[_u]||(_i.levelWiseGeometry[_u]={}),_i.levelWiseGeometry[_u][_a.id]=_a})}},{key:"setOccupantWithLevel",value:function(){var _i=this;this.occupant&&Object.values(this.occupant).forEach(function(_s){var _a,_u;_s.spaceIds&&_s.properties.occupantName&&(_a=[],_u=[],_s.spaceIds.forEach(function(_d){function ny(uy){var _y=!1,_y=(_i.labelTextPreference&&_i.labelTextPreference.length&&(_y=_i.labelTextPreference.indexOf("OCCUPANT_NAMES")!==-1),_i.labelTextPreference===null||_y),dy=uy,my=uy.properties,_y=(my.name=uy.properties.icon||!_y?uy.properties.name:_s.properties.occupantName,my.display_name=uy.properties.icon||!_y?uy.properties.display_name:_s.properties.occupantName,my.address=uy.address,my.occupantName=_s.properties.occupantName,uy.levelId);_i.outdoorLevelMapping[_y]&&(_y=_i.outdoorLevelMapping[_y]),_i.levelWiseGeometry[_y]||(_i.levelWiseGeometry[_y]={}),_i.levelWiseGeometry[_y][uy.id]=dy,_a.push(dy),_u.push(uy.id)}var sy=_d.id,sy=_i.spaces[sy],ay=null;_i.spaceGroups&&Object.values(_i.spaceGroups).forEach(function(uy){uy.properties.spaceGroups&&uy.properties.spaceGroups&&uy.properties.spaceGroups.forEach(function(dy){dy.mainSpace&&dy.mainSpace.id===_d.id&&(ay=dy.spaces.map(function(my){return my.id}))})}),ay&&0<ay.length&&ay.forEach(function(uy){ny(_i.spaces[uy])}),sy&&ny(sy)}),_i.occupant[_s.id]=_s,_i.occupant[_s.id].space=_a,_i.occupant[_s.id].spaceIds=_u)})}},{key:"setEntrance",value:function(){var _i=this;this.entrance&&Object.values(this.entrance).forEach(function(_s){var _a=_s.properties.level.id;_i.levelWiseGeometry[_a]||(_i.levelWiseGeometry[_s.properties.level.id]={}),_i.outdoorLevelMapping[_a]&&(_a=_i.outdoorLevelMapping[_a]),_i.levelWiseGeometry[_a][_s.id]=_s})}},{key:"setLevelWiseGeometry",value:function(){var _i=this;this.level&&Object.keys(this.level).forEach(function(_s){_i.levelWiseGeometry[_s]={}}),this.setSpaceWithLevel(),this.setOccupantWithLevel(),this.setEntrance()}},{key:"getStructureWiseGeometry",value:function(_i){for(var _s={},_a=0,_u=Object.entries(this.levelWiseGeometry);_a<_u.length;_a++){var ny=ty(_u[_a],2),_d=ny[0],ny=ny[1];_i===this.levelStructureMapping[_d]&&(_s[_d]=this.level[_d],_s[_d].features=ny)}return _s}},{key:"getLabelAsPerPreference",value:function(_u){var _u=_u.properties,_s=_u.spaceType,ny=_u.occupantName,ay=_u.spaceName,_a=_u.addressName,_u=_u.spaceCategory,_d=(_e(uy={},Ty,ny),_e(uy,Wy,ay),_e(uy,o0,_s?_s.charAt(0).toUpperCase()+_s.slice(1).toLowerCase():""),_e(uy,_m,_u?_u.charAt(0).toUpperCase()+_u.slice(1).toLowerCase():""),_e(uy,_v,_a),_e(uy,p0,_a),_e(uy,c0,_a),uy),ny=this.theme.spaceRules,sy="",ay=_u&&_s&&ny[_u]&&ny[_u].spaceTypes&&ny[_u].spaceTypes[_s].behavioralAppearance.default.labelType;if(ay==="NONE"){if(!this.labelTextPreference)return"";_d[o0]=""}if(_a=_u&&_s&&ny[_u]&&ny[_u].properties&&ny[_u].properties.behavioralAppearance&&ny[_u].properties.behavioralAppearance.default&&ny[_u].properties.behavioralAppearance.default.labelType,(_a==="NONE"||_a===void 0)&&ay===void 0){if(!this.labelTextPreference)return"";_d[o0]="",_d[_m]=""}var uy=_u&&_s&&ny[_u]&&ny[_u].properties&&ny[_u].properties.behavioralAppearance&&ny[_u].properties.behavioralAppearance.default&&ny[_u].properties.behavioralAppearance.default.labelTextPreference,dy=uy&&this.labelTextPreference?this.labelTextPreference:uy;if(dy){for(var my=0;my<dy.length;my++)if(_d[dy[my]]){sy=_d[dy[my]];break}}return sy}}]),ey}(),r_=function(){function ey(sy){var _u=sy.apiKey,_d=sy.baseUrl,ny=sy.token,sy=sy.hrn;j(this,ey),this.hostOptions_={apiKey:_u,url:_d,token:ny,hrn:sy},this.momData=[],this.theme={},this.loadOptions={}}var _i,_s;return _t(ey,[{key:"setHostOptions",value:function(_a){Object.keys(_a).length!==0&&(this.hostOptions_=h(h({},this.hostOptions_),_a))}},{key:"getToken",value:function(){return this.hostOptions_.token}},{key:"getHrn",value:function(){return this.hostOptions_.hrn}},{key:"load",value:function(_a){var _u=this,_d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return this.loadOptions=h(h(h({},vy),_d),{},{venueId:_a}),this.hostOptions_.mapData=_d.mapData,this.hostOptions_.themeRule=_d.themeRule,this.hostOptions_.svgList=_d.svgList,this.hostOptions_.labelTextPreference=_d.labelTextPreferenceOverride,this.getHrn()?this.getVenueModalInstance():this.getToken()?this.getDefaultCollectionWithToken().then(function(){return _u.getVenueModalInstance()}).catch(function(){return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"))}):Promise.reject(new Error("In order to load indoor map, Please provide either hrn or token"))}},{key:"getVenueModalInstance",value:function(){var _a=this;return Promise.resolve().then(function(){return _a.loadOptions.isMetaEnabled?_a.getMeta_(_a.loadOptions.isIconsEnabled).catch(function(_u){return console.warn(_u),Promise.resolve()}):Promise.reject()}).then(function(_u){return _a.getVenue_(_u)}).then(function(_u){return _u}).catch(function(_u){console.debug("Captured event VENUE_ERROR_STATE",_u)})}},{key:"createMomStructure",value:function(){var _a=this,_u={site:{},structure:{},level:{},levelConnector:{},occupant:{},spaces:{},spaceGroups:{},topology:{},address:{},outdoorLevelMapping:{},entrance:{},levelStructureMapping:{}};return this.momData.forEach(function(_d){var ny="indoormap-00000000-0000-4000-a000-".concat(_a.loadOptions.venueId.toString().padStart(12,"0")),sy=_d.id;_d.momType!==I1&&!_a.hostOptions_.mapData&&_d.properties.indoorMapId!=_a.loadOptions.venueId&&_d.properties.indoorMapId!==ny||(_d.momType===v1?_u.site=f1.setSite(_d,_a.loadOptions.venueId):_d.momType===L1?_u.structure[sy]=f1.setStructure(_d):_d.momType!==yy||_d.properties.isOutdoor&&(!_d.properties.isOutdoor||_d.properties.parentIndoorLevel)?_d.momType===yy&&_d.properties.isOutdoor&&_d.properties.parentIndoorLevel?_u.outdoorLevelMapping[_d.id]=_d.properties.parentIndoorLevel.id:_d.momType===xy?_u.entrance[sy]=f1.setEntrance(_d):_d.momType===S1?_u.occupant[sy]=f1.setOccupant(_d):_d.momType===A1?_u.spaces[sy]=f1.setSpace(_d):_d.momType===O1?_u.spaceGroups[sy]=f1.setSpaceGroups(_d):_d.momType===I1&&(_u.address[sy]=f1.setAddress(_d)):(_u.level[sy]=f1.setLevel(_d),_u.levelStructureMapping[sy]=_d.properties.structure.id))}),_u.theme=this.theme,_u.labelTextPreference=this.hostOptions_.labelTextPreference,new c_(_u)}},{key:"getVenue_",value:function(_a){this.momData=_a.getMomData();var _u=this.createMomStructure();return _u.setLevelWiseGeometry(),new e_(_u,_a)}},{key:"setConfigData",value:function(ny){var _u=ny.themeRule,_d=ny.svgList,ny=ny.defaultLang;t_.setSpaceRules(_u.spaceRules),f1.svgList=_d,f1.themeRule=_u,f1.defaultLang=ny,this.theme=_u}},{key:"getMeta_",value:function(){var _a=this,_u=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],_d=new m1,ny=this.hostOptions_.mapData?{}:this.getMetaConfig_(this.loadOptions.venueId,c1.SITE),sy=this.hostOptions_.themeRule||this.getMetaConfig_(this.loadOptions.venueId,c1.Theme),ay=[];return _u&&(ay=this.hostOptions_.svgList||this.getMetaConfig_(this.loadOptions.venueId,c1.IMAGES)),new Promise(function(uy){Promise.all([ny,sy,ay]).then(function(my){var my=ty(my,3),_y=my[0],Fy=my[1],Vy=my[2],Iy=_a.hostOptions_.mapData?{mom:new Promise(function(Ky){return Ky(_a.hostOptions_.mapData)}),site:_a.hostOptions_.mapData.features.find(function(Ky){return Ky.momType===v1})}:j1.getMomData(_y,_a.hostOptions_);Iy.mom.then(function(Ky){var zy=Fy.properties;_d.imageCache=_u?f1.manageSvgDimensions(Vy.properties):[],_a.setConfigData({themeRule:zy,svgList:_d.imageCache,defaultLang:Iy&&Iy.site&&Iy.site.properties.defaultLanguageCode}),_d.releaseSettings_={displayOptions:{display:zy.entranceRules.default.displayName||F0.STANDARD},mom:Ky.features},_d.theme=new Z0(zy,_d),uy(_d)})})})}},{key:"getMetaConfig_",value:function(_a,_u){return j1.getConfigUrl(_a,_u,this.hostOptions_)}},{key:"fetchCollections",value:function(){return j1.getDefaultCollection(this.hostOptions_)}},{key:"fetchUserProjects",value:function(){return j1.getProjectAccountDetails(this.hostOptions_)}},{key:"getDefaultCollectionWithToken",value:(_i=d().mark(function _a(){var _u=this;return d().wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:return _d.abrupt("return",Promise.all([this.fetchCollections(),this.fetchUserProjects()]).then(function(sy){var sy=ty(sy,2),ay=sy[0],sy=sy[1],ay=_u.getHrnFromDefaultCollection(ay,sy);return ay.hrn?(sy={hrn:ay.hrn},_u.setHostOptions(sy),Promise.resolve()):Promise.reject()}).catch(function(ny){return Promise.reject(ny)}));case 1:case"end":return _d.stop()}},_a,this)}),_s=function(){var _a=this,_u=arguments;return new Promise(function(_d,ny){var sy=_i.apply(_a,_u);function ay(dy){_(sy,_d,ny,ay,uy,"next",dy)}function uy(dy){_(sy,_d,ny,ay,uy,"throw",dy)}ay(void 0)})},function(){return _s.apply(this,arguments)})},{key:"getHrnFromDefaultCollection",value:function(ny,_u){var _d,ny=ny.results.items;return Array.isArray(ny)&&ny.length?(_d=this.getProjectRealm(_u),ny.find(function(sy){return sy.hrn.includes(_d)})):Promise.reject(new Error("Error while accessing default collection"))}},{key:"getProjectRealm",value:function(_a){return Array.isArray(_a.items)&&_a.items.length&&_a.items[0].id.includes("indoor-")?(_a=_a.items[0].hrn,this.getRealmNameFromHrn(_a)):""}},{key:"getRealmNameFromHrn",value:function(_a){return _a?(_a=_a.split(":")).length&&_a[4]:""}},{key:"getSupportedMapList",value:function(){var _a=this,_d=this.hostOptions_,_u=_d.hrn,_d=_d.token;return _u?this.fetchMapInfoList():_d?this.getDefaultCollectionWithToken().then(function(){return _a.fetchMapInfoList()}).catch(function(){return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"))}):Promise.reject(new Error("In order to load map list, Please provide either hrn or token"))}},{key:"fetchMapInfoList",value:function(){var _a=this;return j1.fetchIndoorMapList(this.hostOptions_).then(function(_u){return _u=_u.features,0<_u.length?_u.map(function(sy){var sy=sy.properties,ny=sy.placeProperties,sy=sy.indoorMapId,ay=sy.split("-").pop(),ay=ay.substring(ay.length-5);return{mapIdentifier:sy,mapName:_a.getMapName(ny.names).name,mapId:ay}}):[]}).catch(function(_u){Promise.reject(new Error("".concat(_u,": Error while fetching map list")))})}},{key:"getMapName",value:function(_a){return Array.isArray(_a)&&0<_a.length?_a.find(function(_u){return _u.nameType==="OFFICIAL"}):{}}}]),ey}(),h_=["origin","destination"],p_=function(){function ey(){var _i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};if(j(this,ey),!_i.apiKey&&!_i.token)throw new Error("API key or Token is missing");this.config_=h({baseUrl:"https://meta-indoor-routing.api-gateway.ls.hereapi.com"},_i)}return _t(ey,[{key:"calculateRoute",value:function(_u){var _s=_u.origin,_s=_s===void 0?{}:_s,_a=_u.destination,_a=_a===void 0?{}:_a,_u=_f(_u,h_);if(!_s.coordinates||!_a.coordinates)throw new Error("Waypoint coordinates are missing");function _d(dy){var my=dy.coordinates,uy=dy.venueId,dy=dy.levelId,my=my.join(",");return uy&&dy?my.concat(";indoorMapId=",uy,";levelId=",dy):my}var ny=new URL("".concat(this.config_.baseUrl,"/v1/routes")),sy=new URLSearchParams({origin:_d(_s),destination:_d(_a),apiKey:this.config_.apiKey});return Object.entries(_u).forEach(function(dy){var dy=ty(dy,2),uy=dy[0],dy=dy[1];sy.append(uy,g(dy)==="object"?JSON.stringify(dy):dy)}),ny.search=sy,fetch(ny,{headers:{"X-Api-Key":this.config_.apiKey}}).then(function(ay){return ay.json()})}}]),ey}(),x1={VENUE_DATA_LOADED:"VENUE_DATA_LOADED",VENUE_THEME_LOADED:"VENUE_THEME_LOADED",VENUE_ICONS_LOADED:"VENUE_ICONS_LOADED",VENUE_MOM_DATA_LOADED:"VENUE_MOM_DATA_LOADED",VENUE_ERROR_STATE:"VENUE_ERROR_STATE",VENUE_MAP_DATA_LOADED:"VENUE_MAP_DATA_LOADED",VENUE_ENTITY_DATA_LOADED:"VENUE_ENTITY_DATA_LOADED",VENUE_DATA_MODEL_LOADED:"VENUE_DATA_MODEL_LOADED",VENUE_NAV_DATA_LOADED:"VENUE_NAV_DATA_LOADED",META_DATA_LOADED:"META_DATA_LOADED",META_DATA_MODEL_LOADED:"META_DATA_MODEL_LOADED",META_DATA_MODEL_UPDATED:"META_DATA_MODEL_UPDATED"},h0=(Object.freeze((_e(l0={},x1.VENUE_DATA_LOADED,{description:"event fired when all requested files along with metadata & overrides are loaded",emitTemplate:{}}),_e(l0,x1.VENUE_MAP_DATA_LOADED,{description:"event fired when requested levels, drawings & community files are loaded",emitTemplate:{}}),_e(l0,x1.VENUE_ENTITY_DATA_LOADED,{description:"event fired when requested entity data is loaded",emitTemplate:{}}),_e(l0,x1.VENUE_DATA_MODEL_LOADED,{description:"event fired when a map file is loaded",emitTemplate:{}}),_e(l0,x1.VENUE_NAV_DATA_LOADED,{description:"event fired when requested navigation product is loaded",emitTemplate:{}}),_e(l0,x1.META_DATA_LOADED,{description:"event fired when all requested meta files are loaded except icon & marker",emitTemplate:{}}),_e(l0,x1.META_DATA_MODEL_LOADED,{description:"event fired when a specific model is loaded except icon & marker",emitTemplate:{}}),_e(l0,x1.META_DATA_MODEL_UPDATED,{description:"event fired when a specific meta override is added or removed",emitTemplate:{}}),_e(l0,x1.VENUE_ICONS_LOADED,{description:"event fired when all icons of venue are loaded",emitTemplate:{}}),l0)),new My),U0=(h0.EVENT_NAME=x1,h0.on("newListener",function(ey){x1[ey]||console.warn("subscribing for un-registered/documented event")}),function(){_r(_i,H.map.Feature);var ey=_p(_i);function _i(_s){var _a;if(j(this,_i),_a=ey.call(this),_s instanceof e_)return _a.venueModel=_s,_a.search_=new T1(_s),_a.status_={activeDrawingId:_s.getRootDrawing().getIdentifier(),activeLevelIndex:_s.getRootDrawing().getMainLevel().getZIndex()},_a.mapObjectStore_=_a.getDefaultMapObjectsStore_(),_a.drawings=_s.getDrawings().map(function(_u){return _u=new gy(_u),_u.setParentEventTarget(_c(_a)),_u}),_a.levels=_s.getLevels().map(function(_u){var _d=new by(_u);return _d.setParentEventTarget(_a.drawings.find(function(ny){return ny.getIdentifier()===_d.getData().getDrawing().getIdentifier()})),_d}),_a.geometries=_s.getGeometries().map(function(_u){var _d=new py(_u);return _d.setParentEventTarget(_a.levels.find(function(ny){return ny.getIdentifier()===_d.getData().getLevel().getIdentifier()})),_d}),_a.mutualExclusiveHighlight_=!1,_a;throw new Error("It is mandatory to provide valid instance of venueModel")}return _t(_i,[{key:"getData",value:function(){return this.venueModel}},{key:"getBoundingBox",value:function(){return _l(H.geo.Rect,oy(this.venueModel.getBoundingBox()))}},{key:"getCenter",value:function(){var _a=ty(this.venueModel.getCenter(),2),_s=_a[0],_a=_a[1];return new H.geo.Point(_a,_s)}},{key:"getId",value:function(){return this.venueModel.getId()}},{key:"getIdentifier",value:function(){return this.venueModel.getIdentifier()}},{key:"getName",value:function(){return this.venueModel.getName()}},{key:"getDrawing",value:function(_s){return this.drawings.find(function(_a){return _a.getIdentifier()===_s})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getLevel",value:function(_s){return this.levels.find(function(_a){return _a.getIdentifier()===_s})}},{key:"getLevels",value:function(){return this.levels}},{key:"getGeometry",value:function(_s){return this.getGeometries().find(function(_a){return _a.getIdentifier()===_s})}},{key:"getGeometries",value:function(){return this.geometries}},{key:"getActiveLevels",value:function(){var _s=this;return this.getData().getDisplaySettings()===F0.FLATTEN?this.venueModel.getLevelsByZIndex(this.status_.activeLevelIndex).map(function(_a){return _s.getLevel(_a.getIdentifier())}):[this.venueModel.getDrawingById(this.status_.activeDrawingId).getLevelByZIndex(this.status_.activeLevelIndex)].map(function(_a){return _s.getLevel(_a.getIdentifier())})}},{key:"getActiveDrawing",value:function(){return this.getDrawing(this.status_.activeDrawingId)}},{key:"setActiveDrawing",value:function(_s){if(this.status_.activeDrawingId!==_s){var _a=this.venueModel.getDrawingById(_s);if(!_a)throw new Error("Drawing ".concat(_s," was not found"));var _u=this.status_.activeDrawingId;this.status_.activeDrawingId=_a.id,this.setActiveLevelIndex(_a.getMainLevel().getZIndex()),this.dispatchEvent(new H.util.ChangeEvent(_i.EVENTS.DRAWING_CHANGE,_s,_u))}}},{key:"getActiveLevelIndex",value:function(){return this.status_.activeLevelIndex}},{key:"setActiveLevelIndex",value:function(_s){var _a;this.venueModel.getLevelsByZIndex(_s)&&(_a=this.status_.activeLevelIndex,this.status_.activeLevelIndex=_s,this.dispatchEvent(new H.util.ChangeEvent(_i.EVENTS.LEVEL_CHANGE,_s,_a)))}},{key:"isActive",value:function(){var _s=this.getParentEventTarget();return!!_s&&this===_s.activeVenue}},{key:"getHighlightedGeometries",value:function(){var _s=this;return this.venueModel.getGeometries().filter(function(_a){return _a.isHighlighted()}).map(function(_a){return _s.getGeometry(_a.getIdentifier())})}},{key:"setHighlightedGeometries",value:function(){var _s=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],_a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[],_d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},_u=3<arguments.length&&arguments[3]!==void 0&&arguments[3],_d=h(h({},k1),_d),ny=_d.fillColor,sy=_d.outlineColor,ay=_d.outlineWidth;this.mutualExclusiveHighlight_=!!_u,this.mutualExclusiveHighlight_&&this.getHighlightedGeometries().forEach(function(uy){uy.getData().highlight(!1)}),_a.forEach(function(uy){uy.getData().highlight(_s,{m:ny,o:sy,w:ay})}),this.dispatchEvent(_i.EVENTS.GEOMETRY_HIGHLIGHT)}},{key:"getMapObjects",value:function(){var _s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.getActiveLevelIndex(),_a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.getActiveDrawing();return this.mapObjectStore_[_s][_a.getIdentifier()]}},{key:"setMapObjects",value:function(){var _s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],_a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.getActiveLevelIndex(),_u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.getActiveDrawing();this.mapObjectStore_[_a]&&this.mapObjectStore_[_a][_u.getIdentifier()]&&(this.mapObjectStore_[_a][_u.getIdentifier()]=oy(_s)),this.updateMapObjectsVisibility_()}},{key:"search",value:function(){var _s=this;return this.search_.find(0<arguments.length&&arguments[0]!==void 0?arguments[0]:"").flatMap(function(_a){return _a.geometries.map(function(_u){return _s.getGeometry(_u.id)})})}},{key:"updateMapObjectsVisibility_",value:function(){Object.values(this.mapObjectStore_).forEach(function(_s){Object.values(_s).forEach(function(_a){return _a.forEach(function(_u){return _u.setVisibility(!1)})})}),this.isActive()&&this.mapObjectStore_[this.getActiveLevelIndex()][this.getActiveDrawing().getIdentifier()].forEach(function(_s){return _s.setVisibility(!0)})}},{key:"getDefaultMapObjectsStore_",value:function(){var _s=this,_a=this.getData().getDisplaySettings()===F0.FLATTEN;return this.venueModel.getLevels().reduce(function(sy,_d){var ny=_d.getZIndex(),sy=h({},sy);return sy[ny]||(sy[ny]={}),sy[ny][_d.getDrawing().getIdentifier()]=[],_a&&(sy[ny][_s.venueModel.getRootDrawing().getIdentifier()]=[]),sy},{})}}]),_i}()),B1=(U0.EVENTS={ACTIVE_VENUE_CHANGE:"activevenuechange",DRAWING_CHANGE:"drawingchange",LEVEL_CHANGE:"levelchange",GEOMETRY_HIGHLIGHT:"geometryhighlight"},function(){function ey(){j(this,ey)}return _t(ey,null,[{key:"getIconLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&arguments[0]!==void 0?arguments[0]:[]).flatMap(function(_i){return _i.getData().getGeometries()}).filter(function(_i){return _i.isIcon()&&_i.getIcon()}).map(function(_i){var _a=ty(_i.getLabelArea(),2),_s=_a[0],_a=_a[1],_u=_i.getLevel(),_d=_i.getIcon(),ny=_i.properties.spaceType||_i.properties.spaceCategory||_i.getDisplayName();return{type:"Feature",properties:{id:_i.getIdentifier(),geometryId:_i.getIdentifier(),levelId:_u.getIdentifier(),name:ny,venueId:_u.getDrawing().getVenueModel().getIdentifier(),url:_d?"data:image/svg+xml;utf8,".concat(encodeURIComponent(_d)):""},geometry:{type:W0.POINT,coordinates:[_s,_a]}}})}}},{key:"getLabelLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&arguments[0]!==void 0?arguments[0]:[]).flatMap(function(_i){return _i.getData().getGeometries()}).filter(function(_i){return _i.getDisplayName()&&!_i.isIcon()}).map(function(_i){var _a=ty(_i.getLabelArea(),2),_s=_a[0],_a=_a[1],_d=_i.getLabelStyle(),_u=_d.fill,_d=_d.zmin,ny=_i.getLevel();return{type:"Feature",properties:{id:_i.getIdentifier(),geometryId:_i.getIdentifier(),levelId:ny.getIdentifier(),venueId:ny.getDrawing().getVenueModel().getIdentifier(),name:_i.getDisplayName(),minZoom:_d||15,textFillColor:_u.toLowerCase()},geometry:{type:W0.POINT,coordinates:[_s,_a]}}})}}},{key:"getGeometryLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&arguments[0]!==void 0?arguments[0]:[]).flatMap(function(_i){return _i.getData().getGeometries()}).filter(function(_i){return _i.getType()!==W0.POINT}).map(function(_i){var _u=_i.getHighlightedStyle()||{},_s=_u.m,_a=_u.o,_u=_u.w,sy=h({},_i.getStyle()),_d=sy.m,ny=sy.o,sy=sy.w,dy=i1,ay=dy.fillColor,uy=dy.outlineColor,dy=dy.outlineWidth,my=_i.getLevel();return{type:"Feature",properties:{id:_i.getIdentifier(),fillColor:(_s||_d||ay).toLowerCase(),geometryId:_i.getIdentifier(),levelId:my.getIdentifier(),venueId:my.getDrawing().getVenueModel().getIdentifier(),outlineColor:(_a||ny||uy).toLowerCase(),outlineWidth:Number(((_u||sy||dy)/3).toFixed(2)),zIndex:_i.getZIndex()},geometry:{type:_i.getType(),coordinates:_i.getCoordinates()}}})}}},{key:"getFootprintLayer",value:function(_i){return{type:"FeatureCollection",features:_i.flatMap(function(_s){var _a=_s.getData().getRootDrawing().getMainLevel().getIdentifier(),_u=_s.getLevel(_a).getData().getGeometries().filter(function(_d){return _d.getType()===W0.POLYGON});return[{type:"Feature",properties:{isFootprint:!0,levelId:_a,venueId:_s.getIdentifier(),zIndex:1},geometry:{type:"MultiPolygon",coordinates:_u.map(function(_d){return _d.getCoordinates()})}},{type:"Feature",properties:{isFootprint:!0,levelId:_a,venueId:_s.getIdentifier(),zIndex:2,venueName:_s.getName()},geometry:{type:"Point",coordinates:_s.getCenter().toGeoJSON().coordinates.slice(0,2)}}]})}}}]),ey}()),f_=function(){function ey(){j(this,ey)}return _t(ey,null,[{key:"getStyle",value:function(){var _i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],_s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[],_a={styles:[{layer:T0.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#613F8E",lineWidth:"2px",renderOrder:1},{layer:T0.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#AF91B4",renderOrder:2},{layer:T0.FOOTPRINT,when:["==",["geometry-type"],"Point"],technique:"text",color:"black",size:16,text:["get","venueName"],priority:61},{layer:T0.VECTOR,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:["get","fillColor"],renderOrder:["get","zIndex"]},{layer:T0.VECTOR,technique:"solid-line",color:["get","outlineColor"],lineWidth:["get","outlineWidth"],renderOrder:["get","zIndex"]},{layer:T0.TEXT,minZoomLevel:["get","minZoom"],technique:"text",color:["get","textFillColor"],size:w1.size,text:["get","name"],priority:60},{layer:T0.ICON,minZoomLevel:X0,when:["==",["geometry-type"],"Point"],technique:"labeled-icon",textIsOptional:!0,size:0,imageTexture:["concat","texture",["get","name"]],screenWidth:["interpolate",["linear"],["zoom"],15,3,21,70],screenHeight:["interpolate",["linear"],["zoom"],15,3,21,70],priority:61}],images:{},imageTextures:[]};return _i.forEach(function(_u){var _d="texture"+_u.properties.name;_a.images[_d]||(_a.images[_d]={url:_u.properties.url,preload:!0},_a.imageTextures.push({name:_d,image:_d}))}),_s.forEach(function(_u){var _d,ay=_u.getData().getHighlightedStyle(),ny=ay.m,sy=ay.o,ay=ay.w;(_d=_a.styles).push.apply(_d,[{layer:T0.VECTOR,when:["==",["get","id"],_u.id],technique:"fill",color:ny,renderOrder:["get","zIndex"]},{layer:T0.VECTOR,when:["==",["get","id"],_u.id],technique:"solid-line",color:sy,lineWidth:ay,renderOrder:["get","zIndex"]}])}),new H.map.render.harp.Style(_a)}}]),ey}(),d_=function(){function ey(){j(this,ey)}return _t(ey,null,[{key:"getIconsTextures",value:function(){var _i={},_s={},_a=(0<arguments.length&&arguments[0]!==void 0?arguments[0]:[]).reduce(function(_u,_d){var ny=_d.properties.name;return _u[ny]||(_u[ny]=[]),_u[ny].push(_d),_u},{});return Object.keys(_a).forEach(function(_u){var _d="texture".concat(_u),ny="sprite".concat(_u),sy=_a[_u][0].properties.url;_i[_d]={url:sy,sprites:_e({},ny,[0,0,50,50])},_a[_u].forEach(function(ay){ay=ay.properties,_s["icon".concat(ay.name)]={filter:{name:ay.name,$zoom:{min:X0}},draw:{points:{interactive:!0,priority:1,size:[[15,"50%"],[16,"55%"],[17,"60%"],[18,"65%"],[19,"75%"],[20,"80%"],[21,"100%"]],texture:_d,sprite:ny}}}})}),{textures:_i,iconLayers:_s}}},{key:"getFootprintLayer",value:function(){return{data:{source:"venues",layer:T0.FOOTPRINT},draw:{polygons:{interactive:!0,color:"#AF91B4",order:2},lines:{color:"#613F8E",width:"2px",order:1},points:{color:"[0, 0, 0, 0]",size:"0px",order:3,priority:1,text:{anchor:"center",collide:!1,font:{fill:"black",size:"16px"},text_source:"function() { return feature.venueName }"}}}}}},{key:"getGeometryLayer",value:function(){var _i,_s,_a,_u=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],_d={};return _u.length&&(_i=(_a=_u[0].getData().getHighlightedStyle()).m,_s=_a.o,_a=_a.w,_d={filter:{id:_u.map(function(ny){return ny.id})},draw:{polygons:{interactive:!0,color:_i},lines:{color:_s,width:_a}}}),{data:{source:"venues",layer:T0.VECTOR},draw:{polygons:{interactive:!0,color:"function() { return feature.fillColor }",order:"function() { return feature.zIndex }"},lines:{color:"function() { return feature.outlineColor }",order:"function() { return feature.zIndex }",width:"function() { return feature.outlineWidth }"}},highlighted:_d}}},{key:"getTextLayer",value:function(){return{filter:{$zoom:{min:l1}},data:{source:"venues",layer:T0.TEXT},draw:{points:{filter:"function() { return $zoom > feature.minZoom }",color:"[0, 0, 0, 0]",size:"0px",offset:["0px","-10px"],priority:2,text:{font:{fill:"function() { return feature.textFillColor }",size:w1.size},text_source:"function() { return feature.name }"}}}}}},{key:"getIconLayer",value:function(_i){return h({data:{source:"venues",layer:T0.ICON}},_i)}},{key:"getStyle",value:function(){var _a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],_s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[],_a=ey.getIconsTextures(_a),_i=_a.textures,_a=_a.iconLayers,_s={venue_footprints:ey.getFootprintLayer(),venue_geometries:ey.getGeometryLayer(_s),venue_labels:ey.getTextLayer(),venue_icons:ey.getIconLayer(_a)},_a=H.gl.yaml.safeDump({sources:{venues:{max_zoom:P1,type:"GeoJSONTileSource"}},layers:_s,textures:_i});return new H.map.render.webgl.Style(_a)}}]),ey}(),g_={type:"FeatureCollection",features:[]},$1={extent:4096,indexMaxZoom:0,maxZoom:24,tolerance:3},l0=function(){_r(_i,H.map.provider.RemoteTileProvider);var ey=_p(_i);function _i(_s){return j(this,_i),(_s=ey.call(this,_s)).venues=[],_s.activeVenue=null,_s.dataLayers_={},_s.tileIndexes_={},_s.addEventListener(U0.EVENTS.ACTIVE_VENUE_CHANGE,_s.activeVenueChangeHandler_,void 0,_c(_s)),_s}return _t(_i,[{key:"setStyle",value:function(_s){return this.setStyleInternal(_s)}},{key:"getStyle",value:function(){return this.getStyleInternal()}},{key:"isFeatureVisible_",value:function(_s,_a){var _u=_s.properties;return this.activeVenue&&_u.venueId===this.activeVenue.getIdentifier()?_a!==T0.FOOTPRINT&&this.activeVenue.getActiveLevels().some(function(_d){return _d.id===_u.levelId}):_u.isFootprint===!0&&_a===T0.FOOTPRINT}},{key:"requestInternal",value:function(_s,_a,_u,_d){function ny(uy){for(var dy=0;dy<uy.length;dy+=1)uy[dy]=uy[dy].map(function(my){return s1(my,_u,_s,_a,$1.extent)})}var sy=this,ay={};return Object.keys(this.tileIndexes_).forEach(function(uy){var dy=sy.tileIndexes_[uy].getTile(_u,_s,_a);ay[uy]=dy?h1(dy):g_,ay[uy].features=ay[uy].features.filter(function(Ky){return sy.isFeatureVisible_(Ky,uy)});for(var my=0;my<ay[uy].features.length;my+=1){var _y=ay[uy].features[my],Fy=_y.geometry.type;if(Fy===W0.POLYGON||Fy===W0.MULTI_LINESTRING)ny(_y.geometry.coordinates);else if(Fy===W0.MULTI_POLYGON)_y.geometry.coordinates.map(ny);else for(var Vy=_y.geometry.coordinates,Iy=0;Iy<Vy.length;Iy+=1)Vy[Iy]=s1(Vy[Iy],_u,_s,_a,$1.extent)}}),_d(ay),{cancel:function(){}}}},{key:"getActiveVenue",value:function(){return this.activeVenue}},{key:"getVenue",value:function(_s){return _s?this.venues.find(function(_a){return _a.getIdentifier()===_s}):this.activeVenue}},{key:"setActiveVenue",value:function(_s){var _a=this.activeVenue;this.activeVenue=_s,this.dispatchEvent(new H.util.ChangeEvent(U0.EVENTS.ACTIVE_VENUE_CHANGE,_s,_a)),this.reload()}},{key:"addVenue",value:function(_s){var _a=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!(_s instanceof U0))throw new Error("Invalid argument");var _u=_s.getIdentifier();if(this.getVenue(_u))throw new Error("Please invoke provider.removeVenue to remove old instance of venue ".concat(_u," before adding new"));_s.setParentEventTarget(this),this.venues.push(_s),_a||(this.reloadData_(),this.reloadStyle_())}},{key:"addVenues",value:function(){var _s=this,_a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];0<_a.length&&(_a.forEach(function(_u){_u instanceof U0&&_s.addVenue(_u,!0)}),this.reloadData_(),this.reloadStyle_())}},{key:"removeVenue",value:function(_s){var _a;_s instanceof U0&&-1<this.venues.indexOf(_s)&&(_a=_s.getIdentifier(),this.activeVenue&&this.activeVenue.getIdentifier()===_a&&this.setActiveVenue(null),this.venues.splice(this.venues.indexOf(_s),1),this.reloadData_(),this.reloadStyle_(),this.reload())}},{key:"getFeatureProxy",value:function(ny,_a,_u){var _d=ny.geometryId,ny=ny.venueId,ny=this.getVenue(ny);return _d?_u(ny.getGeometries().find(function(sy){return sy.id===_d})):ny&&_u(ny),!0}},{key:"addVenueEventListeners_",value:function(_s){_s&&(_s.addEventListener(U0.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),_s.addEventListener(U0.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),_s.addEventListener(U0.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"removeVenueEventListeners_",value:function(_s){_s&&(_s.removeEventListener(U0.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),_s.removeEventListener(U0.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),_s.removeEventListener(U0.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"activeVenueChangeHandler_",value:function(_u){var _a=_u.oldValue,_u=_u.newValue;_a&&(this.removeVenueEventListeners_(_a),_a.updateMapObjectsVisibility_()),_u&&(this.addVenueEventListeners_(_u),_u.updateMapObjectsVisibility_())}},{key:"drawingChangeHandler_",value:function(){this.reload()}},{key:"levelChangeHandler_",value:function(){this.activeVenue&&(this.activeVenue.updateMapObjectsVisibility_(),this.reload())}},{key:"geometryHighlightHandler_",value:function(){this.reloadStyle_(this.activeVenue.getHighlightedGeometries())}},{key:"createDataLayers_",value:function(){var _s=this,_a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:Object.keys(T0),_u=T0.FOOTPRINT,_d=T0.ICON,ny=T0.TEXT,sy=T0.VECTOR;_a.forEach(function(ay){switch(ay){case sy:_s.dataLayers_[sy]=B1.getGeometryLayer(_s.venues);break;case _u:_s.dataLayers_[_u]=B1.getFootprintLayer(_s.venues);break;case _d:_s.dataLayers_[_d]=B1.getIconLayer(_s.venues);break;case ny:_s.dataLayers_[ny]=B1.getLabelLayer(_s.venues);break;default:throw new Error("Unsupported Layer ".concat(ay))}})}},{key:"createTileIndexes_",value:function(){var _s=this;(0<arguments.length&&arguments[0]!==void 0?arguments[0]:Object.keys(T0)).forEach(function(_a){_s.tileIndexes_[_a]=new t1(_s.dataLayers_[_a],$1)})}},{key:"reloadData_",value:function(){var _s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:Object.keys(T0);this.createDataLayers_(_s),this.createTileIndexes_(_s)}},{key:"reloadStyle_",value:function(_s){var _a=this.dataLayers_[T0.ICON]?this.dataLayers_[T0.ICON].features:[];this.getEngineType()===H.Map.EngineType.WEBGL?this.setStyle(d_.getStyle(_a,_s)):this.getEngineType()===H.Map.EngineType.HARP&&this.setStyle(f_.getStyle(_a,_s))}},{key:"providesGeoJSON",value:function(){return!0}}]),_i}(),y_=new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3}),v_=new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3}),m_=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImIiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PG1hc2sgaWQ9ImMiIHdpZHRoPSIzOCIgaGVpZ2h0PSI0NiIgeD0iMCIgeT0iMCIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZWxsaXBzZSBjeD0iMjAiIGN5PSI0NS4xNiIgZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjOTc5Nzk3IiBzdHJva2Utd2lkdGg9Ii4yNSIgcng9IjMuNSIgcnk9IjMuNSIvPjx1c2UgZmlsbD0iIzAxQjZCMiIgeGxpbms6aHJlZj0iI2IiLz48cGF0aCBmaWxsPSIjMzIzMjMyIiBmaWxsLW9wYWNpdHk9Ii41IiBkPSJNMTEuODEgMzcuNjZoMTYuMzhsLTguMiA4eiIvPjx1c2Ugc3Ryb2tlPSIjNDE2QTg2IiBzdHJva2Utd2lkdGg9Ii41IiBtYXNrPSJ1cmwoI2MpIiB4bGluazpocmVmPSIjYSIvPjxlbGxpcHNlIGN4PSIxOS44MSIgY3k9IjE5LjE5IiBmaWxsPSIjRkZGIiByeD0iNC44MSIgcnk9IjQuODEiLz48L2c+PC9zdmc+"),__=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzMi44MyAzMy4xMDRjLjQwNy0uMzc0IDEuNDE5LTEuNDUyIDEuNDE5LTEuNDUyeiIvPjxtYXNrIGlkPSJjIiB3aWR0aD0iMzgiIGhlaWdodD0iNDYiIHg9IjAiIHk9IjAiIGZpbGw9IiNmZmYiPjx1c2UgeGxpbms6aHJlZj0iI2EiLz48L21hc2s+PGVsbGlwc2UgaWQ9ImIiIGN4PSIxOS44MDciIGN5PSIxOS4xNjgiIHJ4PSIxMi4zNjMiIHJ5PSIxMi4xOTciLz48bWFzayBpZD0iZCIgd2lkdGg9IjI1LjcyNSIgaGVpZ2h0PSIyNS4zOTQiIHg9Ii0uNSIgeT0iLS41Ij48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNi45NDQgNi40NzFoMjUuNzI1djI1LjM5NEg2Ljk0NHoiLz48dXNlIHhsaW5rOmhyZWY9IiNiIi8+PC9tYXNrPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxlbGxpcHNlIGN4PSIyMCIgY3k9IjQ1LjE2IiBmaWxsPSIjRkZGIiBzdHJva2U9IiM5Nzk3OTciIHN0cm9rZS13aWR0aD0iLjI1IiByeD0iMy41IiByeT0iMy41Ii8+PHVzZSBmaWxsPSIjMzIzMjMyIiB4bGluazpocmVmPSIjYSIvPjxwYXRoIGZpbGw9IiM3RDdEN0QiIGQ9Ik0xMi4wMTEgMzcuODA1aDE1Ljk3OGwtNy45MTYgOHoiLz48dXNlIHN0cm9rZT0iIzdDN0M3QyIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNlKSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNjKSIgeGxpbms6aHJlZj0iI2EiLz48ZWxsaXBzZSBmaWxsPSIjRkZGIiBjeD0iMTkuODA3IiBjeT0iMTkuMTY4IiByeD0iMTIuMzYzIiByeT0iMTIuMTk3Ii8+PHBhdGggZmlsbD0iIzMyMzIzMiIgZD0iTTYuODEyIDYuOTQ4aDYuNDV2Ni4zNjRoLTYuNDV6bTAgMTIuNzI3aDYuNDV2Ni4zNjRoLTYuNDV6bTYuNDUtNi4zNjNoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS0xOS4wOTFoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS02LjM2M2g2LjQ1djYuMzY0aC02LjQ1em0wIDEyLjcyN2g2LjQ1djYuMzY0aC02LjQ1eiIvPjx1c2Ugc3Ryb2tlPSIjRkZGIiBtYXNrPSJ1cmwoI2QpIiB4bGluazpocmVmPSIjYiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIvPjwvZz48L3N2Zz4="),F1=function(){function ey(_i,_s){j(this,ey),this.indoorMapObjects_=null,this.outdoorMapObjects_=null,this.createRouteObjects_(_i,_s)}return _t(ey,[{key:"createRouteObjects_",value:function(_i){for(var _s=this,_i=_i.sections,_a=_i===void 0?[]:_i,_u=1<arguments.length&&arguments[1]!==void 0?arguments[1]:V0,_d=(this.indoorMapObjects_={},this.outdoorMapObjects_=new H.map.Group,function(ay){var uy,dy=_a[ay],_y=dy.departure.place,my=_y.id,_y=_y.type,Fy=H.util.flexiblePolyline.decode(dy.polyline).polyline,Vy=void 0,Iy=void 0,Ky=_u(ay,_a,ey.ObjectType.SEGMENT_START_MARKER),Ky=(Ky&&(Vy=new H.map.Marker(dy.departure.place.location,{icon:Ky})),_u(ay,_a,ey.ObjectType.SEGMENT_FINISH_MARKER)),zy=(Ky&&(Iy=new H.map.Marker(dy.arrival.place.location,{icon:Ky})),_u(ay,_a,ey.ObjectType.SEGMENT_POLYLINE));_y==="indoor"?(Ky=function(){var Oy=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],ky=new Map,Ry=new H.geo.LineString,Dy=ty(Oy[0],3)[2];return ky.set(Dy,[Ry]),Oy.forEach(function(Jy){Jy[2]!==Dy&&(Dy=Jy[2],Ry=new H.geo.LineString,ky.has(Dy)?ky.get(Dy).push(Ry):ky.set(Dy,[Ry])),Ry.pushLatLngAlt.apply(Ry,oy(Jy))}),ky}(Fy),uy=Array.from(Ky.keys()).reduce(function(Oy,ky){return Oy[ky]||(Oy[ky]=new H.map.Group),Oy},{}),zy&&Ky.forEach(function(Oy,ky){Oy.forEach(function(Ry){1<Ry.getPointCount()&&(Ry=new H.map.Polyline(Ry,{style:zy}),uy[ky].addObject(Ry))})}),Vy&&uy[dy.departure.place.location.lvl].addObject(Vy),Iy&&uy[dy.arrival.place.location.lvl].addObject(Iy),_s.indoorMapObjects_[my]=h(h({},_s.indoorMapObjects_[my]||{}),uy)):(zy&&(ay=new H.geo.LineString(Fy.flatMap(function(Oy){return[Oy[0],Oy[1],0]})),_y=new H.map.Polyline(ay,{style:zy}),_s.outdoorMapObjects_.addObject(_y)),Vy&&_s.outdoorMapObjects_.addObject(Vy),Iy&&_s.outdoorMapObjects_.addObject(Iy))}),ny=0;ny<_a.length;ny++)_d(ny)}},{key:"getIndoorObjects",value:function(){return this.indoorMapObjects_}},{key:"getOutdoorObjects",value:function(){return this.outdoorMapObjects_}}]),ey}(),q1=(F1.ObjectType={SEGMENT_START_MARKER:1,SEGMENT_FINISH_MARKER:2,SEGMENT_POLYLINE:3},function(){_r(_i,H.service.Service);var ey=_p(_i);function _i(_s){j(this,_i),_a=ey.call(this,_i,h(h({},_s),{},{baseUrl:void 0}));var _a,_u={apiKey:_s.apikey,baseUrl:_s.baseUrl,token:_s.token},_d={apiKey:_u.apiKey,token:_u.token},ny=(_u.apiKey||(_u.apiKey=_a.getUrl().getQuery().apikey),_s.useLegacy||!1);return _a.venueService_=new r_(_u,ny),_d.apiKey||(_d.apiKey=_a.getUrl().getQuery().apikey),_s.routingBaseUrl&&(_d.baseUrl=_s.routingBaseUrl),_a.routingService_=new p_(_d),_a}return _t(_i,[{key:"loadVenue",value:function(_s){return console.warn("Venue service version 1 is no longer supported hence "+_s+" could not be loaded"),Promise.resolve()}},{key:"calculateRoute",value:function(_s){return console.warn("HERE Indoor Routing is deprecated and will be removed soon."),this.routingService_.calculateRoute(_s)}}]),_i}()),U1=(q1.CONFIG_KEY="venues",function(){_r(_i,H.service.Service);var ey=_p(_i);function _i(_d){j(this,_i),_a=ey.call(this,_i,h(h({},_d),{},{baseUrl:void 0}));var _a,_u={apiKey:_d.apikey,baseUrl:_d.baseUrl,token:_d.token,hrn:_d.hrn},_d=(_u.apiKey||(_u.apiKey=_a.getUrl().getQuery().apikey),_d.useLegacy||!1);return _a.venueService_=new r_(_u,_d),_a}return _t(_i,[{key:"loadVenue",value:function(_s){return this.venueService_.load(_s,1<arguments.length&&arguments[1]!==void 0?arguments[1]:{}).then(function(_a){return new U0(_a)})}},{key:"getMapInfoList",value:function(){return this.venueService_.getSupportedMapList()}}]),_i}()),h0=(U1.CONFIG_KEY="indoorMaps",H.service.Platform.prototype.getVenuesService=function(ey,_i){var _s=U1;return _i!==1&&_i?_i!==E1.v2||ey.token||(ey.hrn?ey.apikey||console.error("Venue Service version 2 requires either apikey or token"):console.error("Token is mandatory when Hrn is not provided in Venue Service version 2")):(console.warn("Venue service version 1 is no longer supported"),_s=q1),this.createService(_s,ey)},U1.LABEL_TEXT_PREFERENCE_OVERRIDE={OCCUPANT_NAMES:"OCCUPANT_NAMES",SPACE_NAME:"SPACE_NAME",SPACE_TYPE_NAME:"SPACE_TYPE_NAME",SPACE_CATEGORY_NAME:"SPACE_CATEGORY_NAME",INTERNAL_ADDRESS:"INTERNAL_ADDRESS"},function(){_r(_i,H.ui.Control);var ey=_p(_i);function _i(_s){var _a,_u=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return j(this,_i),(_a=ey.call(this)).provider_=null,_a.levelSelectorUI_=null,_a.setAlignment(_u&&_u.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),_a.addClass("venues-ui"),_s instanceof U0&&_a.setVenue(_s),_a}return _t(_i,[{key:"renderInternal",value:function(_s,_a){_g(_n(_i.prototype),"renderInternal",this).call(this,_s,_a),this.createLevelSelectorUI_(_s),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(_s){_s instanceof U0&&(this.removeEventListeners_(),this.venue=_s,this.provider_=_s.getParentEventTarget(),this.update_(),this.addEventListeners_())}},{key:"createLevelSelectorUI_",value:function(_s){var _a=this;_s.innerHTML="",this.levelSelectorUI_=null,this.levelSelectorUI_=new g1(_s,null,null,function(_u){return _a.venue.setActiveLevelIndex(_u)})}},{key:"update_",value:function(){var _s,_a;this.levelSelectorUI_&&(_s=this.venue.getActiveDrawing().getData(),_a=this.venue.getData().getDisplaySettings(),this.levelSelectorUI_.update(_s,_a),this.levelChangeHandler_())}},{key:"addEventListeners_",value:function(){this.venue&&(this.venue.addEventListener(U0.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.addEventListener(U0.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.addEventListener(U0.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&(this.venue.removeEventListener(U0.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.removeEventListener(U0.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.removeEventListener(U0.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"levelChangeHandler_",value:function(){this.levelSelectorUI_.switch(this.venue.getActiveLevelIndex())}},{key:"drawingChangeHandler_",value:function(){this.update_()}},{key:"activeVenueChangeHandler_",value:function(_s){this.setVenue(_s.newValue)}}]),_i}()),W1=function(){_r(_i,H.ui.Control);var ey=_p(_i);function _i(_s){var _a,_u=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return j(this,_i),(_a=ey.call(this)).provider_=null,_a.drawingSelectorUI_=null,_a.addClass("venues-ui"),_a.setAlignment(_u&&_u.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),_s instanceof U0&&_a.setVenue(_s),_a}return _t(_i,[{key:"renderInternal",value:function(_s,_a){_g(_n(_i.prototype),"renderInternal",this).call(this,_s,_a),this.createDrawingSelectorUI_(_s),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(_s){_s instanceof U0&&(this.removeEventListeners_(),this.venue=_s,this.provider_=_s.getParentEventTarget(),this.drawingSelectorUI_&&this.drawingSelectorUI_.update(_s.getData()),this.addEventListeners_())}},{key:"createDrawingSelectorUI_",value:function(_s){var _a=this;_s.innerHTML="",this.drawingSelectorUI_=null,this.drawingSelectorUI_=new R0(_s,null,function(_u){return _a.venue.setActiveDrawing(_u)})}},{key:"addEventListeners_",value:function(){this.venue&&this.venue.addEventListener(U0.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.addEventListener(U0.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&this.venue.removeEventListener(U0.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.removeEventListener(U0.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"drawingChangeHandler_",value:function(){this.drawingSelectorUI_.switch(this.venue.getActiveDrawing().id)}},{key:"activeVenueChangeHandler_",value:function(_s){this.setVenue(_s.newValue)}}]),_i}(),W1=Object.freeze({__proto__:null,DrawingControl:W1,LevelControl:h0});return o(`.venues-ui * {
  font-family: "Fira Sans", "Helvetica Neue", Helvetica, sans-serif;
  color: #0F1621;
}
.venues-ui .arrow {
  display: block;
  width: 100%;
  height: 100%;
  background-repeat: no-repeat;
  background-position: center;
}
.venues-ui .arrow--up {
  background-image: url("data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-426.000000, -584.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls-Copy' transform='translate(417.753906, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(15.000000, 16.499023) rotate(-180.000000) translate(-15.000000, -16.499023) translate(9.000000, 12.749023)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
.venues-ui .arrow--down {
  background-image: url("data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-347.000000, -704.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls' transform='translate(338.251953, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(9.000000, 132.746094)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
.venues-ui .venues-ui-button {
  display: block;
  width: 40px;
  height: 40px;
  line-height: 40px;
  font-size: 16px;
  font-weight: 600;
  background-color: #fff;
  border: none;
  border-bottom: 1px solid #9FA2A6;
  cursor: pointer;
  overflow: hidden;
  color: #6e737a;
  text-align: center;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.venues-ui .venues-ui-button:hover, .venues-ui .venues-ui-button--active {
  background-color: #f0f0f0;
  color: #0F1621;
}
@keyframes fade {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}
.venues-ui__drawings .drawings {
  position: absolute;
  top: 0;
  right: 45px;
  display: none;
  opacity: 0;
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__drawings .drawings--open {
  display: block;
  opacity: 1;
  animation: fade 1s;
}
.venues-ui__drawings .drawings .venues-ui-button {
  width: auto;
  padding: 0 10px;
}
.venues-ui__drawings .drawings .venues-ui-button:first-of-type {
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
}
.venues-ui__drawings .drawings .venues-ui-button:last-of-type {
  border-bottom-left-radius: 5px;
  border-bottom-right-radius: 5px;
}
.venues-ui__drawings .trigger {
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__drawings .trigger .arrow {
  transform: rotate(0);
  transition: 0.4s;
}
.venues-ui__drawings .trigger.venues-ui-button--active .arrow {
  transform: rotate(90deg);
  transition: 0.4s;
}
.venues-ui__levels {
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__levels .levels {
  overflow: hidden;
}
.venues-ui__levels .venues-ui-button--up + .levels .venues-ui-button {
  border-radius: 0;
}
.venues-ui__levels .venues-ui-button:first-of-type {
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
}
.venues-ui__levels .venues-ui-button:last-of-type {
  border-bottom-left-radius: 5px;
  border-bottom-right-radius: 5px;
}
.venues-ui__levels .venues-ui-button[disabled=disabled] .arrow {
  opacity: 0.5;
}
.venues-ui__directory {
  position: absolute;
  top: 10px;
  right: 60px;
  bottom: calc(100% - 45px);
  width: 350px;
  overflow: hidden;
  background: white;
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__directory.active {
  bottom: 10px;
}
.venues-ui__directory .directory__list {
  top: 80px;
  bottom: 20px;
  position: absolute;
  overflow-y: scroll;
  right: 10px;
  left: 10px;
  font-size: 12px;
}
.venues-ui__directory .directory__list svg {
  width: 25px;
  height: 25px;
}
.venues-ui__directory .directory__heading {
  margin: 8px;
  font-size: 15px;
  font-weight: normal;
  cursor: pointer;
}
.venues-ui__directory .directory__input {
  margin: 10px;
}
.venues-ui__directory .directory__input input {
  width: 100%;
  padding: 5px 0;
}
.venues-ui__directory .directory__trigger {
  position: absolute;
  right: 10px;
  top: 15px;
  width: 10px;
  height: 10px;
}
.venues-ui__directory .directory__trigger .arrow {
  transform: rotate(0);
  transition: 0.4s;
}
.venues-ui__directory .directory__trigger--active .arrow {
  transform: rotate(-180deg);
  transition: 0.4s;
}`),e.Drawing=gy,e.Geometry=py,e.Level=by,e.Provider=l0,e.Route=F1,e.Service=q1,e.Service2=U1,e.Venue=U0,e.ui=W1,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}).call(self);const H$1=H;async function getIntersectingArea(e){var d,g,_;if(!e.orsKey)throw new MissingKeyError("API key not provided. Go to settings to save a key");if(!(e!=null&&e.locations)||!(e!=null&&e.range))throw new InvalidParameterError("Required parameters to get intersecting area were not present");const s={locations:e.locations.map(j=>[j.lng,j.lat]),range:[60*e.range[0]],smoothing:10},h={body:JSON.stringify(s),method:"POST",headers:{Authorization:e.orsKey,"content-type":"application/json"}};try{console.info("Making request to openRouteService for isochones"),console.debug(`Sending request options: ${JSON.stringify(h)}`);const j=await fetch("https://api.openrouteservice.org/v2/isochrones/driving-car",h);console.info("Successfully called openRouteService");let $;if((d=j.headers.get("content-type"))!=null&&d.includes("json")?$=await j.json():$=await j.text(),console.debug(`Received response: ${JSON.stringify($)}`),!$.features)throw new Error("Invalid response for retrieving isochrone polygon");if(!((_=(g=$==null?void 0:$.features[0])==null?void 0:g.properties)!=null&&_.center))throw new Error("Did not receive required center location or poly coordinates");return{center:reverseLatAndLong($.features[0].properties.center),poly:constructReverseCoordinates($.features[0].geometry.coordinates[0])}}catch(j){throw console.log(`OpenRouteService request at 'getIntersectingArea' return an error: ${j}`),j}}function constructReverseCoordinates(e){const o=[];for(const s of e)o.push([s[1],s[0]]);return console.debug(`reversed coordinates for polygon map ${o}`),o}function reverseLatAndLong(e){return!e||e.length===0?{lat:0,lng:0}:{lat:e[1],lng:e[0]}}function Map$1({addresses:e}){const{hereKey:o,openRouteServiceKey:s}=reactExports.useContext(SettingsContext),h=reactExports.useRef(null),d=reactExports.useRef(null),g=reactExports.useRef(null),[_,j]=reactExports.useState();function $(){return new H$1.map.Marker({lat:e[0].position.lat,lng:e[0].position.lng})}async function _t(){if(e){console.info("Creating polygon details");const _n=await getIntersectingArea({locations:[e[0].position],range:[e[0].distance],orsKey:s});console.debug(`Polygon data: ${JSON.stringify(_n)}`);const _o={area:_n.poly,center:_n.center,markers:$()};console.debug(`Formatted polygon: ${_o}`),j(_o)}}function _e(_n){let _o=[];_.area.forEach(_l=>_o.push(_l[0],_l[1],100));const ga=new H$1.geo.LineString(_o);_n.removeObjects(_n.getObjects()),_n.addObject(new H$1.map.Polygon(ga)),_.markers&&_n.addObject(_.markers)}function _r(_n){if(console.info("Creating map"),!h.current)throw new Error("Map not found on page");g.current=new H$1.service.Platform({apikey:o});const _o=g.current.getRasterTileService({queryParams:{style:"explore.day",size:512}}),ga=new H$1.service.rasterTile.Provider(_o),_l=new H$1.map.layer.TileLayer(ga),_f=new H$1.Map(h.current,_l,{pixelRatio:window.devicePixelRatio,center:{lat:_n.lat,lng:_n.lng}});return _f.setZoom(11),_f}return reactExports.useEffect(()=>{console.info("useEffect: address, distance"),console.debug(`trigger address: ${JSON.stringify(e)}`),_t()},[e]),reactExports.useEffect(()=>{console.info("useEffect: polygon"),console.debug(`polygon updated: ${_}`),!d.current&&(_!=null&&_.center)?(d.current=_r(_.center),window.addEventListener("resize",()=>d.current.getViewPort().resize()),_e(d.current)):d.current&&(_!=null&&_.center)&&(d.current.setCenter(_.center),_e(d.current))},[_]),e?jsxRuntimeExports.jsx("div",{style:{width:"100%",height:"100%"},ref:h}):jsxRuntimeExports.jsx("div",{className:"text-gray-500",children:"Enter an address.."})}function Search(){const{addresses:e}=reactExports.useContext(SearchContext);return jsxRuntimeExports.jsx("div",{className:"w-full h-full flex flex-col",children:jsxRuntimeExports.jsxs("div",{id:"content",className:"flex h-full",children:[jsxRuntimeExports.jsx("div",{id:"sidebar",className:"w-1/4 mt-6 flex flex-col justify-between",children:jsxRuntimeExports.jsxs("div",{id:"top",className:"mx-4",children:[jsxRuntimeExports.jsx("h2",{children:"Locations"}),jsxRuntimeExports.jsx("div",{id:"addresses",className:"flex flex-col gap-4",children:e==null?void 0:e.map((o,s)=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(InputBox,{inputType:"text",labelText:"Address 1",value:o==null?void 0:o.label,inputUpdate:()=>{}}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("div",{className:"w-[40%]",children:jsxRuntimeExports.jsx(InputBox,{inputType:"text",labelText:"Distance (time)",value:o.distance.toString(),inputUpdate:()=>{}})}),jsxRuntimeExports.jsx("div",{className:"w-[55%]",children:jsxRuntimeExports.jsx(InputBox,{inputType:"text",labelText:"Label",value:"Home",inputUpdate:()=>{}})})]})]},s))})]})}),jsxRuntimeExports.jsx("div",{id:"map",className:"w-3/4 flex justify-center items-center bg-slate-300",children:jsxRuntimeExports.jsx(Map$1,{addresses:e})})]})})}function Settings(){const e=useNavigate(),o=reactExports.useRef(""),s=reactExports.useRef(""),{setHereKey:h,setOpenRouteServiceKey:d}=reactExports.useContext(SettingsContext);return jsxRuntimeExports.jsxs("div",{id:"settings",className:"h-full flex flex-col justify-center items-center gap-6",children:[jsxRuntimeExports.jsxs("div",{id:"here",className:"text-left",children:[jsxRuntimeExports.jsx("a",{href:"https://www.here.com/docs/bundle/identity-and-access-management-developer-guide/page/topics/dev-apikey.html",className:"underline decoration-dashed",children:"Here Developer Key"}),jsxRuntimeExports.jsx(InputBox,{inputType:"text",labelText:"Key",inputUpdate:g=>{o.current=g}})]}),jsxRuntimeExports.jsxs("div",{id:"openRoute",children:[jsxRuntimeExports.jsx("a",{href:"https://openrouteservice.org/plans/",className:"underline decoration-dashed",children:"ORS Developer Key"}),jsxRuntimeExports.jsx(InputBox,{inputType:"text",labelText:"Key",inputUpdate:g=>{s.current=g}})]}),jsxRuntimeExports.jsx("button",{className:"border  py-1 px-4",onClick:()=>{console.log("we save"),h(o.current),d(s.current),e("/")},children:"Save"})]})}const routes=[{path:"",element:jsxRuntimeExports.jsx(Home,{})},{path:"/search",element:jsxRuntimeExports.jsx(Search,{})},{path:"/settings",element:jsxRuntimeExports.jsx(Settings,{})},{path:"*",element:jsxRuntimeExports.jsx(NotFound,{})}];function ErrorView(){return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col gap-4 justify-center items-center",children:[jsxRuntimeExports.jsx(PiSmileySadLight,{size:64}),jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"Something went wrong"})]})}const router=createBrowserRouter([{element:jsxRuntimeExports.jsx(RootLayout,{}),errorElement:jsxRuntimeExports.jsx(ErrorView,{}),children:routes}]);client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(RouterProvider,{router})}))});export default E_();
